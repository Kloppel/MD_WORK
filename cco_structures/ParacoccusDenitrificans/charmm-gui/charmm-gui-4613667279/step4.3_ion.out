1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 46b1     August 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
      Current operating system: Linux-3.10.0-1160.45.1.el7.x86_64(x86_64)       
                 Created on  3/1/22 at  7:38:00 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 01. 2022. JOBID=4613667279
 RDTITL> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 3000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     3000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream toppar.str
 VOPEN> Attempting to open::toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 01. 2022. JOBID=4613667279
 RDTITL> * STREAM FILE FOR TOPOLOGY AND PARAMETER READING
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! protein topology and parameter
 CHARMM>    open read card unit 10 name toppar/top_all36_prot.rtf
 VOPEN> Attempting to open::toppar/top_all36_prot.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_prot.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *>>>>>>>>CHARMM36 ALL-HYDROGEN TOPOLOGY FILE FOR PROTEINS <<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> MAY 2011 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36m_prot.prm
 VOPEN> Attempting to open::toppar/par_all36m_prot.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36m_prot.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *>>>> CHARMM36 ALL-HYDROGEN PARAMETER FILE FOR PROTEINS <<<<<<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! nucleic acids
 CHARMM>    open read card unit 10 name toppar/top_all36_na.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_na.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_na.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID TOPOLOGY FILE ////
 TITLE> *   ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                      APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *           PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_na.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_na.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_na.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID PARAMETER FILE ////
 TITLE> *         ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                        APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG PARAMETER
 TITLE> *                     SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! carbohydrates
 CHARMM>    open read card unit 10 name toppar/top_all36_carb.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_carb.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_carb.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * $ID: TOP_ALLXX_SUGAR.INP,V 1.106 2014/08/19 19:07:43 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN TOPOLOGIES USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_carb.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_carb.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_carb.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * $ID: PAR_ALLXX_SUGAR.INP,V 1.132 2014/08/19 19:03:21 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN PARAMETERS USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! lipids
 CHARMM>    open read card unit 10 name toppar/top_all36_lipid.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_lipid.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_lipid.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID TOPOLOGY FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_lipid.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_lipid.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_lipid.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID PARAMETER FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! CGENFF
 CHARMM>    open read card unit 10 name toppar/top_all36_cgenff.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_cgenff.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_cgenff.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_cgenff.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_cgenff.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_cgenff.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! Phosphates and Sulfates
 CHARMM>    stream toppar/toppar_all36_moreions.str
 VOPEN> Attempting to open::toppar/toppar_all36_moreions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_moreions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIONAL IONS GENERATED USING CGENFF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "345"
 Parameter: NAT <- "345"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "345"
 Parameter: NAT -> "345"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""345"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "345" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES GENERATED BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Interface FF
 CHARMM>    open read card unit 10 name toppar/top_interface.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_interface.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_interface.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY FOR NANOMATERIALS
 TITLE> *
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO17      -1.050
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO21      -1.050
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/par_interface.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_interface.prm::
 OPNLGU> Unit 10 opened for READONLY access to toppar/par_interface.prm
  
 CHARMM>    read para card unit 10 append flex

          PARAMETER FILE BEING READ FROM UNIT 10
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY AND PARAMETER FOR CALY MINERALS, CEMENT MINERALS
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 10950): HGR6  ICG1  ICG1  ICGE is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    stream toppar/toppar_all36_nano_lig.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR NANO-LIGAND
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_nano_lig_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for synthetic polymer
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_polymer_solvent.str
 VOPEN> Attempting to open::toppar/toppar_all36_polymer_solvent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_polymer_solvent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for water and ions
 CHARMM>    stream toppar/toppar_water_ions.str
 VOPEN> Attempting to open::toppar/toppar_water_ions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_water_ions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR WATER AND IONS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_water_ions.inp
 CHARMM>     
  
 CHARMM>    ! IMPORTANT NOTE: this file contains NBFixes between carboxylates and sodium,
 CHARMM>    ! which will only apply if the main files containing carboxylate atom types
 CHARMM>    ! have been read in first!
 CHARMM>     
  
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !TIP3P water model
 CHARMM>    !
 CHARMM>    !W.L. Jorgensen; J.Chandrasekhar; J.D. Madura; R.W. Impey;
 CHARMM>    !M.L. Klein; "Comparison of simple potential functions for
 CHARMM>    !simulating liquid water", J. Chem. Phys. 79 926-935 (1983).
 CHARMM>    !
 CHARMM>    !IONS
 CHARMM>    !
 CHARMM>    !Ions from Roux and coworkers
 CHARMM>    !
 CHARMM>    !Beglov, D. and Roux, B., Finite Representation of an Infinite
 CHARMM>    !Bulk System: Solvent Boundary Potential for Computer Simulations,
 CHARMM>    !Journal of Chemical Physics, 1994, 100: 9050-9063
 CHARMM>    !
 CHARMM>    !ZINC
 CHARMM>    !
 CHARMM>    !Stote, R.H. and Karplus, M. Zinc Binding in Proteins and
 CHARMM>    !Solution: A Simple but Accurate Nonbonded Representation, PROTEINS:
 CHARMM>    !Structure, Function, and Genetics 23:12-31 (1995)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "455"
 Parameter: NAT <- "455"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "455"
 Parameter: NAT -> "455"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""455"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "455" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR WATER AND IONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for sodium interacting with
 CHARMM>    ! carboxylate oxygens of various CHARMM force fields. It will generate
 CHARMM>    ! level -1 warnings whenever any of these force fields have not been
 CHARMM>    ! read prior to the current stream file. Since we don't want to force
 CHARMM>    ! the user to always read all the force fields, we're suppressing the
 CHARMM>    ! warnings. The only side effect is that you will have "most severe
 CHARMM>    ! warning was at level 0" at the end of your output. Also note that
 CHARMM>    ! the user is responsible for reading the current file last if they
 CHARMM>    ! want the NBFixes to apply. A more elegant solution would require new
 CHARMM>    ! features to be added to CHARMM.
 CHARMM>    ! parallel fix, to avoid duplicated messages in the log
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CARBOXYLATE AND SODIUM
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_dum_noble_gases.str
 VOPEN> Attempting to open::toppar/toppar_dum_noble_gases.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_dum_noble_gases.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_dum_nobel_gases.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous	toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "472"
 Parameter: NAT <- "472"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "472"
 Parameter: NAT -> "472"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""472"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "472" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_ions_won.str
 VOPEN> Attempting to open::toppar/toppar_ions_won.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_ions_won.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOP_IONS_WON.STR: GENERAL MODEL FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !This is a comprehensive set of ions developed using stochastic boundary
 CHARMM>    !conditions. It is strongly recommended that ion parameters in
 CHARMM>    !toppar_water_ions.str be used if available, as they are more highly
 CHARMM>    !optimized.  Accordingly, those ions have been commented in this
 CHARMM>    !file.
 CHARMM>    !
 CHARMM>    !reference
 CHARMM>    !Won, Y., "Force Field for Monovalent, Divalent, and Trivalent Cations
 CHARMM>    !Developed under the Solvent Boundary Potential," Journal of Physical
 CHARMM>    !Chemistry A., 116: 11763-11767, 2012.
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "475"
 Parameter: NAT <- "475"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "475"
 Parameter: NAT -> "475"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""475"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "475" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PAR_CATION.PRM FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for protein
 CHARMM>    stream toppar/toppar_all36_prot_arg0.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_arg0.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_arg0.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>> ALL-HYDROGEN TOPOLOGY FOR NEUTRAL ARG <<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> 2007 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Atom names include "R" (for Arg) as the second letter. The
 CHARMM>    ! only other atom types in the additive FF with this second
 CHARMM>    ! letter are histidine [HN]R[123] in the protein FF and CRL[12]
 CHARMM>    ! in toppar_all36_lipid_cholesterol.str , so no more conflicts.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.rtf
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_arg0.inp
 CHARMM>     
  
 CHARMM>    !Li, L., Vorobyov, I.V., MacKerell, Jr., A.D., Allen, T.W., "Is
 CHARMM>    !arginine charged in a membrane?" Biophysical Journal, 94: L11-L13,
 CHARMM>    !2008, PMCID: PMC2157258
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MGU1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU1          0.00
*** WARNING **** residue MGU2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU2          0.00
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_c36m_d_aminoacids.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_c36m_d_aminoacids.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_c36m_d_aminoacids.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>>CHARMM36 ALL-HYDROGEN TOPPAR FILE FOR D-PROTEINS <<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 RDTITL> *             PARAMETER SET DISCUSSION FORUM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !update 2016/2. use directly inverted CMAPs
 CHARMM>     
  
 CHARMM>    !toppar stream file for D-amino acids. Includes new residue
 CHARMM>    !names, inverted CMAP and additional parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36m_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_d_amino_acid.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "539"
 Parameter: NAT <- "539"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "539"
 Parameter: NAT -> "539"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""539"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "539" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR D- AMINOACIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR D- AMINOACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_fluoro_alkanes.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_fluoro_alkanes.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_fluoro_alkanes.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR FLUORINATED ALKANES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !These parameters are maintained for historic reasons.  The CGenFF
 CHARMM>    !halogen parameters are a significant improvement over these
 CHARMM>    !parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_fluoro_alkanes.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Chen, I.-J., Yin, D. and MacKerell, Jr., A.D., "Combined Ab
 CHARMM>    !initio/Empirical Approach for Optimization of Lennard-Jones Parameters
 CHARMM>    !for Polar-Neutral Compounds," Journal of Computational Chemistry,
 CHARMM>    !2002, 23:199-213.
 CHARMM>    !
 CHARMM>    !Note that these parameters are higly optimized to reproduce the
 CHARMM>    !corresponding condensed phase properties and have not been incorporated
 CHARMM>    !into the CHARMM22 or CHARMM27 biomolecular force fields
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR FLUOROALKANES
 RDTITL> *
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA  0.0
*** WARNING **** residue FETH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FETH  0.0
*** WARNING **** residue DFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DFET 0.0
*** WARNING **** residue TFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFET  0.0
*** WARNING **** residue TFE  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFE   0.0
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * FLUOROALKANE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_heme.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_heme.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_heme.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR HEME AND RELATED
 RDTITL> * LIGANDS AND PATCHES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !updated 2016/2, allow for use of AUTOGENERATE ANGLE DIHEDRAl PATCH
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_heme.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HEME AND RELATED COMPOUNDS AND PATCHES
 RDTITL> *
*** WARNING **** residue CO2  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO2             0.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR HEME
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_na_combined.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_na_combined.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_na_combined.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR PATCHES TO CREATE
 RDTITL> * MODEL COMPOUNDS AND PATCHES THAT REQUIRE BOTH PROTEIN AND
 RDTITL> * NUCLEIC ACID TOPOLOGY AND PARAMETER INFORMATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>    !stream/toppar_all36_prot_fluoro_alkanes.str ! atom types an parameters for fluorinated compounds
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_na_combined.inp
 CHARMM>     
  
 CHARMM>    !all patches must be followed by AUTOGENERATE ANGLES DIHEDRALS
 CHARMM>     
  
 CHARMM>    !PHOSPHOTYROSINE
 CHARMM>    !
 CHARMM>    !Feng, M.-H., Philippopoulos, M., MacKerell, Jr., A.D. and Lim, C.
 CHARMM>    !Structural Characterization of the Phosphotyrosine Binding Region of a
 CHARMM>    !High-Affinity aSH2 Domain-Phosphopeptide Complex by Molecular Dynamics
 CHARMM>    !Simulation and Chemical Shift Calculations. Journal of the American
 CHARMM>    !Chemical Society, 1996, 118: 11265-11277.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
*** WARNING **** residue THFI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFI       0.00
*** WARNING **** residue THMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THMI       0.00
*** WARNING **** residue THFA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFA        0.00
*** WARNING **** residue THAO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THAO         0.00
*** WARNING **** residue RNUS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RNUS         0.00
*** WARNING **** residue NUCL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NUCL        -1.00
*** WARNING **** residue PPH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPH1      -1.00
*** WARNING **** residue BMPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPH      -1.00
*** WARNING **** residue BMPD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPD      -2.00
*** WARNING **** residue BDFP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFP      -1.00
*** WARNING **** residue BDFD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFD -2.00
*** WARNING **** residue EP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EP_2        -2.00
*** WARNING **** residue IP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IP_2        -2.00
 There were  13 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_retinol.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_retinol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_retinol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR RETINOL AND RETINAL PARAMETERS
 RDTITL> * A. LOCCISANO, A.M.W., J. EVANSECK AND A.D. MACKERELL, JR.
 RDTITL> * APRIL, 2005
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !use with c36 protein force fields
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * RETINAL/RETINOL AND RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue 13DB already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DB       0.00
*** WARNING **** residue 13DP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DP       0.00
*** WARNING **** residue DMB1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMB1       0.00
*** WARNING **** residue DMP1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP1       0.00
*** WARNING **** residue DMP2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP2       0.00
*** WARNING **** residue CROT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CROT       0.00
*** WARNING **** residue PACP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PACP       0.00
*** WARNING **** residue MECH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MECH       0.00
*** WARNING **** residue TMCH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TMCH       0.00
*** WARNING **** residue FRET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FRET       0.00
*** WARNING **** residue RTOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTOL       0.00
*** WARNING **** residue RTAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAL       0.00
*** WARNING **** residue RTAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAC      -1.00
*** WARNING **** residue PRAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAC      -1.00
*** WARNING **** residue PROL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROL       0.00
*** WARNING **** residue PRAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAL       0.00
*** WARNING **** residue SCH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH1       0.00
*** WARNING **** residue SCH2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH2       1.00
*** WARNING **** residue SCH3 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH3       1.00
 There were  20 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * RETINAL/RETINOL AND RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>> ALL-HYDROGEN TOPOLOGY FOR SMALL MODEL COMPOUNDS USED IN THE <<
 RDTITL> *>> DEVELOPMENT OF THE CHARMM22 PROTEIN ALL-HYDROGEN PARAMETERS <<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> JULY 1997 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *CONVERTED TO STREAM FORMAT, DECEMBER 2003
 RDTITL> *CONVERTED TO CHARMM36 PROTEIN ATOM TYPES, MAY 2011
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_model.inp
 CHARMM>     
  
 CHARMM>    !changes after 9/98
 CHARMM>    !
 CHARMM>    !change alkene HA1 and HA2 to HE1 and HE2
 CHARMM>    !
 CHARMM>    !improper atom ordering corrected
 CHARMM>    !
 CHARMM>    !version b5i to be consistent with protein toppar files
 CHARMM>    !
 CHARMM>    !Heme vinyl groups upgraded based on new butene parameters
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    ! references
 CHARMM>    !
 CHARMM>    !PROTEINS
 CHARMM>    !
 CHARMM>    !MacKerell, Jr., A. D.; Bashford, D.; Bellott, M.; Dunbrack Jr., R.L.;
 CHARMM>    !Evanseck, J.D.; Field, M.J.; Fischer, S.; Gao, J.; Guo, H.; Ha, S.;
 CHARMM>    !Joseph-McCarthy, D.; Kuchnir, L.; Kuczera, K.; Lau, F.T.K.; Mattos,
 CHARMM>    !C.; Michnick, S.; Ngo, T.; Nguyen, D.T.; Prodhom, B.; Reiher, III,
 CHARMM>    !W.E.; Roux, B.; Schlenkrich, M.; Smith, J.C.; Stote, R.; Straub, J.;
 CHARMM>    !Watanabe, M.; Wiorkiewicz-Kuczera, J.; Yin, D.; Karplus, M.  All-atom
 CHARMM>    !empirical potential for molecular modeling and dynamics Studies of
 CHARMM>    !proteins.  Journal of Physical Chemistry B, 1998, 102, 3586-3616.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue ACET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACET       -1.00
*** WARNING **** residue PROA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROA       -1.00
*** WARNING **** residue GUAN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GUAN        1.00
*** WARNING **** residue MGUA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGUA        1.00
*** WARNING **** residue GLYN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYN         0.00
*** WARNING **** residue MAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAMM        1.00
*** WARNING **** residue EAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EAMM        1.00
*** WARNING **** residue ACEH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEH        0.00
*** WARNING **** residue MEOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MEOH        0.00
*** WARNING **** residue METO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI METO       -1.00
*** WARNING **** residue ETOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETOH        0.00
*** WARNING **** residue ETO  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETO        -1.00
*** WARNING **** residue PRO2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRO2        0.00
*** WARNING **** residue FORM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FORM        0.00
*** WARNING **** residue ACEM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEM        0.00
*** WARNING **** residue NMA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NMA         0.00
*** WARNING **** residue MESH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MESH        0.00
*** WARNING **** residue MES1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MES1       -1.00
*** WARNING **** residue ETSH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETSH        0.00
*** WARNING **** residue ES1  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ES1        -1.00
*** WARNING **** residue DMDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMDS        0.00
*** WARNING **** residue DEDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DEDS        0.00
*** WARNING **** residue EMS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EMS         0.00
*** WARNING **** residue IMIA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIA        0.00
*** WARNING **** residue MIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MIMI        0.00
*** WARNING **** residue EIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMI        0.00
*** WARNING **** residue IMIM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIM        1.00
*** WARNING **** residue EIMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMM        1.00
*** WARNING **** residue BENZ already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BENZ        0.00
*** WARNING **** residue EBEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EBEN         0.00
*** WARNING **** residue PHEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEN        0.00
*** WARNING **** residue EPHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EPHE        0.00
*** WARNING **** residue PHEO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEO       -1.00
*** WARNING **** residue INDO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI INDO        0.00
*** WARNING **** residue EIND already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIND        0.00
*** WARNING **** residue PDIP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PDIP        0.00
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA        0.00
*** WARNING **** residue PRPA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPA        0.00
*** WARNING **** residue IBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IBUT        0.00
*** WARNING **** residue OCOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI OCOH    0.0
*** WARNING **** residue CO3  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO3  -2.0
*** WARNING **** residue C3   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI C3    0.00
 There were  42 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_modify_res.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_modify_res.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_modify_res.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR FILE FOR VARIOUS MODIFIED RESIDUES AND PATCHES, INCLUDING
 RDTITL> * PATCHES TO COVALENTLY LINK RESIDUES TO IONS TO WORK WITH THE
 RDTITL> * ADDITIVE C36 PROTEIN FORCE FIELD
 RDTITL> * REQUIRES CGENFF PARAMETER FILE
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Acetyllysine (ALY)
 CHARMM>    !Norleucine (NLE) and
 CHARMM>    ! residues and patches for Zn-protein interactions modeled using
 CHARMM>    ! bond and angles between the protein and Zn.
 CHARMM>     
  
 CHARMM>    !non-standard amino acids: 2021
 CHARMM>    !Croitoru, A., Park, S.-J., Kumar, A., Lee, J., Im, Wonpil; MacKerell,
 CHARMM>    !A.D., Jr., and Aleksandrov, A. Additive CHARMM36 Force Field for
 CHARMM>    !Nonstandard Amino Acids, Journal of Chemical Theory and Computation,
 CHARMM>    !17:3554-3570, doi: 10.1021/acs.jctc.1c00254.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPPAR FILE PROTEIN MODIFICATIONS
 RDTITL> *
*** WARNING **** residue CGU  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGU              -2.000
*** WARNING **** residue CME  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CME               0.000
*** WARNING **** residue HIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HIC               0.000
*** WARNING **** residue HICP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HICP              1.000
*** WARNING **** residue CGUP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGUP             -1.000
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for nucleic acids
 CHARMM>    stream toppar/toppar_all36_na_nad_ppi.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_nad_ppi.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_nad_ppi.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN NUCLEIC ACID FORCE TOPPAR STREAM FILE
 RDTITL> * NAD+, NADH, ADP, ATP, PPI AND RELATED ANALOGS
 RDTITL> * A.D. MACKERELL, JR., JULY 2001
 RDTITL> * STREAM FOLLOWING RTF AND PARAM READ OF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Update, 2015/1, nomenclature for NAD+ etc. consistent with PDB
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_na_nad_ppi.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Pavelites, J.J., Bash, P.A., Gao, J., and MacKerell, Jr.,
 CHARMM>    !A.D. A Molecular Mechanics Force Field for NAD+, NADH and the
 CHARMM>    !Pyrophosphate Groups of Nucleotides, Journal of Computational
 CHARMM>    !Chemistry, 1997, 18: 221-239.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * NAD, PPI TOPOLOGY
 RDTITL> *
*** WARNING **** residue NIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NIC         1.00
*** WARNING **** residue NICH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NICH         0.00
*** WARNING **** residue PPI1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI1        -3.00
*** WARNING **** residue PPI2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI2        -2.00
*** WARNING **** residue AMP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI AMP         -2.00
*** WARNING **** residue ADP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ADP         -3.00
*** WARNING **** residue ATP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ATP         -4.00
*** WARNING **** residue 5DP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES 5DP         -3.00
*** WARNING **** residue NAD  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NAD         -1.00
*** WARNING **** residue NADH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADH        -2.00
*** WARNING **** residue NADP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADP        -2.00
*** WARNING **** residue NDPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NDPH        -3.00
 There were  12 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NAD, PPI PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_na_rna_modified.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_rna_modified.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_rna_modified.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIVE CHARMM FORCE FIELD FOR MODIFIED RIBONUCLEIC ACIDS, INCLUDING
 RDTITL> * THOSE FOUNDS IN TRNA. YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> * |
 RDTITL> * WARNING: PARAMETERS AND ATOM TYPE ASSIGNMENTS IN THIS FILE ARE SPECIFIC
 RDTITL> * FOR THESE COMPOUNDS AND SHOULD UNDER NO CIRCUMSTANCES BE APPLIED TO
 RDTITL> * OTHER ORGANIC MOLECULES
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Xu, Y., Vanommeslaeghe, K., Aleksandrov, A., MacKerell, A.D.,
 CHARMM>    ! Jr. Nilsson, L., “Additive CHARMM force field for naturally
 CHARMM>    ! occurring modified ribonucleotides,” Journal of Computational
 CHARMM>    !  Chemistry, DOI: 10.1002/jcc.24307, 2016
 CHARMM>     
  
 CHARMM>    ! Should be used with parent files CGenFF: top_all36_cgenff.inp and par_all36_cgenff.inp
 CHARMM>    !                                    NA36: top_all36_na.inp and par_all36_na.inp
 CHARMM>    !                              and Carb36: top_all36_carb.inp and par_all36_carb.inp
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES OF MODIFIED NUCLEOTIDES
 RDTITL> *
*** WARNING **** residue BUG  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUG           -1.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIVE CHARMM PARAMETERS FOR MODIFIED NUCLEIC ACIDS, BETA VERSION
 RDTITL> * YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for lipids
 CHARMM>    stream toppar/toppar_all36_lipid_sphingo.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_sphingo.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_sphingo.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FOR CERAMIDES AND SPINGOMYELINS; REQUIRES FLEX FORMAT FILES
 RDTITL> * TOP_ALL36_LIPID.RTF AND PAR_ALL36_LIPID.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! PSM and SSM Lipids
 CHARMM>    !
 CHARMM>    ! Venable, R. M.; Sodt, A. J.; Rogaski, B.; Rui, H.; Hatcher, E.; MacKerell, A. D.;
 CHARMM>    ! Pastor, R. W.; Klauda, J. B., CHARMM All-Atom Additive Force Field for Sphingomyelin:
 CHARMM>    ! Elucidation of Hydrogen Bonding and of Positive Curvature. Biophys. J. 2014, 107 (1), 134-145
 CHARMM>    !
 CHARMM>    ! Ceramide
 CHARMM>    !
 CHARMM>    ! Submited by Sam Tonddast-Navaei of U. Cincinnati. Advised by Russell Devane
 CHARMM>    ! Tested by Eric Wang of U. Maryland. Advised by Jeffery Klauda
 CHARMM>    !
 CHARMM>    !
 CHARMM>    ! CerAP/Cer6, CerNP/Cer3, and CerEOS/Cer1
 CHARMM>    !
 CHARMM>    ! Wang, E.; Klauda, J. B., Structure and Permeability of Ceramide Bilayers and Multilayers.
 CHARMM>    ! J. Phys. Chem. B., 2019, 123, 11, 2525-2535
 CHARMM>    ! Wang, E.; Klauda, J. B., Molecular Structure of the Long Periodicity Phase in the Stratum Corneum.
 CHARMM>    ! J. Amer. Chem. Soc., 2019. 141, 42, 16930-16943
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "570"
 Parameter: NAT <- "570"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "570"
 Parameter: NAT -> "570"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""570"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "570" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CER/SM RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 14695): NHL   C     CTO1  HAL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 14716): O     C     CTO1  HAL1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_archaeal.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_archaeal.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_archaeal.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR ARCHAEAL LIPIDS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! This is an on-going file of archaeal lipids
 CHARMM>    ! I am adding meanquinone-7 now
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * ARCHAEAL LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY CGENFF
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_bacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_bacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_bacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! Branched Lipids
 CHARMM>    !
 CHARMM>    ! Lim, J.B. & Klauda, J.B. Branching at the Iso- and Anteiso- Positions in Complex Chlamydia
 CHARMM>    ! Membranes: A Molecular Dynamics Study. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1808:323-331 (2011).
 CHARMM>    !
 CHARMM>    ! Cyclic-replacement of double bond
 CHARMM>    !
 CHARMM>    ! Pandit, K.R. & Klauda, J.B. Membrane models of E. coli containing cyclic moieties in
 CHARMM>    ! the aliphatic lipid chain. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1818:1205-1210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cardiolipin.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cardiolipin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cardiolipin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL>  
 RDTITL> No title read.
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cholesterol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cholesterol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cholesterol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR CHOLESTEROL.  STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> * TOP_ALL36_CGENFF.RTF
 RDTITL> * AND PAR_ALL36_CGENFF.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !topology and parameters are included for two cholesterol models. the
 CHARMM>    !model may be selected by setting variable chol_model to 1 or 2, as
 CHARMM>    !specified below
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set chol_model 1 !2 for original Suits et al. model
 Parameter: CHOL_MODEL <- "1"
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    !1) Revised model of Lim et al.  This contains a number of NBFIXes that
 CHARMM>    !makes it unsuitable for ANTON (set chol_model 1)
 CHARMM>    !
 CHARMM>    !2) Original model of Suits et al., which is used on ANTON as well as
 CHARMM>    !being suitable for other systems (set chol_model 2 (or anything but 1....))
 CHARMM>    !
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    !Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>    !Suits, F., Pitman, M., MacKerell, A.D., Jr., Feller, S.E. "Molecular Level
 CHARMM>    !Organization of Saturated and Polyunsaturated Fatty Acids in a
 CHARMM>    !Phosphatidylcholine Bilayer Containing Cholesterol" Biochemistry,
 CHARMM>    !43(49):15318-28, 2004
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    !test "append"
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    if chol_model eq 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>    ! reference
 CHARMM>    ! Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    ! Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR CHOLESTEROL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CHOLESTEROL PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_dag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_dag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_dag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM DAG
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_inositol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_inositol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_inositol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lnp.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lnp.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lnp.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LNP
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
 **** WARNING from RTFRDR **** The total charge of the residue, DAGP,  -0.0100000,
 does not equal the expected charge,   0.0000000.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
          PRES DPEPEG
 **** WARNING from RTFRDR **** The total charge of the residue, DPEP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * LNP
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lps.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lps.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lps.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM LPS
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read param card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_mycobacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_mycobacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_mycobacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MYCOBACTERIAL (ACPIM2) RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_miscellaneous.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_miscellaneous.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_miscellaneous.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR MISCELLANEOUS LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETER FOR ACYL PYROPHOSPHATE: ADDED 2019_7
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN LIPID FORCE FIELD TOPPAR STREAM FILE
 RDTITL> * COLLECTION OF RESIDUES AND PATCHES FOR MODEL COMPOUNDS USED
 RDTITL> * IN THE OPTIMIZATION THE LIPID FORCE FIELD.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_lipid_model.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 LIPID MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MAS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAS          0.00
*** WARNING **** residue ETAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAC         0.00
*** WARNING **** residue MPRO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MPRO         0.00
*** WARNING **** residue MP_1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_1        -1.00
*** WARNING **** residue MP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_2        -2.00
*** WARNING **** residue MSO4 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MSO4        -1.00
*** WARNING **** residue BUTA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUTA         0.00
*** WARNING **** residue PENT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PENT         0.00
*** WARNING **** residue HEXA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HEXA         0.00
*** WARNING **** residue ETHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHE       0.00
*** WARNING **** residue PRPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPE       0.00
*** WARNING **** residue BTE1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE1       0.00
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue DIPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIPE       0.00
*** WARNING **** residue DIHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIHE       0.00
*** WARNING **** residue NC4  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC4          1.00
*** WARNING **** residue NC5  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC5          1.00
*** WARNING **** residue CHOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CHOL         1.00
*** WARNING **** residue ACHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACHO         1.00
*** WARNING **** residue PC   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PC           0.00
*** WARNING **** residue GPC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GPC          0.00
*** WARNING **** residue TEA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TEA          1.00
*** WARNING **** residue ETAM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAM       1.00
*** WARNING **** residue GLYC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYC         0.00
*** WARNING **** residue MBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MBUT         0.00
 There were  25 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_prot.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_prot.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_prot.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR LIPID TAIL LINKERS TO CYSTEINE AND GLYCINE,
 RDTITL> * FOR EXAMPLE, PALMITOYLATION, MARISTOYLATION, FERNASYLATION, GERANYLATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LIPID-MODIFIED PROTEIN RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CYSTEIN-PALMITATE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_tag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_tag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_tag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TRIACYLGLYCEROLS [STEPHEN GEE FROM LEHIGH UNIVERSITY]
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_yeast.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_yeast.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_yeast.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_hmmm.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_hmmm.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_hmmm.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TERMINAL PATCHES FOR HMMM TRUNCATED LIPIDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_detergent.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_detergent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_detergent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR DETERGENTS AND FATTY ACIDS.
 RDTITL> * STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Additional residues added by Im lab, Aug. 2017
 CHARMM>     
  
 CHARMM>    !Fatty acids added Jan. 2016
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * DETERGENT AND FATTY ACID RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SB3-12 AND SB3-14 PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_ether.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_ether.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_ether.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN ETHER LIPID FORCE FIELD INCLUDING PLASMALOGENS ALISON
 RDTITL> * N. LEONARD (A. L.), 7/18 WITH RICHARD PASTOR AND JEFFERY KLAUDA, JPCB 122(26)
 RDTITL> * PP. 6744 - 6754.  ANA WEST, 1/20 WITH VALERIA ZONI, WALTER TEAGUE JR., ALISON
 RDTITL> * LEONARD, STEFANO VANNI, KLAUS GAWRISCH, STEPHANIE TRISTAM-NAGLE, JONATHAN
 RDTITL> * SACHS, AND JEFFERY KLAUDA, JPCB 124(5) PP. 828 - 839.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>    !top_all36_cgenff.rtf
 CHARMM>    !par_all36_cgenff.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 ETHER MODEL COMPOUNDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for carbohydrates
 CHARMM>    stream toppar/toppar_all36_carb_glycolipid.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycolipid.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycolipid.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOLIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PIP RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_glycopeptide.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycopeptide.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycopeptide.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOPEPTIDE LINKAGES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_imlab.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_imlab.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_imlab.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for spin/fluorophore labels
 CHARMM>    stream toppar/toppar_all36_label_spin.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_spin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_spin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>> TOPOLOGY FOR NITROXYDE SPIN LABELS <<<<<<<
 RDTITL> * SHAHIDUL M. ISLAM, UNIVERSITY OF CHICAGO
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! please reference the following:
 CHARMM>    !Sezer, D., Freed J. H., and Roux, B. “Parametrization, Molecular Dynamics Simulation, and Calculation of Electron Spin
 CHARMM>    !Resonance Spectra of a Nitroxide Spin Label on a Polyalanine alpha-Helix” J. Phys. Chem. B 2008, 112, 5755-5767
 CHARMM>     
  
 CHARMM>    !Islam, S. M., and Roux, B. “Parameterization and molecular dynamics simulations of a
 CHARMM>    !conformationally constrained double linked spin label constrained by EPR/DEER data”
 CHARMM>    !(planed submission to J journal)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SPIN LABEL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR SPIN LABEL
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_label_fluorophore.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_fluorophore.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_fluorophore.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FILES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MINI FORCE FIELD PARAMETER FILE.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    ! Read PSF and Coordinates
 CHARMM>    open read unit 10 card name step1_pdbreader.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step1_pdbreader.psf::
 OPNLGU> Unit 10 opened for READONLY access to step1_pdbreader.psf
  
 CHARMM>    read psf  unit 10 card
 MAINIO> Protein structure file being read from unit  10.
 PSFRD2> Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 01. 2022. JOB
 TITLE>  * READ PDB, MANIPULATE STRUCTURE IF NEEDED, AND GENERATE TOPOLOGY FILE
 TITLE>  *  DATE:     3/ 1/22      7:20:29      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        7   Number of residues   =      785
         Number of atoms         =    12321   Number of groups     =     3804
         Number of bonds         =    12532   Number of angles     =    22620
         Number of dihedrals     =    33224   Number of impropers  =     2004
         Number of cross-terms   =      772
         Number of HB acceptors  =     1076   Number of HB donors  =     1154
         Number of NB exclusions =        0   Total charge =  -16.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step2_orient.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2_orient.crd::
 OPNLGU> Unit 10 opened for READONLY access to step2_orient.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * CALC TOPAREA = 2326.13557
 TITLE> * CALC BOTAREA = 2028.01025
 TITLE> * CALC XMAX = 23.9839799
 TITLE> * CALC XMIN = -28.8084268
 TITLE> * CALC YMAX = 30.4696795
 TITLE> * CALC YMIN = -30.8469461
 TITLE> * CALC ZMAX = 51.8767607
 TITLE> * CALC ZMIN = -46.0084784
 TITLE> *  DATE:     3/ 1/22      7:27:22      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    define PROT sele all end
 SELRPN>  12321 atoms have been selected out of  12321
  
 CHARMM>     
  
 CHARMM>    !Read the system information
 CHARMM>    stream step3_size.str
 VOPEN> Attempting to open::step3_size.str::
 OPNLGU> Unit 99 opened for READONLY access to step3_size.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A        = 112.065471
 Parameter: A <- "112.065471"
  
 CHARMM>     SET B        = 112.065471
 Parameter: B <- "112.065471"
  
 CHARMM>     SET C        = 142.885239
 Parameter: C <- "142.885239"
  
 CHARMM>     SET ALPHA    = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA     = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA    = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET ZCEN     = 2.93414115
 Parameter: ZCEN <- "2.93414115"
  
 CHARMM>     SET NLIPTOP  = 150
 Parameter: NLIPTOP <- "150"
  
 CHARMM>     SET NLIPBOT  = 154
 Parameter: NLIPBOT <- "154"
  
 CHARMM>     SET WBOXZ    = 22.5
 Parameter: WBOXZ <- "22.5"
  
 CHARMM>     SET WATBOXZ  = 54.3767607
 Parameter: WATBOXZ <- "54.3767607"
  
 CHARMM>     SET NCHARGE  = -16
 Parameter: NCHARGE <- "-16"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step4_components.str
 VOPEN> Attempting to open::step4_components.str::
 OPNLGU> Unit 99 opened for READONLY access to step4_components.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NWATER = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NWATER = 0
 Parameter: NWATER <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    if islconj .eq. YES stream step3_lipid_conjugate.str
 Comparing "ISLCONJ" and "YES".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    ! Read Lipids
 CHARMM>    open read unit 10 card name step4_lipid_lipid.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.psf::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.psf
  
 CHARMM>    read psf  unit 10 card append
 MAINIO> Protein structure file being read from unit  10.
 PSFRD2> Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 01. 2022. JOB
 TITLE>  * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE>  *  DATE:     3/ 1/22      7:36:57      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        8   Number of residues   =     1089
         Number of atoms         =    53057   Number of groups     =    14140
         Number of bonds         =    52964   Number of angles     =   100444
         Number of dihedrals     =   141448   Number of impropers  =     2612
         Number of cross-terms   =      772
         Number of HB acceptors  =     1076   Number of HB donors  =     1154
         Number of NB exclusions =        0   Total charge =  -16.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4_lipid_lipid.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.crd
  
 CHARMM>    read coor unit 10 card append
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 A RESIDUE OFFSET OF 785 WILL BE USED.
 INFO: A subset of total atoms will be read.

 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 01. 2022. JOB
 TITLE> * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE> *  DATE:     3/ 1/22      7:36:58      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    ! Write coordinates
 CHARMM>    open write unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for WRITE access to step4.3_ion_protmemb.crd
  
 CHARMM>    write coor unit 10 card
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    define LPSION sele none end
 SELRPN>      0 atoms have been selected out of  53057
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions
 CHARMM>    ! nneg    : number of negative ions
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set zmemb =  20.0           ! ion exclusion membrane region
 Parameter: ZMEMB <- "20.0"
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR     53057 SELECTED ATOMS:
    XMIN =  -61.269096 XMAX =   61.865152 XAVE =   -0.093957
    YMIN =  -62.363711 YMAX =   61.906732 YAVE =   -0.128786
    ZMIN =  -47.026483 ZMAX =   51.876761 ZAVE =   -0.120143
    WMIN =    0.000000 WMAX =    0.054054 WAVE =    0.000009
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "61.8651523"
 RDCMND substituted energy or value "?XMIN" to "-61.2690957"
Evaluating: INT((61.8651523--61.2690957+5.0)/0.5)+1
 Parameter: XDIM <- "257"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "61.9067317"
 RDCMND substituted energy or value "?YMIN" to "-62.3637109"
Evaluating: INT((61.9067317--62.3637109+5.0)/0.5)+1
 Parameter: YDIM <- "259"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "51.8767607"
 RDCMND substituted energy or value "?ZMIN" to "-47.0264826"
Evaluating: INT((51.8767607--47.0264826+5.0)/0.5)+1
 Parameter: ZDIM <- "208"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "257"
 Parameter: YDIM -> "259"
 Parameter: ZDIM -> "208"
Evaluating: 257*259*208
 Parameter: SPACE <- "13845104"
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname TIP3 end
 Parameter: SPACE -> "13845104"
 SELRPN>  53057 atoms have been selected out of  53057
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -64.0091 XMAX=     64.6052 NX= 256
   YMIN=    -65.1037 YMAX=     64.5567 NY= 258
   ZMIN=    -49.7665 ZMAX=     54.9768 NZ= 208


 A TOTAL OF    32173   VACUUM POINTS WERE FOUND
 A TOTAL OF  5028151 OCCUPIED POINTS WERE FOUND
 A TOTAL OF  8677660 EXTERNAL POINTS WERE FOUND
 A TOTAL OF 13705811 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  639304.711462
 TOTAL SELECTED  VOLUME = 1742626.573210
 TOTAL FREE      VOLUME =    4090.638981
 FRACTIONAL FREE VOLUME =       0.635789
  
 CHARMM>     
  
 CHARMM>    set sysvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "639304.711"
 Parameter: SYSVOL <- "639304.711"
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .ne. HEXA then
 Comparing "RECT" and "HEXA".
 IF test evaluated as true.  Performing command
  
 CHARMM>       calc volumn = ( @A * @B * @C ) - @sysvol
 Parameter: A -> "112.065471"
 Parameter: B -> "112.065471"
 Parameter: C -> "142.885239"
 Parameter: SYSVOL -> "639304.711"
Evaluating: (112.065471*112.065471*142.885239)-639304.711
 Parameter: VOLUMN <- "1155143.82"
  
 CHARMM>    ENDIF
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .eq. HEXA THEN
 Comparing "RECT" and "HEXA".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    if @?nlipaion  .eq. 0 set nlipaion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NLIPAION <- "0"
  
 CHARMM>    if @?ncoreion  .eq. 0 set ncoreion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NCOREION <- "0"
  
 CHARMM>    if @?noantiion .eq. 0 set noantiion = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NOANTIION <- "0"
  
 CHARMM>     
  
 CHARMM>    calc npostot = @nlipaion + @ncoreion + @noantiion
 Parameter: NLIPAION -> "0"
 Parameter: NCOREION -> "0"
 Parameter: NOANTIION -> "0"
Evaluating: 0+0+0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = @npostot
 Parameter: NPOSTOT -> "0"
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of  53057
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of  53057
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of  53057
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = POT
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "POT"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CLA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CLA"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.15
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.15"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-16"
Evaluating: INT(-16)
 Parameter: NCHARGE <- "-16"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-16"
Evaluating: -16
 Parameter: CGTOT <- "-16"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "-16"
 Parameter: POSCHARGE -> "1"
 Comparing "-16" and "0".
 IF test evaluated as true.  Performing command
Evaluating: INT(ABS(-16)/1)
 Parameter: NPOS <- "16"
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "-16"
 Parameter: NEGCHARGE -> "1"
 Comparing "-16" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-16"
 Parameter: NPOS -> "16"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-16+16*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "16"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-16"
 Parameter: NPOS -> "16"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-16+16*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "16"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "1155143.82"
 Parameter: NEGVAL -> "1"
Evaluating: 16+INT(0.15*6.021*0.0001*1155143.82)*1
 Parameter: NPOS <- "120"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "1155143.82"
 Parameter: POSVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*1155143.82)*1
 Parameter: NNEG <- "104"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "120" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "104" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "120" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "POT"
 Parameter: NPOS -> "120"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 GENPSF> Segment   9 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        9   Number of residues   =     1209
         Number of atoms         =    53177   Number of groups     =    14260
         Number of bonds         =    52964   Number of angles     =   100444
         Number of dihedrals     =   141448   Number of impropers  =     2612
         Number of cross-terms   =      772
         Number of HB acceptors  =     1076   Number of HB donors  =     1154
         Number of NB exclusions =        0   Total charge =  104.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>    120 atoms have been selected out of  53177
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele POS end
 SELRPN>    120 atoms have been selected out of  53177
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "104" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CLA"
 Parameter: NNEG -> "104"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 GENPSF> Segment  10 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =       10   Number of residues   =     1313
         Number of atoms         =    53281   Number of groups     =    14364
         Number of bonds         =    52964   Number of angles     =   100444
         Number of dihedrals     =   141448   Number of impropers  =     2612
         Number of cross-terms   =      772
         Number of HB acceptors  =     1076   Number of HB donors  =     1154
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>    104 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele NEG end
 SELRPN>    104 atoms have been selected out of  53281
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>    224 atoms have been selected out of  53281
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>    224 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "120"
 Parameter: NNEG -> "104"
Evaluating: 120+104
 Parameter: NION <- "224"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "120"
 Parameter: NPOSTOT <- "120"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "104"
 Parameter: NNEGTOT <- "104"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "224"
 Parameter: NIONTOT <- "224"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "224" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        !
  
 CHARMM>        !Images Setup [to place all atoms inside the box]
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        open read unit 10 card name crystal_image.str
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to crystal_image.str
  
 CHARMM>        CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "112.065471"
 Parameter: B -> "112.065471"
 Parameter: C -> "142.885239"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
 Crystal Parameters : Crystal Type = TETR
           A     =  112.06547 B    =  112.06547 C     =  142.88524
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>        CRYSTAL READ UNIT 10 CARD
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 01. 2022. JOBID=4613667279
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 01. 2022. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>     
  
 CHARMM>        !Image centering by residue
  
 CHARMM>        IMAGE BYRES XCEN 0.0 YCEN 0.0 ZCEN @zcen
 Parameter: ZCEN -> "2.93414115"
 IMAGE CENTERING ON FOR SOME ATOMS
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000  2.934141
 RESIDUE  892 OPERATED ON BY TRANSFORMATION C022
 RESIDUE  919 OPERATED ON BY TRANSFORMATION C011
 RESIDUE  921 OPERATED ON BY TRANSFORMATION C022
 RESIDUE  933 OPERATED ON BY TRANSFORMATION C008
 RESIDUE 1041 OPERATED ON BY TRANSFORMATION C011
 RESIDUE 1060 OPERATED ON BY TRANSFORMATION C008
 RESIDUE 1072 OPERATED ON BY TRANSFORMATION C008
 RESIDUE 1087 OPERATED ON BY TRANSFORMATION C010

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  C001 has       0       0       0       73.77
    2  C002 has       0       0       0       63.36
    3  C003 has       0       0       0       74.16
    4  C004 has       0       0       0       58.69
    5  C005 has       0       0       0       43.98
    6  C006 has       0       0       0       64.61
    7  C007 has     674     161       8        0.00
    8  C008 has    7088    1771      68        0.00
    9  C009 has     804     199       9        0.00
   10  C010 has    7203    1808      66        0.00
   12  C012 has       0       0       0       68.06
   13  C013 has       0       0       0       58.66
   14  C014 has       0       0       0       68.73
 Total of69050 atoms and18303 groups and 1464 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>     
  
 CHARMM>        CONS FIX SELE .NOT. ( POS .OR. NEG ) END
 SELRPN>  53057 atoms have been selected out of  53281
  
 CHARMM>        SKIP ALL EXCL VDW ELEC
 SKIPE> The following energy terms will be computed :
  VDW  ELEC
  
 CHARMM>        scalar wmain = charge
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "1" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.169795733"
Evaluating: 112.065471*(0.169795733-0.5)
 Parameter: XPOS <- "-37.0044967"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.75515628"
Evaluating: 112.065471*(0.75515628-0.5)
 Parameter: YPOS <- "28.5942087"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.423611907"
Evaluating: 142.885239*(0.423611907-0.5)+2.93414115
 Parameter: ZPOS <- "-7.98058978"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.98058978" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.98058978" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "1" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.474677728"
Evaluating: 112.065471*(0.474677728-0.5)
 Parameter: XPOS <- "-2.83775234"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.20893267"
Evaluating: 112.065471*(0.20893267-0.5)
 Parameter: YPOS <- "-32.6185974"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.916614407"
Evaluating: 142.885239*(0.916614407-0.5)+2.93414115
 Parameter: ZPOS <- "62.4621903"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "62.4621903" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "62.4621903" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.83775234"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.83775234-0
 Parameter: XTRAN <- "-2.83775234"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.6185974"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.6185974-0
 Parameter: YTRAN <- "-32.6185974"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "62.4621903"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 62.4621903-0
 Parameter: ZTRAN <- "62.4621903"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.83775234"
 Parameter: YTRAN -> "-32.6185974"
 Parameter: ZTRAN -> "62.4621903"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -2.837752  -32.618597   62.462190
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.693981722"
Evaluating: 0.693981722*360.0
 Parameter: XPHI <- "249.83342"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.867345822"
Evaluating: 0.867345822*360.0
 Parameter: YPHI <- "312.244496"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.881737364E-02"
Evaluating: 9.881737364E-02*360.0
 Parameter: ZPHI <- "35.5742545"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.83775234"
 Parameter: YPOS -> "-32.6185974"
 Parameter: ZPOS -> "62.4621903"
 Parameter: XPHI -> "249.83342"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.344751   -0.938694
    0.000000    0.938694   -0.344751

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  110.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.83775234"
 Parameter: YPOS -> "-32.6185974"
 Parameter: ZPOS -> "62.4621903"
 Parameter: YPHI -> "312.244496"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.672296    0.000000    0.740283
    0.000000    1.000000    0.000000
   -0.740283    0.000000    0.672296

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   47.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.83775234"
 Parameter: YPOS -> "-32.6185974"
 Parameter: ZPOS -> "62.4621903"
 Parameter: ZPHI -> "35.5742545"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.813362    0.581758    0.000000
   -0.581758    0.813362    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   35.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.837752 XMAX =   -2.837752 XAVE =   -2.837752
    YMIN =  -32.618597 YMAX =  -32.618597 YAVE =  -32.618597
    ZMIN =   62.462190 ZMAX =   62.462190 ZAVE =   62.462190
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.83775234"
Evaluating: -2.83775234+3.5
 Parameter: XMAX <- "0.66224766"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.6185974"
Evaluating: -32.6185974+3.5
 Parameter: YMAX <- "-29.1185974"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "62.4621903"
Evaluating: 62.4621903+3.5
 Parameter: ZMAX <- "65.9621903"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.83775234"
Evaluating: -2.83775234-3.5
 Parameter: XMIN <- "-6.33775234"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.6185974"
Evaluating: -32.6185974-3.5
 Parameter: YMIN <- "-36.1185974"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "62.4621903"
Evaluating: 62.4621903-3.5
 Parameter: ZMIN <- "58.9621903"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.66224766"
 Parameter: XMIN -> "-6.33775234"
 Parameter: YMAX -> "-29.1185974"
 Parameter: YMIN -> "-36.1185974"
 Parameter: ZMAX -> "65.9621903"
 Parameter: ZMIN -> "58.9621903"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "2" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "2" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.119972585"
Evaluating: 112.065471*(0.119972585-0.5)
 Parameter: XPOS <- "-42.5879513"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.714090373"
Evaluating: 112.065471*(0.714090373-0.5)
 Parameter: YPOS <- "23.9921385"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.58565859"
Evaluating: 142.885239*(0.58565859-0.5)+2.93414115
 Parameter: ZPOS <- "15.1734893"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.1734893" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.1734893" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.5879513"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.5879513-0
 Parameter: XTRAN <- "-42.5879513"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.9921385"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.9921385-0
 Parameter: YTRAN <- "23.9921385"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.1734893"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.1734893-0
 Parameter: ZTRAN <- "15.1734893"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.5879513"
 Parameter: YTRAN -> "23.9921385"
 Parameter: ZTRAN -> "15.1734893"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -42.587951   23.992138   15.173489
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.618086276"
Evaluating: 0.618086276*360.0
 Parameter: XPHI <- "222.511059"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318846939"
Evaluating: 0.318846939*360.0
 Parameter: YPHI <- "114.784898"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.14048584"
Evaluating: 0.14048584*360.0
 Parameter: ZPHI <- "50.5749024"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.5879513"
 Parameter: YPOS -> "23.9921385"
 Parameter: ZPOS -> "15.1734893"
 Parameter: XPHI -> "222.511059"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.737147   -0.675733
    0.000000    0.675733   -0.737147

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  137.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.5879513"
 Parameter: YPOS -> "23.9921385"
 Parameter: ZPOS -> "15.1734893"
 Parameter: YPHI -> "114.784898"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.419213    0.000000   -0.907888
    0.000000    1.000000    0.000000
    0.907888    0.000000   -0.419213

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  114.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.5879513"
 Parameter: YPOS -> "23.9921385"
 Parameter: ZPOS -> "15.1734893"
 Parameter: ZPHI -> "50.5749024"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.635069    0.772455    0.000000
   -0.772455    0.635069    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   50.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.587951 XMAX =  -42.587951 XAVE =  -42.587951
    YMIN =   23.992138 YMAX =   23.992138 YAVE =   23.992138
    ZMIN =   15.173489 ZMAX =   15.173489 ZAVE =   15.173489
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.5879513"
Evaluating: -42.5879513+3.5
 Parameter: XMAX <- "-39.0879513"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.9921385"
Evaluating: 23.9921385+3.5
 Parameter: YMAX <- "27.4921385"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.1734893"
Evaluating: 15.1734893+3.5
 Parameter: ZMAX <- "18.6734893"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.5879513"
Evaluating: -42.5879513-3.5
 Parameter: XMIN <- "-46.0879513"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.9921385"
Evaluating: 23.9921385-3.5
 Parameter: YMIN <- "20.4921385"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.1734893"
Evaluating: 15.1734893-3.5
 Parameter: ZMIN <- "11.6734893"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.0879513"
 Parameter: XMIN -> "-46.0879513"
 Parameter: YMAX -> "27.4921385"
 Parameter: YMIN -> "20.4921385"
 Parameter: ZMAX -> "18.6734893"
 Parameter: ZMIN -> "11.6734893"
 SELRPN>     24 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     12 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53059 POS      POT      2        POT     -**** MEMB     POPC     64       O31           3.1223
53059 POS      POT      2        POT     -**** MEMB     POPC     64       C31           3.3290
53059 POS      POT      2        POT     -**** MEMB     POPC     64       O32           3.9355
53059 POS      POT      2        POT     -**** MEMB     POPC     64       C32           3.5154
53059 POS      POT      2        POT     -**** MEMB     POPC     94       C13           3.5491
53059 POS      POT      2        POT     -**** MEMB     POPC     111      C3            2.8348
53059 POS      POT      2        POT     -**** MEMB     POPC     111      O31           3.7194
53059 POS      POT      2        POT     -**** MEMB     POPC     111      C31           3.9297
53059 POS      POT      2        POT     -**** MEMB     POPC     111      O32           3.6686
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "2" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.769819158E-02"
Evaluating: 112.065471*(4.769819158E-02-0.5)
 Parameter: XPOS <- "-50.6874152"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.93988513"
Evaluating: 112.065471*(0.93988513-0.5)
 Parameter: YPOS <- "49.2959343"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.516683451"
Evaluating: 142.885239*(0.516683451-0.5)+2.93414115
 Parameter: ZPOS <- "5.31796003"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.31796003" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.31796003" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "2" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.585103357"
Evaluating: 112.065471*(0.585103357-0.5)
 Parameter: XPOS <- "9.53714779"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "2.343609825E-02"
Evaluating: 112.065471*(2.343609825E-02-0.5)
 Parameter: YPOS <- "-53.4063581"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.93430901"
Evaluating: 142.885239*(0.93430901-0.5)+2.93414115
 Parameter: ZPOS <- "64.9904878"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "64.9904878" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "64.9904878" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.587951 XMAX =  -42.587951 XAVE =  -42.587951
    YMIN =   23.992138 YMAX =   23.992138 YAVE =   23.992138
    ZMIN =   15.173489 ZMAX =   15.173489 ZAVE =   15.173489
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.53714779"
 RDCMND substituted energy or value "?XAVE" to "-42.5879513"
Evaluating: 9.53714779--42.5879513
 Parameter: XTRAN <- "52.1250991"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-53.4063581"
 RDCMND substituted energy or value "?YAVE" to "23.9921385"
Evaluating: -53.4063581-23.9921385
 Parameter: YTRAN <- "-77.3984966"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "64.9904878"
 RDCMND substituted energy or value "?ZAVE" to "15.1734893"
Evaluating: 64.9904878-15.1734893
 Parameter: ZTRAN <- "49.8169985"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.1250991"
 Parameter: YTRAN -> "-77.3984966"
 Parameter: ZTRAN -> "49.8169985"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    52.125099  -77.398497   49.816998
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.969607873"
Evaluating: 0.969607873*360.0
 Parameter: XPHI <- "349.058834"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.434713128"
Evaluating: 0.434713128*360.0
 Parameter: YPHI <- "156.496726"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.166660615"
Evaluating: 0.166660615*360.0
 Parameter: ZPHI <- "59.9978214"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.53714779"
 Parameter: YPOS -> "-53.4063581"
 Parameter: ZPOS -> "64.9904878"
 Parameter: XPHI -> "349.058834"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.981823   -0.189801
    0.000000    0.189801    0.981823

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   10.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.53714779"
 Parameter: YPOS -> "-53.4063581"
 Parameter: ZPOS -> "64.9904878"
 Parameter: YPHI -> "156.496726"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.917037    0.000000   -0.398801
    0.000000    1.000000    0.000000
    0.398801    0.000000   -0.917037

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  156.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.53714779"
 Parameter: YPOS -> "-53.4063581"
 Parameter: ZPOS -> "64.9904878"
 Parameter: ZPHI -> "59.9978214"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.500033    0.866006    0.000000
   -0.866006    0.500033    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   60.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.537148 XMAX =    9.537148 XAVE =    9.537148
    YMIN =  -53.406358 YMAX =  -53.406358 YAVE =  -53.406358
    ZMIN =   64.990488 ZMAX =   64.990488 ZAVE =   64.990488
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.53714779"
Evaluating: 9.53714779+3.5
 Parameter: XMAX <- "13.0371478"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-53.4063581"
Evaluating: -53.4063581+3.5
 Parameter: YMAX <- "-49.9063581"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "64.9904878"
Evaluating: 64.9904878+3.5
 Parameter: ZMAX <- "68.4904878"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.53714779"
Evaluating: 9.53714779-3.5
 Parameter: XMIN <- "6.03714779"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-53.4063581"
Evaluating: -53.4063581-3.5
 Parameter: YMIN <- "-56.9063581"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "64.9904878"
Evaluating: 64.9904878-3.5
 Parameter: ZMIN <- "61.4904878"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.0371478"
 Parameter: XMIN -> "6.03714779"
 Parameter: YMAX -> "-49.9063581"
 Parameter: YMIN -> "-56.9063581"
 Parameter: ZMAX -> "68.4904878"
 Parameter: ZMIN -> "61.4904878"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "3" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "3" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.513261723"
Evaluating: 112.065471*(0.513261723-0.5)
 Parameter: XPOS <- "1.48618123"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.208478023"
Evaluating: 112.065471*(0.208478023-0.5)
 Parameter: YPOS <- "-32.6695477"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.34236418"
Evaluating: 142.885239*(0.34236418-0.5)+2.93414115
 Parameter: ZPOS <- "-19.5896907"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.5896907" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.48618123"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.48618123-0
 Parameter: XTRAN <- "1.48618123"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.6695477"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.6695477-0
 Parameter: YTRAN <- "-32.6695477"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.5896907"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.5896907-0
 Parameter: ZTRAN <- "-19.5896907"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.48618123"
 Parameter: YTRAN -> "-32.6695477"
 Parameter: ZTRAN -> "-19.5896907"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     1.486181  -32.669548  -19.589691
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.634884533"
Evaluating: 0.634884533*360.0
 Parameter: XPHI <- "228.558432"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.439893969E-02"
Evaluating: 3.439893969E-02*360.0
 Parameter: YPHI <- "12.3836183"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.666961975"
Evaluating: 0.666961975*360.0
 Parameter: ZPHI <- "240.106311"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.48618123"
 Parameter: YPOS -> "-32.6695477"
 Parameter: ZPOS -> "-19.5896907"
 Parameter: XPHI -> "228.558432"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.661856   -0.749631
    0.000000    0.749631   -0.661856

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  131.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.48618123"
 Parameter: YPOS -> "-32.6695477"
 Parameter: ZPOS -> "-19.5896907"
 Parameter: YPHI -> "12.3836183"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.976734    0.000000   -0.214456
    0.000000    1.000000    0.000000
    0.214456    0.000000    0.976734

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   12.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.48618123"
 Parameter: YPOS -> "-32.6695477"
 Parameter: ZPOS -> "-19.5896907"
 Parameter: ZPHI -> "240.106311"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.498392   -0.866952    0.000000
    0.866952   -0.498392    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  119.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.486181 XMAX =    1.486181 XAVE =    1.486181
    YMIN =  -32.669548 YMAX =  -32.669548 YAVE =  -32.669548
    ZMIN =  -19.589691 ZMAX =  -19.589691 ZAVE =  -19.589691
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.48618123"
Evaluating: 1.48618123+3.5
 Parameter: XMAX <- "4.98618123"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.6695477"
Evaluating: -32.6695477+3.5
 Parameter: YMAX <- "-29.1695477"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.5896907"
Evaluating: -19.5896907+3.5
 Parameter: ZMAX <- "-16.0896907"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.48618123"
Evaluating: 1.48618123-3.5
 Parameter: XMIN <- "-2.01381877"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.6695477"
Evaluating: -32.6695477-3.5
 Parameter: YMIN <- "-36.1695477"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.5896907"
Evaluating: -19.5896907-3.5
 Parameter: ZMIN <- "-23.0896907"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.98618123"
 Parameter: XMIN -> "-2.01381877"
 Parameter: YMAX -> "-29.1695477"
 Parameter: YMIN -> "-36.1695477"
 Parameter: ZMAX -> "-16.0896907"
 Parameter: ZMIN -> "-23.0896907"
 SELRPN>     22 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      1 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53060 POS      POT      3        POT     -  40 PROA     PHE      19       CE1           4.7333
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "3" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.748903848"
Evaluating: 112.065471*(0.748903848-0.5)
 Parameter: XPOS <- "27.893527"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.213588157"
Evaluating: 112.065471*(0.213588157-0.5)
 Parameter: YPOS <- "-32.0968781"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.979232389"
Evaluating: 142.885239*(0.979232389-0.5)+2.93414115
 Parameter: ZPOS <- "71.4093756"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "71.4093756" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "71.4093756" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.486181 XMAX =    1.486181 XAVE =    1.486181
    YMIN =  -32.669548 YMAX =  -32.669548 YAVE =  -32.669548
    ZMIN =  -19.589691 ZMAX =  -19.589691 ZAVE =  -19.589691
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.893527"
 RDCMND substituted energy or value "?XAVE" to "1.48618123"
Evaluating: 27.893527-1.48618123
 Parameter: XTRAN <- "26.4073458"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.0968781"
 RDCMND substituted energy or value "?YAVE" to "-32.6695477"
Evaluating: -32.0968781--32.6695477
 Parameter: YTRAN <- "0.5726696"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "71.4093756"
 RDCMND substituted energy or value "?ZAVE" to "-19.5896907"
Evaluating: 71.4093756--19.5896907
 Parameter: ZTRAN <- "90.9990663"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.4073458"
 Parameter: YTRAN -> "0.5726696"
 Parameter: ZTRAN -> "90.9990663"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    26.407346    0.572670   90.999066
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.503058516E-02"
Evaluating: 1.503058516E-02*360.0
 Parameter: XPHI <- "5.41101066"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.917005037E-02"
Evaluating: 7.917005037E-02*360.0
 Parameter: YPHI <- "28.5012181"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.49695813"
Evaluating: 0.49695813*360.0
 Parameter: ZPHI <- "178.904927"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.893527"
 Parameter: YPOS -> "-32.0968781"
 Parameter: ZPOS -> "71.4093756"
 Parameter: XPHI -> "5.41101066"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.995544    0.094300
    0.000000   -0.094300    0.995544

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    5.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.893527"
 Parameter: YPOS -> "-32.0968781"
 Parameter: ZPOS -> "71.4093756"
 Parameter: YPHI -> "28.5012181"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.878807    0.000000   -0.477177
    0.000000    1.000000    0.000000
    0.477177    0.000000    0.878807

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   28.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.893527"
 Parameter: YPOS -> "-32.0968781"
 Parameter: ZPOS -> "71.4093756"
 Parameter: ZPHI -> "178.904927"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.999817    0.019111    0.000000
   -0.019111   -0.999817    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  178.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.893527 XMAX =   27.893527 XAVE =   27.893527
    YMIN =  -32.096878 YMAX =  -32.096878 YAVE =  -32.096878
    ZMIN =   71.409376 ZMAX =   71.409376 ZAVE =   71.409376
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.893527"
Evaluating: 27.893527+3.5
 Parameter: XMAX <- "31.393527"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.0968781"
Evaluating: -32.0968781+3.5
 Parameter: YMAX <- "-28.5968781"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "71.4093756"
Evaluating: 71.4093756+3.5
 Parameter: ZMAX <- "74.9093756"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.893527"
Evaluating: 27.893527-3.5
 Parameter: XMIN <- "24.393527"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.0968781"
Evaluating: -32.0968781-3.5
 Parameter: YMIN <- "-35.5968781"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "71.4093756"
Evaluating: 71.4093756-3.5
 Parameter: ZMIN <- "67.9093756"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.393527"
 Parameter: XMIN -> "24.393527"
 Parameter: YMAX -> "-28.5968781"
 Parameter: YMIN -> "-35.5968781"
 Parameter: ZMAX -> "74.9093756"
 Parameter: ZMIN -> "67.9093756"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "4" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "4" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.636201683"
Evaluating: 112.065471*(0.636201683-0.5)
 Parameter: XPOS <- "15.2635058"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.865102551"
Evaluating: 112.065471*(0.865102551-0.5)
 Parameter: YPOS <- "40.9153893"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.560650689"
Evaluating: 142.885239*(0.560650689-0.5)+2.93414115
 Parameter: ZPOS <- "11.6002293"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.6002293" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.6002293" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "4" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.881032021"
Evaluating: 112.065471*(0.881032021-0.5)
 Parameter: XPOS <- "42.7005329"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.71870763"
Evaluating: 112.065471*(0.71870763-0.5)
 Parameter: YPOS <- "24.5095736"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.680852203"
Evaluating: 142.885239*(0.680852203-0.5)+2.93414115
 Parameter: ZPOS <- "28.7752514"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.7752514" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.7752514" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.7005329"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.7005329-0
 Parameter: XTRAN <- "42.7005329"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.5095736"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.5095736-0
 Parameter: YTRAN <- "24.5095736"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.7752514"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.7752514-0
 Parameter: ZTRAN <- "28.7752514"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.7005329"
 Parameter: YTRAN -> "24.5095736"
 Parameter: ZTRAN -> "28.7752514"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    42.700533   24.509574   28.775251
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.101395908"
Evaluating: 0.101395908*360.0
 Parameter: XPHI <- "36.5025269"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.119891427"
Evaluating: 0.119891427*360.0
 Parameter: YPHI <- "43.1609137"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.552088246"
Evaluating: 0.552088246*360.0
 Parameter: ZPHI <- "198.751769"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.7005329"
 Parameter: YPOS -> "24.5095736"
 Parameter: ZPOS -> "28.7752514"
 Parameter: XPHI -> "36.5025269"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.803831    0.594858
    0.000000   -0.594858    0.803831

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   36.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.7005329"
 Parameter: YPOS -> "24.5095736"
 Parameter: ZPOS -> "28.7752514"
 Parameter: YPHI -> "43.1609137"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.729435    0.000000   -0.684050
    0.000000    1.000000    0.000000
    0.684050    0.000000    0.729435

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   43.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.7005329"
 Parameter: YPOS -> "24.5095736"
 Parameter: ZPOS -> "28.7752514"
 Parameter: ZPHI -> "198.751769"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.946920   -0.321469    0.000000
    0.321469   -0.946920    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  161.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.700533 XMAX =   42.700533 XAVE =   42.700533
    YMIN =   24.509574 YMAX =   24.509574 YAVE =   24.509574
    ZMIN =   28.775251 ZMAX =   28.775251 ZAVE =   28.775251
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.7005329"
Evaluating: 42.7005329+3.5
 Parameter: XMAX <- "46.2005329"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.5095736"
Evaluating: 24.5095736+3.5
 Parameter: YMAX <- "28.0095736"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.7752514"
Evaluating: 28.7752514+3.5
 Parameter: ZMAX <- "32.2752514"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.7005329"
Evaluating: 42.7005329-3.5
 Parameter: XMIN <- "39.2005329"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.5095736"
Evaluating: 24.5095736-3.5
 Parameter: YMIN <- "21.0095736"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.7752514"
Evaluating: 28.7752514-3.5
 Parameter: ZMIN <- "25.2752514"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.2005329"
 Parameter: XMIN -> "39.2005329"
 Parameter: YMAX -> "28.0095736"
 Parameter: YMIN -> "21.0095736"
 Parameter: ZMAX -> "32.2752514"
 Parameter: ZMIN -> "25.2752514"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "5" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "5" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.766679235"
Evaluating: 112.065471*(0.766679235-0.5)
 Parameter: XPOS <- "29.8855341"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.992657191"
Evaluating: 112.065471*(0.992657191-0.5)
 Parameter: YPOS <- "55.2098602"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.476105035"
Evaluating: 142.885239*(0.476105035-0.5)+2.93414115
 Parameter: ZPOS <- "-0.480096635"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.480096635" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.480096635" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "5" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.577945446"
Evaluating: 112.065471*(0.577945446-0.5)
 Parameter: XPOS <- "8.73499312"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.156316389"
Evaluating: 112.065471*(0.156316389-0.5)
 Parameter: YPOS <- "-38.5150657"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.333057068"
Evaluating: 142.885239*(0.333057068-0.5)+2.93414115
 Parameter: ZPOS <- "-20.9195396"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.9195396" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.73499312"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.73499312-0
 Parameter: XTRAN <- "8.73499312"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.5150657"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.5150657-0
 Parameter: YTRAN <- "-38.5150657"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.9195396"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.9195396-0
 Parameter: ZTRAN <- "-20.9195396"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.73499312"
 Parameter: YTRAN -> "-38.5150657"
 Parameter: ZTRAN -> "-20.9195396"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     8.734993  -38.515066  -20.919540
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.653347915"
Evaluating: 0.653347915*360.0
 Parameter: XPHI <- "235.205249"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.131974031"
Evaluating: 0.131974031*360.0
 Parameter: YPHI <- "47.5106512"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.937088286"
Evaluating: 0.937088286*360.0
 Parameter: ZPHI <- "337.351783"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.73499312"
 Parameter: YPOS -> "-38.5150657"
 Parameter: ZPOS -> "-20.9195396"
 Parameter: XPHI -> "235.205249"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.570638   -0.821201
    0.000000    0.821201   -0.570638

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  124.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.73499312"
 Parameter: YPOS -> "-38.5150657"
 Parameter: ZPOS -> "-20.9195396"
 Parameter: YPHI -> "47.5106512"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.675453    0.000000   -0.737403
    0.000000    1.000000    0.000000
    0.737403    0.000000    0.675453

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   47.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.73499312"
 Parameter: YPOS -> "-38.5150657"
 Parameter: ZPOS -> "-20.9195396"
 Parameter: ZPHI -> "337.351783"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.922886   -0.385072    0.000000
    0.385072    0.922886    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   22.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.734993 XMAX =    8.734993 XAVE =    8.734993
    YMIN =  -38.515066 YMAX =  -38.515066 YAVE =  -38.515066
    ZMIN =  -20.919540 ZMAX =  -20.919540 ZAVE =  -20.919540
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.73499312"
Evaluating: 8.73499312+3.5
 Parameter: XMAX <- "12.2349931"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.5150657"
Evaluating: -38.5150657+3.5
 Parameter: YMAX <- "-35.0150657"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.9195396"
Evaluating: -20.9195396+3.5
 Parameter: ZMAX <- "-17.4195396"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.73499312"
Evaluating: 8.73499312-3.5
 Parameter: XMIN <- "5.23499312"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.5150657"
Evaluating: -38.5150657-3.5
 Parameter: YMIN <- "-42.0150657"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.9195396"
Evaluating: -20.9195396-3.5
 Parameter: ZMIN <- "-24.4195396"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.2349931"
 Parameter: XMIN -> "5.23499312"
 Parameter: YMAX -> "-35.0150657"
 Parameter: YMIN -> "-42.0150657"
 Parameter: ZMAX -> "-17.4195396"
 Parameter: ZMIN -> "-24.4195396"
 SELRPN>     14 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      5 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53062 POS      POT      5        POT     -**** MEMB     POPC     186      C12           3.0081
53062 POS      POT      5        POT     -**** MEMB     POPC     186      C15           3.5284
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "5" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "8.46014486E-02"
Evaluating: 112.065471*(8.46014486E-02-0.5)
 Parameter: XPOS <- "-46.5518343"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.696830406"
Evaluating: 112.065471*(0.696830406-0.5)
 Parameter: YPOS <- "22.0578922"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "2.913880969E-02"
Evaluating: 142.885239*(2.913880969E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-64.3449726"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-64.3449726" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.734993 XMAX =    8.734993 XAVE =    8.734993
    YMIN =  -38.515066 YMAX =  -38.515066 YAVE =  -38.515066
    ZMIN =  -20.919540 ZMAX =  -20.919540 ZAVE =  -20.919540
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.5518343"
 RDCMND substituted energy or value "?XAVE" to "8.73499312"
Evaluating: -46.5518343-8.73499312
 Parameter: XTRAN <- "-55.2868274"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.0578922"
 RDCMND substituted energy or value "?YAVE" to "-38.5150657"
Evaluating: 22.0578922--38.5150657
 Parameter: YTRAN <- "60.5729579"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-64.3449726"
 RDCMND substituted energy or value "?ZAVE" to "-20.9195396"
Evaluating: -64.3449726--20.9195396
 Parameter: ZTRAN <- "-43.425433"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-55.2868274"
 Parameter: YTRAN -> "60.5729579"
 Parameter: ZTRAN -> "-43.425433"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -55.286827   60.572958  -43.425433
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.917307758"
Evaluating: 0.917307758*360.0
 Parameter: XPHI <- "330.230793"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.915816486"
Evaluating: 0.915816486*360.0
 Parameter: YPHI <- "329.693935"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.623589253"
Evaluating: 0.623589253*360.0
 Parameter: ZPHI <- "224.492131"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.5518343"
 Parameter: YPOS -> "22.0578922"
 Parameter: ZPOS -> "-64.3449726"
 Parameter: XPHI -> "330.230793"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.868032   -0.496508
    0.000000    0.496508    0.868032

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   29.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.5518343"
 Parameter: YPOS -> "22.0578922"
 Parameter: ZPOS -> "-64.3449726"
 Parameter: YPHI -> "329.693935"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.863342    0.000000    0.504619
    0.000000    1.000000    0.000000
   -0.504619    0.000000    0.863342

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   30.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.5518343"
 Parameter: YPOS -> "22.0578922"
 Parameter: ZPOS -> "-64.3449726"
 Parameter: ZPHI -> "224.492131"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.713347   -0.700811    0.000000
    0.700811   -0.713347    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  135.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.551834 XMAX =  -46.551834 XAVE =  -46.551834
    YMIN =   22.057892 YMAX =   22.057892 YAVE =   22.057892
    ZMIN =  -64.344973 ZMAX =  -64.344973 ZAVE =  -64.344973
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.5518343"
Evaluating: -46.5518343+3.5
 Parameter: XMAX <- "-43.0518343"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.0578922"
Evaluating: 22.0578922+3.5
 Parameter: YMAX <- "25.5578922"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-64.3449726"
Evaluating: -64.3449726+3.5
 Parameter: ZMAX <- "-60.8449726"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.5518343"
Evaluating: -46.5518343-3.5
 Parameter: XMIN <- "-50.0518343"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.0578922"
Evaluating: 22.0578922-3.5
 Parameter: YMIN <- "18.5578922"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-64.3449726"
Evaluating: -64.3449726-3.5
 Parameter: ZMIN <- "-67.8449726"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.0518343"
 Parameter: XMIN -> "-50.0518343"
 Parameter: YMAX -> "25.5578922"
 Parameter: YMIN -> "18.5578922"
 Parameter: ZMAX -> "-60.8449726"
 Parameter: ZMIN -> "-67.8449726"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "6" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "6" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.374075755"
Evaluating: 112.065471*(0.374075755-0.5)
 Parameter: XPOS <- "-14.1117598"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.831149659"
Evaluating: 112.065471*(0.831149659-0.5)
 Parameter: YPOS <- "37.1104425"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.105210913"
Evaluating: 142.885239*(0.105210913-0.5)+2.93414115
 Parameter: ZPOS <- "-53.4753919"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.4753919" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.1117598"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.1117598-0
 Parameter: XTRAN <- "-14.1117598"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.1104425"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.1104425-0
 Parameter: YTRAN <- "37.1104425"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.4753919"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.4753919-0
 Parameter: ZTRAN <- "-53.4753919"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.1117598"
 Parameter: YTRAN -> "37.1104425"
 Parameter: ZTRAN -> "-53.4753919"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -14.111760   37.110442  -53.475392
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.163566734E-02"
Evaluating: 1.163566734E-02*360.0
 Parameter: XPHI <- "4.18884024"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.389429963"
Evaluating: 0.389429963*360.0
 Parameter: YPHI <- "140.194787"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.795740729"
Evaluating: 0.795740729*360.0
 Parameter: ZPHI <- "286.466662"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.1117598"
 Parameter: YPOS -> "37.1104425"
 Parameter: ZPOS -> "-53.4753919"
 Parameter: XPHI -> "4.18884024"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997329    0.073044
    0.000000   -0.073044    0.997329

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    4.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.1117598"
 Parameter: YPOS -> "37.1104425"
 Parameter: ZPOS -> "-53.4753919"
 Parameter: YPHI -> "140.194787"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.768225    0.000000   -0.640180
    0.000000    1.000000    0.000000
    0.640180    0.000000   -0.768225

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  140.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.1117598"
 Parameter: YPOS -> "37.1104425"
 Parameter: ZPOS -> "-53.4753919"
 Parameter: ZPHI -> "286.466662"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.283457   -0.958985    0.000000
    0.958985    0.283457    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   73.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.111760 XMAX =  -14.111760 XAVE =  -14.111760
    YMIN =   37.110442 YMAX =   37.110442 YAVE =   37.110442
    ZMIN =  -53.475392 ZMAX =  -53.475392 ZAVE =  -53.475392
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.1117598"
Evaluating: -14.1117598+3.5
 Parameter: XMAX <- "-10.6117598"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.1104425"
Evaluating: 37.1104425+3.5
 Parameter: YMAX <- "40.6104425"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.4753919"
Evaluating: -53.4753919+3.5
 Parameter: ZMAX <- "-49.9753919"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.1117598"
Evaluating: -14.1117598-3.5
 Parameter: XMIN <- "-17.6117598"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.1104425"
Evaluating: 37.1104425-3.5
 Parameter: YMIN <- "33.6104425"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.4753919"
Evaluating: -53.4753919-3.5
 Parameter: ZMIN <- "-56.9753919"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.6117598"
 Parameter: XMIN -> "-17.6117598"
 Parameter: YMAX -> "40.6104425"
 Parameter: YMIN -> "33.6104425"
 Parameter: ZMAX -> "-49.9753919"
 Parameter: ZMIN -> "-56.9753919"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "7" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "7" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.676912052E-02"
Evaluating: 112.065471*(4.676912052E-02-0.5)
 Parameter: XPOS <- "-50.791532"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.629299942"
Evaluating: 112.065471*(0.629299942-0.5)
 Parameter: YPOS <- "14.4900589"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.106324469"
Evaluating: 142.885239*(0.106324469-0.5)+2.93414115
 Parameter: ZPOS <- "-53.3162812"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.3162812" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.791532"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -50.791532-0
 Parameter: XTRAN <- "-50.791532"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.4900589"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.4900589-0
 Parameter: YTRAN <- "14.4900589"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.3162812"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.3162812-0
 Parameter: ZTRAN <- "-53.3162812"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.791532"
 Parameter: YTRAN -> "14.4900589"
 Parameter: ZTRAN -> "-53.3162812"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -50.791532   14.490059  -53.316281
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.355306565"
Evaluating: 0.355306565*360.0
 Parameter: XPHI <- "127.910363"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.536084342"
Evaluating: 0.536084342*360.0
 Parameter: YPHI <- "192.990363"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491368972"
Evaluating: 0.491368972*360.0
 Parameter: ZPHI <- "176.89283"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.791532"
 Parameter: YPOS -> "14.4900589"
 Parameter: ZPOS -> "-53.3162812"
 Parameter: XPHI -> "127.910363"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.614428    0.788973
    0.000000   -0.788973   -0.614428

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  127.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.791532"
 Parameter: YPOS -> "14.4900589"
 Parameter: ZPOS -> "-53.3162812"
 Parameter: YPHI -> "192.990363"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.974408    0.000000    0.224787
    0.000000    1.000000    0.000000
   -0.224787    0.000000   -0.974408

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  167.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.791532"
 Parameter: YPOS -> "14.4900589"
 Parameter: ZPOS -> "-53.3162812"
 Parameter: ZPHI -> "176.89283"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.998530    0.054204    0.000000
   -0.054204   -0.998530    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.791532 XMAX =  -50.791532 XAVE =  -50.791532
    YMIN =   14.490059 YMAX =   14.490059 YAVE =   14.490059
    ZMIN =  -53.316281 ZMAX =  -53.316281 ZAVE =  -53.316281
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.791532"
Evaluating: -50.791532+3.5
 Parameter: XMAX <- "-47.291532"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.4900589"
Evaluating: 14.4900589+3.5
 Parameter: YMAX <- "17.9900589"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.3162812"
Evaluating: -53.3162812+3.5
 Parameter: ZMAX <- "-49.8162812"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.791532"
Evaluating: -50.791532-3.5
 Parameter: XMIN <- "-54.291532"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.4900589"
Evaluating: 14.4900589-3.5
 Parameter: YMIN <- "10.9900589"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.3162812"
Evaluating: -53.3162812-3.5
 Parameter: ZMIN <- "-56.8162812"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-47.291532"
 Parameter: XMIN -> "-54.291532"
 Parameter: YMAX -> "17.9900589"
 Parameter: YMIN -> "10.9900589"
 Parameter: ZMAX -> "-49.8162812"
 Parameter: ZMIN -> "-56.8162812"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "8" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "8" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.145674225"
Evaluating: 112.065471*(0.145674225-0.5)
 Parameter: XPOS <- "-39.7076849"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.405408939"
Evaluating: 112.065471*(0.405408939-0.5)
 Parameter: YPOS <- "-10.6003918"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.576376821"
Evaluating: 142.885239*(0.576376821-0.5)+2.93414115
 Parameter: ZPOS <- "13.8472615"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.8472615" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.8472615" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "8" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.169733913"
Evaluating: 112.065471*(0.169733913-0.5)
 Parameter: XPOS <- "-37.0114246"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.946911477"
Evaluating: 112.065471*(0.946911477-0.5)
 Parameter: YPOS <- "50.0833452"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.130698152"
Evaluating: 142.885239*(0.130698152-0.5)+2.93414115
 Parameter: ZPOS <- "-49.8336417"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.8336417" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.0114246"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -37.0114246-0
 Parameter: XTRAN <- "-37.0114246"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.0833452"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 50.0833452-0
 Parameter: YTRAN <- "50.0833452"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.8336417"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -49.8336417-0
 Parameter: ZTRAN <- "-49.8336417"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.0114246"
 Parameter: YTRAN -> "50.0833452"
 Parameter: ZTRAN -> "-49.8336417"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -37.011425   50.083345  -49.833642
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.809864967"
Evaluating: 0.809864967*360.0
 Parameter: XPHI <- "291.551388"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.386321507"
Evaluating: 0.386321507*360.0
 Parameter: YPHI <- "139.075743"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.389987697"
Evaluating: 0.389987697*360.0
 Parameter: ZPHI <- "140.395571"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.0114246"
 Parameter: YPOS -> "50.0833452"
 Parameter: ZPOS -> "-49.8336417"
 Parameter: XPHI -> "291.551388"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.367336   -0.930088
    0.000000    0.930088    0.367336

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   68.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.0114246"
 Parameter: YPOS -> "50.0833452"
 Parameter: ZPOS -> "-49.8336417"
 Parameter: YPHI -> "139.075743"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.755576    0.000000   -0.655061
    0.000000    1.000000    0.000000
    0.655061    0.000000   -0.755576

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  139.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.0114246"
 Parameter: YPOS -> "50.0833452"
 Parameter: ZPOS -> "-49.8336417"
 Parameter: ZPHI -> "140.395571"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.770464    0.637484    0.000000
   -0.637484   -0.770464    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  140.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.011425 XMAX =  -37.011425 XAVE =  -37.011425
    YMIN =   50.083345 YMAX =   50.083345 YAVE =   50.083345
    ZMIN =  -49.833642 ZMAX =  -49.833642 ZAVE =  -49.833642
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.0114246"
Evaluating: -37.0114246+3.5
 Parameter: XMAX <- "-33.5114246"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.0833452"
Evaluating: 50.0833452+3.5
 Parameter: YMAX <- "53.5833452"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.8336417"
Evaluating: -49.8336417+3.5
 Parameter: ZMAX <- "-46.3336417"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.0114246"
Evaluating: -37.0114246-3.5
 Parameter: XMIN <- "-40.5114246"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.0833452"
Evaluating: 50.0833452-3.5
 Parameter: YMIN <- "46.5833452"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.8336417"
Evaluating: -49.8336417-3.5
 Parameter: ZMIN <- "-53.3336417"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.5114246"
 Parameter: XMIN -> "-40.5114246"
 Parameter: YMAX -> "53.5833452"
 Parameter: YMIN -> "46.5833452"
 Parameter: ZMAX -> "-46.3336417"
 Parameter: ZMIN -> "-53.3336417"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "9" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "9" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.62598829"
Evaluating: 112.065471*(0.62598829-0.5)
 Parameter: XPOS <- "14.1189371"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.419100394"
Evaluating: 112.065471*(0.419100394-0.5)
 Parameter: YPOS <- "-9.06605245"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.612608216"
Evaluating: 142.885239*(0.612608216-0.5)+2.93414115
 Parameter: ZPOS <- "19.024193"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.024193" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.024193" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.1189371"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.1189371-0
 Parameter: XTRAN <- "14.1189371"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.06605245"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.06605245-0
 Parameter: YTRAN <- "-9.06605245"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.024193"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.024193-0
 Parameter: ZTRAN <- "19.024193"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.1189371"
 Parameter: YTRAN -> "-9.06605245"
 Parameter: ZTRAN -> "19.024193"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    14.118937   -9.066052   19.024193
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.96549942"
Evaluating: 0.96549942*360.0
 Parameter: XPHI <- "347.579791"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.452372362"
Evaluating: 0.452372362*360.0
 Parameter: YPHI <- "162.85405"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.276735073"
Evaluating: 0.276735073*360.0
 Parameter: ZPHI <- "99.6246263"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.1189371"
 Parameter: YPOS -> "-9.06605245"
 Parameter: ZPOS -> "19.024193"
 Parameter: XPHI -> "347.579791"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.976596   -0.215080
    0.000000    0.215080    0.976596

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   12.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.1189371"
 Parameter: YPOS -> "-9.06605245"
 Parameter: ZPOS -> "19.024193"
 Parameter: YPHI -> "162.85405"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.955557    0.000000   -0.294807
    0.000000    1.000000    0.000000
    0.294807    0.000000   -0.955557

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.1189371"
 Parameter: YPOS -> "-9.06605245"
 Parameter: ZPOS -> "19.024193"
 Parameter: ZPHI -> "99.6246263"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.167193    0.985924    0.000000
   -0.985924   -0.167193    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   99.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.118937 XMAX =   14.118937 XAVE =   14.118937
    YMIN =   -9.066052 YMAX =   -9.066052 YAVE =   -9.066052
    ZMIN =   19.024193 ZMAX =   19.024193 ZAVE =   19.024193
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.1189371"
Evaluating: 14.1189371+3.5
 Parameter: XMAX <- "17.6189371"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.06605245"
Evaluating: -9.06605245+3.5
 Parameter: YMAX <- "-5.56605245"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.024193"
Evaluating: 19.024193+3.5
 Parameter: ZMAX <- "22.524193"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.1189371"
Evaluating: 14.1189371-3.5
 Parameter: XMIN <- "10.6189371"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.06605245"
Evaluating: -9.06605245-3.5
 Parameter: YMIN <- "-12.5660525"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.024193"
Evaluating: 19.024193-3.5
 Parameter: ZMIN <- "15.524193"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.6189371"
 Parameter: XMIN -> "10.6189371"
 Parameter: YMAX -> "-5.56605245"
 Parameter: YMIN -> "-12.5660525"
 Parameter: ZMAX -> "22.524193"
 Parameter: ZMIN -> "15.524193"
 SELRPN>     37 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     19 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53066 POS      POT      9        POT     -2333 PROA     PRO      169      CD            5.0392
53066 POS      POT      9        POT     -3715 PROB     PRO      258      CB            4.6310
53066 POS      POT      9        POT     -3718 PROB     PRO      258      CG            3.5561
53066 POS      POT      9        POT     -3762 PROB     ASP      263      OD1           5.1902
53066 POS      POT      9        POT     -3767 PROB     PRO      264      CD            3.1492
53066 POS      POT      9        POT     -3775 PROB     PRO      264      CG            3.0980
53066 POS      POT      9        POT     -**** PROF     VAL      195      CA            3.8486
53066 POS      POT      9        POT     -**** PROF     VAL      195      CB            3.7595
53066 POS      POT      9        POT     -**** PROF     VAL      195      CG1           2.7229
53066 POS      POT      9        POT     -**** PROF     VAL      195      C             3.2319
53066 POS      POT      9        POT     -**** PROF     VAL      195      O             3.8330
53066 POS      POT      9        POT     -**** PROF     PRO      196      N             2.7549
53066 POS      POT      9        POT     -**** PROF     PRO      196      CD            2.8784
53066 POS      POT      9        POT     -**** PROF     PRO      196      CA            3.0509
53066 POS      POT      9        POT     -**** PROF     PRO      196      CB            3.2961
53066 POS      POT      9        POT     -**** PROF     PRO      196      CG            3.5737
53066 POS      POT      9        POT     -**** PROF     PRO      196      C             2.6985
53066 POS      POT      9        POT     -**** PROF     PRO      196      O             1.8021
53066 POS      POT      9        POT     -**** PROF     ARG      198      N             4.8713
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        19
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "9" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.102790847"
Evaluating: 112.065471*(0.102790847-0.5)
 Parameter: XPOS <- "-44.5134308"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.300190667"
Evaluating: 112.065471*(0.300190667-0.5)
 Parameter: YPOS <- "-22.391727"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.102086551"
Evaluating: 142.885239*(0.102086551-0.5)+2.93414115
 Parameter: ZPOS <- "-53.9218171"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.9218171" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.118937 XMAX =   14.118937 XAVE =   14.118937
    YMIN =   -9.066052 YMAX =   -9.066052 YAVE =   -9.066052
    ZMIN =   19.024193 ZMAX =   19.024193 ZAVE =   19.024193
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.5134308"
 RDCMND substituted energy or value "?XAVE" to "14.1189371"
Evaluating: -44.5134308-14.1189371
 Parameter: XTRAN <- "-58.6323679"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.391727"
 RDCMND substituted energy or value "?YAVE" to "-9.06605245"
Evaluating: -22.391727--9.06605245
 Parameter: YTRAN <- "-13.3256745"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.9218171"
 RDCMND substituted energy or value "?ZAVE" to "19.024193"
Evaluating: -53.9218171-19.024193
 Parameter: ZTRAN <- "-72.9460101"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.6323679"
 Parameter: YTRAN -> "-13.3256745"
 Parameter: ZTRAN -> "-72.9460101"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -58.632368  -13.325674  -72.946010
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.777090604"
Evaluating: 0.777090604*360.0
 Parameter: XPHI <- "279.752617"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.803506733"
Evaluating: 0.803506733*360.0
 Parameter: YPHI <- "289.262424"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318378321"
Evaluating: 0.318378321*360.0
 Parameter: ZPHI <- "114.616196"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.5134308"
 Parameter: YPOS -> "-22.391727"
 Parameter: ZPOS -> "-53.9218171"
 Parameter: XPHI -> "279.752617"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.169395   -0.985548
    0.000000    0.985548    0.169395

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   80.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.5134308"
 Parameter: YPOS -> "-22.391727"
 Parameter: ZPOS -> "-53.9218171"
 Parameter: YPHI -> "289.262424"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.329895    0.000000    0.944018
    0.000000    1.000000    0.000000
   -0.944018    0.000000    0.329895

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   70.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.5134308"
 Parameter: YPOS -> "-22.391727"
 Parameter: ZPOS -> "-53.9218171"
 Parameter: ZPHI -> "114.616196"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.416538    0.909118    0.000000
   -0.909118   -0.416538    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.513431 XMAX =  -44.513431 XAVE =  -44.513431
    YMIN =  -22.391727 YMAX =  -22.391727 YAVE =  -22.391727
    ZMIN =  -53.921817 ZMAX =  -53.921817 ZAVE =  -53.921817
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.5134308"
Evaluating: -44.5134308+3.5
 Parameter: XMAX <- "-41.0134308"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.391727"
Evaluating: -22.391727+3.5
 Parameter: YMAX <- "-18.891727"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.9218171"
Evaluating: -53.9218171+3.5
 Parameter: ZMAX <- "-50.4218171"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.5134308"
Evaluating: -44.5134308-3.5
 Parameter: XMIN <- "-48.0134308"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.391727"
Evaluating: -22.391727-3.5
 Parameter: YMIN <- "-25.891727"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.9218171"
Evaluating: -53.9218171-3.5
 Parameter: ZMIN <- "-57.4218171"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.0134308"
 Parameter: XMIN -> "-48.0134308"
 Parameter: YMAX -> "-18.891727"
 Parameter: YMIN -> "-25.891727"
 Parameter: ZMAX -> "-50.4218171"
 Parameter: ZMIN -> "-57.4218171"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "10" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "10" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.205669218E-02"
Evaluating: 112.065471*(7.205669218E-02-0.5)
 Parameter: XPOS <- "-47.9576684"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.370888115E-02"
Evaluating: 112.065471*(7.370888115E-02-0.5)
 Parameter: YPOS <- "-47.772515"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.918683605"
Evaluating: 142.885239*(0.918683605-0.5)+2.93414115
 Parameter: ZPOS <- "62.7578481"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "62.7578481" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "62.7578481" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.9576684"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.9576684-0
 Parameter: XTRAN <- "-47.9576684"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.772515"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.772515-0
 Parameter: YTRAN <- "-47.772515"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "62.7578481"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 62.7578481-0
 Parameter: ZTRAN <- "62.7578481"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.9576684"
 Parameter: YTRAN -> "-47.772515"
 Parameter: ZTRAN -> "62.7578481"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -47.957668  -47.772515   62.757848
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.717424971"
Evaluating: 0.717424971*360.0
 Parameter: XPHI <- "258.27299"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.451497941"
Evaluating: 0.451497941*360.0
 Parameter: YPHI <- "162.539259"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.393948046"
Evaluating: 0.393948046*360.0
 Parameter: ZPHI <- "141.821297"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.9576684"
 Parameter: YPOS -> "-47.772515"
 Parameter: ZPOS -> "62.7578481"
 Parameter: XPHI -> "258.27299"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.203249   -0.979127
    0.000000    0.979127   -0.203249

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  101.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.9576684"
 Parameter: YPOS -> "-47.772515"
 Parameter: ZPOS -> "62.7578481"
 Parameter: YPHI -> "162.539259"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.953923    0.000000   -0.300052
    0.000000    1.000000    0.000000
    0.300052    0.000000   -0.953923

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.9576684"
 Parameter: YPOS -> "-47.772515"
 Parameter: ZPOS -> "62.7578481"
 Parameter: ZPHI -> "141.821297"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.786087    0.618116    0.000000
   -0.618116   -0.786087    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  141.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.957668 XMAX =  -47.957668 XAVE =  -47.957668
    YMIN =  -47.772515 YMAX =  -47.772515 YAVE =  -47.772515
    ZMIN =   62.757848 ZMAX =   62.757848 ZAVE =   62.757848
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.9576684"
Evaluating: -47.9576684+3.5
 Parameter: XMAX <- "-44.4576684"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.772515"
Evaluating: -47.772515+3.5
 Parameter: YMAX <- "-44.272515"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "62.7578481"
Evaluating: 62.7578481+3.5
 Parameter: ZMAX <- "66.2578481"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.9576684"
Evaluating: -47.9576684-3.5
 Parameter: XMIN <- "-51.4576684"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.772515"
Evaluating: -47.772515-3.5
 Parameter: YMIN <- "-51.272515"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "62.7578481"
Evaluating: 62.7578481-3.5
 Parameter: ZMIN <- "59.2578481"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.4576684"
 Parameter: XMIN -> "-51.4576684"
 Parameter: YMAX -> "-44.272515"
 Parameter: YMIN -> "-51.272515"
 Parameter: ZMAX -> "66.2578481"
 Parameter: ZMIN -> "59.2578481"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "11" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "11" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.693299789"
Evaluating: 112.065471*(0.693299789-0.5)
 Parameter: XPOS <- "21.6622319"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.993900047"
Evaluating: 112.065471*(0.993900047-0.5)
 Parameter: YPOS <- "55.3491414"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.150754676"
Evaluating: 142.885239*(0.150754676-0.5)+2.93414115
 Parameter: ZPOS <- "-46.9678604"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.9678604" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.6622319"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.6622319-0
 Parameter: XTRAN <- "21.6622319"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "55.3491414"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 55.3491414-0
 Parameter: YTRAN <- "55.3491414"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.9678604"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -46.9678604-0
 Parameter: ZTRAN <- "-46.9678604"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.6622319"
 Parameter: YTRAN -> "55.3491414"
 Parameter: ZTRAN -> "-46.9678604"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    21.662232   55.349141  -46.967860
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.25800895"
Evaluating: 0.25800895*360.0
 Parameter: XPHI <- "92.883222"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.718175294"
Evaluating: 0.718175294*360.0
 Parameter: YPHI <- "258.543106"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.22023703"
Evaluating: 0.22023703*360.0
 Parameter: ZPHI <- "79.2853308"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.6622319"
 Parameter: YPOS -> "55.3491414"
 Parameter: ZPOS -> "-46.9678604"
 Parameter: XPHI -> "92.883222"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.050300    0.998734
    0.000000   -0.998734   -0.050300

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   92.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.6622319"
 Parameter: YPOS -> "55.3491414"
 Parameter: ZPOS -> "-46.9678604"
 Parameter: YPHI -> "258.543106"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.198631    0.000000    0.980074
    0.000000    1.000000    0.000000
   -0.980074    0.000000   -0.198631

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  101.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.6622319"
 Parameter: YPOS -> "55.3491414"
 Parameter: ZPOS -> "-46.9678604"
 Parameter: ZPHI -> "79.2853308"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.185918    0.982565    0.000000
   -0.982565    0.185918    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   79.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.662232 XMAX =   21.662232 XAVE =   21.662232
    YMIN =   55.349141 YMAX =   55.349141 YAVE =   55.349141
    ZMIN =  -46.967860 ZMAX =  -46.967860 ZAVE =  -46.967860
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.6622319"
Evaluating: 21.6622319+3.5
 Parameter: XMAX <- "25.1622319"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "55.3491414"
Evaluating: 55.3491414+3.5
 Parameter: YMAX <- "58.8491414"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.9678604"
Evaluating: -46.9678604+3.5
 Parameter: ZMAX <- "-43.4678604"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.6622319"
Evaluating: 21.6622319-3.5
 Parameter: XMIN <- "18.1622319"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "55.3491414"
Evaluating: 55.3491414-3.5
 Parameter: YMIN <- "51.8491414"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.9678604"
Evaluating: -46.9678604-3.5
 Parameter: ZMIN <- "-50.4678604"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.1622319"
 Parameter: XMIN -> "18.1622319"
 Parameter: YMAX -> "58.8491414"
 Parameter: YMIN -> "51.8491414"
 Parameter: ZMAX -> "-43.4678604"
 Parameter: ZMIN -> "-50.4678604"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "12" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "12" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.250525916"
Evaluating: 112.065471*(0.250525916-0.5)
 Parameter: XPOS <- "-27.9574307"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.396678234E-03"
Evaluating: 112.065471*(4.396678234E-03-0.5)
 Parameter: YPOS <- "-55.5400197"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.928820478"
Evaluating: 142.885239*(0.928820478-0.5)+2.93414115
 Parameter: ZPOS <- "64.2062576"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "64.2062576" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "64.2062576" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.9574307"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.9574307-0
 Parameter: XTRAN <- "-27.9574307"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-55.5400197"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -55.5400197-0
 Parameter: YTRAN <- "-55.5400197"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "64.2062576"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 64.2062576-0
 Parameter: ZTRAN <- "64.2062576"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.9574307"
 Parameter: YTRAN -> "-55.5400197"
 Parameter: ZTRAN -> "64.2062576"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -27.957431  -55.540020   64.206258
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.303753961"
Evaluating: 0.303753961*360.0
 Parameter: XPHI <- "109.351426"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.56519776"
Evaluating: 0.56519776*360.0
 Parameter: YPHI <- "203.471194"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.837885231"
Evaluating: 0.837885231*360.0
 Parameter: ZPHI <- "301.638683"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.9574307"
 Parameter: YPOS -> "-55.5400197"
 Parameter: ZPOS -> "64.2062576"
 Parameter: XPHI -> "109.351426"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.331361    0.943504
    0.000000   -0.943504   -0.331361

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  109.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.9574307"
 Parameter: YPOS -> "-55.5400197"
 Parameter: ZPOS -> "64.2062576"
 Parameter: YPHI -> "203.471194"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.917260    0.000000    0.398288
    0.000000    1.000000    0.000000
   -0.398288    0.000000   -0.917260

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  156.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.9574307"
 Parameter: YPOS -> "-55.5400197"
 Parameter: ZPOS -> "64.2062576"
 Parameter: ZPHI -> "301.638683"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.524561   -0.851373    0.000000
    0.851373    0.524561    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   58.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.957431 XMAX =  -27.957431 XAVE =  -27.957431
    YMIN =  -55.540020 YMAX =  -55.540020 YAVE =  -55.540020
    ZMIN =   64.206258 ZMAX =   64.206258 ZAVE =   64.206258
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.9574307"
Evaluating: -27.9574307+3.5
 Parameter: XMAX <- "-24.4574307"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-55.5400197"
Evaluating: -55.5400197+3.5
 Parameter: YMAX <- "-52.0400197"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "64.2062576"
Evaluating: 64.2062576+3.5
 Parameter: ZMAX <- "67.7062576"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.9574307"
Evaluating: -27.9574307-3.5
 Parameter: XMIN <- "-31.4574307"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-55.5400197"
Evaluating: -55.5400197-3.5
 Parameter: YMIN <- "-59.0400197"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "64.2062576"
Evaluating: 64.2062576-3.5
 Parameter: ZMIN <- "60.7062576"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.4574307"
 Parameter: XMIN -> "-31.4574307"
 Parameter: YMAX -> "-52.0400197"
 Parameter: YMIN -> "-59.0400197"
 Parameter: ZMAX -> "67.7062576"
 Parameter: ZMIN -> "60.7062576"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "13" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "13" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.534731664"
Evaluating: 112.065471*(0.534731664-0.5)
 Parameter: XPOS <- "3.89222028"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.143170138"
Evaluating: 112.065471*(0.143170138-0.5)
 Parameter: YPOS <- "-39.9883066"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.996761592"
Evaluating: 142.885239*(0.996761592-0.5)+2.93414115
 Parameter: ZPOS <- "73.9140399"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "73.9140399" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "73.9140399" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.89222028"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.89222028-0
 Parameter: XTRAN <- "3.89222028"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.9883066"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.9883066-0
 Parameter: YTRAN <- "-39.9883066"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "73.9140399"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 73.9140399-0
 Parameter: ZTRAN <- "73.9140399"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.89222028"
 Parameter: YTRAN -> "-39.9883066"
 Parameter: ZTRAN -> "73.9140399"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     3.892220  -39.988307   73.914040
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.286919229"
Evaluating: 0.286919229*360.0
 Parameter: XPHI <- "103.290922"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.650212747"
Evaluating: 0.650212747*360.0
 Parameter: YPHI <- "234.076589"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.243703481"
Evaluating: 0.243703481*360.0
 Parameter: ZPHI <- "87.7332532"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.89222028"
 Parameter: YPOS -> "-39.9883066"
 Parameter: ZPOS -> "73.9140399"
 Parameter: XPHI -> "103.290922"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.229896    0.973215
    0.000000   -0.973215   -0.229896

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  103.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.89222028"
 Parameter: YPOS -> "-39.9883066"
 Parameter: ZPOS -> "73.9140399"
 Parameter: YPHI -> "234.076589"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.586703    0.000000    0.809802
    0.000000    1.000000    0.000000
   -0.809802    0.000000   -0.586703

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  125.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.89222028"
 Parameter: YPOS -> "-39.9883066"
 Parameter: ZPOS -> "73.9140399"
 Parameter: ZPHI -> "87.7332532"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.039552    0.999218    0.000000
   -0.999218    0.039552    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   87.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.892220 XMAX =    3.892220 XAVE =    3.892220
    YMIN =  -39.988307 YMAX =  -39.988307 YAVE =  -39.988307
    ZMIN =   73.914040 ZMAX =   73.914040 ZAVE =   73.914040
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.89222028"
Evaluating: 3.89222028+3.5
 Parameter: XMAX <- "7.39222028"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.9883066"
Evaluating: -39.9883066+3.5
 Parameter: YMAX <- "-36.4883066"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "73.9140399"
Evaluating: 73.9140399+3.5
 Parameter: ZMAX <- "77.4140399"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.89222028"
Evaluating: 3.89222028-3.5
 Parameter: XMIN <- "0.39222028"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.9883066"
Evaluating: -39.9883066-3.5
 Parameter: YMIN <- "-43.4883066"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "73.9140399"
Evaluating: 73.9140399-3.5
 Parameter: ZMIN <- "70.4140399"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.39222028"
 Parameter: XMIN -> "0.39222028"
 Parameter: YMAX -> "-36.4883066"
 Parameter: YMIN -> "-43.4883066"
 Parameter: ZMAX -> "77.4140399"
 Parameter: ZMIN -> "70.4140399"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "14" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "14" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.480133689"
Evaluating: 112.065471*(0.480133689-0.5)
 Parameter: XPOS <- "-2.2263275"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.400278278"
Evaluating: 112.065471*(0.400278278-0.5)
 Parameter: YPOS <- "-11.1753617"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.46031474"
Evaluating: 142.885239*(0.46031474-0.5)+2.93414115
 Parameter: ZPOS <- "-2.73629671"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.73629671" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.73629671" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "14" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.210533288"
Evaluating: 112.065471*(0.210533288-0.5)
 Parameter: XPOS <- "-32.4392234"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.012439665E-02"
Evaluating: 112.065471*(5.012439665E-02-0.5)
 Parameter: YPOS <- "-50.4155214"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.20520974"
Evaluating: 142.885239*(0.20520974-0.5)+2.93414115
 Parameter: ZPOS <- "-39.1870356"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.1870356" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.4392234"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.4392234-0
 Parameter: XTRAN <- "-32.4392234"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.4155214"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -50.4155214-0
 Parameter: YTRAN <- "-50.4155214"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.1870356"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.1870356-0
 Parameter: ZTRAN <- "-39.1870356"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.4392234"
 Parameter: YTRAN -> "-50.4155214"
 Parameter: ZTRAN -> "-39.1870356"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -32.439223  -50.415521  -39.187036
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.436103983"
Evaluating: 0.436103983*360.0
 Parameter: XPHI <- "156.997434"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.585166349"
Evaluating: 0.585166349*360.0
 Parameter: YPHI <- "210.659886"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.870233478"
Evaluating: 0.870233478*360.0
 Parameter: ZPHI <- "313.284052"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.4392234"
 Parameter: YPOS -> "-50.4155214"
 Parameter: ZPOS -> "-39.1870356"
 Parameter: XPHI -> "156.997434"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.920487    0.390772
    0.000000   -0.390772   -0.920487

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  157.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.4392234"
 Parameter: YPOS -> "-50.4155214"
 Parameter: ZPOS -> "-39.1870356"
 Parameter: YPHI -> "210.659886"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.860210    0.000000    0.509941
    0.000000    1.000000    0.000000
   -0.509941    0.000000   -0.860210

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  149.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.4392234"
 Parameter: YPOS -> "-50.4155214"
 Parameter: ZPOS -> "-39.1870356"
 Parameter: ZPHI -> "313.284052"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.685616   -0.727964    0.000000
    0.727964    0.685616    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   46.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.439223 XMAX =  -32.439223 XAVE =  -32.439223
    YMIN =  -50.415521 YMAX =  -50.415521 YAVE =  -50.415521
    ZMIN =  -39.187036 ZMAX =  -39.187036 ZAVE =  -39.187036
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.4392234"
Evaluating: -32.4392234+3.5
 Parameter: XMAX <- "-28.9392234"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.4155214"
Evaluating: -50.4155214+3.5
 Parameter: YMAX <- "-46.9155214"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.1870356"
Evaluating: -39.1870356+3.5
 Parameter: ZMAX <- "-35.6870356"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.4392234"
Evaluating: -32.4392234-3.5
 Parameter: XMIN <- "-35.9392234"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.4155214"
Evaluating: -50.4155214-3.5
 Parameter: YMIN <- "-53.9155214"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.1870356"
Evaluating: -39.1870356-3.5
 Parameter: ZMIN <- "-42.6870356"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.9392234"
 Parameter: XMIN -> "-35.9392234"
 Parameter: YMAX -> "-46.9155214"
 Parameter: YMIN -> "-53.9155214"
 Parameter: ZMAX -> "-35.6870356"
 Parameter: ZMIN -> "-42.6870356"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "15" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "15" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.198351393"
Evaluating: 112.065471*(0.198351393-0.5)
 Parameter: XPOS <- "-33.8043932"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.260365671"
Evaluating: 112.065471*(0.260365671-0.5)
 Parameter: YPOS <- "-26.8547339"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.876042479"
Evaluating: 142.885239*(0.876042479-0.5)+2.93414115
 Parameter: ZPOS <- "56.6650606"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.6650606" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.6650606" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.8043932"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.8043932-0
 Parameter: XTRAN <- "-33.8043932"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.8547339"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.8547339-0
 Parameter: YTRAN <- "-26.8547339"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.6650606"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 56.6650606-0
 Parameter: ZTRAN <- "56.6650606"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.8043932"
 Parameter: YTRAN -> "-26.8547339"
 Parameter: ZTRAN -> "56.6650606"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -33.804393  -26.854734   56.665061
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.961950465"
Evaluating: 0.961950465*360.0
 Parameter: XPHI <- "346.302167"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.165237193"
Evaluating: 0.165237193*360.0
 Parameter: YPHI <- "59.4853895"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420094023"
Evaluating: 0.420094023*360.0
 Parameter: ZPHI <- "151.233848"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.8043932"
 Parameter: YPOS -> "-26.8547339"
 Parameter: ZPOS -> "56.6650606"
 Parameter: XPHI -> "346.302167"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.971558   -0.236801
    0.000000    0.236801    0.971558

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   13.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.8043932"
 Parameter: YPOS -> "-26.8547339"
 Parameter: ZPOS -> "56.6650606"
 Parameter: YPHI -> "59.4853895"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.507758    0.000000   -0.861500
    0.000000    1.000000    0.000000
    0.861500    0.000000    0.507758

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   59.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.8043932"
 Parameter: YPOS -> "-26.8547339"
 Parameter: ZPOS -> "56.6650606"
 Parameter: ZPHI -> "151.233848"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.876591    0.481236    0.000000
   -0.481236   -0.876591    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  151.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.804393 XMAX =  -33.804393 XAVE =  -33.804393
    YMIN =  -26.854734 YMAX =  -26.854734 YAVE =  -26.854734
    ZMIN =   56.665061 ZMAX =   56.665061 ZAVE =   56.665061
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.8043932"
Evaluating: -33.8043932+3.5
 Parameter: XMAX <- "-30.3043932"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.8547339"
Evaluating: -26.8547339+3.5
 Parameter: YMAX <- "-23.3547339"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.6650606"
Evaluating: 56.6650606+3.5
 Parameter: ZMAX <- "60.1650606"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.8043932"
Evaluating: -33.8043932-3.5
 Parameter: XMIN <- "-37.3043932"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.8547339"
Evaluating: -26.8547339-3.5
 Parameter: YMIN <- "-30.3547339"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.6650606"
Evaluating: 56.6650606-3.5
 Parameter: ZMIN <- "53.1650606"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.3043932"
 Parameter: XMIN -> "-37.3043932"
 Parameter: YMAX -> "-23.3547339"
 Parameter: YMIN -> "-30.3547339"
 Parameter: ZMAX -> "60.1650606"
 Parameter: ZMIN -> "53.1650606"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "16" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "16" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.171687409"
Evaluating: 112.065471*(0.171687409-0.5)
 Parameter: XPOS <- "-36.7925051"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.561906673"
Evaluating: 112.065471*(0.561906673-0.5)
 Parameter: YPOS <- "6.93760047"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "2.797170522E-02"
Evaluating: 142.885239*(2.797170522E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-64.5117346"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-64.5117346" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.7925051"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.7925051-0
 Parameter: XTRAN <- "-36.7925051"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.93760047"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.93760047-0
 Parameter: YTRAN <- "6.93760047"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-64.5117346"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -64.5117346-0
 Parameter: ZTRAN <- "-64.5117346"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.7925051"
 Parameter: YTRAN -> "6.93760047"
 Parameter: ZTRAN -> "-64.5117346"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -36.792505    6.937600  -64.511735
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.311554972"
Evaluating: 0.311554972*360.0
 Parameter: XPHI <- "112.15979"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.452767661"
Evaluating: 0.452767661*360.0
 Parameter: YPHI <- "162.996358"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.765675868"
Evaluating: 0.765675868*360.0
 Parameter: ZPHI <- "275.643312"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.7925051"
 Parameter: YPOS -> "6.93760047"
 Parameter: ZPOS -> "-64.5117346"
 Parameter: XPHI -> "112.15979"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.377191    0.926136
    0.000000   -0.926136   -0.377191

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.7925051"
 Parameter: YPOS -> "6.93760047"
 Parameter: ZPOS -> "-64.5117346"
 Parameter: YPHI -> "162.996358"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.956286    0.000000   -0.292432
    0.000000    1.000000    0.000000
    0.292432    0.000000   -0.956286

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  163.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.7925051"
 Parameter: YPOS -> "6.93760047"
 Parameter: ZPOS -> "-64.5117346"
 Parameter: ZPHI -> "275.643312"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.098335   -0.995153    0.000000
    0.995153    0.098335    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   84.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.792505 XMAX =  -36.792505 XAVE =  -36.792505
    YMIN =    6.937600 YMAX =    6.937600 YAVE =    6.937600
    ZMIN =  -64.511735 ZMAX =  -64.511735 ZAVE =  -64.511735
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.7925051"
Evaluating: -36.7925051+3.5
 Parameter: XMAX <- "-33.2925051"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.93760047"
Evaluating: 6.93760047+3.5
 Parameter: YMAX <- "10.4376005"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-64.5117346"
Evaluating: -64.5117346+3.5
 Parameter: ZMAX <- "-61.0117346"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.7925051"
Evaluating: -36.7925051-3.5
 Parameter: XMIN <- "-40.2925051"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.93760047"
Evaluating: 6.93760047-3.5
 Parameter: YMIN <- "3.43760047"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-64.5117346"
Evaluating: -64.5117346-3.5
 Parameter: ZMIN <- "-68.0117346"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.2925051"
 Parameter: XMIN -> "-40.2925051"
 Parameter: YMAX -> "10.4376005"
 Parameter: YMIN -> "3.43760047"
 Parameter: ZMAX -> "-61.0117346"
 Parameter: ZMIN -> "-68.0117346"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "17" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "17" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.763776689"
Evaluating: 112.065471*(0.763776689-0.5)
 Parameter: XPOS <- "29.5602589"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.115479723"
Evaluating: 112.065471*(0.115479723-0.5)
 Parameter: YPOS <- "-43.091446"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "5.42817288E-02"
Evaluating: 142.885239*(5.42817288E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-60.7524206"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-60.7524206" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.5602589"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.5602589-0
 Parameter: XTRAN <- "29.5602589"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.091446"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.091446-0
 Parameter: YTRAN <- "-43.091446"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-60.7524206"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -60.7524206-0
 Parameter: ZTRAN <- "-60.7524206"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.5602589"
 Parameter: YTRAN -> "-43.091446"
 Parameter: ZTRAN -> "-60.7524206"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    29.560259  -43.091446  -60.752421
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.123001496"
Evaluating: 0.123001496*360.0
 Parameter: XPHI <- "44.2805386"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.858787652"
Evaluating: 0.858787652*360.0
 Parameter: YPHI <- "309.163555"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.349799195"
Evaluating: 0.349799195*360.0
 Parameter: ZPHI <- "125.92771"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.5602589"
 Parameter: YPOS -> "-43.091446"
 Parameter: ZPOS -> "-60.7524206"
 Parameter: XPHI -> "44.2805386"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.715930    0.698172
    0.000000   -0.698172    0.715930

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   44.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.5602589"
 Parameter: YPOS -> "-43.091446"
 Parameter: ZPOS -> "-60.7524206"
 Parameter: YPHI -> "309.163555"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.631536    0.000000    0.775346
    0.000000    1.000000    0.000000
   -0.775346    0.000000    0.631536

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   50.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.5602589"
 Parameter: YPOS -> "-43.091446"
 Parameter: ZPOS -> "-60.7524206"
 Parameter: ZPHI -> "125.92771"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.586764    0.809758    0.000000
   -0.809758   -0.586764    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  125.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.560259 XMAX =   29.560259 XAVE =   29.560259
    YMIN =  -43.091446 YMAX =  -43.091446 YAVE =  -43.091446
    ZMIN =  -60.752421 ZMAX =  -60.752421 ZAVE =  -60.752421
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.5602589"
Evaluating: 29.5602589+3.5
 Parameter: XMAX <- "33.0602589"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.091446"
Evaluating: -43.091446+3.5
 Parameter: YMAX <- "-39.591446"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-60.7524206"
Evaluating: -60.7524206+3.5
 Parameter: ZMAX <- "-57.2524206"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.5602589"
Evaluating: 29.5602589-3.5
 Parameter: XMIN <- "26.0602589"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.091446"
Evaluating: -43.091446-3.5
 Parameter: YMIN <- "-46.591446"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-60.7524206"
Evaluating: -60.7524206-3.5
 Parameter: ZMIN <- "-64.2524206"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.0602589"
 Parameter: XMIN -> "26.0602589"
 Parameter: YMAX -> "-39.591446"
 Parameter: YMIN -> "-46.591446"
 Parameter: ZMAX -> "-57.2524206"
 Parameter: ZMIN -> "-64.2524206"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "18" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "18" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.22113839"
Evaluating: 112.065471*(0.22113839-0.5)
 Parameter: XPOS <- "-31.2507577"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.636231101"
Evaluating: 112.065471*(0.636231101-0.5)
 Parameter: YPOS <- "15.2668025"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "9.993024668E-02"
Evaluating: 142.885239*(9.993024668E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-54.2299212"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.2299212" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.2507577"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.2507577-0
 Parameter: XTRAN <- "-31.2507577"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.2668025"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.2668025-0
 Parameter: YTRAN <- "15.2668025"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.2299212"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.2299212-0
 Parameter: ZTRAN <- "-54.2299212"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.2507577"
 Parameter: YTRAN -> "15.2668025"
 Parameter: ZTRAN -> "-54.2299212"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -31.250758   15.266803  -54.229921
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.540448177"
Evaluating: 0.540448177*360.0
 Parameter: XPHI <- "194.561344"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.738332455"
Evaluating: 0.738332455*360.0
 Parameter: YPHI <- "265.799684"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.934833159"
Evaluating: 0.934833159*360.0
 Parameter: ZPHI <- "336.539937"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.2507577"
 Parameter: YPOS -> "15.2668025"
 Parameter: ZPOS -> "-54.2299212"
 Parameter: XPHI -> "194.561344"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.967879   -0.251416
    0.000000    0.251416   -0.967879

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  165.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.2507577"
 Parameter: YPOS -> "15.2668025"
 Parameter: ZPOS -> "-54.2299212"
 Parameter: YPHI -> "265.799684"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.073244    0.000000    0.997314
    0.000000    1.000000    0.000000
   -0.997314    0.000000   -0.073244

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   94.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.2507577"
 Parameter: YPOS -> "15.2668025"
 Parameter: ZPOS -> "-54.2299212"
 Parameter: ZPHI -> "336.539937"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.917338   -0.398110    0.000000
    0.398110    0.917338    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   23.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.250758 XMAX =  -31.250758 XAVE =  -31.250758
    YMIN =   15.266803 YMAX =   15.266803 YAVE =   15.266803
    ZMIN =  -54.229921 ZMAX =  -54.229921 ZAVE =  -54.229921
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.2507577"
Evaluating: -31.2507577+3.5
 Parameter: XMAX <- "-27.7507577"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.2668025"
Evaluating: 15.2668025+3.5
 Parameter: YMAX <- "18.7668025"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.2299212"
Evaluating: -54.2299212+3.5
 Parameter: ZMAX <- "-50.7299212"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.2507577"
Evaluating: -31.2507577-3.5
 Parameter: XMIN <- "-34.7507577"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.2668025"
Evaluating: 15.2668025-3.5
 Parameter: YMIN <- "11.7668025"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.2299212"
Evaluating: -54.2299212-3.5
 Parameter: ZMIN <- "-57.7299212"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.7507577"
 Parameter: XMIN -> "-34.7507577"
 Parameter: YMAX -> "18.7668025"
 Parameter: YMIN -> "11.7668025"
 Parameter: ZMAX -> "-50.7299212"
 Parameter: ZMIN -> "-57.7299212"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "19" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "19" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.597287429"
Evaluating: 112.065471*(0.597287429-0.5)
 Parameter: XPOS <- "10.9025616"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.756212743"
Evaluating: 112.065471*(0.756212743-0.5)
 Parameter: YPOS <- "28.7126017"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.548787952"
Evaluating: 142.885239*(0.548787952-0.5)+2.93414115
 Parameter: ZPOS <- "9.90521933"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.90521933" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.90521933" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "19" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.808726895"
Evaluating: 112.065471*(0.808726895-0.5)
 Parameter: XPOS <- "34.5976249"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.166920263"
Evaluating: 112.065471*(0.166920263-0.5)
 Parameter: YPOS <- "-37.3267376"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.924764457"
Evaluating: 142.885239*(0.924764457-0.5)+2.93414115
 Parameter: ZPOS <- "63.6267121"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.6267121" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.6267121" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.5976249"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.5976249-0
 Parameter: XTRAN <- "34.5976249"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.3267376"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.3267376-0
 Parameter: YTRAN <- "-37.3267376"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.6267121"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 63.6267121-0
 Parameter: ZTRAN <- "63.6267121"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.5976249"
 Parameter: YTRAN -> "-37.3267376"
 Parameter: ZTRAN -> "63.6267121"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    34.597625  -37.326738   63.626712
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317862468"
Evaluating: 0.317862468*360.0
 Parameter: XPHI <- "114.430488"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.626742881"
Evaluating: 0.626742881*360.0
 Parameter: YPHI <- "225.627437"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.964363791"
Evaluating: 0.964363791*360.0
 Parameter: ZPHI <- "347.170965"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.5976249"
 Parameter: YPOS -> "-37.3267376"
 Parameter: ZPOS -> "63.6267121"
 Parameter: XPHI -> "114.430488"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.413589    0.910464
    0.000000   -0.910464   -0.413589

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.5976249"
 Parameter: YPOS -> "-37.3267376"
 Parameter: ZPOS -> "63.6267121"
 Parameter: YPHI -> "225.627437"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.699321    0.000000    0.714808
    0.000000    1.000000    0.000000
   -0.714808    0.000000   -0.699321

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  134.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.5976249"
 Parameter: YPOS -> "-37.3267376"
 Parameter: ZPOS -> "63.6267121"
 Parameter: ZPHI -> "347.170965"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.975037   -0.222043    0.000000
    0.222043    0.975037    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   12.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.597625 XMAX =   34.597625 XAVE =   34.597625
    YMIN =  -37.326738 YMAX =  -37.326738 YAVE =  -37.326738
    ZMIN =   63.626712 ZMAX =   63.626712 ZAVE =   63.626712
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.5976249"
Evaluating: 34.5976249+3.5
 Parameter: XMAX <- "38.0976249"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.3267376"
Evaluating: -37.3267376+3.5
 Parameter: YMAX <- "-33.8267376"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.6267121"
Evaluating: 63.6267121+3.5
 Parameter: ZMAX <- "67.1267121"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.5976249"
Evaluating: 34.5976249-3.5
 Parameter: XMIN <- "31.0976249"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.3267376"
Evaluating: -37.3267376-3.5
 Parameter: YMIN <- "-40.8267376"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.6267121"
Evaluating: 63.6267121-3.5
 Parameter: ZMIN <- "60.1267121"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.0976249"
 Parameter: XMIN -> "31.0976249"
 Parameter: YMAX -> "-33.8267376"
 Parameter: YMIN -> "-40.8267376"
 Parameter: ZMAX -> "67.1267121"
 Parameter: ZMIN -> "60.1267121"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "20" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "20" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.659522891"
Evaluating: 112.065471*(0.659522891-0.5)
 Parameter: XPOS <- "17.8770079"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "8.773912511E-02"
Evaluating: 112.065471*(8.773912511E-02-0.5)
 Parameter: YPOS <- "-46.2002091"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.75534306"
Evaluating: 142.885239*(0.75534306-0.5)+2.93414115
 Parameter: ZPOS <- "39.4188953"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.4188953" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.4188953" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.8770079"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.8770079-0
 Parameter: XTRAN <- "17.8770079"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.2002091"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.2002091-0
 Parameter: YTRAN <- "-46.2002091"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.4188953"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.4188953-0
 Parameter: ZTRAN <- "39.4188953"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.8770079"
 Parameter: YTRAN -> "-46.2002091"
 Parameter: ZTRAN -> "39.4188953"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    17.877008  -46.200209   39.418895
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.492411473"
Evaluating: 0.492411473*360.0
 Parameter: XPHI <- "177.26813"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.424600203"
Evaluating: 0.424600203*360.0
 Parameter: YPHI <- "152.856073"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.251750857E-02"
Evaluating: 7.251750857E-02*360.0
 Parameter: ZPHI <- "26.1063031"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.8770079"
 Parameter: YPOS -> "-46.2002091"
 Parameter: ZPOS -> "39.4188953"
 Parameter: XPHI -> "177.26813"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998864    0.047662
    0.000000   -0.047662   -0.998864

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  177.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.8770079"
 Parameter: YPOS -> "-46.2002091"
 Parameter: ZPOS -> "39.4188953"
 Parameter: YPHI -> "152.856073"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.889863    0.000000   -0.456227
    0.000000    1.000000    0.000000
    0.456227    0.000000   -0.889863

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  152.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.8770079"
 Parameter: YPOS -> "-46.2002091"
 Parameter: ZPOS -> "39.4188953"
 Parameter: ZPHI -> "26.1063031"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.897979    0.440038    0.000000
   -0.440038    0.897979    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   26.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.877008 XMAX =   17.877008 XAVE =   17.877008
    YMIN =  -46.200209 YMAX =  -46.200209 YAVE =  -46.200209
    ZMIN =   39.418895 ZMAX =   39.418895 ZAVE =   39.418895
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.8770079"
Evaluating: 17.8770079+3.5
 Parameter: XMAX <- "21.3770079"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.2002091"
Evaluating: -46.2002091+3.5
 Parameter: YMAX <- "-42.7002091"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.4188953"
Evaluating: 39.4188953+3.5
 Parameter: ZMAX <- "42.9188953"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.8770079"
Evaluating: 17.8770079-3.5
 Parameter: XMIN <- "14.3770079"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.2002091"
Evaluating: -46.2002091-3.5
 Parameter: YMIN <- "-49.7002091"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.4188953"
Evaluating: 39.4188953-3.5
 Parameter: ZMIN <- "35.9188953"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.3770079"
 Parameter: XMIN -> "14.3770079"
 Parameter: YMAX -> "-42.7002091"
 Parameter: YMIN -> "-49.7002091"
 Parameter: ZMAX -> "42.9188953"
 Parameter: ZMIN -> "35.9188953"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "21" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "21" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.118026783"
Evaluating: 112.065471*(0.118026783-0.5)
 Parameter: XPOS <- "-42.8060085"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.798593377"
Evaluating: 112.065471*(0.798593377-0.5)
 Parameter: YPOS <- "33.4620074"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "7.70299466E-02"
Evaluating: 142.885239*(7.70299466E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-57.502036"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.502036" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.8060085"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.8060085-0
 Parameter: XTRAN <- "-42.8060085"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.4620074"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.4620074-0
 Parameter: YTRAN <- "33.4620074"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.502036"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -57.502036-0
 Parameter: ZTRAN <- "-57.502036"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.8060085"
 Parameter: YTRAN -> "33.4620074"
 Parameter: ZTRAN -> "-57.502036"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -42.806008   33.462007  -57.502036
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.813800933"
Evaluating: 0.813800933*360.0
 Parameter: XPHI <- "292.968336"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.521473519"
Evaluating: 0.521473519*360.0
 Parameter: YPHI <- "187.730467"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.583138617E-02"
Evaluating: 7.583138617E-02*360.0
 Parameter: ZPHI <- "27.299299"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.8060085"
 Parameter: YPOS -> "33.4620074"
 Parameter: ZPOS -> "-57.502036"
 Parameter: XPHI -> "292.968336"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.390222   -0.920721
    0.000000    0.920721    0.390222

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   67.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.8060085"
 Parameter: YPOS -> "33.4620074"
 Parameter: ZPOS -> "-57.502036"
 Parameter: YPHI -> "187.730467"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.990912    0.000000    0.134513
    0.000000    1.000000    0.000000
   -0.134513    0.000000   -0.990912

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  172.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.8060085"
 Parameter: YPOS -> "33.4620074"
 Parameter: ZPOS -> "-57.502036"
 Parameter: ZPHI -> "27.299299"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.888623    0.458639    0.000000
   -0.458639    0.888623    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   27.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.806008 XMAX =  -42.806008 XAVE =  -42.806008
    YMIN =   33.462007 YMAX =   33.462007 YAVE =   33.462007
    ZMIN =  -57.502036 ZMAX =  -57.502036 ZAVE =  -57.502036
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.8060085"
Evaluating: -42.8060085+3.5
 Parameter: XMAX <- "-39.3060085"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.4620074"
Evaluating: 33.4620074+3.5
 Parameter: YMAX <- "36.9620074"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.502036"
Evaluating: -57.502036+3.5
 Parameter: ZMAX <- "-54.002036"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.8060085"
Evaluating: -42.8060085-3.5
 Parameter: XMIN <- "-46.3060085"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.4620074"
Evaluating: 33.4620074-3.5
 Parameter: YMIN <- "29.9620074"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.502036"
Evaluating: -57.502036-3.5
 Parameter: ZMIN <- "-61.002036"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.3060085"
 Parameter: XMIN -> "-46.3060085"
 Parameter: YMAX -> "36.9620074"
 Parameter: YMIN -> "29.9620074"
 Parameter: ZMAX -> "-54.002036"
 Parameter: ZMIN -> "-61.002036"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "22" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "22" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.593693643"
Evaluating: 112.065471*(0.593693643-0.5)
 Parameter: XPOS <- "10.4998222"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.811448532E-02"
Evaluating: 112.065471*(5.811448532E-02-0.5)
 Parameter: YPOS <- "-49.5201083"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.734270375"
Evaluating: 142.885239*(0.734270375-0.5)+2.93414115
 Parameter: ZPOS <- "36.4079197"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.4079197" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.4079197" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.4998222"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.4998222-0
 Parameter: XTRAN <- "10.4998222"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.5201083"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -49.5201083-0
 Parameter: YTRAN <- "-49.5201083"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.4079197"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.4079197-0
 Parameter: ZTRAN <- "36.4079197"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.4998222"
 Parameter: YTRAN -> "-49.5201083"
 Parameter: ZTRAN -> "36.4079197"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    10.499822  -49.520108   36.407920
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.735561162"
Evaluating: 0.735561162*360.0
 Parameter: XPHI <- "264.802018"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.839694903"
Evaluating: 0.839694903*360.0
 Parameter: YPHI <- "302.290165"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.863708363"
Evaluating: 0.863708363*360.0
 Parameter: ZPHI <- "310.935011"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.4998222"
 Parameter: YPOS -> "-49.5201083"
 Parameter: ZPOS -> "36.4079197"
 Parameter: XPHI -> "264.802018"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.090598   -0.995888
    0.000000    0.995888   -0.090598

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   95.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.4998222"
 Parameter: YPOS -> "-49.5201083"
 Parameter: ZPOS -> "36.4079197"
 Parameter: YPHI -> "302.290165"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.534207    0.000000    0.845354
    0.000000    1.000000    0.000000
   -0.845354    0.000000    0.534207

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   57.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.4998222"
 Parameter: YPOS -> "-49.5201083"
 Parameter: ZPOS -> "36.4079197"
 Parameter: ZPHI -> "310.935011"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.655203   -0.755453    0.000000
    0.755453    0.655203    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   49.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.499822 XMAX =   10.499822 XAVE =   10.499822
    YMIN =  -49.520108 YMAX =  -49.520108 YAVE =  -49.520108
    ZMIN =   36.407920 ZMAX =   36.407920 ZAVE =   36.407920
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.4998222"
Evaluating: 10.4998222+3.5
 Parameter: XMAX <- "13.9998222"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.5201083"
Evaluating: -49.5201083+3.5
 Parameter: YMAX <- "-46.0201083"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.4079197"
Evaluating: 36.4079197+3.5
 Parameter: ZMAX <- "39.9079197"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.4998222"
Evaluating: 10.4998222-3.5
 Parameter: XMIN <- "6.9998222"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.5201083"
Evaluating: -49.5201083-3.5
 Parameter: YMIN <- "-53.0201083"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.4079197"
Evaluating: 36.4079197-3.5
 Parameter: ZMIN <- "32.9079197"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.9998222"
 Parameter: XMIN -> "6.9998222"
 Parameter: YMAX -> "-46.0201083"
 Parameter: YMIN -> "-53.0201083"
 Parameter: ZMAX -> "39.9079197"
 Parameter: ZMIN -> "32.9079197"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "23" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "23" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.32927312"
Evaluating: 112.065471*(0.32927312-0.5)
 Parameter: XPOS <- "-19.1325882"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.238969924"
Evaluating: 112.065471*(0.238969924-0.5)
 Parameter: YPOS <- "-29.2524584"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.778327903"
Evaluating: 142.885239*(0.778327903-0.5)+2.93414115
 Parameter: ZPOS <- "42.7030901"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "42.7030901" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "42.7030901" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.1325882"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -19.1325882-0
 Parameter: XTRAN <- "-19.1325882"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.2524584"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.2524584-0
 Parameter: YTRAN <- "-29.2524584"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.7030901"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 42.7030901-0
 Parameter: ZTRAN <- "42.7030901"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-19.1325882"
 Parameter: YTRAN -> "-29.2524584"
 Parameter: ZTRAN -> "42.7030901"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -19.132588  -29.252458   42.703090
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.725013578"
Evaluating: 0.725013578*360.0
 Parameter: XPHI <- "261.004888"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.186556341"
Evaluating: 0.186556341*360.0
 Parameter: YPHI <- "67.1602828"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.684331906"
Evaluating: 0.684331906*360.0
 Parameter: ZPHI <- "246.359486"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.1325882"
 Parameter: YPOS -> "-29.2524584"
 Parameter: ZPOS -> "42.7030901"
 Parameter: XPHI -> "261.004888"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.156350   -0.987702
    0.000000    0.987702   -0.156350

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   99.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.1325882"
 Parameter: YPOS -> "-29.2524584"
 Parameter: ZPOS -> "42.7030901"
 Parameter: YPHI -> "67.1602828"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.388155    0.000000   -0.921594
    0.000000    1.000000    0.000000
    0.921594    0.000000    0.388155

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   67.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.1325882"
 Parameter: YPOS -> "-29.2524584"
 Parameter: ZPOS -> "42.7030901"
 Parameter: ZPHI -> "246.359486"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.400997   -0.916079    0.000000
    0.916079   -0.400997    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  113.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.132588 XMAX =  -19.132588 XAVE =  -19.132588
    YMIN =  -29.252458 YMAX =  -29.252458 YAVE =  -29.252458
    ZMIN =   42.703090 ZMAX =   42.703090 ZAVE =   42.703090
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.1325882"
Evaluating: -19.1325882+3.5
 Parameter: XMAX <- "-15.6325882"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.2524584"
Evaluating: -29.2524584+3.5
 Parameter: YMAX <- "-25.7524584"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.7030901"
Evaluating: 42.7030901+3.5
 Parameter: ZMAX <- "46.2030901"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.1325882"
Evaluating: -19.1325882-3.5
 Parameter: XMIN <- "-22.6325882"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.2524584"
Evaluating: -29.2524584-3.5
 Parameter: YMIN <- "-32.7524584"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.7030901"
Evaluating: 42.7030901-3.5
 Parameter: ZMIN <- "39.2030901"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.6325882"
 Parameter: XMIN -> "-22.6325882"
 Parameter: YMAX -> "-25.7524584"
 Parameter: YMIN -> "-32.7524584"
 Parameter: ZMAX -> "46.2030901"
 Parameter: ZMIN -> "39.2030901"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "24" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "24" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.085014624E-02"
Evaluating: 112.065471*(4.085014624E-02-0.5)
 Parameter: XPOS <- "-51.4548446"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.702327773"
Evaluating: 112.065471*(0.702327773-0.5)
 Parameter: YPOS <- "22.6739572"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.393053682"
Evaluating: 142.885239*(0.393053682-0.5)+2.93414115
 Parameter: ZPOS <- "-12.3469091"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.3469091" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.3469091" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "24" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.955315917"
Evaluating: 112.065471*(0.955315917-0.5)
 Parameter: XPOS <- "51.0251927"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.641262278"
Evaluating: 112.065471*(0.641262278-0.5)
 Parameter: YPOS <- "15.8306237"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.507950324"
Evaluating: 142.885239*(0.507950324-0.5)+2.93414115
 Parameter: ZPOS <- "4.07012509"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.07012509" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.07012509" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "24" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.403956589"
Evaluating: 112.065471*(0.403956589-0.5)
 Parameter: XPOS <- "-10.7631501"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.785506672"
Evaluating: 112.065471*(0.785506672-0.5)
 Parameter: YPOS <- "31.9954397"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.481742547"
Evaluating: 142.885239*(0.481742547-0.5)+2.93414115
 Parameter: ZPOS <- "0.325420615"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.325420615" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.325420615" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "24" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.826424801"
Evaluating: 112.065471*(0.826424801-0.5)
 Parameter: XPOS <- "36.5809491"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.217869352"
Evaluating: 112.065471*(0.217869352-0.5)
 Parameter: YPOS <- "-31.617104"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "3.290957808E-02"
Evaluating: 142.885239*(3.290957808E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-63.8061854"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-63.8061854" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.5809491"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.5809491-0
 Parameter: XTRAN <- "36.5809491"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.617104"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.617104-0
 Parameter: YTRAN <- "-31.617104"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-63.8061854"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -63.8061854-0
 Parameter: ZTRAN <- "-63.8061854"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.5809491"
 Parameter: YTRAN -> "-31.617104"
 Parameter: ZTRAN -> "-63.8061854"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    36.580949  -31.617104  -63.806185
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.712261777"
Evaluating: 0.712261777*360.0
 Parameter: XPHI <- "256.41424"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.47806421"
Evaluating: 0.47806421*360.0
 Parameter: YPHI <- "172.103116"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.398445788"
Evaluating: 0.398445788*360.0
 Parameter: ZPHI <- "143.440484"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.5809491"
 Parameter: YPOS -> "-31.617104"
 Parameter: ZPOS -> "-63.8061854"
 Parameter: XPHI -> "256.41424"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.234901   -0.972019
    0.000000    0.972019   -0.234901

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  103.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.5809491"
 Parameter: YPOS -> "-31.617104"
 Parameter: ZPOS -> "-63.8061854"
 Parameter: YPHI -> "172.103116"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.990517    0.000000   -0.137391
    0.000000    1.000000    0.000000
    0.137391    0.000000   -0.990517

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  172.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.5809491"
 Parameter: YPOS -> "-31.617104"
 Parameter: ZPOS -> "-63.8061854"
 Parameter: ZPHI -> "143.440484"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.803239    0.595657    0.000000
   -0.595657   -0.803239    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  143.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.580949 XMAX =   36.580949 XAVE =   36.580949
    YMIN =  -31.617104 YMAX =  -31.617104 YAVE =  -31.617104
    ZMIN =  -63.806185 ZMAX =  -63.806185 ZAVE =  -63.806185
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.5809491"
Evaluating: 36.5809491+3.5
 Parameter: XMAX <- "40.0809491"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.617104"
Evaluating: -31.617104+3.5
 Parameter: YMAX <- "-28.117104"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-63.8061854"
Evaluating: -63.8061854+3.5
 Parameter: ZMAX <- "-60.3061854"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.5809491"
Evaluating: 36.5809491-3.5
 Parameter: XMIN <- "33.0809491"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.617104"
Evaluating: -31.617104-3.5
 Parameter: YMIN <- "-35.117104"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-63.8061854"
Evaluating: -63.8061854-3.5
 Parameter: ZMIN <- "-67.3061854"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.0809491"
 Parameter: XMIN -> "33.0809491"
 Parameter: YMAX -> "-28.117104"
 Parameter: YMIN -> "-35.117104"
 Parameter: ZMAX -> "-60.3061854"
 Parameter: ZMIN -> "-67.3061854"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "25" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "25" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.546848655"
Evaluating: 112.065471*(0.546848655-0.5)
 Parameter: XPOS <- "5.25011659"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.778176681"
Evaluating: 112.065471*(0.778176681-0.5)
 Parameter: YPOS <- "31.1740008"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.694744801"
Evaluating: 142.885239*(0.694744801-0.5)+2.93414115
 Parameter: ZPOS <- "30.7602986"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.7602986" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.7602986" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.25011659"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.25011659-0
 Parameter: XTRAN <- "5.25011659"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.1740008"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.1740008-0
 Parameter: YTRAN <- "31.1740008"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.7602986"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.7602986-0
 Parameter: ZTRAN <- "30.7602986"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.25011659"
 Parameter: YTRAN -> "31.1740008"
 Parameter: ZTRAN -> "30.7602986"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     5.250117   31.174001   30.760299
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.110612798"
Evaluating: 0.110612798*360.0
 Parameter: XPHI <- "39.8206073"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.379813287"
Evaluating: 0.379813287*360.0
 Parameter: YPHI <- "136.732783"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.474906341"
Evaluating: 0.474906341*360.0
 Parameter: ZPHI <- "170.966283"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.25011659"
 Parameter: YPOS -> "31.1740008"
 Parameter: ZPOS -> "30.7602986"
 Parameter: XPHI -> "39.8206073"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.768053    0.640386
    0.000000   -0.640386    0.768053

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   39.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.25011659"
 Parameter: YPOS -> "31.1740008"
 Parameter: ZPOS -> "30.7602986"
 Parameter: YPHI -> "136.732783"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.728165    0.000000   -0.685402
    0.000000    1.000000    0.000000
    0.685402    0.000000   -0.728165

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  136.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.25011659"
 Parameter: YPOS -> "31.1740008"
 Parameter: ZPOS -> "30.7602986"
 Parameter: ZPHI -> "170.966283"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.987596    0.157016    0.000000
   -0.157016   -0.987596    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  170.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.250117 XMAX =    5.250117 XAVE =    5.250117
    YMIN =   31.174001 YMAX =   31.174001 YAVE =   31.174001
    ZMIN =   30.760299 ZMAX =   30.760299 ZAVE =   30.760299
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.25011659"
Evaluating: 5.25011659+3.5
 Parameter: XMAX <- "8.75011659"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.1740008"
Evaluating: 31.1740008+3.5
 Parameter: YMAX <- "34.6740008"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.7602986"
Evaluating: 30.7602986+3.5
 Parameter: ZMAX <- "34.2602986"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.25011659"
Evaluating: 5.25011659-3.5
 Parameter: XMIN <- "1.75011659"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.1740008"
Evaluating: 31.1740008-3.5
 Parameter: YMIN <- "27.6740008"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.7602986"
Evaluating: 30.7602986-3.5
 Parameter: ZMIN <- "27.2602986"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.75011659"
 Parameter: XMIN -> "1.75011659"
 Parameter: YMAX -> "34.6740008"
 Parameter: YMIN -> "27.6740008"
 Parameter: ZMAX -> "34.2602986"
 Parameter: ZMIN -> "27.2602986"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "26" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "26" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.57982561"
Evaluating: 112.065471*(0.57982561-0.5)
 Parameter: XPOS <- "8.94569458"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.275653006"
Evaluating: 112.065471*(0.275653006-0.5)
 Parameter: YPOS <- "-25.1415516"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.879149829"
Evaluating: 142.885239*(0.879149829-0.5)+2.93414115
 Parameter: ZPOS <- "57.1090551"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.1090551" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.1090551" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.94569458"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.94569458-0
 Parameter: XTRAN <- "8.94569458"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.1415516"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.1415516-0
 Parameter: YTRAN <- "-25.1415516"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.1090551"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.1090551-0
 Parameter: ZTRAN <- "57.1090551"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.94569458"
 Parameter: YTRAN -> "-25.1415516"
 Parameter: ZTRAN -> "57.1090551"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     8.945695  -25.141552   57.109055
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.246750749"
Evaluating: 0.246750749*360.0
 Parameter: XPHI <- "88.8302696"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987804958"
Evaluating: 0.987804958*360.0
 Parameter: YPHI <- "355.609785"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.441294237"
Evaluating: 0.441294237*360.0
 Parameter: ZPHI <- "158.865925"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.94569458"
 Parameter: YPOS -> "-25.1415516"
 Parameter: ZPOS -> "57.1090551"
 Parameter: XPHI -> "88.8302696"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.020414    0.999792
    0.000000   -0.999792    0.020414

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   88.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.94569458"
 Parameter: YPOS -> "-25.1415516"
 Parameter: ZPOS -> "57.1090551"
 Parameter: YPHI -> "355.609785"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.997066    0.000000    0.076549
    0.000000    1.000000    0.000000
   -0.076549    0.000000    0.997066

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.94569458"
 Parameter: YPOS -> "-25.1415516"
 Parameter: ZPOS -> "57.1090551"
 Parameter: ZPHI -> "158.865925"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.932739    0.360552    0.000000
   -0.360552   -0.932739    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  158.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.945695 XMAX =    8.945695 XAVE =    8.945695
    YMIN =  -25.141552 YMAX =  -25.141552 YAVE =  -25.141552
    ZMIN =   57.109055 ZMAX =   57.109055 ZAVE =   57.109055
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.94569458"
Evaluating: 8.94569458+3.5
 Parameter: XMAX <- "12.4456946"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.1415516"
Evaluating: -25.1415516+3.5
 Parameter: YMAX <- "-21.6415516"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.1090551"
Evaluating: 57.1090551+3.5
 Parameter: ZMAX <- "60.6090551"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.94569458"
Evaluating: 8.94569458-3.5
 Parameter: XMIN <- "5.44569458"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.1415516"
Evaluating: -25.1415516-3.5
 Parameter: YMIN <- "-28.6415516"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.1090551"
Evaluating: 57.1090551-3.5
 Parameter: ZMIN <- "53.6090551"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.4456946"
 Parameter: XMIN -> "5.44569458"
 Parameter: YMAX -> "-21.6415516"
 Parameter: YMIN -> "-28.6415516"
 Parameter: ZMAX -> "60.6090551"
 Parameter: ZMIN -> "53.6090551"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "27" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "27" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.526870767"
Evaluating: 112.065471*(0.526870767-0.5)
 Parameter: XPOS <- "3.01128516"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.161701014"
Evaluating: 112.065471*(0.161701014-0.5)
 Parameter: YPOS <- "-37.9116352"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.805507502"
Evaluating: 142.885239*(0.805507502-0.5)+2.93414115
 Parameter: ZPOS <- "46.5866536"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.5866536" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.5866536" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.01128516"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.01128516-0
 Parameter: XTRAN <- "3.01128516"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.9116352"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.9116352-0
 Parameter: YTRAN <- "-37.9116352"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.5866536"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.5866536-0
 Parameter: ZTRAN <- "46.5866536"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.01128516"
 Parameter: YTRAN -> "-37.9116352"
 Parameter: ZTRAN -> "46.5866536"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     3.011285  -37.911635   46.586654
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.403099242"
Evaluating: 0.403099242*360.0
 Parameter: XPHI <- "145.115727"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.608605341"
Evaluating: 0.608605341*360.0
 Parameter: YPHI <- "219.097923"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.711161529E-02"
Evaluating: 3.711161529E-02*360.0
 Parameter: ZPHI <- "13.3601815"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.01128516"
 Parameter: YPOS -> "-37.9116352"
 Parameter: ZPOS -> "46.5866536"
 Parameter: XPHI -> "145.115727"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.820309    0.571921
    0.000000   -0.571921   -0.820309

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  145.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.01128516"
 Parameter: YPOS -> "-37.9116352"
 Parameter: ZPOS -> "46.5866536"
 Parameter: YPHI -> "219.097923"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.776069    0.000000    0.630648
    0.000000    1.000000    0.000000
   -0.630648    0.000000   -0.776069

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  140.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.01128516"
 Parameter: YPOS -> "-37.9116352"
 Parameter: ZPOS -> "46.5866536"
 Parameter: ZPHI -> "13.3601815"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.972937    0.231072    0.000000
   -0.231072    0.972937    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.011285 XMAX =    3.011285 XAVE =    3.011285
    YMIN =  -37.911635 YMAX =  -37.911635 YAVE =  -37.911635
    ZMIN =   46.586654 ZMAX =   46.586654 ZAVE =   46.586654
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.01128516"
Evaluating: 3.01128516+3.5
 Parameter: XMAX <- "6.51128516"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.9116352"
Evaluating: -37.9116352+3.5
 Parameter: YMAX <- "-34.4116352"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.5866536"
Evaluating: 46.5866536+3.5
 Parameter: ZMAX <- "50.0866536"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.01128516"
Evaluating: 3.01128516-3.5
 Parameter: XMIN <- "-0.48871484"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.9116352"
Evaluating: -37.9116352-3.5
 Parameter: YMIN <- "-41.4116352"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.5866536"
Evaluating: 46.5866536-3.5
 Parameter: ZMIN <- "43.0866536"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.51128516"
 Parameter: XMIN -> "-0.48871484"
 Parameter: YMAX -> "-34.4116352"
 Parameter: YMIN -> "-41.4116352"
 Parameter: ZMAX -> "50.0866536"
 Parameter: ZMIN -> "43.0866536"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "28" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "28" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.408947943"
Evaluating: 112.065471*(0.408947943-0.5)
 Parameter: XPOS <- "-10.2037917"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.568254988E-02"
Evaluating: 112.065471*(7.568254988E-02-0.5)
 Parameter: YPOS <- "-47.5513349"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.480766401"
Evaluating: 142.885239*(0.480766401-0.5)+2.93414115
 Parameter: ZPOS <- "0.18594376"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.18594376" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.18594376" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "28" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.280230534"
Evaluating: 112.065471*(0.280230534-0.5)
 Parameter: XPOS <- "-24.6285687"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.749817863"
Evaluating: 112.065471*(0.749817863-0.5)
 Parameter: YPOS <- "27.9959565"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.518361426"
Evaluating: 142.885239*(0.518361426-0.5)+2.93414115
 Parameter: ZPOS <- "5.55771789"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.55771789" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.55771789" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "28" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.112779673"
Evaluating: 112.065471*(0.112779673-0.5)
 Parameter: XPOS <- "-43.3940283"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.802672924"
Evaluating: 112.065471*(0.802672924-0.5)
 Parameter: YPOS <- "33.9191838"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.667409688"
Evaluating: 142.885239*(0.667409688-0.5)+2.93414115
 Parameter: ZPOS <- "26.8545144"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.8545144" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.8545144" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.3940283"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.3940283-0
 Parameter: XTRAN <- "-43.3940283"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.9191838"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.9191838-0
 Parameter: YTRAN <- "33.9191838"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.8545144"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.8545144-0
 Parameter: ZTRAN <- "26.8545144"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.3940283"
 Parameter: YTRAN -> "33.9191838"
 Parameter: ZTRAN -> "26.8545144"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -43.394028   33.919184   26.854514
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.842421329"
Evaluating: 0.842421329*360.0
 Parameter: XPHI <- "303.271678"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.66052527"
Evaluating: 0.66052527*360.0
 Parameter: YPHI <- "237.789097"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.263308457"
Evaluating: 0.263308457*360.0
 Parameter: ZPHI <- "94.7910445"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.3940283"
 Parameter: YPOS -> "33.9191838"
 Parameter: ZPOS -> "26.8545144"
 Parameter: XPHI -> "303.271678"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.548610   -0.836079
    0.000000    0.836079    0.548610

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   56.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.3940283"
 Parameter: YPOS -> "33.9191838"
 Parameter: ZPOS -> "26.8545144"
 Parameter: YPHI -> "237.789097"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.533037    0.000000    0.846092
    0.000000    1.000000    0.000000
   -0.846092    0.000000   -0.533037

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  122.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.3940283"
 Parameter: YPOS -> "33.9191838"
 Parameter: ZPOS -> "26.8545144"
 Parameter: ZPHI -> "94.7910445"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.083522    0.996506    0.000000
   -0.996506   -0.083522    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   94.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.394028 XMAX =  -43.394028 XAVE =  -43.394028
    YMIN =   33.919184 YMAX =   33.919184 YAVE =   33.919184
    ZMIN =   26.854514 ZMAX =   26.854514 ZAVE =   26.854514
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.3940283"
Evaluating: -43.3940283+3.5
 Parameter: XMAX <- "-39.8940283"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.9191838"
Evaluating: 33.9191838+3.5
 Parameter: YMAX <- "37.4191838"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.8545144"
Evaluating: 26.8545144+3.5
 Parameter: ZMAX <- "30.3545144"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.3940283"
Evaluating: -43.3940283-3.5
 Parameter: XMIN <- "-46.8940283"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.9191838"
Evaluating: 33.9191838-3.5
 Parameter: YMIN <- "30.4191838"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.8545144"
Evaluating: 26.8545144-3.5
 Parameter: ZMIN <- "23.3545144"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.8940283"
 Parameter: XMIN -> "-46.8940283"
 Parameter: YMAX -> "37.4191838"
 Parameter: YMIN -> "30.4191838"
 Parameter: ZMAX -> "30.3545144"
 Parameter: ZMIN -> "23.3545144"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "29" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "29" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.204085048"
Evaluating: 112.065471*(0.204085048-0.5)
 Parameter: XPOS <- "-33.1618485"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.201003722E-02"
Evaluating: 112.065471*(7.201003722E-02-0.5)
 Parameter: YPOS <- "-47.9628968"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.86437621"
Evaluating: 142.885239*(0.86437621-0.5)+2.93414115
 Parameter: ZPOS <- "54.998123"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.998123" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.998123" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.1618485"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.1618485-0
 Parameter: XTRAN <- "-33.1618485"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.9628968"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.9628968-0
 Parameter: YTRAN <- "-47.9628968"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.998123"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 54.998123-0
 Parameter: ZTRAN <- "54.998123"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.1618485"
 Parameter: YTRAN -> "-47.9628968"
 Parameter: ZTRAN -> "54.998123"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -33.161848  -47.962897   54.998123
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.290421153"
Evaluating: 0.290421153*360.0
 Parameter: XPHI <- "104.551615"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.706301879E-02"
Evaluating: 4.706301879E-02*360.0
 Parameter: YPHI <- "16.9426868"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.333804159"
Evaluating: 0.333804159*360.0
 Parameter: ZPHI <- "120.169497"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.1618485"
 Parameter: YPOS -> "-47.9628968"
 Parameter: ZPOS -> "54.998123"
 Parameter: XPHI -> "104.551615"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.251252    0.967922
    0.000000   -0.967922   -0.251252

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  104.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.1618485"
 Parameter: YPOS -> "-47.9628968"
 Parameter: ZPOS -> "54.998123"
 Parameter: YPHI -> "16.9426868"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.956597    0.000000   -0.291415
    0.000000    1.000000    0.000000
    0.291415    0.000000    0.956597

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   16.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.1618485"
 Parameter: YPOS -> "-47.9628968"
 Parameter: ZPOS -> "54.998123"
 Parameter: ZPHI -> "120.169497"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.502560    0.864542    0.000000
   -0.864542   -0.502560    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.161848 XMAX =  -33.161848 XAVE =  -33.161848
    YMIN =  -47.962897 YMAX =  -47.962897 YAVE =  -47.962897
    ZMIN =   54.998123 ZMAX =   54.998123 ZAVE =   54.998123
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.1618485"
Evaluating: -33.1618485+3.5
 Parameter: XMAX <- "-29.6618485"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.9628968"
Evaluating: -47.9628968+3.5
 Parameter: YMAX <- "-44.4628968"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.998123"
Evaluating: 54.998123+3.5
 Parameter: ZMAX <- "58.498123"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.1618485"
Evaluating: -33.1618485-3.5
 Parameter: XMIN <- "-36.6618485"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.9628968"
Evaluating: -47.9628968-3.5
 Parameter: YMIN <- "-51.4628968"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.998123"
Evaluating: 54.998123-3.5
 Parameter: ZMIN <- "51.498123"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.6618485"
 Parameter: XMIN -> "-36.6618485"
 Parameter: YMAX -> "-44.4628968"
 Parameter: YMIN -> "-51.4628968"
 Parameter: ZMAX -> "58.498123"
 Parameter: ZMIN -> "51.498123"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "30" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "30" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.89130483"
Evaluating: 112.065471*(0.89130483-0.5)
 Parameter: XPOS <- "43.8517601"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.388596973"
Evaluating: 112.065471*(0.388596973-0.5)
 Parameter: YPOS <- "-12.4844327"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.4068054"
Evaluating: 142.885239*(0.4068054-0.5)+2.93414115
 Parameter: ZPOS <- "-10.3819915"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.3819915" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.3819915" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "30" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.34921164"
Evaluating: 112.065471*(0.34921164-0.5)
 Parameter: XPOS <- "-16.8981686"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.17730453"
Evaluating: 112.065471*(0.17730453-0.5)
 Parameter: YPOS <- "-36.1630198"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.676030218"
Evaluating: 142.885239*(0.676030218-0.5)+2.93414115
 Parameter: ZPOS <- "28.0862609"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.0862609" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.0862609" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.8981686"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.8981686-0
 Parameter: XTRAN <- "-16.8981686"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.1630198"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -36.1630198-0
 Parameter: YTRAN <- "-36.1630198"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.0862609"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.0862609-0
 Parameter: ZTRAN <- "28.0862609"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.8981686"
 Parameter: YTRAN -> "-36.1630198"
 Parameter: ZTRAN -> "28.0862609"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -16.898169  -36.163020   28.086261
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.669610632"
Evaluating: 0.669610632*360.0
 Parameter: XPHI <- "241.059828"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420700947"
Evaluating: 0.420700947*360.0
 Parameter: YPHI <- "151.452341"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.617080867"
Evaluating: 0.617080867*360.0
 Parameter: ZPHI <- "222.149112"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.8981686"
 Parameter: YPOS -> "-36.1630198"
 Parameter: ZPOS -> "28.0862609"
 Parameter: XPHI -> "241.059828"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.483896   -0.875125
    0.000000    0.875125   -0.483896

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.8981686"
 Parameter: YPOS -> "-36.1630198"
 Parameter: ZPOS -> "28.0862609"
 Parameter: YPHI -> "151.452341"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.878420    0.000000   -0.477890
    0.000000    1.000000    0.000000
    0.477890    0.000000   -0.878420

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  151.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.8981686"
 Parameter: YPOS -> "-36.1630198"
 Parameter: ZPOS -> "28.0862609"
 Parameter: ZPHI -> "222.149112"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.741401   -0.671062    0.000000
    0.671062   -0.741401    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  137.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.898169 XMAX =  -16.898169 XAVE =  -16.898169
    YMIN =  -36.163020 YMAX =  -36.163020 YAVE =  -36.163020
    ZMIN =   28.086261 ZMAX =   28.086261 ZAVE =   28.086261
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.8981686"
Evaluating: -16.8981686+3.5
 Parameter: XMAX <- "-13.3981686"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.1630198"
Evaluating: -36.1630198+3.5
 Parameter: YMAX <- "-32.6630198"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.0862609"
Evaluating: 28.0862609+3.5
 Parameter: ZMAX <- "31.5862609"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.8981686"
Evaluating: -16.8981686-3.5
 Parameter: XMIN <- "-20.3981686"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.1630198"
Evaluating: -36.1630198-3.5
 Parameter: YMIN <- "-39.6630198"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.0862609"
Evaluating: 28.0862609-3.5
 Parameter: ZMIN <- "24.5862609"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.3981686"
 Parameter: XMIN -> "-20.3981686"
 Parameter: YMAX -> "-32.6630198"
 Parameter: YMIN -> "-39.6630198"
 Parameter: ZMAX -> "31.5862609"
 Parameter: ZMIN -> "24.5862609"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "31" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "31" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.77146009"
Evaluating: 112.065471*(0.77146009-0.5)
 Parameter: XPOS <- "30.4213028"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.873668156"
Evaluating: 112.065471*(0.873668156-0.5)
 Parameter: YPOS <- "41.8752979"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.177071475"
Evaluating: 142.885239*(0.177071475-0.5)+2.93414115
 Parameter: ZPOS <- "-43.2075783"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.2075783" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.4213028"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.4213028-0
 Parameter: XTRAN <- "30.4213028"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.8752979"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.8752979-0
 Parameter: YTRAN <- "41.8752979"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.2075783"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.2075783-0
 Parameter: ZTRAN <- "-43.2075783"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.4213028"
 Parameter: YTRAN -> "41.8752979"
 Parameter: ZTRAN -> "-43.2075783"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    30.421303   41.875298  -43.207578
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.289821433"
Evaluating: 0.289821433*360.0
 Parameter: XPHI <- "104.335716"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.30453689"
Evaluating: 0.30453689*360.0
 Parameter: YPHI <- "109.63328"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.132673586"
Evaluating: 0.132673586*360.0
 Parameter: ZPHI <- "47.762491"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.4213028"
 Parameter: YPOS -> "41.8752979"
 Parameter: ZPOS -> "-43.2075783"
 Parameter: XPHI -> "104.335716"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.247603    0.968862
    0.000000   -0.968862   -0.247603

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  104.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.4213028"
 Parameter: YPOS -> "41.8752979"
 Parameter: ZPOS -> "-43.2075783"
 Parameter: YPHI -> "109.63328"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.335999    0.000000   -0.941862
    0.000000    1.000000    0.000000
    0.941862    0.000000   -0.335999

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.4213028"
 Parameter: YPOS -> "41.8752979"
 Parameter: ZPOS -> "-43.2075783"
 Parameter: ZPHI -> "47.762491"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.672205    0.740365    0.000000
   -0.740365    0.672205    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   47.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.421303 XMAX =   30.421303 XAVE =   30.421303
    YMIN =   41.875298 YMAX =   41.875298 YAVE =   41.875298
    ZMIN =  -43.207578 ZMAX =  -43.207578 ZAVE =  -43.207578
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.4213028"
Evaluating: 30.4213028+3.5
 Parameter: XMAX <- "33.9213028"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.8752979"
Evaluating: 41.8752979+3.5
 Parameter: YMAX <- "45.3752979"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.2075783"
Evaluating: -43.2075783+3.5
 Parameter: ZMAX <- "-39.7075783"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.4213028"
Evaluating: 30.4213028-3.5
 Parameter: XMIN <- "26.9213028"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.8752979"
Evaluating: 41.8752979-3.5
 Parameter: YMIN <- "38.3752979"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.2075783"
Evaluating: -43.2075783-3.5
 Parameter: ZMIN <- "-46.7075783"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.9213028"
 Parameter: XMIN -> "26.9213028"
 Parameter: YMAX -> "45.3752979"
 Parameter: YMIN -> "38.3752979"
 Parameter: ZMAX -> "-39.7075783"
 Parameter: ZMIN -> "-46.7075783"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "32" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "32" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.935195866"
Evaluating: 112.065471*(0.935195866-0.5)
 Parameter: XPOS <- "48.7704297"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.324072443"
Evaluating: 112.065471*(0.324072443-0.5)
 Parameter: YPOS <- "-19.7154045"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.469481134"
Evaluating: 142.885239*(0.469481134-0.5)+2.93414115
 Parameter: ZPOS <- "-1.42655431"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.42655431" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.42655431" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "32" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.612750792"
Evaluating: 112.065471*(0.612750792-0.5)
 Parameter: XPOS <- "12.6354706"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.817111768"
Evaluating: 112.065471*(0.817111768-0.5)
 Parameter: YPOS <- "35.5372796"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.251820734"
Evaluating: 142.885239*(0.251820734-0.5)+2.93414115
 Parameter: ZPOS <- "-32.5270126"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.5270126" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.6354706"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.6354706-0
 Parameter: XTRAN <- "12.6354706"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.5372796"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.5372796-0
 Parameter: YTRAN <- "35.5372796"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.5270126"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.5270126-0
 Parameter: ZTRAN <- "-32.5270126"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.6354706"
 Parameter: YTRAN -> "35.5372796"
 Parameter: ZTRAN -> "-32.5270126"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    12.635471   35.537280  -32.527013
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.668062245"
Evaluating: 0.668062245*360.0
 Parameter: XPHI <- "240.502408"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.766683121"
Evaluating: 0.766683121*360.0
 Parameter: YPHI <- "276.005924"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.853141378"
Evaluating: 0.853141378*360.0
 Parameter: ZPHI <- "307.130896"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.6354706"
 Parameter: YPOS -> "35.5372796"
 Parameter: ZPOS -> "-32.5270126"
 Parameter: XPHI -> "240.502408"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.492387   -0.870376
    0.000000    0.870376   -0.492387

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  119.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.6354706"
 Parameter: YPOS -> "35.5372796"
 Parameter: ZPOS -> "-32.5270126"
 Parameter: YPHI -> "276.005924"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.104631    0.000000    0.994511
    0.000000    1.000000    0.000000
   -0.994511    0.000000    0.104631

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   83.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.6354706"
 Parameter: YPOS -> "35.5372796"
 Parameter: ZPOS -> "-32.5270126"
 Parameter: ZPHI -> "307.130896"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.603638   -0.797259    0.000000
    0.797259    0.603638    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   52.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.635471 XMAX =   12.635471 XAVE =   12.635471
    YMIN =   35.537280 YMAX =   35.537280 YAVE =   35.537280
    ZMIN =  -32.527013 ZMAX =  -32.527013 ZAVE =  -32.527013
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.6354706"
Evaluating: 12.6354706+3.5
 Parameter: XMAX <- "16.1354706"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.5372796"
Evaluating: 35.5372796+3.5
 Parameter: YMAX <- "39.0372796"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.5270126"
Evaluating: -32.5270126+3.5
 Parameter: ZMAX <- "-29.0270126"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.6354706"
Evaluating: 12.6354706-3.5
 Parameter: XMIN <- "9.1354706"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.5372796"
Evaluating: 35.5372796-3.5
 Parameter: YMIN <- "32.0372796"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.5270126"
Evaluating: -32.5270126-3.5
 Parameter: ZMIN <- "-36.0270126"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.1354706"
 Parameter: XMIN -> "9.1354706"
 Parameter: YMAX -> "39.0372796"
 Parameter: YMIN -> "32.0372796"
 Parameter: ZMAX -> "-29.0270126"
 Parameter: ZMIN -> "-36.0270126"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "33" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "33" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.132333218"
Evaluating: 112.065471*(0.132333218-0.5)
 Parameter: XPOS <- "-41.2027511"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "3.465471514E-02"
Evaluating: 112.065471*(3.465471514E-02-0.5)
 Parameter: YPOS <- "-52.1491385"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.173773865"
Evaluating: 142.885239*(0.173773865-0.5)+2.93414115
 Parameter: ZPOS <- "-43.6787581"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.6787581" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.2027511"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.2027511-0
 Parameter: XTRAN <- "-41.2027511"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-52.1491385"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -52.1491385-0
 Parameter: YTRAN <- "-52.1491385"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.6787581"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.6787581-0
 Parameter: ZTRAN <- "-43.6787581"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.2027511"
 Parameter: YTRAN -> "-52.1491385"
 Parameter: ZTRAN -> "-43.6787581"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -41.202751  -52.149138  -43.678758
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.760457113"
Evaluating: 0.760457113*360.0
 Parameter: XPHI <- "273.764561"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.43232853"
Evaluating: 0.43232853*360.0
 Parameter: YPHI <- "155.638271"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.988552954"
Evaluating: 0.988552954*360.0
 Parameter: ZPHI <- "355.879063"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.2027511"
 Parameter: YPOS -> "-52.1491385"
 Parameter: ZPOS -> "-43.6787581"
 Parameter: XPHI -> "273.764561"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.065657   -0.997842
    0.000000    0.997842    0.065657

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   86.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.2027511"
 Parameter: YPOS -> "-52.1491385"
 Parameter: ZPOS -> "-43.6787581"
 Parameter: YPHI -> "155.638271"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.910959    0.000000   -0.412496
    0.000000    1.000000    0.000000
    0.412496    0.000000   -0.910959

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  155.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.2027511"
 Parameter: YPOS -> "-52.1491385"
 Parameter: ZPOS -> "-43.6787581"
 Parameter: ZPHI -> "355.879063"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.997415   -0.071862    0.000000
    0.071862    0.997415    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    4.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.202751 XMAX =  -41.202751 XAVE =  -41.202751
    YMIN =  -52.149138 YMAX =  -52.149138 YAVE =  -52.149138
    ZMIN =  -43.678758 ZMAX =  -43.678758 ZAVE =  -43.678758
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.2027511"
Evaluating: -41.2027511+3.5
 Parameter: XMAX <- "-37.7027511"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-52.1491385"
Evaluating: -52.1491385+3.5
 Parameter: YMAX <- "-48.6491385"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.6787581"
Evaluating: -43.6787581+3.5
 Parameter: ZMAX <- "-40.1787581"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.2027511"
Evaluating: -41.2027511-3.5
 Parameter: XMIN <- "-44.7027511"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-52.1491385"
Evaluating: -52.1491385-3.5
 Parameter: YMIN <- "-55.6491385"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.6787581"
Evaluating: -43.6787581-3.5
 Parameter: ZMIN <- "-47.1787581"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.7027511"
 Parameter: XMIN -> "-44.7027511"
 Parameter: YMAX -> "-48.6491385"
 Parameter: YMIN -> "-55.6491385"
 Parameter: ZMAX -> "-40.1787581"
 Parameter: ZMIN -> "-47.1787581"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "34" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "34" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.686458363"
Evaluating: 112.065471*(0.686458363-0.5)
 Parameter: XPOS <- "20.8955443"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.525058038"
Evaluating: 112.065471*(0.525058038-0.5)
 Parameter: YPOS <- "2.80814083"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "4.482636352E-02"
Evaluating: 142.885239*(4.482636352E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-62.1034527"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-62.1034527" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.8955443"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.8955443-0
 Parameter: XTRAN <- "20.8955443"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.80814083"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.80814083-0
 Parameter: YTRAN <- "2.80814083"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-62.1034527"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -62.1034527-0
 Parameter: ZTRAN <- "-62.1034527"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.8955443"
 Parameter: YTRAN -> "2.80814083"
 Parameter: ZTRAN -> "-62.1034527"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    20.895544    2.808141  -62.103453
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.749951632"
Evaluating: 0.749951632*360.0
 Parameter: XPHI <- "269.982588"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.556930025"
Evaluating: 0.556930025*360.0
 Parameter: YPHI <- "200.494809"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396051027"
Evaluating: 0.396051027*360.0
 Parameter: ZPHI <- "142.57837"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.8955443"
 Parameter: YPOS -> "2.80814083"
 Parameter: ZPOS -> "-62.1034527"
 Parameter: XPHI -> "269.982588"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.000304   -1.000000
    0.000000    1.000000   -0.000304

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   90.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.8955443"
 Parameter: YPOS -> "2.80814083"
 Parameter: ZPOS -> "-62.1034527"
 Parameter: YPHI -> "200.494809"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.936704    0.000000    0.350123
    0.000000    1.000000    0.000000
   -0.350123    0.000000   -0.936704

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  159.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.8955443"
 Parameter: YPOS -> "2.80814083"
 Parameter: ZPOS -> "-62.1034527"
 Parameter: ZPHI -> "142.57837"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.794185    0.607676    0.000000
   -0.607676   -0.794185    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.895544 XMAX =   20.895544 XAVE =   20.895544
    YMIN =    2.808141 YMAX =    2.808141 YAVE =    2.808141
    ZMIN =  -62.103453 ZMAX =  -62.103453 ZAVE =  -62.103453
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.8955443"
Evaluating: 20.8955443+3.5
 Parameter: XMAX <- "24.3955443"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.80814083"
Evaluating: 2.80814083+3.5
 Parameter: YMAX <- "6.30814083"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-62.1034527"
Evaluating: -62.1034527+3.5
 Parameter: ZMAX <- "-58.6034527"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.8955443"
Evaluating: 20.8955443-3.5
 Parameter: XMIN <- "17.3955443"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.80814083"
Evaluating: 2.80814083-3.5
 Parameter: YMIN <- "-0.69185917"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-62.1034527"
Evaluating: -62.1034527-3.5
 Parameter: ZMIN <- "-65.6034527"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.3955443"
 Parameter: XMIN -> "17.3955443"
 Parameter: YMAX -> "6.30814083"
 Parameter: YMIN -> "-0.69185917"
 Parameter: ZMAX -> "-58.6034527"
 Parameter: ZMIN -> "-65.6034527"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "35" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "35" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.941991939"
Evaluating: 112.065471*(0.941991939-0.5)
 Parameter: XPOS <- "49.5320348"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.953831612"
Evaluating: 112.065471*(0.953831612-0.5)
 Parameter: YPOS <- "50.8588534"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.892942901"
Evaluating: 142.885239*(0.892942901-0.5)+2.93414115
 Parameter: ZPOS <- "59.0798815"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "59.0798815" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "59.0798815" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.5320348"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.5320348-0
 Parameter: XTRAN <- "49.5320348"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.8588534"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 50.8588534-0
 Parameter: YTRAN <- "50.8588534"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "59.0798815"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 59.0798815-0
 Parameter: ZTRAN <- "59.0798815"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.5320348"
 Parameter: YTRAN -> "50.8588534"
 Parameter: ZTRAN -> "59.0798815"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    49.532035   50.858853   59.079881
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.955007387"
Evaluating: 0.955007387*360.0
 Parameter: XPHI <- "343.802659"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.138495336"
Evaluating: 0.138495336*360.0
 Parameter: YPHI <- "49.858321"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.367784708"
Evaluating: 0.367784708*360.0
 Parameter: ZPHI <- "132.402495"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.5320348"
 Parameter: YPOS -> "50.8588534"
 Parameter: ZPOS -> "59.0798815"
 Parameter: XPHI -> "343.802659"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.960307   -0.278947
    0.000000    0.278947    0.960307

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   16.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.5320348"
 Parameter: YPOS -> "50.8588534"
 Parameter: ZPOS -> "59.0798815"
 Parameter: YPHI -> "49.858321"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.644680    0.000000   -0.764453
    0.000000    1.000000    0.000000
    0.764453    0.000000    0.644680

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   49.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.5320348"
 Parameter: YPOS -> "50.8588534"
 Parameter: ZPOS -> "59.0798815"
 Parameter: ZPHI -> "132.402495"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.674335    0.738426    0.000000
   -0.738426   -0.674335    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  132.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.532035 XMAX =   49.532035 XAVE =   49.532035
    YMIN =   50.858853 YMAX =   50.858853 YAVE =   50.858853
    ZMIN =   59.079881 ZMAX =   59.079881 ZAVE =   59.079881
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.5320348"
Evaluating: 49.5320348+3.5
 Parameter: XMAX <- "53.0320348"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.8588534"
Evaluating: 50.8588534+3.5
 Parameter: YMAX <- "54.3588534"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "59.0798815"
Evaluating: 59.0798815+3.5
 Parameter: ZMAX <- "62.5798815"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.5320348"
Evaluating: 49.5320348-3.5
 Parameter: XMIN <- "46.0320348"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.8588534"
Evaluating: 50.8588534-3.5
 Parameter: YMIN <- "47.3588534"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "59.0798815"
Evaluating: 59.0798815-3.5
 Parameter: ZMIN <- "55.5798815"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.0320348"
 Parameter: XMIN -> "46.0320348"
 Parameter: YMAX -> "54.3588534"
 Parameter: YMIN -> "47.3588534"
 Parameter: ZMAX -> "62.5798815"
 Parameter: ZMIN -> "55.5798815"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "36" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "36" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.796566767"
Evaluating: 112.065471*(0.796566767-0.5)
 Parameter: XPOS <- "33.2348944"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.83350197"
Evaluating: 112.065471*(0.83350197-0.5)
 Parameter: YPOS <- "37.3740553"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "3.177157011E-03"
Evaluating: 142.885239*(3.177157011E-03-0.5)+2.93414115
 Parameter: ZPOS <- "-68.0545095"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-68.0545095" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.2348944"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.2348944-0
 Parameter: XTRAN <- "33.2348944"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.3740553"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.3740553-0
 Parameter: YTRAN <- "37.3740553"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-68.0545095"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -68.0545095-0
 Parameter: ZTRAN <- "-68.0545095"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.2348944"
 Parameter: YTRAN -> "37.3740553"
 Parameter: ZTRAN -> "-68.0545095"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    33.234894   37.374055  -68.054509
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.296162668E-03"
Evaluating: 9.296162668E-03*360.0
 Parameter: XPHI <- "3.34661856"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.13278668"
Evaluating: 0.13278668*360.0
 Parameter: YPHI <- "47.8032048"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.218098122"
Evaluating: 0.218098122*360.0
 Parameter: ZPHI <- "78.5153239"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.2348944"
 Parameter: YPOS -> "37.3740553"
 Parameter: ZPOS -> "-68.0545095"
 Parameter: XPHI -> "3.34661856"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998295    0.058376
    0.000000   -0.058376    0.998295

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.2348944"
 Parameter: YPOS -> "37.3740553"
 Parameter: ZPOS -> "-68.0545095"
 Parameter: YPHI -> "47.8032048"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.671679    0.000000   -0.740842
    0.000000    1.000000    0.000000
    0.740842    0.000000    0.671679

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   47.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.2348944"
 Parameter: YPOS -> "37.3740553"
 Parameter: ZPOS -> "-68.0545095"
 Parameter: ZPHI -> "78.5153239"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.199106    0.979978    0.000000
   -0.979978    0.199106    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   78.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.234894 XMAX =   33.234894 XAVE =   33.234894
    YMIN =   37.374055 YMAX =   37.374055 YAVE =   37.374055
    ZMIN =  -68.054509 ZMAX =  -68.054509 ZAVE =  -68.054509
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.2348944"
Evaluating: 33.2348944+3.5
 Parameter: XMAX <- "36.7348944"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.3740553"
Evaluating: 37.3740553+3.5
 Parameter: YMAX <- "40.8740553"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-68.0545095"
Evaluating: -68.0545095+3.5
 Parameter: ZMAX <- "-64.5545095"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.2348944"
Evaluating: 33.2348944-3.5
 Parameter: XMIN <- "29.7348944"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.3740553"
Evaluating: 37.3740553-3.5
 Parameter: YMIN <- "33.8740553"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-68.0545095"
Evaluating: -68.0545095-3.5
 Parameter: ZMIN <- "-71.5545095"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.7348944"
 Parameter: XMIN -> "29.7348944"
 Parameter: YMAX -> "40.8740553"
 Parameter: YMIN -> "33.8740553"
 Parameter: ZMAX -> "-64.5545095"
 Parameter: ZMIN -> "-71.5545095"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "37" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "37" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.238444302"
Evaluating: 112.065471*(0.238444302-0.5)
 Parameter: XPOS <- "-29.3113625"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.876009126"
Evaluating: 112.065471*(0.876009126-0.5)
 Parameter: YPOS <- "42.1376398"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.766981179"
Evaluating: 142.885239*(0.766981179-0.5)+2.93414115
 Parameter: ZPOS <- "41.0818107"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.0818107" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.0818107" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.3113625"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.3113625-0
 Parameter: XTRAN <- "-29.3113625"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.1376398"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.1376398-0
 Parameter: YTRAN <- "42.1376398"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.0818107"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.0818107-0
 Parameter: ZTRAN <- "41.0818107"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.3113625"
 Parameter: YTRAN -> "42.1376398"
 Parameter: ZTRAN -> "41.0818107"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -29.311363   42.137640   41.081811
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.443597318"
Evaluating: 0.443597318*360.0
 Parameter: XPHI <- "159.695034"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.512995947"
Evaluating: 0.512995947*360.0
 Parameter: YPHI <- "184.678541"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.271646717E-02"
Evaluating: 3.271646717E-02*360.0
 Parameter: ZPHI <- "11.7779282"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.3113625"
 Parameter: YPOS -> "42.1376398"
 Parameter: ZPOS -> "41.0818107"
 Parameter: XPHI -> "159.695034"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.937859    0.347017
    0.000000   -0.347017   -0.937859

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  159.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.3113625"
 Parameter: YPOS -> "42.1376398"
 Parameter: ZPOS -> "41.0818107"
 Parameter: YPHI -> "184.678541"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.996668    0.000000    0.081565
    0.000000    1.000000    0.000000
   -0.081565    0.000000   -0.996668

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  175.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.3113625"
 Parameter: YPOS -> "42.1376398"
 Parameter: ZPOS -> "41.0818107"
 Parameter: ZPHI -> "11.7779282"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.978946    0.204119    0.000000
   -0.204119    0.978946    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   11.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.311363 XMAX =  -29.311363 XAVE =  -29.311363
    YMIN =   42.137640 YMAX =   42.137640 YAVE =   42.137640
    ZMIN =   41.081811 ZMAX =   41.081811 ZAVE =   41.081811
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.3113625"
Evaluating: -29.3113625+3.5
 Parameter: XMAX <- "-25.8113625"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.1376398"
Evaluating: 42.1376398+3.5
 Parameter: YMAX <- "45.6376398"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.0818107"
Evaluating: 41.0818107+3.5
 Parameter: ZMAX <- "44.5818107"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.3113625"
Evaluating: -29.3113625-3.5
 Parameter: XMIN <- "-32.8113625"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.1376398"
Evaluating: 42.1376398-3.5
 Parameter: YMIN <- "38.6376398"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.0818107"
Evaluating: 41.0818107-3.5
 Parameter: ZMIN <- "37.5818107"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.8113625"
 Parameter: XMIN -> "-32.8113625"
 Parameter: YMAX -> "45.6376398"
 Parameter: YMIN -> "38.6376398"
 Parameter: ZMAX -> "44.5818107"
 Parameter: ZMIN -> "37.5818107"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "38" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "38" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.1742135"
Evaluating: 112.065471*(0.1742135-0.5)
 Parameter: XPOS <- "-36.5094176"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.593114135"
Evaluating: 112.065471*(0.593114135-0.5)
 Parameter: YPOS <- "10.4348794"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.311113907"
Evaluating: 142.885239*(0.311113907-0.5)+2.93414115
 Parameter: ZPOS <- "-24.0548934"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.0548934" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.5094176"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.5094176-0
 Parameter: XTRAN <- "-36.5094176"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.4348794"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.4348794-0
 Parameter: YTRAN <- "10.4348794"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.0548934"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.0548934-0
 Parameter: ZTRAN <- "-24.0548934"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.5094176"
 Parameter: YTRAN -> "10.4348794"
 Parameter: ZTRAN -> "-24.0548934"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -36.509418   10.434879  -24.054893
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.910272865"
Evaluating: 0.910272865*360.0
 Parameter: XPHI <- "327.698231"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762840881"
Evaluating: 0.762840881*360.0
 Parameter: YPHI <- "274.622717"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.417326411"
Evaluating: 0.417326411*360.0
 Parameter: ZPHI <- "150.237508"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.5094176"
 Parameter: YPOS -> "10.4348794"
 Parameter: ZPOS -> "-24.0548934"
 Parameter: XPHI -> "327.698231"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.845245   -0.534378
    0.000000    0.534378    0.845245

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   32.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.5094176"
 Parameter: YPOS -> "10.4348794"
 Parameter: ZPOS -> "-24.0548934"
 Parameter: YPHI -> "274.622717"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.080594    0.000000    0.996747
    0.000000    1.000000    0.000000
   -0.996747    0.000000    0.080594

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   85.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.5094176"
 Parameter: YPOS -> "10.4348794"
 Parameter: ZPOS -> "-24.0548934"
 Parameter: ZPHI -> "150.237508"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.868091    0.496406    0.000000
   -0.496406   -0.868091    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  150.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.509418 XMAX =  -36.509418 XAVE =  -36.509418
    YMIN =   10.434879 YMAX =   10.434879 YAVE =   10.434879
    ZMIN =  -24.054893 ZMAX =  -24.054893 ZAVE =  -24.054893
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.5094176"
Evaluating: -36.5094176+3.5
 Parameter: XMAX <- "-33.0094176"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.4348794"
Evaluating: 10.4348794+3.5
 Parameter: YMAX <- "13.9348794"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.0548934"
Evaluating: -24.0548934+3.5
 Parameter: ZMAX <- "-20.5548934"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.5094176"
Evaluating: -36.5094176-3.5
 Parameter: XMIN <- "-40.0094176"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.4348794"
Evaluating: 10.4348794-3.5
 Parameter: YMIN <- "6.9348794"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.0548934"
Evaluating: -24.0548934-3.5
 Parameter: ZMIN <- "-27.5548934"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.0094176"
 Parameter: XMIN -> "-40.0094176"
 Parameter: YMAX -> "13.9348794"
 Parameter: YMIN -> "6.9348794"
 Parameter: ZMAX -> "-20.5548934"
 Parameter: ZMIN -> "-27.5548934"
 SELRPN>      9 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      3 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53095 POS      POT      38       POT     -**** MEMB     POPC     192      C13           3.5333
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "38" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.422613333"
Evaluating: 112.065471*(0.422613333-0.5)
 Parameter: XPOS <- "-8.67237329"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.904931866"
Evaluating: 112.065471*(0.904931866-0.5)
 Parameter: YPOS <- "45.3788803"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.741997221"
Evaluating: 142.885239*(0.741997221-0.5)+2.93414115
 Parameter: ZPOS <- "37.5119719"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.5119719" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.5119719" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.509418 XMAX =  -36.509418 XAVE =  -36.509418
    YMIN =   10.434879 YMAX =   10.434879 YAVE =   10.434879
    ZMIN =  -24.054893 ZMAX =  -24.054893 ZAVE =  -24.054893
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.67237329"
 RDCMND substituted energy or value "?XAVE" to "-36.5094176"
Evaluating: -8.67237329--36.5094176
 Parameter: XTRAN <- "27.8370443"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.3788803"
 RDCMND substituted energy or value "?YAVE" to "10.4348794"
Evaluating: 45.3788803-10.4348794
 Parameter: YTRAN <- "34.9440009"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.5119719"
 RDCMND substituted energy or value "?ZAVE" to "-24.0548934"
Evaluating: 37.5119719--24.0548934
 Parameter: ZTRAN <- "61.5668653"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.8370443"
 Parameter: YTRAN -> "34.9440009"
 Parameter: ZTRAN -> "61.5668653"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    27.837044   34.944001   61.566865
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.398751454"
Evaluating: 0.398751454*360.0
 Parameter: XPHI <- "143.550523"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.528342118"
Evaluating: 0.528342118*360.0
 Parameter: YPHI <- "190.203162"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.548753273"
Evaluating: 0.548753273*360.0
 Parameter: ZPHI <- "197.551178"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.67237329"
 Parameter: YPOS -> "45.3788803"
 Parameter: ZPOS -> "37.5119719"
 Parameter: XPHI -> "143.550523"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.804381    0.594114
    0.000000   -0.594114   -0.804381

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  143.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.67237329"
 Parameter: YPOS -> "45.3788803"
 Parameter: ZPOS -> "37.5119719"
 Parameter: YPHI -> "190.203162"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.984186    0.000000    0.177139
    0.000000    1.000000    0.000000
   -0.177139    0.000000   -0.984186

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  169.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.67237329"
 Parameter: YPOS -> "45.3788803"
 Parameter: ZPOS -> "37.5119719"
 Parameter: ZPHI -> "197.551178"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.953448   -0.301558    0.000000
    0.301558   -0.953448    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  162.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.672373 XMAX =   -8.672373 XAVE =   -8.672373
    YMIN =   45.378880 YMAX =   45.378880 YAVE =   45.378880
    ZMIN =   37.511972 ZMAX =   37.511972 ZAVE =   37.511972
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.6723733"
Evaluating: -8.6723733+3.5
 Parameter: XMAX <- "-5.1723733"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.3788803"
Evaluating: 45.3788803+3.5
 Parameter: YMAX <- "48.8788803"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.5119719"
Evaluating: 37.5119719+3.5
 Parameter: ZMAX <- "41.0119719"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.6723733"
Evaluating: -8.6723733-3.5
 Parameter: XMIN <- "-12.1723733"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.3788803"
Evaluating: 45.3788803-3.5
 Parameter: YMIN <- "41.8788803"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.5119719"
Evaluating: 37.5119719-3.5
 Parameter: ZMIN <- "34.0119719"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.1723733"
 Parameter: XMIN -> "-12.1723733"
 Parameter: YMAX -> "48.8788803"
 Parameter: YMIN -> "41.8788803"
 Parameter: ZMAX -> "41.0119719"
 Parameter: ZMIN -> "34.0119719"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "39" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "39" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.144501213"
Evaluating: 112.065471*(0.144501213-0.5)
 Parameter: XPOS <- "-39.839139"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.764066015"
Evaluating: 112.065471*(0.764066015-0.5)
 Parameter: YPOS <- "29.5926823"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.879910584"
Evaluating: 142.885239*(0.879910584-0.5)+2.93414115
 Parameter: ZPOS <- "57.2177557"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.2177557" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.2177557" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.839139"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.839139-0
 Parameter: XTRAN <- "-39.839139"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.5926823"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.5926823-0
 Parameter: YTRAN <- "29.5926823"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.2177557"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.2177557-0
 Parameter: ZTRAN <- "57.2177557"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.839139"
 Parameter: YTRAN -> "29.5926823"
 Parameter: ZTRAN -> "57.2177557"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -39.839139   29.592682   57.217756
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.955740246"
Evaluating: 0.955740246*360.0
 Parameter: XPHI <- "344.066489"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.984039797E-02"
Evaluating: 1.984039797E-02*360.0
 Parameter: YPHI <- "7.14254327"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.885809308"
Evaluating: 0.885809308*360.0
 Parameter: ZPHI <- "318.891351"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.839139"
 Parameter: YPOS -> "29.5926823"
 Parameter: ZPOS -> "57.2177557"
 Parameter: XPHI -> "344.066489"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.961581   -0.274522
    0.000000    0.274522    0.961581

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   15.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.839139"
 Parameter: YPOS -> "29.5926823"
 Parameter: ZPOS -> "57.2177557"
 Parameter: YPHI -> "7.14254327"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.992240    0.000000   -0.124338
    0.000000    1.000000    0.000000
    0.124338    0.000000    0.992240

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    7.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.839139"
 Parameter: YPOS -> "29.5926823"
 Parameter: ZPOS -> "57.2177557"
 Parameter: ZPHI -> "318.891351"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.753464   -0.657489    0.000000
    0.657489    0.753464    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   41.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.839139 XMAX =  -39.839139 XAVE =  -39.839139
    YMIN =   29.592682 YMAX =   29.592682 YAVE =   29.592682
    ZMIN =   57.217756 ZMAX =   57.217756 ZAVE =   57.217756
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.839139"
Evaluating: -39.839139+3.5
 Parameter: XMAX <- "-36.339139"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.5926823"
Evaluating: 29.5926823+3.5
 Parameter: YMAX <- "33.0926823"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.2177557"
Evaluating: 57.2177557+3.5
 Parameter: ZMAX <- "60.7177557"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.839139"
Evaluating: -39.839139-3.5
 Parameter: XMIN <- "-43.339139"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.5926823"
Evaluating: 29.5926823-3.5
 Parameter: YMIN <- "26.0926823"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.2177557"
Evaluating: 57.2177557-3.5
 Parameter: ZMIN <- "53.7177557"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.339139"
 Parameter: XMIN -> "-43.339139"
 Parameter: YMAX -> "33.0926823"
 Parameter: YMIN -> "26.0926823"
 Parameter: ZMAX -> "60.7177557"
 Parameter: ZMIN -> "53.7177557"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "40" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "40" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.907042421"
Evaluating: 112.065471*(0.907042421-0.5)
 Parameter: XPOS <- "45.6154006"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.377719883"
Evaluating: 112.065471*(0.377719883-0.5)
 Parameter: YPOS <- "-13.7033789"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.331059381"
Evaluating: 142.885239*(0.331059381-0.5)+2.93414115
 Parameter: ZPOS <- "-21.2049796"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.2049796" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.6154006"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.6154006-0
 Parameter: XTRAN <- "45.6154006"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.7033789"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.7033789-0
 Parameter: YTRAN <- "-13.7033789"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.2049796"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.2049796-0
 Parameter: ZTRAN <- "-21.2049796"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.6154006"
 Parameter: YTRAN -> "-13.7033789"
 Parameter: ZTRAN -> "-21.2049796"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    45.615401  -13.703379  -21.204980
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.380133144E-05"
Evaluating: 1.380133144E-05*360.0
 Parameter: XPHI <- "4.968479318E-03"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.360351042"
Evaluating: 0.360351042*360.0
 Parameter: YPHI <- "129.726375"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67134049"
Evaluating: 0.67134049*360.0
 Parameter: ZPHI <- "241.682576"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.6154006"
 Parameter: YPOS -> "-13.7033789"
 Parameter: ZPOS -> "-21.2049796"
 Parameter: XPHI -> "4.968479318E-03"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    1.000000    0.000087
    0.000000   -0.000087    1.000000

 VERY LITTLE ROTATION: NO AXIS FOUND
 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.6154006"
 Parameter: YPOS -> "-13.7033789"
 Parameter: ZPOS -> "-21.2049796"
 Parameter: YPHI -> "129.726375"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.639122    0.000000   -0.769105
    0.000000    1.000000    0.000000
    0.769105    0.000000   -0.639122

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  129.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.6154006"
 Parameter: YPOS -> "-13.7033789"
 Parameter: ZPOS -> "-21.2049796"
 Parameter: ZPHI -> "241.682576"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.474356   -0.880333    0.000000
    0.880333   -0.474356    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  118.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.615401 XMAX =   45.615401 XAVE =   45.615401
    YMIN =  -13.703379 YMAX =  -13.703379 YAVE =  -13.703379
    ZMIN =  -21.204980 ZMAX =  -21.204980 ZAVE =  -21.204980
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.6154006"
Evaluating: 45.6154006+3.5
 Parameter: XMAX <- "49.1154006"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.7033789"
Evaluating: -13.7033789+3.5
 Parameter: YMAX <- "-10.2033789"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.2049796"
Evaluating: -21.2049796+3.5
 Parameter: ZMAX <- "-17.7049796"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.6154006"
Evaluating: 45.6154006-3.5
 Parameter: XMIN <- "42.1154006"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.7033789"
Evaluating: -13.7033789-3.5
 Parameter: YMIN <- "-17.2033789"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.2049796"
Evaluating: -21.2049796-3.5
 Parameter: ZMIN <- "-24.7049796"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.1154006"
 Parameter: XMIN -> "42.1154006"
 Parameter: YMAX -> "-10.2033789"
 Parameter: YMIN -> "-17.2033789"
 Parameter: ZMAX -> "-17.7049796"
 Parameter: ZMIN -> "-24.7049796"
 SELRPN>     10 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      5 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53097 POS      POT      40       POT     -**** MEMB     POPC     240      C15           2.4168
53097 POS      POT      40       POT     -**** MEMB     POPC     240      O14           2.9263
53097 POS      POT      40       POT     -**** MEMB     POPC     240      O12           3.9139
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "40" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.712161326"
Evaluating: 112.065471*(0.712161326-0.5)
 Parameter: XPOS <- "23.7759589"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.903638679"
Evaluating: 112.065471*(0.903638679-0.5)
 Parameter: YPOS <- "45.2339587"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.513307522"
Evaluating: 142.885239*(0.513307522-0.5)+2.93414115
 Parameter: ZPOS <- "4.83558961"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.83558961" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.83558961" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "40" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.122431601"
Evaluating: 112.065471*(0.122431601-0.5)
 Parameter: XPOS <- "-42.3123805"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.348850507"
Evaluating: 112.065471*(0.348850507-0.5)
 Parameter: YPOS <- "-16.9386391"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.216891183"
Evaluating: 142.885239*(0.216891183-0.5)+2.93414115
 Parameter: ZPOS <- "-37.5179298"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.5179298" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.615401 XMAX =   45.615401 XAVE =   45.615401
    YMIN =  -13.703379 YMAX =  -13.703379 YAVE =  -13.703379
    ZMIN =  -21.204980 ZMAX =  -21.204980 ZAVE =  -21.204980
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.3123805"
 RDCMND substituted energy or value "?XAVE" to "45.6154006"
Evaluating: -42.3123805-45.6154006
 Parameter: XTRAN <- "-87.9277811"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.9386391"
 RDCMND substituted energy or value "?YAVE" to "-13.7033789"
Evaluating: -16.9386391--13.7033789
 Parameter: YTRAN <- "-3.2352602"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.5179298"
 RDCMND substituted energy or value "?ZAVE" to "-21.2049796"
Evaluating: -37.5179298--21.2049796
 Parameter: ZTRAN <- "-16.3129502"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-87.9277811"
 Parameter: YTRAN -> "-3.2352602"
 Parameter: ZTRAN -> "-16.3129502"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -87.927781   -3.235260  -16.312950
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.711167618"
Evaluating: 0.711167618*360.0
 Parameter: XPHI <- "256.020342"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.577347352"
Evaluating: 0.577347352*360.0
 Parameter: YPHI <- "207.845047"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.379815639"
Evaluating: 0.379815639*360.0
 Parameter: ZPHI <- "136.73363"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.3123805"
 Parameter: YPOS -> "-16.9386391"
 Parameter: ZPOS -> "-37.5179298"
 Parameter: XPHI -> "256.020342"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.241577   -0.970382
    0.000000    0.970382   -0.241577

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  103.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.3123805"
 Parameter: YPOS -> "-16.9386391"
 Parameter: ZPOS -> "-37.5179298"
 Parameter: YPHI -> "207.845047"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.884214    0.000000    0.467082
    0.000000    1.000000    0.000000
   -0.467082    0.000000   -0.884214

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  152.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.3123805"
 Parameter: YPOS -> "-16.9386391"
 Parameter: ZPOS -> "-37.5179298"
 Parameter: ZPHI -> "136.73363"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.728175    0.685391    0.000000
   -0.685391   -0.728175    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  136.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.312380 XMAX =  -42.312380 XAVE =  -42.312380
    YMIN =  -16.938639 YMAX =  -16.938639 YAVE =  -16.938639
    ZMIN =  -37.517930 ZMAX =  -37.517930 ZAVE =  -37.517930
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.3123805"
Evaluating: -42.3123805+3.5
 Parameter: XMAX <- "-38.8123805"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.9386391"
Evaluating: -16.9386391+3.5
 Parameter: YMAX <- "-13.4386391"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.5179298"
Evaluating: -37.5179298+3.5
 Parameter: ZMAX <- "-34.0179298"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.3123805"
Evaluating: -42.3123805-3.5
 Parameter: XMIN <- "-45.8123805"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.9386391"
Evaluating: -16.9386391-3.5
 Parameter: YMIN <- "-20.4386391"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.5179298"
Evaluating: -37.5179298-3.5
 Parameter: ZMIN <- "-41.0179298"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.8123805"
 Parameter: XMIN -> "-45.8123805"
 Parameter: YMAX -> "-13.4386391"
 Parameter: YMIN -> "-20.4386391"
 Parameter: ZMAX -> "-34.0179298"
 Parameter: ZMIN -> "-41.0179298"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "41" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "41" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.926446396"
Evaluating: 112.065471*(0.926446396-0.5)
 Parameter: XPOS <- "47.7899162"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.345792413"
Evaluating: 112.065471*(0.345792413-0.5)
 Parameter: YPOS <- "-17.2813459"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.988469432"
Evaluating: 142.885239*(0.988469432-0.5)+2.93414115
 Parameter: ZPOS <- "72.7292127"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "72.7292127" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "72.7292127" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.7899162"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 47.7899162-0
 Parameter: XTRAN <- "47.7899162"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.2813459"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -17.2813459-0
 Parameter: YTRAN <- "-17.2813459"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "72.7292127"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 72.7292127-0
 Parameter: ZTRAN <- "72.7292127"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.7899162"
 Parameter: YTRAN -> "-17.2813459"
 Parameter: ZTRAN -> "72.7292127"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    47.789916  -17.281346   72.729213
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.773714177"
Evaluating: 0.773714177*360.0
 Parameter: XPHI <- "278.537104"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.244685682"
Evaluating: 0.244685682*360.0
 Parameter: YPHI <- "88.0868455"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.700494878"
Evaluating: 0.700494878*360.0
 Parameter: ZPHI <- "252.178156"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.7899162"
 Parameter: YPOS -> "-17.2813459"
 Parameter: ZPOS -> "72.7292127"
 Parameter: XPHI -> "278.537104"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.148450   -0.988920
    0.000000    0.988920    0.148450

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   81.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.7899162"
 Parameter: YPOS -> "-17.2813459"
 Parameter: ZPOS -> "72.7292127"
 Parameter: YPHI -> "88.0868455"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.033385    0.000000   -0.999443
    0.000000    1.000000    0.000000
    0.999443    0.000000    0.033385

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   88.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.7899162"
 Parameter: YPOS -> "-17.2813459"
 Parameter: ZPOS -> "72.7292127"
 Parameter: ZPHI -> "252.178156"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.306058   -0.952013    0.000000
    0.952013   -0.306058    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  107.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.789916 XMAX =   47.789916 XAVE =   47.789916
    YMIN =  -17.281346 YMAX =  -17.281346 YAVE =  -17.281346
    ZMIN =   72.729213 ZMAX =   72.729213 ZAVE =   72.729213
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.7899162"
Evaluating: 47.7899162+3.5
 Parameter: XMAX <- "51.2899162"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.2813459"
Evaluating: -17.2813459+3.5
 Parameter: YMAX <- "-13.7813459"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "72.7292127"
Evaluating: 72.7292127+3.5
 Parameter: ZMAX <- "76.2292127"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.7899162"
Evaluating: 47.7899162-3.5
 Parameter: XMIN <- "44.2899162"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.2813459"
Evaluating: -17.2813459-3.5
 Parameter: YMIN <- "-20.7813459"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "72.7292127"
Evaluating: 72.7292127-3.5
 Parameter: ZMIN <- "69.2292127"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.2899162"
 Parameter: XMIN -> "44.2899162"
 Parameter: YMAX -> "-13.7813459"
 Parameter: YMIN -> "-20.7813459"
 Parameter: ZMAX -> "76.2292127"
 Parameter: ZMIN -> "69.2292127"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "42" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "42" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.61455494"
Evaluating: 112.065471*(0.61455494-0.5)
 Parameter: XPOS <- "12.8376533"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.660741255"
Evaluating: 112.065471*(0.660741255-0.5)
 Parameter: YPOS <- "18.0135445"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.82796686"
Evaluating: 142.885239*(0.82796686-0.5)+2.93414115
 Parameter: ZPOS <- "49.7957643"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.7957643" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.7957643" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.8376533"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.8376533-0
 Parameter: XTRAN <- "12.8376533"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.0135445"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 18.0135445-0
 Parameter: YTRAN <- "18.0135445"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.7957643"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.7957643-0
 Parameter: ZTRAN <- "49.7957643"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.8376533"
 Parameter: YTRAN -> "18.0135445"
 Parameter: ZTRAN -> "49.7957643"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    12.837653   18.013544   49.795764
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.757766878"
Evaluating: 0.757766878*360.0
 Parameter: XPHI <- "272.796076"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.834411133"
Evaluating: 0.834411133*360.0
 Parameter: YPHI <- "300.388008"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.17815203"
Evaluating: 0.17815203*360.0
 Parameter: ZPHI <- "64.1347308"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.8376533"
 Parameter: YPOS -> "18.0135445"
 Parameter: ZPOS -> "49.7957643"
 Parameter: XPHI -> "272.796076"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.048781   -0.998809
    0.000000    0.998809    0.048781

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   87.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.8376533"
 Parameter: YPOS -> "18.0135445"
 Parameter: ZPOS -> "49.7957643"
 Parameter: YPHI -> "300.388008"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.505853    0.000000    0.862620
    0.000000    1.000000    0.000000
   -0.862620    0.000000    0.505853

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   59.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.8376533"
 Parameter: YPOS -> "18.0135445"
 Parameter: ZPOS -> "49.7957643"
 Parameter: ZPHI -> "64.1347308"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.436256    0.899822    0.000000
   -0.899822    0.436256    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   64.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.837653 XMAX =   12.837653 XAVE =   12.837653
    YMIN =   18.013544 YMAX =   18.013544 YAVE =   18.013544
    ZMIN =   49.795764 ZMAX =   49.795764 ZAVE =   49.795764
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.8376533"
Evaluating: 12.8376533+3.5
 Parameter: XMAX <- "16.3376533"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.0135445"
Evaluating: 18.0135445+3.5
 Parameter: YMAX <- "21.5135445"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.7957643"
Evaluating: 49.7957643+3.5
 Parameter: ZMAX <- "53.2957643"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.8376533"
Evaluating: 12.8376533-3.5
 Parameter: XMIN <- "9.3376533"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.0135445"
Evaluating: 18.0135445-3.5
 Parameter: YMIN <- "14.5135445"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.7957643"
Evaluating: 49.7957643-3.5
 Parameter: ZMIN <- "46.2957643"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.3376533"
 Parameter: XMIN -> "9.3376533"
 Parameter: YMAX -> "21.5135445"
 Parameter: YMIN -> "14.5135445"
 Parameter: ZMAX -> "53.2957643"
 Parameter: ZMIN -> "46.2957643"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "43" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "43" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.259803727"
Evaluating: 112.065471*(0.259803727-0.5)
 Parameter: XPOS <- "-26.9177085"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.544391369"
Evaluating: 112.065471*(0.544391369-0.5)
 Parameter: YPOS <- "4.97473968"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.411505605"
Evaluating: 142.885239*(0.411505605-0.5)+2.93414115
 Parameter: ZPOS <- "-9.71040163"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.71040163" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.71040163" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "43" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.952365352"
Evaluating: 112.065471*(0.952365352-0.5)
 Parameter: XPOS <- "50.6945362"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.755741795"
Evaluating: 112.065471*(0.755741795-0.5)
 Parameter: YPOS <- "28.6598247"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.749105336"
Evaluating: 142.885239*(0.749105336-0.5)+2.93414115
 Parameter: ZPOS <- "38.5276166"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.5276166" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.5276166" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.6945362"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 50.6945362-0
 Parameter: XTRAN <- "50.6945362"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.6598247"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.6598247-0
 Parameter: YTRAN <- "28.6598247"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.5276166"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.5276166-0
 Parameter: ZTRAN <- "38.5276166"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.6945362"
 Parameter: YTRAN -> "28.6598247"
 Parameter: ZTRAN -> "38.5276166"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    50.694536   28.659825   38.527617
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.353465825"
Evaluating: 0.353465825*360.0
 Parameter: XPHI <- "127.247697"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.354935615E-02"
Evaluating: 6.354935615E-02*360.0
 Parameter: YPHI <- "22.8777682"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.267569254"
Evaluating: 0.267569254*360.0
 Parameter: ZPHI <- "96.3249314"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.6945362"
 Parameter: YPOS -> "28.6598247"
 Parameter: ZPOS -> "38.5276166"
 Parameter: XPHI -> "127.247697"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.605262    0.796026
    0.000000   -0.796026   -0.605262

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  127.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.6945362"
 Parameter: YPOS -> "28.6598247"
 Parameter: ZPOS -> "38.5276166"
 Parameter: YPHI -> "22.8777682"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.921336    0.000000   -0.388766
    0.000000    1.000000    0.000000
    0.388766    0.000000    0.921336

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   22.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.6945362"
 Parameter: YPOS -> "28.6598247"
 Parameter: ZPOS -> "38.5276166"
 Parameter: ZPHI -> "96.3249314"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.110167    0.993913    0.000000
   -0.993913   -0.110167    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   96.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.694536 XMAX =   50.694536 XAVE =   50.694536
    YMIN =   28.659825 YMAX =   28.659825 YAVE =   28.659825
    ZMIN =   38.527617 ZMAX =   38.527617 ZAVE =   38.527617
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.6945362"
Evaluating: 50.6945362+3.5
 Parameter: XMAX <- "54.1945362"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.6598247"
Evaluating: 28.6598247+3.5
 Parameter: YMAX <- "32.1598247"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.5276166"
Evaluating: 38.5276166+3.5
 Parameter: ZMAX <- "42.0276166"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.6945362"
Evaluating: 50.6945362-3.5
 Parameter: XMIN <- "47.1945362"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.6598247"
Evaluating: 28.6598247-3.5
 Parameter: YMIN <- "25.1598247"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.5276166"
Evaluating: 38.5276166-3.5
 Parameter: ZMIN <- "35.0276166"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.1945362"
 Parameter: XMIN -> "47.1945362"
 Parameter: YMAX -> "32.1598247"
 Parameter: YMIN -> "25.1598247"
 Parameter: ZMAX -> "42.0276166"
 Parameter: ZMIN -> "35.0276166"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "44" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "44" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.384131052"
Evaluating: 112.065471*(0.384131052-0.5)
 Parameter: XPOS <- "-12.9849082"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.502087864"
Evaluating: 112.065471*(0.502087864-0.5)
 Parameter: YPOS <- "0.233977463"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.140228049"
Evaluating: 142.885239*(0.140228049-0.5)+2.93414115
 Parameter: ZPOS <- "-48.4719601"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.4719601" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.9849082"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.9849082-0
 Parameter: XTRAN <- "-12.9849082"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.233977463"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.233977463-0
 Parameter: YTRAN <- "0.233977463"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.4719601"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.4719601-0
 Parameter: ZTRAN <- "-48.4719601"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.9849082"
 Parameter: YTRAN -> "0.233977463"
 Parameter: ZTRAN -> "-48.4719601"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -12.984908    0.233977  -48.471960
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.793427127"
Evaluating: 0.793427127*360.0
 Parameter: XPHI <- "285.633766"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.514616128"
Evaluating: 0.514616128*360.0
 Parameter: YPHI <- "185.261806"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.195767874"
Evaluating: 0.195767874*360.0
 Parameter: ZPHI <- "70.4764346"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.9849082"
 Parameter: YPOS -> "0.233977463"
 Parameter: ZPOS -> "-48.4719601"
 Parameter: XPHI -> "285.633766"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.269487   -0.963004
    0.000000    0.963004    0.269487

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   74.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.9849082"
 Parameter: YPOS -> "0.233977463"
 Parameter: ZPOS -> "-48.4719601"
 Parameter: YPHI -> "185.261806"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.995786    0.000000    0.091707
    0.000000    1.000000    0.000000
   -0.091707    0.000000   -0.995786

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  174.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.9849082"
 Parameter: YPOS -> "0.233977463"
 Parameter: ZPOS -> "-48.4719601"
 Parameter: ZPHI -> "70.4764346"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.334195    0.942504    0.000000
   -0.942504    0.334195    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   70.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.984908 XMAX =  -12.984908 XAVE =  -12.984908
    YMIN =    0.233977 YMAX =    0.233977 YAVE =    0.233977
    ZMIN =  -48.471960 ZMAX =  -48.471960 ZAVE =  -48.471960
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.9849082"
Evaluating: -12.9849082+3.5
 Parameter: XMAX <- "-9.4849082"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.233977463"
Evaluating: 0.233977463+3.5
 Parameter: YMAX <- "3.73397746"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.4719601"
Evaluating: -48.4719601+3.5
 Parameter: ZMAX <- "-44.9719601"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.9849082"
Evaluating: -12.9849082-3.5
 Parameter: XMIN <- "-16.4849082"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.233977463"
Evaluating: 0.233977463-3.5
 Parameter: YMIN <- "-3.26602254"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.4719601"
Evaluating: -48.4719601-3.5
 Parameter: ZMIN <- "-51.9719601"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.4849082"
 Parameter: XMIN -> "-16.4849082"
 Parameter: YMAX -> "3.73397746"
 Parameter: YMIN -> "-3.26602254"
 Parameter: ZMAX -> "-44.9719601"
 Parameter: ZMIN -> "-51.9719601"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "45" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "45" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.754291125"
Evaluating: 112.065471*(0.754291125-0.5)
 Parameter: XPOS <- "28.4972547"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.91214561"
Evaluating: 112.065471*(0.91214561-0.5)
 Parameter: YPOS <- "46.1872919"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.566050072"
Evaluating: 142.885239*(0.566050072-0.5)+2.93414115
 Parameter: ZPOS <- "12.3717215"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.3717215" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.3717215" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "45" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.625145792"
Evaluating: 112.065471*(0.625145792-0.5)
 Parameter: XPOS <- "14.0245221"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.374616094"
Evaluating: 112.065471*(0.374616094-0.5)
 Parameter: YPOS <- "-14.0512065"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.755840472"
Evaluating: 142.885239*(0.755840472-0.5)+2.93414115
 Parameter: ZPOS <- "39.4899681"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.4899681" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.4899681" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.0245221"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.0245221-0
 Parameter: XTRAN <- "14.0245221"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.0512065"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.0512065-0
 Parameter: YTRAN <- "-14.0512065"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.4899681"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.4899681-0
 Parameter: ZTRAN <- "39.4899681"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.0245221"
 Parameter: YTRAN -> "-14.0512065"
 Parameter: ZTRAN -> "39.4899681"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    14.024522  -14.051206   39.489968
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.62972262"
Evaluating: 0.62972262*360.0
 Parameter: XPHI <- "226.700143"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.192539845"
Evaluating: 0.192539845*360.0
 Parameter: YPHI <- "69.3143442"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.661867192"
Evaluating: 0.661867192*360.0
 Parameter: ZPHI <- "238.272189"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.0245221"
 Parameter: YPOS -> "-14.0512065"
 Parameter: ZPOS -> "39.4899681"
 Parameter: XPHI -> "226.700143"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.685817   -0.727774
    0.000000    0.727774   -0.685817

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  133.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.0245221"
 Parameter: YPOS -> "-14.0512065"
 Parameter: ZPOS -> "39.4899681"
 Parameter: YPHI -> "69.3143442"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.353241    0.000000   -0.935532
    0.000000    1.000000    0.000000
    0.935532    0.000000    0.353241

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   69.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.0245221"
 Parameter: YPOS -> "-14.0512065"
 Parameter: ZPOS -> "39.4899681"
 Parameter: ZPHI -> "238.272189"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.525885   -0.850556    0.000000
    0.850556   -0.525885    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  121.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.024522 XMAX =   14.024522 XAVE =   14.024522
    YMIN =  -14.051206 YMAX =  -14.051206 YAVE =  -14.051206
    ZMIN =   39.489968 ZMAX =   39.489968 ZAVE =   39.489968
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.0245221"
Evaluating: 14.0245221+3.5
 Parameter: XMAX <- "17.5245221"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.0512065"
Evaluating: -14.0512065+3.5
 Parameter: YMAX <- "-10.5512065"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.4899681"
Evaluating: 39.4899681+3.5
 Parameter: ZMAX <- "42.9899681"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.0245221"
Evaluating: 14.0245221-3.5
 Parameter: XMIN <- "10.5245221"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.0512065"
Evaluating: -14.0512065-3.5
 Parameter: YMIN <- "-17.5512065"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.4899681"
Evaluating: 39.4899681-3.5
 Parameter: ZMIN <- "35.9899681"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.5245221"
 Parameter: XMIN -> "10.5245221"
 Parameter: YMAX -> "-10.5512065"
 Parameter: YMIN -> "-17.5512065"
 Parameter: ZMAX -> "42.9899681"
 Parameter: ZMIN -> "35.9899681"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "46" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "46" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.398880504"
Evaluating: 112.065471*(0.398880504-0.5)
 Parameter: XPOS <- "-11.3320039"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.568168901"
Evaluating: 112.065471*(0.568168901-0.5)
 Parameter: YPOS <- "7.63938"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.172760421"
Evaluating: 142.885239*(0.172760421-0.5)+2.93414115
 Parameter: ZPOS <- "-43.8235643"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.8235643" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.3320039"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.3320039-0
 Parameter: XTRAN <- "-11.3320039"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.63938"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.63938-0
 Parameter: YTRAN <- "7.63938"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.8235643"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.8235643-0
 Parameter: ZTRAN <- "-43.8235643"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.3320039"
 Parameter: YTRAN -> "7.63938"
 Parameter: ZTRAN -> "-43.8235643"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -11.332004    7.639380  -43.823564
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.42185747"
Evaluating: 0.42185747*360.0
 Parameter: XPHI <- "151.868689"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.429355034"
Evaluating: 0.429355034*360.0
 Parameter: YPHI <- "154.567812"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762833695"
Evaluating: 0.762833695*360.0
 Parameter: ZPHI <- "274.62013"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.3320039"
 Parameter: YPOS -> "7.63938"
 Parameter: ZPOS -> "-43.8235643"
 Parameter: XPHI -> "151.868689"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.881869    0.471494
    0.000000   -0.471494   -0.881869

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  151.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.3320039"
 Parameter: YPOS -> "7.63938"
 Parameter: ZPOS -> "-43.8235643"
 Parameter: YPHI -> "154.567812"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.903094    0.000000   -0.429443
    0.000000    1.000000    0.000000
    0.429443    0.000000   -0.903094

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  154.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.3320039"
 Parameter: YPOS -> "7.63938"
 Parameter: ZPOS -> "-43.8235643"
 Parameter: ZPHI -> "274.62013"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.080549   -0.996751    0.000000
    0.996751    0.080549    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   85.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.332004 XMAX =  -11.332004 XAVE =  -11.332004
    YMIN =    7.639380 YMAX =    7.639380 YAVE =    7.639380
    ZMIN =  -43.823564 ZMAX =  -43.823564 ZAVE =  -43.823564
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.3320039"
Evaluating: -11.3320039+3.5
 Parameter: XMAX <- "-7.8320039"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.63938"
Evaluating: 7.63938+3.5
 Parameter: YMAX <- "11.13938"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.8235643"
Evaluating: -43.8235643+3.5
 Parameter: ZMAX <- "-40.3235643"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.3320039"
Evaluating: -11.3320039-3.5
 Parameter: XMIN <- "-14.8320039"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.63938"
Evaluating: 7.63938-3.5
 Parameter: YMIN <- "4.13938"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.8235643"
Evaluating: -43.8235643-3.5
 Parameter: ZMIN <- "-47.3235643"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.8320039"
 Parameter: XMIN -> "-14.8320039"
 Parameter: YMAX -> "11.13938"
 Parameter: YMIN -> "4.13938"
 Parameter: ZMAX -> "-40.3235643"
 Parameter: ZMIN -> "-47.3235643"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "47" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "47" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.102596329"
Evaluating: 112.065471*(0.102596329-0.5)
 Parameter: XPOS <- "-44.5352296"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.299206043"
Evaluating: 112.065471*(0.299206043-0.5)
 Parameter: YPOS <- "-22.5020694"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.466522055"
Evaluating: 142.885239*(0.466522055-0.5)+2.93414115
 Parameter: ZPOS <- "-1.84936302"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.84936302" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.84936302" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "47" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.120148054"
Evaluating: 112.065471*(0.120148054-0.5)
 Parameter: XPOS <- "-42.5682872"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.720119645"
Evaluating: 112.065471*(0.720119645-0.5)
 Parameter: YPOS <- "24.6678117"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.509542812"
Evaluating: 142.885239*(0.509542812-0.5)+2.93414115
 Parameter: ZPOS <- "4.29766812"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.29766812" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.29766812" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "47" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "6.955823891E-02"
Evaluating: 112.065471*(6.955823891E-02-0.5)
 Parameter: XPOS <- "-48.2376587"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.762238037"
Evaluating: 112.065471*(0.762238037-0.5)
 Parameter: YPOS <- "29.3878291"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.705171157"
Evaluating: 142.885239*(0.705171157-0.5)+2.93414115
 Parameter: ZPOS <- "32.250071"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.250071" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.250071" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-48.2376587"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -48.2376587-0
 Parameter: XTRAN <- "-48.2376587"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.3878291"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.3878291-0
 Parameter: YTRAN <- "29.3878291"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.250071"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.250071-0
 Parameter: ZTRAN <- "32.250071"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-48.2376587"
 Parameter: YTRAN -> "29.3878291"
 Parameter: ZTRAN -> "32.250071"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -48.237659   29.387829   32.250071
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.644992352"
Evaluating: 0.644992352*360.0
 Parameter: XPHI <- "232.197247"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.783207144"
Evaluating: 0.783207144*360.0
 Parameter: YPHI <- "281.954572"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.736808062"
Evaluating: 0.736808062*360.0
 Parameter: ZPHI <- "265.250902"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-48.2376587"
 Parameter: YPOS -> "29.3878291"
 Parameter: ZPOS -> "32.250071"
 Parameter: XPHI -> "232.197247"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.612945   -0.790126
    0.000000    0.790126   -0.612945

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  127.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-48.2376587"
 Parameter: YPOS -> "29.3878291"
 Parameter: ZPOS -> "32.250071"
 Parameter: YPHI -> "281.954572"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.207136    0.000000    0.978312
    0.000000    1.000000    0.000000
   -0.978312    0.000000    0.207136

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   78.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-48.2376587"
 Parameter: YPOS -> "29.3878291"
 Parameter: ZPOS -> "32.250071"
 Parameter: ZPHI -> "265.250902"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.082793   -0.996567    0.000000
    0.996567   -0.082793    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   94.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -48.237659 XMAX =  -48.237659 XAVE =  -48.237659
    YMIN =   29.387829 YMAX =   29.387829 YAVE =   29.387829
    ZMIN =   32.250071 ZMAX =   32.250071 ZAVE =   32.250071
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-48.2376587"
Evaluating: -48.2376587+3.5
 Parameter: XMAX <- "-44.7376587"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.3878291"
Evaluating: 29.3878291+3.5
 Parameter: YMAX <- "32.8878291"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.250071"
Evaluating: 32.250071+3.5
 Parameter: ZMAX <- "35.750071"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-48.2376587"
Evaluating: -48.2376587-3.5
 Parameter: XMIN <- "-51.7376587"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.3878291"
Evaluating: 29.3878291-3.5
 Parameter: YMIN <- "25.8878291"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.250071"
Evaluating: 32.250071-3.5
 Parameter: ZMIN <- "28.750071"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.7376587"
 Parameter: XMIN -> "-51.7376587"
 Parameter: YMAX -> "32.8878291"
 Parameter: YMIN -> "25.8878291"
 Parameter: ZMAX -> "35.750071"
 Parameter: ZMIN -> "28.750071"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "48" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "48" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "6.564688623E-02"
Evaluating: 112.065471*(6.564688623E-02-0.5)
 Parameter: XPOS <- "-48.6759863"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.485510585"
Evaluating: 112.065471*(0.485510585-0.5)
 Parameter: YPOS <- "-1.62376312"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.156449984"
Evaluating: 142.885239*(0.156449984-0.5)+2.93414115
 Parameter: ZPOS <- "-46.154085"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.154085" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-48.6759863"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -48.6759863-0
 Parameter: XTRAN <- "-48.6759863"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.62376312"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.62376312-0
 Parameter: YTRAN <- "-1.62376312"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.154085"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -46.154085-0
 Parameter: ZTRAN <- "-46.154085"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-48.6759863"
 Parameter: YTRAN -> "-1.62376312"
 Parameter: ZTRAN -> "-46.154085"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -48.675986   -1.623763  -46.154085
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.362284043"
Evaluating: 0.362284043*360.0
 Parameter: XPHI <- "130.422255"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.966470617E-02"
Evaluating: 4.966470617E-02*360.0
 Parameter: YPHI <- "17.8792942"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.426990195"
Evaluating: 0.426990195*360.0
 Parameter: ZPHI <- "153.71647"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-48.6759863"
 Parameter: YPOS -> "-1.62376312"
 Parameter: ZPOS -> "-46.154085"
 Parameter: XPHI -> "130.422255"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.648416    0.761287
    0.000000   -0.761287   -0.648416

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  130.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-48.6759863"
 Parameter: YPOS -> "-1.62376312"
 Parameter: ZPOS -> "-46.154085"
 Parameter: YPHI -> "17.8792942"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.951705    0.000000   -0.307013
    0.000000    1.000000    0.000000
    0.307013    0.000000    0.951705

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   17.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-48.6759863"
 Parameter: YPOS -> "-1.62376312"
 Parameter: ZPOS -> "-46.154085"
 Parameter: ZPHI -> "153.71647"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.896614    0.442813    0.000000
   -0.442813   -0.896614    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  153.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -48.675986 XMAX =  -48.675986 XAVE =  -48.675986
    YMIN =   -1.623763 YMAX =   -1.623763 YAVE =   -1.623763
    ZMIN =  -46.154085 ZMAX =  -46.154085 ZAVE =  -46.154085
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-48.6759863"
Evaluating: -48.6759863+3.5
 Parameter: XMAX <- "-45.1759863"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.62376312"
Evaluating: -1.62376312+3.5
 Parameter: YMAX <- "1.87623688"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.154085"
Evaluating: -46.154085+3.5
 Parameter: ZMAX <- "-42.654085"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-48.6759863"
Evaluating: -48.6759863-3.5
 Parameter: XMIN <- "-52.1759863"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.62376312"
Evaluating: -1.62376312-3.5
 Parameter: YMIN <- "-5.12376312"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.154085"
Evaluating: -46.154085-3.5
 Parameter: ZMIN <- "-49.654085"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-45.1759863"
 Parameter: XMIN -> "-52.1759863"
 Parameter: YMAX -> "1.87623688"
 Parameter: YMIN -> "-5.12376312"
 Parameter: ZMAX -> "-42.654085"
 Parameter: ZMIN -> "-49.654085"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "49" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "49" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.664866817"
Evaluating: 112.065471*(0.664866817-0.5)
 Parameter: XPOS <- "18.4758775"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.640140609"
Evaluating: 112.065471*(0.640140609-0.5)
 Parameter: YPOS <- "15.7049234"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.963583103"
Evaluating: 142.885239*(0.963583103-0.5)+2.93414115
 Parameter: ZPOS <- "69.1733236"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.1733236" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.1733236" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.4758775"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.4758775-0
 Parameter: XTRAN <- "18.4758775"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.7049234"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.7049234-0
 Parameter: YTRAN <- "15.7049234"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.1733236"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 69.1733236-0
 Parameter: ZTRAN <- "69.1733236"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.4758775"
 Parameter: YTRAN -> "15.7049234"
 Parameter: ZTRAN -> "69.1733236"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    18.475877   15.704923   69.173324
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460348027"
Evaluating: 0.460348027*360.0
 Parameter: XPHI <- "165.72529"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111735591"
Evaluating: 0.111735591*360.0
 Parameter: YPHI <- "40.2248128"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.999725042"
Evaluating: 0.999725042*360.0
 Parameter: ZPHI <- "359.901015"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.4758775"
 Parameter: YPOS -> "15.7049234"
 Parameter: ZPOS -> "69.1733236"
 Parameter: XPHI -> "165.72529"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.969125    0.246571
    0.000000   -0.246571   -0.969125

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  165.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.4758775"
 Parameter: YPOS -> "15.7049234"
 Parameter: ZPOS -> "69.1733236"
 Parameter: YPHI -> "40.2248128"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.763516    0.000000   -0.645788
    0.000000    1.000000    0.000000
    0.645788    0.000000    0.763516

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   40.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.4758775"
 Parameter: YPOS -> "15.7049234"
 Parameter: ZPOS -> "69.1733236"
 Parameter: ZPHI -> "359.901015"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.999999   -0.001728    0.000000
    0.001728    0.999999    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    0.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.475877 XMAX =   18.475877 XAVE =   18.475877
    YMIN =   15.704923 YMAX =   15.704923 YAVE =   15.704923
    ZMIN =   69.173324 ZMAX =   69.173324 ZAVE =   69.173324
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.4758775"
Evaluating: 18.4758775+3.5
 Parameter: XMAX <- "21.9758775"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.7049234"
Evaluating: 15.7049234+3.5
 Parameter: YMAX <- "19.2049234"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.1733236"
Evaluating: 69.1733236+3.5
 Parameter: ZMAX <- "72.6733236"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.4758775"
Evaluating: 18.4758775-3.5
 Parameter: XMIN <- "14.9758775"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.7049234"
Evaluating: 15.7049234-3.5
 Parameter: YMIN <- "12.2049234"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.1733236"
Evaluating: 69.1733236-3.5
 Parameter: ZMIN <- "65.6733236"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.9758775"
 Parameter: XMIN -> "14.9758775"
 Parameter: YMAX -> "19.2049234"
 Parameter: YMIN -> "12.2049234"
 Parameter: ZMAX -> "72.6733236"
 Parameter: ZMIN -> "65.6733236"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "50" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "50" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.47341771"
Evaluating: 112.065471*(0.47341771-0.5)
 Parameter: XPOS <- "-2.97895685"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.552505244"
Evaluating: 112.065471*(0.552505244-0.5)
 Parameter: YPOS <- "5.8840249"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.859779017"
Evaluating: 142.885239*(0.859779017-0.5)+2.93414115
 Parameter: ZPOS <- "54.341252"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.341252" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.341252" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.97895685"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.97895685-0
 Parameter: XTRAN <- "-2.97895685"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.8840249"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.8840249-0
 Parameter: YTRAN <- "5.8840249"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.341252"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 54.341252-0
 Parameter: ZTRAN <- "54.341252"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.97895685"
 Parameter: YTRAN -> "5.8840249"
 Parameter: ZTRAN -> "54.341252"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -2.978957    5.884025   54.341252
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.836132515"
Evaluating: 0.836132515*360.0
 Parameter: XPHI <- "301.007705"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291882251"
Evaluating: 0.291882251*360.0
 Parameter: YPHI <- "105.07761"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.036542227E-02"
Evaluating: 1.036542227E-02*360.0
 Parameter: ZPHI <- "3.73155202"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.97895685"
 Parameter: YPOS -> "5.8840249"
 Parameter: ZPOS -> "54.341252"
 Parameter: XPHI -> "301.007705"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.515153   -0.857098
    0.000000    0.857098    0.515153

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.97895685"
 Parameter: YPOS -> "5.8840249"
 Parameter: ZPOS -> "54.341252"
 Parameter: YPHI -> "105.07761"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.260127    0.000000   -0.965574
    0.000000    1.000000    0.000000
    0.965574    0.000000   -0.260127

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  105.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.97895685"
 Parameter: YPOS -> "5.8840249"
 Parameter: ZPOS -> "54.341252"
 Parameter: ZPHI -> "3.73155202"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.997880    0.065082    0.000000
   -0.065082    0.997880    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    3.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.978957 XMAX =   -2.978957 XAVE =   -2.978957
    YMIN =    5.884025 YMAX =    5.884025 YAVE =    5.884025
    ZMIN =   54.341252 ZMAX =   54.341252 ZAVE =   54.341252
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.97895685"
Evaluating: -2.97895685+3.5
 Parameter: XMAX <- "0.52104315"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.8840249"
Evaluating: 5.8840249+3.5
 Parameter: YMAX <- "9.3840249"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.341252"
Evaluating: 54.341252+3.5
 Parameter: ZMAX <- "57.841252"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.97895685"
Evaluating: -2.97895685-3.5
 Parameter: XMIN <- "-6.47895685"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.8840249"
Evaluating: 5.8840249-3.5
 Parameter: YMIN <- "2.3840249"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.341252"
Evaluating: 54.341252-3.5
 Parameter: ZMIN <- "50.841252"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.52104315"
 Parameter: XMIN -> "-6.47895685"
 Parameter: YMAX -> "9.3840249"
 Parameter: YMIN -> "2.3840249"
 Parameter: ZMAX -> "57.841252"
 Parameter: ZMIN -> "50.841252"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "51" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "51" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.269087846"
Evaluating: 112.065471*(0.269087846-0.5)
 Parameter: XPOS <- "-25.8772793"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.443283171"
Evaluating: 112.065471*(0.443283171-0.5)
 Parameter: YPOS <- "-6.35599816"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.184907744"
Evaluating: 142.885239*(0.184907744-0.5)+2.93414115
 Parameter: ZPOS <- "-42.0878912"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.0878912" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.8772793"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.8772793-0
 Parameter: XTRAN <- "-25.8772793"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.35599816"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.35599816-0
 Parameter: YTRAN <- "-6.35599816"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.0878912"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.0878912-0
 Parameter: ZTRAN <- "-42.0878912"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.8772793"
 Parameter: YTRAN -> "-6.35599816"
 Parameter: ZTRAN -> "-42.0878912"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -25.877279   -6.355998  -42.087891
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.901528844"
Evaluating: 0.901528844*360.0
 Parameter: XPHI <- "324.550384"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.153723651"
Evaluating: 0.153723651*360.0
 Parameter: YPHI <- "55.3405144"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.664249892"
Evaluating: 0.664249892*360.0
 Parameter: ZPHI <- "239.129961"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.8772793"
 Parameter: YPOS -> "-6.35599816"
 Parameter: ZPOS -> "-42.0878912"
 Parameter: XPHI -> "324.550384"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.814626   -0.579987
    0.000000    0.579987    0.814626

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   35.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.8772793"
 Parameter: YPOS -> "-6.35599816"
 Parameter: ZPOS -> "-42.0878912"
 Parameter: YPHI -> "55.3405144"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.568698    0.000000   -0.822546
    0.000000    1.000000    0.000000
    0.822546    0.000000    0.568698

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   55.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.8772793"
 Parameter: YPOS -> "-6.35599816"
 Parameter: ZPOS -> "-42.0878912"
 Parameter: ZPHI -> "239.129961"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.513092   -0.858333    0.000000
    0.858333   -0.513092    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  120.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.877279 XMAX =  -25.877279 XAVE =  -25.877279
    YMIN =   -6.355998 YMAX =   -6.355998 YAVE =   -6.355998
    ZMIN =  -42.087891 ZMAX =  -42.087891 ZAVE =  -42.087891
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.8772793"
Evaluating: -25.8772793+3.5
 Parameter: XMAX <- "-22.3772793"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.35599816"
Evaluating: -6.35599816+3.5
 Parameter: YMAX <- "-2.85599816"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.0878912"
Evaluating: -42.0878912+3.5
 Parameter: ZMAX <- "-38.5878912"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.8772793"
Evaluating: -25.8772793-3.5
 Parameter: XMIN <- "-29.3772793"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.35599816"
Evaluating: -6.35599816-3.5
 Parameter: YMIN <- "-9.85599816"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.0878912"
Evaluating: -42.0878912-3.5
 Parameter: ZMIN <- "-45.5878912"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-22.3772793"
 Parameter: XMIN -> "-29.3772793"
 Parameter: YMAX -> "-2.85599816"
 Parameter: YMIN -> "-9.85599816"
 Parameter: ZMAX -> "-38.5878912"
 Parameter: ZMIN -> "-45.5878912"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "52" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "52" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.298310676"
Evaluating: 112.065471*(0.298310676-0.5)
 Parameter: XPOS <- "-22.6024091"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.607579063E-02"
Evaluating: 112.065471*(4.607579063E-02-0.5)
 Parameter: YPOS <- "-50.8692303"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.418381334"
Evaluating: 142.885239*(0.418381334-0.5)+2.93414115
 Parameter: ZPOS <- "-8.72796145"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.72796145" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.72796145" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "52" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.337876403"
Evaluating: 112.065471*(0.337876403-0.5)
 Parameter: XPOS <- "-18.1684573"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.519804694"
Evaluating: 112.065471*(0.519804694-0.5)
 Parameter: YPOS <- "2.21942236"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.364426735"
Evaluating: 142.885239*(0.364426735-0.5)+2.93414115
 Parameter: ZPOS <- "-16.4372772"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.4372772" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.1684573"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.1684573-0
 Parameter: XTRAN <- "-18.1684573"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.21942236"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.21942236-0
 Parameter: YTRAN <- "2.21942236"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.4372772"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.4372772-0
 Parameter: ZTRAN <- "-16.4372772"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.1684573"
 Parameter: YTRAN -> "2.21942236"
 Parameter: ZTRAN -> "-16.4372772"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -18.168457    2.219422  -16.437277
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.277703878"
Evaluating: 0.277703878*360.0
 Parameter: XPHI <- "99.9733961"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.312113224"
Evaluating: 0.312113224*360.0
 Parameter: YPHI <- "112.360761"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.672087658"
Evaluating: 0.672087658*360.0
 Parameter: ZPHI <- "241.951557"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.1684573"
 Parameter: YPOS -> "2.21942236"
 Parameter: ZPOS -> "-16.4372772"
 Parameter: XPHI -> "99.9733961"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.173191    0.984888
    0.000000   -0.984888   -0.173191

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   99.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.1684573"
 Parameter: YPOS -> "2.21942236"
 Parameter: ZPOS -> "-16.4372772"
 Parameter: YPHI -> "112.360761"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.380437    0.000000   -0.924807
    0.000000    1.000000    0.000000
    0.924807    0.000000   -0.380437

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  112.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.1684573"
 Parameter: YPOS -> "2.21942236"
 Parameter: ZPOS -> "-16.4372772"
 Parameter: ZPHI -> "241.951557"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.470218   -0.882550    0.000000
    0.882550   -0.470218    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  118.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.168457 XMAX =  -18.168457 XAVE =  -18.168457
    YMIN =    2.219422 YMAX =    2.219422 YAVE =    2.219422
    ZMIN =  -16.437277 ZMAX =  -16.437277 ZAVE =  -16.437277
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.1684573"
Evaluating: -18.1684573+3.5
 Parameter: XMAX <- "-14.6684573"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.21942236"
Evaluating: 2.21942236+3.5
 Parameter: YMAX <- "5.71942236"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.4372772"
Evaluating: -16.4372772+3.5
 Parameter: ZMAX <- "-12.9372772"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.1684573"
Evaluating: -18.1684573-3.5
 Parameter: XMIN <- "-21.6684573"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.21942236"
Evaluating: 2.21942236-3.5
 Parameter: YMIN <- "-1.28057764"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.4372772"
Evaluating: -16.4372772-3.5
 Parameter: ZMIN <- "-19.9372772"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.6684573"
 Parameter: XMIN -> "-21.6684573"
 Parameter: YMAX -> "5.71942236"
 Parameter: YMIN -> "-1.28057764"
 Parameter: ZMAX -> "-12.9372772"
 Parameter: ZMIN -> "-19.9372772"
 SELRPN>     41 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     24 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53109 POS      POT      52       POT     -6635 PROB     ALA      444      CA            5.4116
53109 POS      POT      52       POT     -6641 PROB     ALA      444      C             4.1159
53109 POS      POT      52       POT     -6642 PROB     ALA      444      O             3.4502
53109 POS      POT      52       POT     -6643 PROB     GLY      445      N             4.1669
53109 POS      POT      52       POT     -6645 PROB     GLY      445      CA            3.4372
53109 POS      POT      52       POT     -6648 PROB     GLY      445      C             2.0418
53109 POS      POT      52       POT     -6649 PROB     GLY      445      O             1.4032
53109 POS      POT      52       POT     -6650 PROB     GLN      446      N             2.3345
53109 POS      POT      52       POT     -6652 PROB     GLN      446      CA            2.1467
53109 POS      POT      52       POT     -6654 PROB     GLN      446      CB            3.6456
53109 POS      POT      52       POT     -6665 PROB     GLN      446      C             1.7744
53109 POS      POT      52       POT     -6666 PROB     GLN      446      O             2.1353
53109 POS      POT      52       POT     -6667 PROB     LEU      447      N             2.3944
53109 POS      POT      52       POT     -6669 PROB     LEU      447      CA            3.2084
53109 POS      POT      52       POT     -6684 PROB     LEU      447      C             2.9568
53109 POS      POT      52       POT     -6685 PROB     LEU      447      O             3.7851
53109 POS      POT      52       POT     -6686 PROB     HSD      448      N             2.5583
53109 POS      POT      52       POT     -6688 PROB     HSD      448      CA            3.3025
53109 POS      POT      52       POT     -6690 PROB     HSD      448      CB            3.7370
53109 POS      POT      52       POT     -6701 PROB     HSD      448      C             3.2909
53109 POS      POT      52       POT     -6703 PROB     PHE      449      N             2.4539
53109 POS      POT      52       POT     -6705 PROB     PHE      449      CA            3.4305
53109 POS      POT      52       POT     -6707 PROB     PHE      449      CB            3.3998
53109 POS      POT      52       POT     -6710 PROB     PHE      449      CG            4.7864
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        24
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "24"
 Comparing "24" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "52" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.788712487"
Evaluating: 112.065471*(0.788712487-0.5)
 Parameter: XPOS <- "32.3547008"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.162711108"
Evaluating: 112.065471*(0.162711108-0.5)
 Parameter: YPOS <- "-37.7984385"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.786459371"
Evaluating: 142.885239*(0.786459371-0.5)+2.93414115
 Parameter: ZPOS <- "43.8649568"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.8649568" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.8649568" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.168457 XMAX =  -18.168457 XAVE =  -18.168457
    YMIN =    2.219422 YMAX =    2.219422 YAVE =    2.219422
    ZMIN =  -16.437277 ZMAX =  -16.437277 ZAVE =  -16.437277
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.3547008"
 RDCMND substituted energy or value "?XAVE" to "-18.1684573"
Evaluating: 32.3547008--18.1684573
 Parameter: XTRAN <- "50.5231581"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.7984385"
 RDCMND substituted energy or value "?YAVE" to "2.21942236"
Evaluating: -37.7984385-2.21942236
 Parameter: YTRAN <- "-40.0178609"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.8649568"
 RDCMND substituted energy or value "?ZAVE" to "-16.4372772"
Evaluating: 43.8649568--16.4372772
 Parameter: ZTRAN <- "60.302234"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.5231581"
 Parameter: YTRAN -> "-40.0178609"
 Parameter: ZTRAN -> "60.302234"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    50.523158  -40.017861   60.302234
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.278486975"
Evaluating: 0.278486975*360.0
 Parameter: XPHI <- "100.255311"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.547748504"
Evaluating: 0.547748504*360.0
 Parameter: YPHI <- "197.189461"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.802862813"
Evaluating: 0.802862813*360.0
 Parameter: ZPHI <- "289.030613"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.3547008"
 Parameter: YPOS -> "-37.7984385"
 Parameter: ZPOS -> "43.8649568"
 Parameter: XPHI -> "100.255311"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.178035    0.984024
    0.000000   -0.984024   -0.178035

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  100.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.3547008"
 Parameter: YPOS -> "-37.7984385"
 Parameter: ZPOS -> "43.8649568"
 Parameter: YPHI -> "197.189461"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.955333    0.000000    0.295532
    0.000000    1.000000    0.000000
   -0.295532    0.000000   -0.955333

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  162.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.3547008"
 Parameter: YPOS -> "-37.7984385"
 Parameter: ZPOS -> "43.8649568"
 Parameter: ZPHI -> "289.030613"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.326073   -0.945344    0.000000
    0.945344    0.326073    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.354701 XMAX =   32.354701 XAVE =   32.354701
    YMIN =  -37.798438 YMAX =  -37.798438 YAVE =  -37.798438
    ZMIN =   43.864957 ZMAX =   43.864957 ZAVE =   43.864957
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.3547008"
Evaluating: 32.3547008+3.5
 Parameter: XMAX <- "35.8547008"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.7984385"
Evaluating: -37.7984385+3.5
 Parameter: YMAX <- "-34.2984385"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.8649568"
Evaluating: 43.8649568+3.5
 Parameter: ZMAX <- "47.3649568"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.3547008"
Evaluating: 32.3547008-3.5
 Parameter: XMIN <- "28.8547008"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.7984385"
Evaluating: -37.7984385-3.5
 Parameter: YMIN <- "-41.2984385"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.8649568"
Evaluating: 43.8649568-3.5
 Parameter: ZMIN <- "40.3649568"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.8547008"
 Parameter: XMIN -> "28.8547008"
 Parameter: YMAX -> "-34.2984385"
 Parameter: YMIN -> "-41.2984385"
 Parameter: ZMAX -> "47.3649568"
 Parameter: ZMIN -> "40.3649568"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "53" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "53" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.998011263"
Evaluating: 112.065471*(0.998011263-0.5)
 Parameter: XPOS <- "55.8098668"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.500507327"
Evaluating: 112.065471*(0.500507327-0.5)
 Parameter: YPOS <- "5.685383921E-02"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.93725714"
Evaluating: 142.885239*(0.93725714-0.5)+2.93414115
 Parameter: ZPOS <- "65.4117321"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "65.4117321" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "65.4117321" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "55.8098668"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 55.8098668-0
 Parameter: XTRAN <- "55.8098668"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.685383921E-02"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.685383921E-02-0
 Parameter: YTRAN <- "5.685383921E-02"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "65.4117321"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 65.4117321-0
 Parameter: ZTRAN <- "65.4117321"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "55.8098668"
 Parameter: YTRAN -> "5.685383921E-02"
 Parameter: ZTRAN -> "65.4117321"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    55.809867    0.056854   65.411732
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.912357718"
Evaluating: 0.912357718*360.0
 Parameter: XPHI <- "328.448778"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.767830767"
Evaluating: 0.767830767*360.0
 Parameter: YPHI <- "276.419076"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.337129987"
Evaluating: 0.337129987*360.0
 Parameter: ZPHI <- "121.366795"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "55.8098668"
 Parameter: YPOS -> "5.685383921E-02"
 Parameter: ZPOS -> "65.4117321"
 Parameter: XPHI -> "328.448778"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.852173   -0.523261
    0.000000    0.523261    0.852173

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   31.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "55.8098668"
 Parameter: YPOS -> "5.685383921E-02"
 Parameter: ZPOS -> "65.4117321"
 Parameter: YPHI -> "276.419076"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.111800    0.000000    0.993731
    0.000000    1.000000    0.000000
   -0.993731    0.000000    0.111800

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   83.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "55.8098668"
 Parameter: YPOS -> "5.685383921E-02"
 Parameter: ZPOS -> "65.4117321"
 Parameter: ZPHI -> "121.366795"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.520515    0.853853    0.000000
   -0.853853   -0.520515    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  121.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   55.809867 XMAX =   55.809867 XAVE =   55.809867
    YMIN =    0.056854 YMAX =    0.056854 YAVE =    0.056854
    ZMIN =   65.411732 ZMAX =   65.411732 ZAVE =   65.411732
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "55.8098668"
Evaluating: 55.8098668+3.5
 Parameter: XMAX <- "59.3098668"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.685383921E-02"
Evaluating: 5.685383921E-02+3.5
 Parameter: YMAX <- "3.55685384"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "65.4117321"
Evaluating: 65.4117321+3.5
 Parameter: ZMAX <- "68.9117321"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "55.8098668"
Evaluating: 55.8098668-3.5
 Parameter: XMIN <- "52.3098668"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.685383921E-02"
Evaluating: 5.685383921E-02-3.5
 Parameter: YMIN <- "-3.44314616"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "65.4117321"
Evaluating: 65.4117321-3.5
 Parameter: ZMIN <- "61.9117321"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "59.3098668"
 Parameter: XMIN -> "52.3098668"
 Parameter: YMAX -> "3.55685384"
 Parameter: YMIN -> "-3.44314616"
 Parameter: ZMAX -> "68.9117321"
 Parameter: ZMIN -> "61.9117321"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "54" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "54" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.948622645"
Evaluating: 112.065471*(0.948622645-0.5)
 Parameter: XPOS <- "50.275108"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.712776735"
Evaluating: 112.065471*(0.712776735-0.5)
 Parameter: YPOS <- "23.844925"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.344492289"
Evaluating: 142.885239*(0.344492289-0.5)+2.93414115
 Parameter: ZPOS <- "-19.2856153"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.2856153" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.275108"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 50.275108-0
 Parameter: XTRAN <- "50.275108"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.844925"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.844925-0
 Parameter: YTRAN <- "23.844925"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.2856153"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.2856153-0
 Parameter: ZTRAN <- "-19.2856153"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.275108"
 Parameter: YTRAN -> "23.844925"
 Parameter: ZTRAN -> "-19.2856153"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    50.275108   23.844925  -19.285615
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.200849925"
Evaluating: 0.200849925*360.0
 Parameter: XPHI <- "72.305973"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.426960679"
Evaluating: 0.426960679*360.0
 Parameter: YPHI <- "153.705844"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.611004048"
Evaluating: 0.611004048*360.0
 Parameter: ZPHI <- "219.961457"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.275108"
 Parameter: YPOS -> "23.844925"
 Parameter: ZPOS -> "-19.2856153"
 Parameter: XPHI -> "72.305973"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.303934    0.952693
    0.000000   -0.952693    0.303934

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.275108"
 Parameter: YPOS -> "23.844925"
 Parameter: ZPOS -> "-19.2856153"
 Parameter: YPHI -> "153.705844"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.896532    0.000000   -0.442980
    0.000000    1.000000    0.000000
    0.442980    0.000000   -0.896532

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  153.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.275108"
 Parameter: YPOS -> "23.844925"
 Parameter: ZPOS -> "-19.2856153"
 Parameter: ZPHI -> "219.961457"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.766477   -0.642272    0.000000
    0.642272   -0.766477    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  140.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.275108 XMAX =   50.275108 XAVE =   50.275108
    YMIN =   23.844925 YMAX =   23.844925 YAVE =   23.844925
    ZMIN =  -19.285615 ZMAX =  -19.285615 ZAVE =  -19.285615
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.275108"
Evaluating: 50.275108+3.5
 Parameter: XMAX <- "53.775108"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.844925"
Evaluating: 23.844925+3.5
 Parameter: YMAX <- "27.344925"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.2856153"
Evaluating: -19.2856153+3.5
 Parameter: ZMAX <- "-15.7856153"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.275108"
Evaluating: 50.275108-3.5
 Parameter: XMIN <- "46.775108"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.844925"
Evaluating: 23.844925-3.5
 Parameter: YMIN <- "20.344925"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.2856153"
Evaluating: -19.2856153-3.5
 Parameter: ZMIN <- "-22.7856153"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.775108"
 Parameter: XMIN -> "46.775108"
 Parameter: YMAX -> "27.344925"
 Parameter: YMIN -> "20.344925"
 Parameter: ZMAX -> "-15.7856153"
 Parameter: ZMIN -> "-22.7856153"
 SELRPN>     20 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     10 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53111 POS      POT      54       POT     -**** MEMB     POPC     260      O14           3.2901
53111 POS      POT      54       POT     -**** MEMB     POPC     260      C1            3.4289
53111 POS      POT      54       POT     -**** MEMB     POPC     284      O14           3.6104
53111 POS      POT      54       POT     -**** MEMB     POPC     284      O12           3.6288
53111 POS      POT      54       POT     -**** MEMB     POPC     290      C14           3.3035
53111 POS      POT      54       POT     -**** MEMB     POPC     290      O14           3.5565
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "54" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.895368933"
Evaluating: 112.065471*(0.895368933-0.5)
 Parameter: XPOS <- "44.3072057"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.303584036"
Evaluating: 112.065471*(0.303584036-0.5)
 Parameter: YPOS <- "-22.0114475"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.322049858"
Evaluating: 142.885239*(0.322049858-0.5)+2.93414115
 Parameter: ZPOS <- "-22.4923074"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.4923074" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.275108 XMAX =   50.275108 XAVE =   50.275108
    YMIN =   23.844925 YMAX =   23.844925 YAVE =   23.844925
    ZMIN =  -19.285615 ZMAX =  -19.285615 ZAVE =  -19.285615
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.3072057"
 RDCMND substituted energy or value "?XAVE" to "50.275108"
Evaluating: 44.3072057-50.275108
 Parameter: XTRAN <- "-5.9679023"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.0114475"
 RDCMND substituted energy or value "?YAVE" to "23.844925"
Evaluating: -22.0114475-23.844925
 Parameter: YTRAN <- "-45.8563725"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.4923074"
 RDCMND substituted energy or value "?ZAVE" to "-19.2856153"
Evaluating: -22.4923074--19.2856153
 Parameter: ZTRAN <- "-3.2066921"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.9679023"
 Parameter: YTRAN -> "-45.8563725"
 Parameter: ZTRAN -> "-3.2066921"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -5.967902  -45.856372   -3.206692
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.685372393"
Evaluating: 0.685372393*360.0
 Parameter: XPHI <- "246.734061"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.227921175"
Evaluating: 0.227921175*360.0
 Parameter: YPHI <- "82.051623"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.604863758"
Evaluating: 0.604863758*360.0
 Parameter: ZPHI <- "217.750953"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.3072057"
 Parameter: YPOS -> "-22.0114475"
 Parameter: ZPOS -> "-22.4923074"
 Parameter: XPHI -> "246.734061"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.394999   -0.918681
    0.000000    0.918681   -0.394999

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  113.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.3072057"
 Parameter: YPOS -> "-22.0114475"
 Parameter: ZPOS -> "-22.4923074"
 Parameter: YPHI -> "82.051623"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.138281    0.000000   -0.990393
    0.000000    1.000000    0.000000
    0.990393    0.000000    0.138281

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   82.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.3072057"
 Parameter: YPOS -> "-22.0114475"
 Parameter: ZPOS -> "-22.4923074"
 Parameter: ZPHI -> "217.750953"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.790679   -0.612230    0.000000
    0.612230   -0.790679    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  142.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.307206 XMAX =   44.307206 XAVE =   44.307206
    YMIN =  -22.011447 YMAX =  -22.011447 YAVE =  -22.011447
    ZMIN =  -22.492307 ZMAX =  -22.492307 ZAVE =  -22.492307
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.3072057"
Evaluating: 44.3072057+3.5
 Parameter: XMAX <- "47.8072057"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.0114475"
Evaluating: -22.0114475+3.5
 Parameter: YMAX <- "-18.5114475"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.4923074"
Evaluating: -22.4923074+3.5
 Parameter: ZMAX <- "-18.9923074"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.3072057"
Evaluating: 44.3072057-3.5
 Parameter: XMIN <- "40.8072057"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.0114475"
Evaluating: -22.0114475-3.5
 Parameter: YMIN <- "-25.5114475"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.4923074"
Evaluating: -22.4923074-3.5
 Parameter: ZMIN <- "-25.9923074"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.8072057"
 Parameter: XMIN -> "40.8072057"
 Parameter: YMAX -> "-18.5114475"
 Parameter: YMIN -> "-25.5114475"
 Parameter: ZMAX -> "-18.9923074"
 Parameter: ZMIN -> "-25.9923074"
 SELRPN>      9 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      4 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53111 POS      POT      54       POT     -**** MEMB     POPC     255      C14           2.9219
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "54" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.253144088"
Evaluating: 112.065471*(0.253144088-0.5)
 Parameter: XPOS <- "-27.664024"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.864621249"
Evaluating: 112.065471*(0.864621249-0.5)
 Parameter: YPOS <- "40.861452"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.678170106"
Evaluating: 142.885239*(0.678170106-0.5)+2.93414115
 Parameter: ZPOS <- "28.3920193"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.3920193" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.3920193" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.307206 XMAX =   44.307206 XAVE =   44.307206
    YMIN =  -22.011447 YMAX =  -22.011447 YAVE =  -22.011447
    ZMIN =  -22.492307 ZMAX =  -22.492307 ZAVE =  -22.492307
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.664024"
 RDCMND substituted energy or value "?XAVE" to "44.3072057"
Evaluating: -27.664024-44.3072057
 Parameter: XTRAN <- "-71.9712297"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.861452"
 RDCMND substituted energy or value "?YAVE" to "-22.0114475"
Evaluating: 40.861452--22.0114475
 Parameter: YTRAN <- "62.8728995"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.3920193"
 RDCMND substituted energy or value "?ZAVE" to "-22.4923074"
Evaluating: 28.3920193--22.4923074
 Parameter: ZTRAN <- "50.8843267"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-71.9712297"
 Parameter: YTRAN -> "62.8728995"
 Parameter: ZTRAN -> "50.8843267"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -71.971230   62.872900   50.884327
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.83726923"
Evaluating: 0.83726923*360.0
 Parameter: XPHI <- "301.416923"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396144547"
Evaluating: 0.396144547*360.0
 Parameter: YPHI <- "142.612037"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.256191494"
Evaluating: 0.256191494*360.0
 Parameter: ZPHI <- "92.2289378"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.664024"
 Parameter: YPOS -> "40.861452"
 Parameter: ZPOS -> "28.3920193"
 Parameter: XPHI -> "301.416923"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.521262   -0.853397
    0.000000    0.853397    0.521262

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.664024"
 Parameter: YPOS -> "40.861452"
 Parameter: ZPOS -> "28.3920193"
 Parameter: YPHI -> "142.612037"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.794542    0.000000   -0.607209
    0.000000    1.000000    0.000000
    0.607209    0.000000   -0.794542

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.664024"
 Parameter: YPOS -> "40.861452"
 Parameter: ZPOS -> "28.3920193"
 Parameter: ZPHI -> "92.2289378"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.038892    0.999243    0.000000
   -0.999243   -0.038892    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   92.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.664024 XMAX =  -27.664024 XAVE =  -27.664024
    YMIN =   40.861452 YMAX =   40.861452 YAVE =   40.861452
    ZMIN =   28.392019 ZMAX =   28.392019 ZAVE =   28.392019
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.664024"
Evaluating: -27.664024+3.5
 Parameter: XMAX <- "-24.164024"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.861452"
Evaluating: 40.861452+3.5
 Parameter: YMAX <- "44.361452"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.3920193"
Evaluating: 28.3920193+3.5
 Parameter: ZMAX <- "31.8920193"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.664024"
Evaluating: -27.664024-3.5
 Parameter: XMIN <- "-31.164024"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.861452"
Evaluating: 40.861452-3.5
 Parameter: YMIN <- "37.361452"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.3920193"
Evaluating: 28.3920193-3.5
 Parameter: ZMIN <- "24.8920193"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.164024"
 Parameter: XMIN -> "-31.164024"
 Parameter: YMAX -> "44.361452"
 Parameter: YMIN -> "37.361452"
 Parameter: ZMAX -> "31.8920193"
 Parameter: ZMIN -> "24.8920193"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "55" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "55" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.156278363"
Evaluating: 112.065471*(0.156278363-0.5)
 Parameter: XPOS <- "-38.5193271"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.303735437"
Evaluating: 112.065471*(0.303735437-0.5)
 Parameter: YPOS <- "-21.9944807"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.286787747"
Evaluating: 142.885239*(0.286787747-0.5)+2.93414115
 Parameter: ZPOS <- "-27.5307426"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.5307426" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.5193271"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.5193271-0
 Parameter: XTRAN <- "-38.5193271"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.9944807"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.9944807-0
 Parameter: YTRAN <- "-21.9944807"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.5307426"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.5307426-0
 Parameter: ZTRAN <- "-27.5307426"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.5193271"
 Parameter: YTRAN -> "-21.9944807"
 Parameter: ZTRAN -> "-27.5307426"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -38.519327  -21.994481  -27.530743
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.840768538"
Evaluating: 0.840768538*360.0
 Parameter: XPHI <- "302.676674"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.687511325"
Evaluating: 0.687511325*360.0
 Parameter: YPHI <- "247.504077"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.293539675"
Evaluating: 0.293539675*360.0
 Parameter: ZPHI <- "105.674283"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.5193271"
 Parameter: YPOS -> "-21.9944807"
 Parameter: ZPOS -> "-27.5307426"
 Parameter: XPHI -> "302.676674"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.539898   -0.841731
    0.000000    0.841731    0.539898

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   57.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.5193271"
 Parameter: YPOS -> "-21.9944807"
 Parameter: ZPOS -> "-27.5307426"
 Parameter: YPHI -> "247.504077"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.382618    0.000000    0.923907
    0.000000    1.000000    0.000000
   -0.923907    0.000000   -0.382618

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  112.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.5193271"
 Parameter: YPOS -> "-21.9944807"
 Parameter: ZPOS -> "-27.5307426"
 Parameter: ZPHI -> "105.674283"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.270168    0.962813    0.000000
   -0.962813   -0.270168    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  105.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.519327 XMAX =  -38.519327 XAVE =  -38.519327
    YMIN =  -21.994481 YMAX =  -21.994481 YAVE =  -21.994481
    ZMIN =  -27.530743 ZMAX =  -27.530743 ZAVE =  -27.530743
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.5193271"
Evaluating: -38.5193271+3.5
 Parameter: XMAX <- "-35.0193271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.9944807"
Evaluating: -21.9944807+3.5
 Parameter: YMAX <- "-18.4944807"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.5307426"
Evaluating: -27.5307426+3.5
 Parameter: ZMAX <- "-24.0307426"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.5193271"
Evaluating: -38.5193271-3.5
 Parameter: XMIN <- "-42.0193271"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.9944807"
Evaluating: -21.9944807-3.5
 Parameter: YMIN <- "-25.4944807"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.5307426"
Evaluating: -27.5307426-3.5
 Parameter: ZMIN <- "-31.0307426"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.0193271"
 Parameter: XMIN -> "-42.0193271"
 Parameter: YMAX -> "-18.4944807"
 Parameter: YMIN -> "-25.4944807"
 Parameter: ZMAX -> "-24.0307426"
 Parameter: ZMIN -> "-31.0307426"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "56" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "56" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.787826828"
Evaluating: 112.065471*(0.787826828-0.5)
 Parameter: XPOS <- "32.255449"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.468468977"
Evaluating: 112.065471*(0.468468977-0.5)
 Parameter: YPOS <- "-3.53353894"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.705847061"
Evaluating: 142.885239*(0.705847061-0.5)+2.93414115
 Parameter: ZPOS <- "32.3466477"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.3466477" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.3466477" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.255449"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.255449-0
 Parameter: XTRAN <- "32.255449"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.53353894"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.53353894-0
 Parameter: YTRAN <- "-3.53353894"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.3466477"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.3466477-0
 Parameter: ZTRAN <- "32.3466477"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.255449"
 Parameter: YTRAN -> "-3.53353894"
 Parameter: ZTRAN -> "32.3466477"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    32.255449   -3.533539   32.346648
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.036657861E-03"
Evaluating: 8.036657861E-03*360.0
 Parameter: XPHI <- "2.89319683"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.804302611"
Evaluating: 0.804302611*360.0
 Parameter: YPHI <- "289.54894"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.361195449E-02"
Evaluating: 2.361195449E-02*360.0
 Parameter: ZPHI <- "8.50030362"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.255449"
 Parameter: YPOS -> "-3.53353894"
 Parameter: ZPOS -> "32.3466477"
 Parameter: XPHI -> "2.89319683"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998725    0.050474
    0.000000   -0.050474    0.998725

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    2.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.255449"
 Parameter: YPOS -> "-3.53353894"
 Parameter: ZPOS -> "32.3466477"
 Parameter: YPHI -> "289.54894"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.334612    0.000000    0.942356
    0.000000    1.000000    0.000000
   -0.942356    0.000000    0.334612

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   70.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.255449"
 Parameter: YPOS -> "-3.53353894"
 Parameter: ZPOS -> "32.3466477"
 Parameter: ZPHI -> "8.50030362"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.989015    0.147815    0.000000
   -0.147815    0.989015    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    8.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.255449 XMAX =   32.255449 XAVE =   32.255449
    YMIN =   -3.533539 YMAX =   -3.533539 YAVE =   -3.533539
    ZMIN =   32.346648 ZMAX =   32.346648 ZAVE =   32.346648
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.255449"
Evaluating: 32.255449+3.5
 Parameter: XMAX <- "35.755449"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.53353894"
Evaluating: -3.53353894+3.5
 Parameter: YMAX <- "-3.353894E-02"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.3466477"
Evaluating: 32.3466477+3.5
 Parameter: ZMAX <- "35.8466477"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.255449"
Evaluating: 32.255449-3.5
 Parameter: XMIN <- "28.755449"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.53353894"
Evaluating: -3.53353894-3.5
 Parameter: YMIN <- "-7.03353894"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.3466477"
Evaluating: 32.3466477-3.5
 Parameter: ZMIN <- "28.8466477"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.755449"
 Parameter: XMIN -> "28.755449"
 Parameter: YMAX -> "-3.353894E-02"
 Parameter: YMIN -> "-7.03353894"
 Parameter: ZMAX -> "35.8466477"
 Parameter: ZMIN -> "28.8466477"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "57" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "57" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.257004668"
Evaluating: 112.065471*(0.257004668-0.5)
 Parameter: XPOS <- "-27.2313863"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.409260034"
Evaluating: 112.065471*(0.409260034-0.5)
 Parameter: YPOS <- "-10.168817"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.334751495"
Evaluating: 142.885239*(0.334751495-0.5)+2.93414115
 Parameter: ZPOS <- "-20.677431"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.677431" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.2313863"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.2313863-0
 Parameter: XTRAN <- "-27.2313863"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.168817"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -10.168817-0
 Parameter: YTRAN <- "-10.168817"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.677431"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.677431-0
 Parameter: ZTRAN <- "-20.677431"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.2313863"
 Parameter: YTRAN -> "-10.168817"
 Parameter: ZTRAN -> "-20.677431"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -27.231386  -10.168817  -20.677431
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.669084235"
Evaluating: 0.669084235*360.0
 Parameter: XPHI <- "240.870325"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.571948405"
Evaluating: 0.571948405*360.0
 Parameter: YPHI <- "205.901426"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.233153841E-02"
Evaluating: 1.233153841E-02*360.0
 Parameter: ZPHI <- "4.43935383"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.2313863"
 Parameter: YPOS -> "-10.168817"
 Parameter: ZPOS -> "-20.677431"
 Parameter: XPHI -> "240.870325"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.486788   -0.873520
    0.000000    0.873520   -0.486788

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  119.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.2313863"
 Parameter: YPOS -> "-10.168817"
 Parameter: ZPOS -> "-20.677431"
 Parameter: YPHI -> "205.901426"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.899547    0.000000    0.436824
    0.000000    1.000000    0.000000
   -0.436824    0.000000   -0.899547

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  154.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.2313863"
 Parameter: YPOS -> "-10.168817"
 Parameter: ZPOS -> "-20.677431"
 Parameter: ZPHI -> "4.43935383"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.997000    0.077404    0.000000
   -0.077404    0.997000    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    4.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.231386 XMAX =  -27.231386 XAVE =  -27.231386
    YMIN =  -10.168817 YMAX =  -10.168817 YAVE =  -10.168817
    ZMIN =  -20.677431 ZMAX =  -20.677431 ZAVE =  -20.677431
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.2313863"
Evaluating: -27.2313863+3.5
 Parameter: XMAX <- "-23.7313863"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.168817"
Evaluating: -10.168817+3.5
 Parameter: YMAX <- "-6.668817"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.677431"
Evaluating: -20.677431+3.5
 Parameter: ZMAX <- "-17.177431"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.2313863"
Evaluating: -27.2313863-3.5
 Parameter: XMIN <- "-30.7313863"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.168817"
Evaluating: -10.168817-3.5
 Parameter: YMIN <- "-13.668817"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.677431"
Evaluating: -20.677431-3.5
 Parameter: ZMIN <- "-24.177431"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.7313863"
 Parameter: XMIN -> "-30.7313863"
 Parameter: YMAX -> "-6.668817"
 Parameter: YMIN -> "-13.668817"
 Parameter: ZMAX -> "-17.177431"
 Parameter: ZMIN -> "-24.177431"
 SELRPN>     26 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     14 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53114 POS      POT      57       POT     -**** MEMB     POPC     157      O11           3.9332
53114 POS      POT      57       POT     -**** MEMB     POPC     157      C1            2.6355
53114 POS      POT      57       POT     -**** MEMB     POPC     157      C2            3.2096
53114 POS      POT      57       POT     -**** MEMB     POPC     157      O22           3.7929
53114 POS      POT      57       POT     -**** MEMB     POPC     171      N             2.6932
53114 POS      POT      57       POT     -**** MEMB     POPC     171      C12           3.4705
53114 POS      POT      57       POT     -**** MEMB     POPC     171      C13           1.2796
53114 POS      POT      57       POT     -**** MEMB     POPC     171      C14           3.7301
53114 POS      POT      57       POT     -**** MEMB     POPC     171      C15           3.4082
53114 POS      POT      57       POT     -**** MEMB     POPC     171      C11           3.7311
53114 POS      POT      57       POT     -**** MEMB     POPC     171      O12           3.0143
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "57" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.501942783"
Evaluating: 112.065471*(0.501942783-0.5)
 Parameter: XPOS <- "0.217718892"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.468932636"
Evaluating: 112.065471*(0.468932636-0.5)
 Parameter: YPOS <- "-3.48157878"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.73135671"
Evaluating: 142.885239*(0.73135671-0.5)+2.93414115
 Parameter: ZPOS <- "35.9916"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.9916" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.9916" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.231386 XMAX =  -27.231386 XAVE =  -27.231386
    YMIN =  -10.168817 YMAX =  -10.168817 YAVE =  -10.168817
    ZMIN =  -20.677431 ZMAX =  -20.677431 ZAVE =  -20.677431
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.217718892"
 RDCMND substituted energy or value "?XAVE" to "-27.2313863"
Evaluating: 0.217718892--27.2313863
 Parameter: XTRAN <- "27.4491052"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.48157878"
 RDCMND substituted energy or value "?YAVE" to "-10.168817"
Evaluating: -3.48157878--10.168817
 Parameter: YTRAN <- "6.68723822"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.9916"
 RDCMND substituted energy or value "?ZAVE" to "-20.677431"
Evaluating: 35.9916--20.677431
 Parameter: ZTRAN <- "56.669031"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.4491052"
 Parameter: YTRAN -> "6.68723822"
 Parameter: ZTRAN -> "56.669031"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    27.449105    6.687238   56.669031
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.197709855"
Evaluating: 0.197709855*360.0
 Parameter: XPHI <- "71.1755478"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.19072007"
Evaluating: 0.19072007*360.0
 Parameter: YPHI <- "68.6592252"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.567256653"
Evaluating: 0.567256653*360.0
 Parameter: ZPHI <- "204.212395"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.217718892"
 Parameter: YPOS -> "-3.48157878"
 Parameter: ZPOS -> "35.9916"
 Parameter: XPHI -> "71.1755478"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.322670    0.946512
    0.000000   -0.946512    0.322670

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   71.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.217718892"
 Parameter: YPOS -> "-3.48157878"
 Parameter: ZPOS -> "35.9916"
 Parameter: YPHI -> "68.6592252"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.363914    0.000000   -0.931432
    0.000000    1.000000    0.000000
    0.931432    0.000000    0.363914

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.217718892"
 Parameter: YPOS -> "-3.48157878"
 Parameter: ZPOS -> "35.9916"
 Parameter: ZPHI -> "204.212395"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.912031   -0.410120    0.000000
    0.410120   -0.912031    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  155.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.217719 XMAX =    0.217719 XAVE =    0.217719
    YMIN =   -3.481579 YMAX =   -3.481579 YAVE =   -3.481579
    ZMIN =   35.991600 ZMAX =   35.991600 ZAVE =   35.991600
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.217718889"
Evaluating: 0.217718889+3.5
 Parameter: XMAX <- "3.71771889"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.48157878"
Evaluating: -3.48157878+3.5
 Parameter: YMAX <- "1.842122E-02"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.9916"
Evaluating: 35.9916+3.5
 Parameter: ZMAX <- "39.4916"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.217718889"
Evaluating: 0.217718889-3.5
 Parameter: XMIN <- "-3.28228111"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.48157878"
Evaluating: -3.48157878-3.5
 Parameter: YMIN <- "-6.98157878"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.9916"
Evaluating: 35.9916-3.5
 Parameter: ZMIN <- "32.4916"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.71771889"
 Parameter: XMIN -> "-3.28228111"
 Parameter: YMAX -> "1.842122E-02"
 Parameter: YMIN -> "-6.98157878"
 Parameter: ZMAX -> "39.4916"
 Parameter: ZMIN -> "32.4916"
 SELRPN>     29 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     15 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53114 POS      POT      57       POT     -**** PROF     TYR      125      CG            4.3993
53114 POS      POT      57       POT     -**** PROF     TYR      125      CD2           3.8244
53114 POS      POT      57       POT     -**** PROF     PHE      134      CB            3.8194
53114 POS      POT      57       POT     -**** PROF     PHE      134      CG            2.5185
53114 POS      POT      57       POT     -**** PROF     PHE      134      CD1           1.3601
53114 POS      POT      57       POT     -**** PROF     PHE      134      CE1           0.3706
53114 POS      POT      57       POT     -**** PROF     PHE      134      CZ            1.6827
53114 POS      POT      57       POT     -**** PROF     PHE      134      CD2           3.0006
53114 POS      POT      57       POT     -**** PROF     PHE      134      CE2           2.6969
53114 POS      POT      57       POT     -**** PROF     PHE      134      O             4.2517
53114 POS      POT      57       POT     -**** PROF     ALA      136      CA            5.0219
53114 POS      POT      57       POT     -**** PROF     ASN      160      CB            3.4278
53114 POS      POT      57       POT     -**** PROF     ASN      160      ND2           4.8030
53114 POS      POT      57       POT     -**** PROF     ASN      160      O             3.9737
53114 POS      POT      57       POT     -**** PROF     PRO      161      O             3.6701
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        15
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "15"
 Comparing "15" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "57" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.47963282"
Evaluating: 112.065471*(0.47963282-0.5)
 Parameter: XPOS <- "-2.28245762"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.580525633"
Evaluating: 112.065471*(0.580525633-0.5)
 Parameter: YPOS <- "9.02414299"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.855221507"
Evaluating: 142.885239*(0.855221507-0.5)+2.93414115
 Parameter: ZPOS <- "53.6900511"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "53.6900511" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "53.6900511" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.217719 XMAX =    0.217719 XAVE =    0.217719
    YMIN =   -3.481579 YMAX =   -3.481579 YAVE =   -3.481579
    ZMIN =   35.991600 ZMAX =   35.991600 ZAVE =   35.991600
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.28245762"
 RDCMND substituted energy or value "?XAVE" to "0.217718889"
Evaluating: -2.28245762-0.217718889
 Parameter: XTRAN <- "-2.50017651"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.02414299"
 RDCMND substituted energy or value "?YAVE" to "-3.48157878"
Evaluating: 9.02414299--3.48157878
 Parameter: YTRAN <- "12.5057218"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "53.6900511"
 RDCMND substituted energy or value "?ZAVE" to "35.9916"
Evaluating: 53.6900511-35.9916
 Parameter: ZTRAN <- "17.6984511"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.50017651"
 Parameter: YTRAN -> "12.5057218"
 Parameter: ZTRAN -> "17.6984511"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -2.500177   12.505722   17.698451
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.360381802"
Evaluating: 0.360381802*360.0
 Parameter: XPHI <- "129.737449"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.85806007E-03"
Evaluating: 2.85806007E-03*360.0
 Parameter: YPHI <- "1.02890163"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.683338403"
Evaluating: 0.683338403*360.0
 Parameter: ZPHI <- "246.001825"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.28245762"
 Parameter: YPOS -> "9.02414299"
 Parameter: ZPOS -> "53.6900511"
 Parameter: XPHI -> "129.737449"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.639271    0.768982
    0.000000   -0.768982   -0.639271

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  129.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.28245762"
 Parameter: YPOS -> "9.02414299"
 Parameter: ZPOS -> "53.6900511"
 Parameter: YPHI -> "1.02890163"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.999839    0.000000   -0.017957
    0.000000    1.000000    0.000000
    0.017957    0.000000    0.999839

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    1.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.28245762"
 Parameter: YPOS -> "9.02414299"
 Parameter: ZPOS -> "53.6900511"
 Parameter: ZPHI -> "246.001825"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.406708   -0.913558    0.000000
    0.913558   -0.406708    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  114.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.282458 XMAX =   -2.282458 XAVE =   -2.282458
    YMIN =    9.024143 YMAX =    9.024143 YAVE =    9.024143
    ZMIN =   53.690051 ZMAX =   53.690051 ZAVE =   53.690051
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.28245761"
Evaluating: -2.28245761+3.5
 Parameter: XMAX <- "1.21754239"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.024143"
Evaluating: 9.024143+3.5
 Parameter: YMAX <- "12.524143"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "53.6900511"
Evaluating: 53.6900511+3.5
 Parameter: ZMAX <- "57.1900511"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.28245761"
Evaluating: -2.28245761-3.5
 Parameter: XMIN <- "-5.78245761"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.024143"
Evaluating: 9.024143-3.5
 Parameter: YMIN <- "5.524143"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "53.6900511"
Evaluating: 53.6900511-3.5
 Parameter: ZMIN <- "50.1900511"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.21754239"
 Parameter: XMIN -> "-5.78245761"
 Parameter: YMAX -> "12.524143"
 Parameter: YMIN -> "5.524143"
 Parameter: ZMAX -> "57.1900511"
 Parameter: ZMIN -> "50.1900511"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      1 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53114 POS      POT      57       POT     -**** POS      POT      50       POT           3.2817
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "57" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.458275386"
Evaluating: 112.065471*(0.458275386-0.5)
 Parameter: XPOS <- "-4.67588852"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.758427392"
Evaluating: 112.065471*(0.758427392-0.5)
 Parameter: YPOS <- "28.9607874"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.794694071"
Evaluating: 142.885239*(0.794694071-0.5)+2.93414115
 Parameter: ZPOS <- "45.0415739"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.0415739" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.0415739" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.282458 XMAX =   -2.282458 XAVE =   -2.282458
    YMIN =    9.024143 YMAX =    9.024143 YAVE =    9.024143
    ZMIN =   53.690051 ZMAX =   53.690051 ZAVE =   53.690051
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.67588852"
 RDCMND substituted energy or value "?XAVE" to "-2.28245761"
Evaluating: -4.67588852--2.28245761
 Parameter: XTRAN <- "-2.39343091"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.9607874"
 RDCMND substituted energy or value "?YAVE" to "9.024143"
Evaluating: 28.9607874-9.024143
 Parameter: YTRAN <- "19.9366444"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.0415739"
 RDCMND substituted energy or value "?ZAVE" to "53.6900511"
Evaluating: 45.0415739-53.6900511
 Parameter: ZTRAN <- "-8.6484772"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.39343091"
 Parameter: YTRAN -> "19.9366444"
 Parameter: ZTRAN -> "-8.6484772"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -2.393431   19.936644   -8.648477
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.202690028"
Evaluating: 0.202690028*360.0
 Parameter: XPHI <- "72.9684101"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.927000335"
Evaluating: 0.927000335*360.0
 Parameter: YPHI <- "333.720121"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.346442648E-02"
Evaluating: 2.346442648E-02*360.0
 Parameter: ZPHI <- "8.44719353"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.67588852"
 Parameter: YPOS -> "28.9607874"
 Parameter: ZPOS -> "45.0415739"
 Parameter: XPHI -> "72.9684101"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.292899    0.956143
    0.000000   -0.956143    0.292899

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.67588852"
 Parameter: YPOS -> "28.9607874"
 Parameter: ZPOS -> "45.0415739"
 Parameter: YPHI -> "333.720121"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.896642    0.000000    0.442756
    0.000000    1.000000    0.000000
   -0.442756    0.000000    0.896642

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   26.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.67588852"
 Parameter: YPOS -> "28.9607874"
 Parameter: ZPOS -> "45.0415739"
 Parameter: ZPHI -> "8.44719353"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.989152    0.146898    0.000000
   -0.146898    0.989152    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    8.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.675889 XMAX =   -4.675889 XAVE =   -4.675889
    YMIN =   28.960787 YMAX =   28.960787 YAVE =   28.960787
    ZMIN =   45.041574 ZMAX =   45.041574 ZAVE =   45.041574
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.67588852"
Evaluating: -4.67588852+3.5
 Parameter: XMAX <- "-1.17588852"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.9607874"
Evaluating: 28.9607874+3.5
 Parameter: YMAX <- "32.4607874"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.0415739"
Evaluating: 45.0415739+3.5
 Parameter: ZMAX <- "48.5415739"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.67588852"
Evaluating: -4.67588852-3.5
 Parameter: XMIN <- "-8.17588852"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.9607874"
Evaluating: 28.9607874-3.5
 Parameter: YMIN <- "25.4607874"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.0415739"
Evaluating: 45.0415739-3.5
 Parameter: ZMIN <- "41.5415739"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.17588852"
 Parameter: XMIN -> "-8.17588852"
 Parameter: YMAX -> "32.4607874"
 Parameter: YMIN -> "25.4607874"
 Parameter: ZMAX -> "48.5415739"
 Parameter: ZMIN -> "41.5415739"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "58" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "58" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.528361463"
Evaluating: 112.065471*(0.528361463-0.5)
 Parameter: XPOS <- "3.17834071"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.475588966"
Evaluating: 112.065471*(0.475588966-0.5)
 Parameter: YPOS <- "-2.73563402"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.932041264"
Evaluating: 142.885239*(0.932041264-0.5)+2.93414115
 Parameter: ZPOS <- "64.6664604"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "64.6664604" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "64.6664604" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.17834071"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.17834071-0
 Parameter: XTRAN <- "3.17834071"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.73563402"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.73563402-0
 Parameter: YTRAN <- "-2.73563402"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "64.6664604"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 64.6664604-0
 Parameter: ZTRAN <- "64.6664604"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.17834071"
 Parameter: YTRAN -> "-2.73563402"
 Parameter: ZTRAN -> "64.6664604"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     3.178341   -2.735634   64.666460
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.993220606"
Evaluating: 0.993220606*360.0
 Parameter: XPHI <- "357.559418"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.916078925"
Evaluating: 0.916078925*360.0
 Parameter: YPHI <- "329.788413"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.949064539"
Evaluating: 0.949064539*360.0
 Parameter: ZPHI <- "341.663234"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.17834071"
 Parameter: YPOS -> "-2.73563402"
 Parameter: ZPOS -> "64.6664604"
 Parameter: XPHI -> "357.559418"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999093   -0.042583
    0.000000    0.042583    0.999093

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    2.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.17834071"
 Parameter: YPOS -> "-2.73563402"
 Parameter: ZPOS -> "64.6664604"
 Parameter: YPHI -> "329.788413"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.864173    0.000000    0.503195
    0.000000    1.000000    0.000000
   -0.503195    0.000000    0.864173

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   30.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.17834071"
 Parameter: YPOS -> "-2.73563402"
 Parameter: ZPOS -> "64.6664604"
 Parameter: ZPHI -> "341.663234"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.949224   -0.314602    0.000000
    0.314602    0.949224    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   18.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.178341 XMAX =    3.178341 XAVE =    3.178341
    YMIN =   -2.735634 YMAX =   -2.735634 YAVE =   -2.735634
    ZMIN =   64.666460 ZMAX =   64.666460 ZAVE =   64.666460
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.17834071"
Evaluating: 3.17834071+3.5
 Parameter: XMAX <- "6.67834071"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.73563402"
Evaluating: -2.73563402+3.5
 Parameter: YMAX <- "0.76436598"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "64.6664604"
Evaluating: 64.6664604+3.5
 Parameter: ZMAX <- "68.1664604"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.17834071"
Evaluating: 3.17834071-3.5
 Parameter: XMIN <- "-0.32165929"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.73563402"
Evaluating: -2.73563402-3.5
 Parameter: YMIN <- "-6.23563402"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "64.6664604"
Evaluating: 64.6664604-3.5
 Parameter: ZMIN <- "61.1664604"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.67834071"
 Parameter: XMIN -> "-0.32165929"
 Parameter: YMAX -> "0.76436598"
 Parameter: YMIN -> "-6.23563402"
 Parameter: ZMAX -> "68.1664604"
 Parameter: ZMIN -> "61.1664604"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "59" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "59" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.978443567"
Evaluating: 112.065471*(0.978443567-0.5)
 Parameter: XPOS <- "53.6170037"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.75050277"
Evaluating: 112.065471*(0.75050277-0.5)
 Parameter: YPOS <- "28.0727109"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.666946567"
Evaluating: 142.885239*(0.666946567-0.5)+2.93414115
 Parameter: ZPOS <- "26.7883413"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.7883413" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.7883413" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.6170037"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.6170037-0
 Parameter: XTRAN <- "53.6170037"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.0727109"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.0727109-0
 Parameter: YTRAN <- "28.0727109"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.7883413"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.7883413-0
 Parameter: ZTRAN <- "26.7883413"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.6170037"
 Parameter: YTRAN -> "28.0727109"
 Parameter: ZTRAN -> "26.7883413"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    53.617004   28.072711   26.788341
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.154332097"
Evaluating: 0.154332097*360.0
 Parameter: XPHI <- "55.5595549"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.947218504"
Evaluating: 0.947218504*360.0
 Parameter: YPHI <- "340.998661"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317763201"
Evaluating: 0.317763201*360.0
 Parameter: ZPHI <- "114.394752"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.6170037"
 Parameter: YPOS -> "28.0727109"
 Parameter: ZPOS -> "26.7883413"
 Parameter: XPHI -> "55.5595549"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.565549    0.824714
    0.000000   -0.824714    0.565549

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   55.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.6170037"
 Parameter: YPOS -> "28.0727109"
 Parameter: ZPOS -> "26.7883413"
 Parameter: YPHI -> "340.998661"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.945511    0.000000    0.325590
    0.000000    1.000000    0.000000
   -0.325590    0.000000    0.945511

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   19.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.6170037"
 Parameter: YPOS -> "28.0727109"
 Parameter: ZPOS -> "26.7883413"
 Parameter: ZPHI -> "114.394752"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.413021    0.910721    0.000000
   -0.910721   -0.413021    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.617004 XMAX =   53.617004 XAVE =   53.617004
    YMIN =   28.072711 YMAX =   28.072711 YAVE =   28.072711
    ZMIN =   26.788341 ZMAX =   26.788341 ZAVE =   26.788341
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.6170037"
Evaluating: 53.6170037+3.5
 Parameter: XMAX <- "57.1170037"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.0727109"
Evaluating: 28.0727109+3.5
 Parameter: YMAX <- "31.5727109"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.7883413"
Evaluating: 26.7883413+3.5
 Parameter: ZMAX <- "30.2883413"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.6170037"
Evaluating: 53.6170037-3.5
 Parameter: XMIN <- "50.1170037"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.0727109"
Evaluating: 28.0727109-3.5
 Parameter: YMIN <- "24.5727109"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.7883413"
Evaluating: 26.7883413-3.5
 Parameter: ZMIN <- "23.2883413"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.1170037"
 Parameter: XMIN -> "50.1170037"
 Parameter: YMAX -> "31.5727109"
 Parameter: YMIN -> "24.5727109"
 Parameter: ZMAX -> "30.2883413"
 Parameter: ZMIN -> "23.2883413"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "60" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "60" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.723011604E-02"
Evaluating: 112.065471*(5.723011604E-02-0.5)
 Parameter: XPOS <- "-49.6192156"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.578003812"
Evaluating: 112.065471*(0.578003812-0.5)
 Parameter: YPOS <- "8.74153393"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.940421197"
Evaluating: 142.885239*(0.940421197-0.5)+2.93414115
 Parameter: ZPOS <- "65.8638291"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "65.8638291" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "65.8638291" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-49.6192156"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -49.6192156-0
 Parameter: XTRAN <- "-49.6192156"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.74153393"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.74153393-0
 Parameter: YTRAN <- "8.74153393"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "65.8638291"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 65.8638291-0
 Parameter: ZTRAN <- "65.8638291"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.6192156"
 Parameter: YTRAN -> "8.74153393"
 Parameter: ZTRAN -> "65.8638291"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -49.619216    8.741534   65.863829
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.717262743"
Evaluating: 0.717262743*360.0
 Parameter: XPHI <- "258.214587"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.93627183"
Evaluating: 0.93627183*360.0
 Parameter: YPHI <- "337.057859"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.165943682"
Evaluating: 0.165943682*360.0
 Parameter: ZPHI <- "59.7397255"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-49.6192156"
 Parameter: YPOS -> "8.74153393"
 Parameter: ZPOS -> "65.8638291"
 Parameter: XPHI -> "258.214587"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.204247   -0.978919
    0.000000    0.978919   -0.204247

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  101.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-49.6192156"
 Parameter: YPOS -> "8.74153393"
 Parameter: ZPOS -> "65.8638291"
 Parameter: YPHI -> "337.057859"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.920899    0.000000    0.389801
    0.000000    1.000000    0.000000
   -0.389801    0.000000    0.920899

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   22.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-49.6192156"
 Parameter: YPOS -> "8.74153393"
 Parameter: ZPOS -> "65.8638291"
 Parameter: ZPHI -> "59.7397255"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.503929    0.863745    0.000000
   -0.863745    0.503929    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   59.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.619216 XMAX =  -49.619216 XAVE =  -49.619216
    YMIN =    8.741534 YMAX =    8.741534 YAVE =    8.741534
    ZMIN =   65.863829 ZMAX =   65.863829 ZAVE =   65.863829
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-49.6192156"
Evaluating: -49.6192156+3.5
 Parameter: XMAX <- "-46.1192156"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.74153393"
Evaluating: 8.74153393+3.5
 Parameter: YMAX <- "12.2415339"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "65.8638291"
Evaluating: 65.8638291+3.5
 Parameter: ZMAX <- "69.3638291"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-49.6192156"
Evaluating: -49.6192156-3.5
 Parameter: XMIN <- "-53.1192156"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.74153393"
Evaluating: 8.74153393-3.5
 Parameter: YMIN <- "5.24153393"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "65.8638291"
Evaluating: 65.8638291-3.5
 Parameter: ZMIN <- "62.3638291"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.1192156"
 Parameter: XMIN -> "-53.1192156"
 Parameter: YMAX -> "12.2415339"
 Parameter: YMIN -> "5.24153393"
 Parameter: ZMAX -> "69.3638291"
 Parameter: ZMIN -> "62.3638291"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "61" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "61" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.378440647"
Evaluating: 112.065471*(0.378440647-0.5)
 Parameter: XPOS <- "-13.6226061"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.135523194"
Evaluating: 112.065471*(0.135523194-0.5)
 Parameter: YPOS <- "-40.8452649"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.426269422"
Evaluating: 142.885239*(0.426269422-0.5)+2.93414115
 Parameter: ZPOS <- "-7.60087011"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.60087011" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.60087011" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "61" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.709745744"
Evaluating: 112.065471*(0.709745744-0.5)
 Parameter: XPOS <- "23.5052556"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.238144162"
Evaluating: 112.065471*(0.238144162-0.5)
 Parameter: YPOS <- "-29.3449978"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.134625874"
Evaluating: 142.885239*(0.134625874-0.5)+2.93414115
 Parameter: ZPOS <- "-49.2724282"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.2724282" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.5052556"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.5052556-0
 Parameter: XTRAN <- "23.5052556"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.3449978"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.3449978-0
 Parameter: YTRAN <- "-29.3449978"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.2724282"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -49.2724282-0
 Parameter: ZTRAN <- "-49.2724282"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.5052556"
 Parameter: YTRAN -> "-29.3449978"
 Parameter: ZTRAN -> "-49.2724282"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    23.505256  -29.344998  -49.272428
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.181496992"
Evaluating: 0.181496992*360.0
 Parameter: XPHI <- "65.3389171"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.163006768"
Evaluating: 0.163006768*360.0
 Parameter: YPHI <- "58.6824365"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.315413776"
Evaluating: 0.315413776*360.0
 Parameter: ZPHI <- "113.548959"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.5052556"
 Parameter: YPOS -> "-29.3449978"
 Parameter: ZPOS -> "-49.2724282"
 Parameter: XPHI -> "65.3389171"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.417250    0.908792
    0.000000   -0.908792    0.417250

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   65.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.5052556"
 Parameter: YPOS -> "-29.3449978"
 Parameter: ZPOS -> "-49.2724282"
 Parameter: YPHI -> "58.6824365"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.519781    0.000000   -0.854300
    0.000000    1.000000    0.000000
    0.854300    0.000000    0.519781

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   58.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.5052556"
 Parameter: YPOS -> "-29.3449978"
 Parameter: ZPOS -> "-49.2724282"
 Parameter: ZPHI -> "113.548959"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.399533    0.916719    0.000000
   -0.916719   -0.399533    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  113.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.505256 XMAX =   23.505256 XAVE =   23.505256
    YMIN =  -29.344998 YMAX =  -29.344998 YAVE =  -29.344998
    ZMIN =  -49.272428 ZMAX =  -49.272428 ZAVE =  -49.272428
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.5052556"
Evaluating: 23.5052556+3.5
 Parameter: XMAX <- "27.0052556"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.3449978"
Evaluating: -29.3449978+3.5
 Parameter: YMAX <- "-25.8449978"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.2724282"
Evaluating: -49.2724282+3.5
 Parameter: ZMAX <- "-45.7724282"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.5052556"
Evaluating: 23.5052556-3.5
 Parameter: XMIN <- "20.0052556"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.3449978"
Evaluating: -29.3449978-3.5
 Parameter: YMIN <- "-32.8449978"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.2724282"
Evaluating: -49.2724282-3.5
 Parameter: ZMIN <- "-52.7724282"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.0052556"
 Parameter: XMIN -> "20.0052556"
 Parameter: YMAX -> "-25.8449978"
 Parameter: YMIN -> "-32.8449978"
 Parameter: ZMAX -> "-45.7724282"
 Parameter: ZMIN -> "-52.7724282"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "62" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "62" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "1.265633282E-02"
Evaluating: 112.065471*(1.265633282E-02-0.5)
 Parameter: XPOS <- "-54.6143976"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.46901125"
Evaluating: 112.065471*(0.46901125-0.5)
 Parameter: YPOS <- "-3.47276886"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.385800977"
Evaluating: 142.885239*(0.385800977-0.5)+2.93414115
 Parameter: ZPOS <- "-13.3832135"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.3832135" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.3832135" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "62" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.74533498"
Evaluating: 112.065471*(0.74533498-0.5)
 Parameter: XPOS <- "27.4935801"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.998547124"
Evaluating: 112.065471*(0.998547124-0.5)
 Parameter: YPOS <- "55.8699183"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.311501839"
Evaluating: 142.885239*(0.311501839-0.5)+2.93414115
 Parameter: ZPOS <- "-23.9994636"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.9994636" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.4935801"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.4935801-0
 Parameter: XTRAN <- "27.4935801"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "55.8699183"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 55.8699183-0
 Parameter: YTRAN <- "55.8699183"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.9994636"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.9994636-0
 Parameter: ZTRAN <- "-23.9994636"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.4935801"
 Parameter: YTRAN -> "55.8699183"
 Parameter: ZTRAN -> "-23.9994636"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    27.493580   55.869918  -23.999464
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.370089585"
Evaluating: 0.370089585*360.0
 Parameter: XPHI <- "133.232251"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.738963236"
Evaluating: 0.738963236*360.0
 Parameter: YPHI <- "266.026765"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.120364205"
Evaluating: 0.120364205*360.0
 Parameter: ZPHI <- "43.3311138"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.4935801"
 Parameter: YPOS -> "55.8699183"
 Parameter: ZPOS -> "-23.9994636"
 Parameter: XPHI -> "133.232251"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.684957    0.728583
    0.000000   -0.728583   -0.684957

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  133.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.4935801"
 Parameter: YPOS -> "55.8699183"
 Parameter: ZPOS -> "-23.9994636"
 Parameter: YPHI -> "266.026765"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.069290    0.000000    0.997597
    0.000000    1.000000    0.000000
   -0.997597    0.000000   -0.069290

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   93.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.4935801"
 Parameter: YPOS -> "55.8699183"
 Parameter: ZPOS -> "-23.9994636"
 Parameter: ZPHI -> "43.3311138"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.727400    0.686213    0.000000
   -0.686213    0.727400    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   43.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.493580 XMAX =   27.493580 XAVE =   27.493580
    YMIN =   55.869918 YMAX =   55.869918 YAVE =   55.869918
    ZMIN =  -23.999464 ZMAX =  -23.999464 ZAVE =  -23.999464
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.4935801"
Evaluating: 27.4935801+3.5
 Parameter: XMAX <- "30.9935801"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "55.8699183"
Evaluating: 55.8699183+3.5
 Parameter: YMAX <- "59.3699183"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.9994636"
Evaluating: -23.9994636+3.5
 Parameter: ZMAX <- "-20.4994636"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.4935801"
Evaluating: 27.4935801-3.5
 Parameter: XMIN <- "23.9935801"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "55.8699183"
Evaluating: 55.8699183-3.5
 Parameter: YMIN <- "52.3699183"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.9994636"
Evaluating: -23.9994636-3.5
 Parameter: ZMIN <- "-27.4994636"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.9935801"
 Parameter: XMIN -> "23.9935801"
 Parameter: YMAX -> "59.3699183"
 Parameter: YMIN -> "52.3699183"
 Parameter: ZMAX -> "-20.4994636"
 Parameter: ZMIN -> "-27.4994636"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "63"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "63" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "63" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.528863808"
Evaluating: 112.065471*(0.528863808-0.5)
 Parameter: XPOS <- "3.23463624"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.788783493"
Evaluating: 112.065471*(0.788783493-0.5)
 Parameter: YPOS <- "32.3626582"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "1.513724821E-02"
Evaluating: 142.885239*(1.513724821E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-66.345589"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-66.345589" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.23463624"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.23463624-0
 Parameter: XTRAN <- "3.23463624"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.3626582"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.3626582-0
 Parameter: YTRAN <- "32.3626582"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-66.345589"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -66.345589-0
 Parameter: ZTRAN <- "-66.345589"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.23463624"
 Parameter: YTRAN -> "32.3626582"
 Parameter: ZTRAN -> "-66.345589"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     3.234636   32.362658  -66.345589
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.852457919"
Evaluating: 0.852457919*360.0
 Parameter: XPHI <- "306.884851"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.552658154E-02"
Evaluating: 5.552658154E-02*360.0
 Parameter: YPHI <- "19.9895694"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.830766904"
Evaluating: 0.830766904*360.0
 Parameter: ZPHI <- "299.076085"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.23463624"
 Parameter: YPOS -> "32.3626582"
 Parameter: ZPOS -> "-66.345589"
 Parameter: XPHI -> "306.884851"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.600209   -0.799843
    0.000000    0.799843    0.600209

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   53.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.23463624"
 Parameter: YPOS -> "32.3626582"
 Parameter: ZPOS -> "-66.345589"
 Parameter: YPHI -> "19.9895694"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.939755    0.000000   -0.341849
    0.000000    1.000000    0.000000
    0.341849    0.000000    0.939755

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   19.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.23463624"
 Parameter: YPOS -> "32.3626582"
 Parameter: ZPOS -> "-66.345589"
 Parameter: ZPHI -> "299.076085"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.485971   -0.873975    0.000000
    0.873975    0.485971    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.234636 XMAX =    3.234636 XAVE =    3.234636
    YMIN =   32.362658 YMAX =   32.362658 YAVE =   32.362658
    ZMIN =  -66.345589 ZMAX =  -66.345589 ZAVE =  -66.345589
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.23463624"
Evaluating: 3.23463624+3.5
 Parameter: XMAX <- "6.73463624"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.3626582"
Evaluating: 32.3626582+3.5
 Parameter: YMAX <- "35.8626582"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-66.345589"
Evaluating: -66.345589+3.5
 Parameter: ZMAX <- "-62.845589"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.23463624"
Evaluating: 3.23463624-3.5
 Parameter: XMIN <- "-0.26536376"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.3626582"
Evaluating: 32.3626582-3.5
 Parameter: YMIN <- "28.8626582"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-66.345589"
Evaluating: -66.345589-3.5
 Parameter: ZMIN <- "-69.845589"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.73463624"
 Parameter: XMIN -> "-0.26536376"
 Parameter: YMAX -> "35.8626582"
 Parameter: YMIN -> "28.8626582"
 Parameter: ZMAX -> "-62.845589"
 Parameter: ZMIN -> "-69.845589"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "64"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "64" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "64" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.776698851"
Evaluating: 112.065471*(0.776698851-0.5)
 Parameter: XPOS <- "31.0083871"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.962481671"
Evaluating: 112.065471*(0.962481671-0.5)
 Parameter: YPOS <- "51.8282263"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.609661184"
Evaluating: 142.885239*(0.609661184-0.5)+2.93414115
 Parameter: ZPOS <- "18.6031056"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.6031056" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.6031056" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.0083871"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.0083871-0
 Parameter: XTRAN <- "31.0083871"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.8282263"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 51.8282263-0
 Parameter: YTRAN <- "51.8282263"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.6031056"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 18.6031056-0
 Parameter: ZTRAN <- "18.6031056"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.0083871"
 Parameter: YTRAN -> "51.8282263"
 Parameter: ZTRAN -> "18.6031056"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    31.008387   51.828226   18.603106
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.498359239E-02"
Evaluating: 6.498359239E-02*360.0
 Parameter: XPHI <- "23.3940933"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.555419324"
Evaluating: 0.555419324*360.0
 Parameter: YPHI <- "199.950957"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.646837964"
Evaluating: 0.646837964*360.0
 Parameter: ZPHI <- "232.861667"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.0083871"
 Parameter: YPOS -> "51.8282263"
 Parameter: ZPOS -> "18.6031056"
 Parameter: XPHI -> "23.3940933"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.917796    0.397053
    0.000000   -0.397053    0.917796

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   23.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.0083871"
 Parameter: YPOS -> "51.8282263"
 Parameter: ZPOS -> "18.6031056"
 Parameter: YPHI -> "199.950957"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.939985    0.000000    0.341216
    0.000000    1.000000    0.000000
   -0.341216    0.000000   -0.939985

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  160.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.0083871"
 Parameter: YPOS -> "51.8282263"
 Parameter: ZPOS -> "18.6031056"
 Parameter: ZPHI -> "232.861667"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.603741   -0.797180    0.000000
    0.797180   -0.603741    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  127.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.008387 XMAX =   31.008387 XAVE =   31.008387
    YMIN =   51.828226 YMAX =   51.828226 YAVE =   51.828226
    ZMIN =   18.603106 ZMAX =   18.603106 ZAVE =   18.603106
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.0083871"
Evaluating: 31.0083871+3.5
 Parameter: XMAX <- "34.5083871"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.8282263"
Evaluating: 51.8282263+3.5
 Parameter: YMAX <- "55.3282263"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.6031056"
Evaluating: 18.6031056+3.5
 Parameter: ZMAX <- "22.1031056"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.0083871"
Evaluating: 31.0083871-3.5
 Parameter: XMIN <- "27.5083871"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.8282263"
Evaluating: 51.8282263-3.5
 Parameter: YMIN <- "48.3282263"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.6031056"
Evaluating: 18.6031056-3.5
 Parameter: ZMIN <- "15.1031056"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.5083871"
 Parameter: XMIN -> "27.5083871"
 Parameter: YMAX -> "55.3282263"
 Parameter: YMIN -> "48.3282263"
 Parameter: ZMAX -> "22.1031056"
 Parameter: ZMIN -> "15.1031056"
 SELRPN>     32 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     18 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53121 POS      POT      64       POT     -**** MEMB     POPC     126      N             3.0506
53121 POS      POT      64       POT     -**** MEMB     POPC     126      C12           3.0252
53121 POS      POT      64       POT     -**** MEMB     POPC     126      C13           3.1601
53121 POS      POT      64       POT     -**** MEMB     POPC     126      C15           2.6470
53121 POS      POT      64       POT     -**** MEMB     POPC     126      C11           2.2624
53121 POS      POT      64       POT     -**** MEMB     POPC     126      P             1.8144
53121 POS      POT      64       POT     -**** MEMB     POPC     126      O13           3.1047
53121 POS      POT      64       POT     -**** MEMB     POPC     126      O14           2.6612
53121 POS      POT      64       POT     -**** MEMB     POPC     126      O12           1.7662
53121 POS      POT      64       POT     -**** MEMB     POPC     126      O11           1.3250
53121 POS      POT      64       POT     -**** MEMB     POPC     126      C1            1.9269
53121 POS      POT      64       POT     -**** MEMB     POPC     126      C2            3.2044
53121 POS      POT      64       POT     -**** MEMB     POPC     126      O21           3.4220
53121 POS      POT      64       POT     -**** MEMB     POPC     126      C21           3.2565
53121 POS      POT      64       POT     -**** MEMB     POPC     126      O22           3.1233
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        15
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "15"
 Comparing "15" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "64" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.239960558"
Evaluating: 112.065471*(0.239960558-0.5)
 Parameter: XPOS <- "-29.1414425"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.875112096"
Evaluating: 112.065471*(0.875112096-0.5)
 Parameter: YPOS <- "42.0371137"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.818557148"
Evaluating: 142.885239*(0.818557148-0.5)+2.93414115
 Parameter: ZPOS <- "48.4512554"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.4512554" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.4512554" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.008387 XMAX =   31.008387 XAVE =   31.008387
    YMIN =   51.828226 YMAX =   51.828226 YAVE =   51.828226
    ZMIN =   18.603106 ZMAX =   18.603106 ZAVE =   18.603106
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.1414425"
 RDCMND substituted energy or value "?XAVE" to "31.0083871"
Evaluating: -29.1414425-31.0083871
 Parameter: XTRAN <- "-60.1498296"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.0371137"
 RDCMND substituted energy or value "?YAVE" to "51.8282263"
Evaluating: 42.0371137-51.8282263
 Parameter: YTRAN <- "-9.7911126"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.4512554"
 RDCMND substituted energy or value "?ZAVE" to "18.6031056"
Evaluating: 48.4512554-18.6031056
 Parameter: ZTRAN <- "29.8481498"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-60.1498296"
 Parameter: YTRAN -> "-9.7911126"
 Parameter: ZTRAN -> "29.8481498"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -60.149830   -9.791113   29.848150
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.305593266"
Evaluating: 0.305593266*360.0
 Parameter: XPHI <- "110.013576"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.907633011"
Evaluating: 0.907633011*360.0
 Parameter: YPHI <- "326.747884"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.74200283"
Evaluating: 0.74200283*360.0
 Parameter: ZPHI <- "267.121019"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.1414425"
 Parameter: YPOS -> "42.0371137"
 Parameter: ZPOS -> "48.4512554"
 Parameter: XPHI -> "110.013576"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.342243    0.939612
    0.000000   -0.939612   -0.342243

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  110.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.1414425"
 Parameter: YPOS -> "42.0371137"
 Parameter: ZPOS -> "48.4512554"
 Parameter: YPHI -> "326.747884"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.836266    0.000000    0.548324
    0.000000    1.000000    0.000000
   -0.548324    0.000000    0.836266

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   33.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.1414425"
 Parameter: YPOS -> "42.0371137"
 Parameter: ZPOS -> "48.4512554"
 Parameter: ZPHI -> "267.121019"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.050227   -0.998738    0.000000
    0.998738   -0.050227    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   92.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.141443 XMAX =  -29.141443 XAVE =  -29.141443
    YMIN =   42.037114 YMAX =   42.037114 YAVE =   42.037114
    ZMIN =   48.451255 ZMAX =   48.451255 ZAVE =   48.451255
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.1414425"
Evaluating: -29.1414425+3.5
 Parameter: XMAX <- "-25.6414425"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.0371137"
Evaluating: 42.0371137+3.5
 Parameter: YMAX <- "45.5371137"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.4512554"
Evaluating: 48.4512554+3.5
 Parameter: ZMAX <- "51.9512554"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.1414425"
Evaluating: -29.1414425-3.5
 Parameter: XMIN <- "-32.6414425"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.0371137"
Evaluating: 42.0371137-3.5
 Parameter: YMIN <- "38.5371137"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.4512554"
Evaluating: 48.4512554-3.5
 Parameter: ZMIN <- "44.9512554"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.6414425"
 Parameter: XMIN -> "-32.6414425"
 Parameter: YMAX -> "45.5371137"
 Parameter: YMIN -> "38.5371137"
 Parameter: ZMAX -> "51.9512554"
 Parameter: ZMIN -> "44.9512554"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "65"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "65" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "65" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.229833989"
Evaluating: 112.065471*(0.229833989-0.5)
 Parameter: XPOS <- "-30.2762813"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.997301759"
Evaluating: 112.065471*(0.997301759-0.5)
 Parameter: YPOS <- "55.7303559"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.226067224"
Evaluating: 142.885239*(0.226067224-0.5)+2.93414115
 Parameter: ZPOS <- "-36.206809"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.206809" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.2762813"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.2762813-0
 Parameter: XTRAN <- "-30.2762813"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "55.7303559"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 55.7303559-0
 Parameter: YTRAN <- "55.7303559"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.206809"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.206809-0
 Parameter: ZTRAN <- "-36.206809"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.2762813"
 Parameter: YTRAN -> "55.7303559"
 Parameter: ZTRAN -> "-36.206809"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -30.276281   55.730356  -36.206809
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.958435565"
Evaluating: 0.958435565*360.0
 Parameter: XPHI <- "345.036803"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.437551868"
Evaluating: 0.437551868*360.0
 Parameter: YPHI <- "157.518672"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.523790749E-02"
Evaluating: 7.523790749E-02*360.0
 Parameter: ZPHI <- "27.0856467"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.2762813"
 Parameter: YPOS -> "55.7303559"
 Parameter: ZPOS -> "-36.206809"
 Parameter: XPHI -> "345.036803"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.966092   -0.258199
    0.000000    0.258199    0.966092

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   14.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.2762813"
 Parameter: YPOS -> "55.7303559"
 Parameter: ZPOS -> "-36.206809"
 Parameter: YPHI -> "157.518672"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.924004    0.000000   -0.382382
    0.000000    1.000000    0.000000
    0.382382    0.000000   -0.924004

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  157.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.2762813"
 Parameter: YPOS -> "55.7303559"
 Parameter: ZPOS -> "-36.206809"
 Parameter: ZPHI -> "27.0856467"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.890327    0.455322    0.000000
   -0.455322    0.890327    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   27.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.276281 XMAX =  -30.276281 XAVE =  -30.276281
    YMIN =   55.730356 YMAX =   55.730356 YAVE =   55.730356
    ZMIN =  -36.206809 ZMAX =  -36.206809 ZAVE =  -36.206809
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.2762813"
Evaluating: -30.2762813+3.5
 Parameter: XMAX <- "-26.7762813"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "55.7303559"
Evaluating: 55.7303559+3.5
 Parameter: YMAX <- "59.2303559"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.206809"
Evaluating: -36.206809+3.5
 Parameter: ZMAX <- "-32.706809"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.2762813"
Evaluating: -30.2762813-3.5
 Parameter: XMIN <- "-33.7762813"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "55.7303559"
Evaluating: 55.7303559-3.5
 Parameter: YMIN <- "52.2303559"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.206809"
Evaluating: -36.206809-3.5
 Parameter: ZMIN <- "-39.706809"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.7762813"
 Parameter: XMIN -> "-33.7762813"
 Parameter: YMAX -> "59.2303559"
 Parameter: YMIN -> "52.2303559"
 Parameter: ZMAX -> "-32.706809"
 Parameter: ZMIN -> "-39.706809"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "66"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "66" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "66" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.497477124"
Evaluating: 112.065471*(0.497477124-0.5)
 Parameter: XPOS <- "-0.282727287"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.813138845"
Evaluating: 112.065471*(0.813138845-0.5)
 Parameter: YPOS <- "35.0920522"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "5.657457344E-02"
Evaluating: 142.885239*(5.657457344E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-60.4248069"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-60.4248069" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.282727287"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.282727287-0
 Parameter: XTRAN <- "-0.282727287"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.0920522"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.0920522-0
 Parameter: YTRAN <- "35.0920522"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-60.4248069"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -60.4248069-0
 Parameter: ZTRAN <- "-60.4248069"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.282727287"
 Parameter: YTRAN -> "35.0920522"
 Parameter: ZTRAN -> "-60.4248069"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -0.282727   35.092052  -60.424807
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.253674604"
Evaluating: 0.253674604*360.0
 Parameter: XPHI <- "91.3228574"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.646281824"
Evaluating: 0.646281824*360.0
 Parameter: YPHI <- "232.661457"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272513646"
Evaluating: 0.272513646*360.0
 Parameter: ZPHI <- "98.1049126"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.282727287"
 Parameter: YPOS -> "35.0920522"
 Parameter: ZPOS -> "-60.4248069"
 Parameter: XPHI -> "91.3228574"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.023086    0.999733
    0.000000   -0.999733   -0.023086

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   91.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.282727287"
 Parameter: YPOS -> "35.0920522"
 Parameter: ZPOS -> "-60.4248069"
 Parameter: YPHI -> "232.661457"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.606523    0.000000    0.795066
    0.000000    1.000000    0.000000
   -0.795066    0.000000   -0.606523

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  127.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.282727287"
 Parameter: YPOS -> "35.0920522"
 Parameter: ZPOS -> "-60.4248069"
 Parameter: ZPHI -> "98.1049126"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.140986    0.990012    0.000000
   -0.990012   -0.140986    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   98.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.282727 XMAX =   -0.282727 XAVE =   -0.282727
    YMIN =   35.092052 YMAX =   35.092052 YAVE =   35.092052
    ZMIN =  -60.424807 ZMAX =  -60.424807 ZAVE =  -60.424807
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.282727287"
Evaluating: -0.282727287+3.5
 Parameter: XMAX <- "3.21727271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.0920522"
Evaluating: 35.0920522+3.5
 Parameter: YMAX <- "38.5920522"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-60.4248069"
Evaluating: -60.4248069+3.5
 Parameter: ZMAX <- "-56.9248069"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.282727287"
Evaluating: -0.282727287-3.5
 Parameter: XMIN <- "-3.78272729"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.0920522"
Evaluating: 35.0920522-3.5
 Parameter: YMIN <- "31.5920522"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-60.4248069"
Evaluating: -60.4248069-3.5
 Parameter: ZMIN <- "-63.9248069"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.21727271"
 Parameter: XMIN -> "-3.78272729"
 Parameter: YMAX -> "38.5920522"
 Parameter: YMIN -> "31.5920522"
 Parameter: ZMAX -> "-56.9248069"
 Parameter: ZMIN -> "-63.9248069"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "67"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "67" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "67" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.572524755"
Evaluating: 112.065471*(0.572524755-0.5)
 Parameter: XPOS <- "8.12752083"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.876782716"
Evaluating: 112.065471*(0.876782716-0.5)
 Parameter: YPOS <- "42.2243325"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.957058745"
Evaluating: 142.885239*(0.957058745-0.5)+2.93414115
 Parameter: ZPOS <- "68.2410892"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "68.2410892" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "68.2410892" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.12752083"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.12752083-0
 Parameter: XTRAN <- "8.12752083"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.2243325"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.2243325-0
 Parameter: YTRAN <- "42.2243325"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "68.2410892"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 68.2410892-0
 Parameter: ZTRAN <- "68.2410892"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.12752083"
 Parameter: YTRAN -> "42.2243325"
 Parameter: ZTRAN -> "68.2410892"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     8.127521   42.224333   68.241089
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454170343"
Evaluating: 0.454170343*360.0
 Parameter: XPHI <- "163.501323"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.866775906"
Evaluating: 0.866775906*360.0
 Parameter: YPHI <- "312.039326"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.577345354"
Evaluating: 0.577345354*360.0
 Parameter: ZPHI <- "207.844327"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.12752083"
 Parameter: YPOS -> "42.2243325"
 Parameter: ZPOS -> "68.2410892"
 Parameter: XPHI -> "163.501323"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.958826    0.283993
    0.000000   -0.283993   -0.958826

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  163.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.12752083"
 Parameter: YPOS -> "42.2243325"
 Parameter: ZPOS -> "68.2410892"
 Parameter: YPHI -> "312.039326"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.669641    0.000000    0.742685
    0.000000    1.000000    0.000000
   -0.742685    0.000000    0.669641

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   47.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.12752083"
 Parameter: YPOS -> "42.2243325"
 Parameter: ZPOS -> "68.2410892"
 Parameter: ZPHI -> "207.844327"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.884220   -0.467071    0.000000
    0.467071   -0.884220    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  152.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.127521 XMAX =    8.127521 XAVE =    8.127521
    YMIN =   42.224333 YMAX =   42.224333 YAVE =   42.224333
    ZMIN =   68.241089 ZMAX =   68.241089 ZAVE =   68.241089
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.12752083"
Evaluating: 8.12752083+3.5
 Parameter: XMAX <- "11.6275208"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.2243325"
Evaluating: 42.2243325+3.5
 Parameter: YMAX <- "45.7243325"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "68.2410892"
Evaluating: 68.2410892+3.5
 Parameter: ZMAX <- "71.7410892"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.12752083"
Evaluating: 8.12752083-3.5
 Parameter: XMIN <- "4.62752083"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.2243325"
Evaluating: 42.2243325-3.5
 Parameter: YMIN <- "38.7243325"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "68.2410892"
Evaluating: 68.2410892-3.5
 Parameter: ZMIN <- "64.7410892"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.6275208"
 Parameter: XMIN -> "4.62752083"
 Parameter: YMAX -> "45.7243325"
 Parameter: YMIN -> "38.7243325"
 Parameter: ZMAX -> "71.7410892"
 Parameter: ZMIN -> "64.7410892"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "68"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "68" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "68" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.341392839"
Evaluating: 112.065471*(0.341392839-0.5)
 Parameter: XPOS <- "-17.7743862"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.93812523"
Evaluating: 112.065471*(0.93812523-0.5)
 Parameter: YPOS <- "49.0987103"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.854523196"
Evaluating: 142.885239*(0.854523196-0.5)+2.93414115
 Parameter: ZPOS <- "53.5902727"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "53.5902727" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "53.5902727" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.7743862"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.7743862-0
 Parameter: XTRAN <- "-17.7743862"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "49.0987103"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 49.0987103-0
 Parameter: YTRAN <- "49.0987103"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "53.5902727"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 53.5902727-0
 Parameter: ZTRAN <- "53.5902727"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.7743862"
 Parameter: YTRAN -> "49.0987103"
 Parameter: ZTRAN -> "53.5902727"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -17.774386   49.098710   53.590273
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.93297696"
Evaluating: 0.93297696*360.0
 Parameter: XPHI <- "335.871706"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.626400401"
Evaluating: 0.626400401*360.0
 Parameter: YPHI <- "225.504144"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.696633528"
Evaluating: 0.696633528*360.0
 Parameter: ZPHI <- "250.78807"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.7743862"
 Parameter: YPOS -> "49.0987103"
 Parameter: ZPOS -> "53.5902727"
 Parameter: XPHI -> "335.871706"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.912632   -0.408781
    0.000000    0.408781    0.912632

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   24.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.7743862"
 Parameter: YPOS -> "49.0987103"
 Parameter: ZPOS -> "53.5902727"
 Parameter: YPHI -> "225.504144"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.700858    0.000000    0.713301
    0.000000    1.000000    0.000000
   -0.713301    0.000000   -0.700858

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  134.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.7743862"
 Parameter: YPOS -> "49.0987103"
 Parameter: ZPOS -> "53.5902727"
 Parameter: ZPHI -> "250.78807"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.329063   -0.944308    0.000000
    0.944308   -0.329063    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  109.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.774386 XMAX =  -17.774386 XAVE =  -17.774386
    YMIN =   49.098710 YMAX =   49.098710 YAVE =   49.098710
    ZMIN =   53.590273 ZMAX =   53.590273 ZAVE =   53.590273
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.7743862"
Evaluating: -17.7743862+3.5
 Parameter: XMAX <- "-14.2743862"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "49.0987103"
Evaluating: 49.0987103+3.5
 Parameter: YMAX <- "52.5987103"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "53.5902727"
Evaluating: 53.5902727+3.5
 Parameter: ZMAX <- "57.0902727"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.7743862"
Evaluating: -17.7743862-3.5
 Parameter: XMIN <- "-21.2743862"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "49.0987103"
Evaluating: 49.0987103-3.5
 Parameter: YMIN <- "45.5987103"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "53.5902727"
Evaluating: 53.5902727-3.5
 Parameter: ZMIN <- "50.0902727"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.2743862"
 Parameter: XMIN -> "-21.2743862"
 Parameter: YMAX -> "52.5987103"
 Parameter: YMIN -> "45.5987103"
 Parameter: ZMAX -> "57.0902727"
 Parameter: ZMIN -> "50.0902727"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "69"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "69" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "69" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.741337765"
Evaluating: 112.065471*(0.741337765-0.5)
 Parameter: XPOS <- "27.0456303"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.319891622"
Evaluating: 112.065471*(0.319891622-0.5)
 Parameter: YPOS <- "-20.1839302"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.969317203"
Evaluating: 142.885239*(0.969317203-0.5)+2.93414115
 Parameter: ZPOS <- "69.9926419"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.9926419" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.9926419" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.0456303"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.0456303-0
 Parameter: XTRAN <- "27.0456303"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.1839302"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.1839302-0
 Parameter: YTRAN <- "-20.1839302"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.9926419"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 69.9926419-0
 Parameter: ZTRAN <- "69.9926419"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.0456303"
 Parameter: YTRAN -> "-20.1839302"
 Parameter: ZTRAN -> "69.9926419"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    27.045630  -20.183930   69.992642
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.97711342"
Evaluating: 0.97711342*360.0
 Parameter: XPHI <- "351.760831"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.473845047"
Evaluating: 0.473845047*360.0
 Parameter: YPHI <- "170.584217"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.265075873E-02"
Evaluating: 2.265075873E-02*360.0
 Parameter: ZPHI <- "8.15427314"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.0456303"
 Parameter: YPOS -> "-20.1839302"
 Parameter: ZPOS -> "69.9926419"
 Parameter: XPHI -> "351.760831"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.989678   -0.143306
    0.000000    0.143306    0.989678

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    8.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.0456303"
 Parameter: YPOS -> "-20.1839302"
 Parameter: ZPOS -> "69.9926419"
 Parameter: YPHI -> "170.584217"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.986527    0.000000   -0.163598
    0.000000    1.000000    0.000000
    0.163598    0.000000   -0.986527

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  170.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.0456303"
 Parameter: YPOS -> "-20.1839302"
 Parameter: ZPOS -> "69.9926419"
 Parameter: ZPHI -> "8.15427314"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.989890    0.141839    0.000000
   -0.141839    0.989890    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    8.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.045630 XMAX =   27.045630 XAVE =   27.045630
    YMIN =  -20.183930 YMAX =  -20.183930 YAVE =  -20.183930
    ZMIN =   69.992642 ZMAX =   69.992642 ZAVE =   69.992642
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.0456303"
Evaluating: 27.0456303+3.5
 Parameter: XMAX <- "30.5456303"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.1839302"
Evaluating: -20.1839302+3.5
 Parameter: YMAX <- "-16.6839302"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.9926419"
Evaluating: 69.9926419+3.5
 Parameter: ZMAX <- "73.4926419"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.0456303"
Evaluating: 27.0456303-3.5
 Parameter: XMIN <- "23.5456303"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.1839302"
Evaluating: -20.1839302-3.5
 Parameter: YMIN <- "-23.6839302"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.9926419"
Evaluating: 69.9926419-3.5
 Parameter: ZMIN <- "66.4926419"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.5456303"
 Parameter: XMIN -> "23.5456303"
 Parameter: YMAX -> "-16.6839302"
 Parameter: YMIN -> "-23.6839302"
 Parameter: ZMAX -> "73.4926419"
 Parameter: ZMIN -> "66.4926419"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "70"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "70" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "70" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.829424117"
Evaluating: 112.065471*(0.829424117-0.5)
 Parameter: XPOS <- "36.9170688"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.9691648"
Evaluating: 112.065471*(0.9691648-0.5)
 Parameter: YPOS <- "52.5771743"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.712520867"
Evaluating: 142.885239*(0.712520867-0.5)+2.93414115
 Parameter: ZPOS <- "33.300236"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.300236" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.300236" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.9170688"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.9170688-0
 Parameter: XTRAN <- "36.9170688"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "52.5771743"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 52.5771743-0
 Parameter: YTRAN <- "52.5771743"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.300236"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.300236-0
 Parameter: ZTRAN <- "33.300236"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.9170688"
 Parameter: YTRAN -> "52.5771743"
 Parameter: ZTRAN -> "33.300236"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    36.917069   52.577174   33.300236
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225048774"
Evaluating: 0.225048774*360.0
 Parameter: XPHI <- "81.0175586"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335623494"
Evaluating: 0.335623494*360.0
 Parameter: YPHI <- "120.824458"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.995952621E-02"
Evaluating: 5.995952621E-02*360.0
 Parameter: ZPHI <- "21.5854294"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.9170688"
 Parameter: YPOS -> "52.5771743"
 Parameter: ZPOS -> "33.300236"
 Parameter: XPHI -> "81.0175586"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.156132    0.987736
    0.000000   -0.987736    0.156132

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   81.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.9170688"
 Parameter: YPOS -> "52.5771743"
 Parameter: ZPOS -> "33.300236"
 Parameter: YPHI -> "120.824458"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.512409    0.000000   -0.858741
    0.000000    1.000000    0.000000
    0.858741    0.000000   -0.512409

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  120.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.9170688"
 Parameter: YPOS -> "52.5771743"
 Parameter: ZPOS -> "33.300236"
 Parameter: ZPHI -> "21.5854294"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.929870    0.367888    0.000000
   -0.367888    0.929870    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   21.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.917069 XMAX =   36.917069 XAVE =   36.917069
    YMIN =   52.577174 YMAX =   52.577174 YAVE =   52.577174
    ZMIN =   33.300236 ZMAX =   33.300236 ZAVE =   33.300236
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.9170688"
Evaluating: 36.9170688+3.5
 Parameter: XMAX <- "40.4170688"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "52.5771743"
Evaluating: 52.5771743+3.5
 Parameter: YMAX <- "56.0771743"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.300236"
Evaluating: 33.300236+3.5
 Parameter: ZMAX <- "36.800236"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.9170688"
Evaluating: 36.9170688-3.5
 Parameter: XMIN <- "33.4170688"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "52.5771743"
Evaluating: 52.5771743-3.5
 Parameter: YMIN <- "49.0771743"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.300236"
Evaluating: 33.300236-3.5
 Parameter: ZMIN <- "29.800236"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.4170688"
 Parameter: XMIN -> "33.4170688"
 Parameter: YMAX -> "56.0771743"
 Parameter: YMIN -> "49.0771743"
 Parameter: ZMAX -> "36.800236"
 Parameter: ZMIN -> "29.800236"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "71"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "71" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "71" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.170901008"
Evaluating: 112.065471*(0.170901008-0.5)
 Parameter: XPOS <- "-36.8806335"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.896265825"
Evaluating: 112.065471*(0.896265825-0.5)
 Parameter: YPOS <- "44.4077163"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.699823551"
Evaluating: 142.885239*(0.699823551-0.5)+2.93414115
 Parameter: ZPOS <- "31.485977"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.485977" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.485977" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.8806335"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.8806335-0
 Parameter: XTRAN <- "-36.8806335"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.4077163"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.4077163-0
 Parameter: YTRAN <- "44.4077163"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.485977"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.485977-0
 Parameter: ZTRAN <- "31.485977"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.8806335"
 Parameter: YTRAN -> "44.4077163"
 Parameter: ZTRAN -> "31.485977"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -36.880634   44.407716   31.485977
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.61847209"
Evaluating: 0.61847209*360.0
 Parameter: XPHI <- "222.649952"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.764671923"
Evaluating: 0.764671923*360.0
 Parameter: YPHI <- "275.281892"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.338553724"
Evaluating: 0.338553724*360.0
 Parameter: ZPHI <- "121.879341"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.8806335"
 Parameter: YPOS -> "44.4077163"
 Parameter: ZPOS -> "31.485977"
 Parameter: XPHI -> "222.649952"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.735507   -0.677517
    0.000000    0.677517   -0.735507

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  137.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.8806335"
 Parameter: YPOS -> "44.4077163"
 Parameter: ZPOS -> "31.485977"
 Parameter: YPHI -> "275.281892"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.092056    0.000000    0.995754
    0.000000    1.000000    0.000000
   -0.995754    0.000000    0.092056

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   84.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.8806335"
 Parameter: YPOS -> "44.4077163"
 Parameter: ZPOS -> "31.485977"
 Parameter: ZPHI -> "121.879341"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.528132    0.849162    0.000000
   -0.849162   -0.528132    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  121.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.880634 XMAX =  -36.880634 XAVE =  -36.880634
    YMIN =   44.407716 YMAX =   44.407716 YAVE =   44.407716
    ZMIN =   31.485977 ZMAX =   31.485977 ZAVE =   31.485977
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.8806335"
Evaluating: -36.8806335+3.5
 Parameter: XMAX <- "-33.3806335"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.4077163"
Evaluating: 44.4077163+3.5
 Parameter: YMAX <- "47.9077163"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.485977"
Evaluating: 31.485977+3.5
 Parameter: ZMAX <- "34.985977"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.8806335"
Evaluating: -36.8806335-3.5
 Parameter: XMIN <- "-40.3806335"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.4077163"
Evaluating: 44.4077163-3.5
 Parameter: YMIN <- "40.9077163"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.485977"
Evaluating: 31.485977-3.5
 Parameter: ZMIN <- "27.985977"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.3806335"
 Parameter: XMIN -> "-40.3806335"
 Parameter: YMAX -> "47.9077163"
 Parameter: YMIN -> "40.9077163"
 Parameter: ZMAX -> "34.985977"
 Parameter: ZMIN -> "27.985977"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "72"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "72" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "72" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.991440926"
Evaluating: 112.065471*(0.991440926-0.5)
 Parameter: XPOS <- "55.0735588"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.226564287"
Evaluating: 112.065471*(0.226564287-0.5)
 Parameter: YPOS <- "-30.642702"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.376988688"
Evaluating: 142.885239*(0.376988688-0.5)+2.93414115
 Parameter: ZPOS <- "-14.6423596"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.6423596" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.6423596" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "72" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.677728426"
Evaluating: 112.065471*(0.677728426-0.5)
 Parameter: XPOS <- "19.9172198"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.116983513E-02"
Evaluating: 112.065471*(4.116983513E-02-0.5)
 Parameter: YPOS <- "-51.4190185"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.933509588"
Evaluating: 142.885239*(0.933509588-0.5)+2.93414115
 Parameter: ZPOS <- "64.8762622"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "64.8762622" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "64.8762622" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.9172198"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 19.9172198-0
 Parameter: XTRAN <- "19.9172198"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-51.4190185"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -51.4190185-0
 Parameter: YTRAN <- "-51.4190185"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "64.8762622"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 64.8762622-0
 Parameter: ZTRAN <- "64.8762622"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.9172198"
 Parameter: YTRAN -> "-51.4190185"
 Parameter: ZTRAN -> "64.8762622"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    19.917220  -51.419018   64.876262
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.645710228"
Evaluating: 0.645710228*360.0
 Parameter: XPHI <- "232.455682"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.532706905"
Evaluating: 0.532706905*360.0
 Parameter: YPHI <- "191.774486"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.25531841"
Evaluating: 0.25531841*360.0
 Parameter: ZPHI <- "91.9146276"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.9172198"
 Parameter: YPOS -> "-51.4190185"
 Parameter: ZPOS -> "64.8762622"
 Parameter: XPHI -> "232.455682"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.609375   -0.792882
    0.000000    0.792882   -0.609375

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  127.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.9172198"
 Parameter: YPOS -> "-51.4190185"
 Parameter: ZPOS -> "64.8762622"
 Parameter: YPHI -> "191.774486"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.978958    0.000000    0.204060
    0.000000    1.000000    0.000000
   -0.204060    0.000000   -0.978958

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  168.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.9172198"
 Parameter: YPOS -> "-51.4190185"
 Parameter: ZPOS -> "64.8762622"
 Parameter: ZPHI -> "91.9146276"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.033410    0.999442    0.000000
   -0.999442   -0.033410    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   91.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.917220 XMAX =   19.917220 XAVE =   19.917220
    YMIN =  -51.419018 YMAX =  -51.419018 YAVE =  -51.419018
    ZMIN =   64.876262 ZMAX =   64.876262 ZAVE =   64.876262
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.9172198"
Evaluating: 19.9172198+3.5
 Parameter: XMAX <- "23.4172198"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-51.4190185"
Evaluating: -51.4190185+3.5
 Parameter: YMAX <- "-47.9190185"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "64.8762622"
Evaluating: 64.8762622+3.5
 Parameter: ZMAX <- "68.3762622"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.9172198"
Evaluating: 19.9172198-3.5
 Parameter: XMIN <- "16.4172198"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-51.4190185"
Evaluating: -51.4190185-3.5
 Parameter: YMIN <- "-54.9190185"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "64.8762622"
Evaluating: 64.8762622-3.5
 Parameter: ZMIN <- "61.3762622"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.4172198"
 Parameter: XMIN -> "16.4172198"
 Parameter: YMAX -> "-47.9190185"
 Parameter: YMIN -> "-54.9190185"
 Parameter: ZMAX -> "68.3762622"
 Parameter: ZMIN -> "61.3762622"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "73"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "73" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "73" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.121158278"
Evaluating: 112.065471*(0.121158278-0.5)
 Parameter: XPOS <- "-42.455076"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.277552118"
Evaluating: 112.065471*(0.277552118-0.5)
 Parameter: YPOS <- "-24.9287267"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.996763035"
Evaluating: 142.885239*(0.996763035-0.5)+2.93414115
 Parameter: ZPOS <- "73.9142461"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "73.9142461" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "73.9142461" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.455076"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.455076-0
 Parameter: XTRAN <- "-42.455076"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.9287267"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.9287267-0
 Parameter: YTRAN <- "-24.9287267"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "73.9142461"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 73.9142461-0
 Parameter: ZTRAN <- "73.9142461"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.455076"
 Parameter: YTRAN -> "-24.9287267"
 Parameter: ZTRAN -> "73.9142461"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -42.455076  -24.928727   73.914246
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.555738109"
Evaluating: 0.555738109*360.0
 Parameter: XPHI <- "200.065719"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.737030825"
Evaluating: 0.737030825*360.0
 Parameter: YPHI <- "265.331097"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938050153"
Evaluating: 0.938050153*360.0
 Parameter: ZPHI <- "337.698055"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.455076"
 Parameter: YPOS -> "-24.9287267"
 Parameter: ZPOS -> "73.9142461"
 Parameter: XPHI -> "200.065719"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.939300   -0.343098
    0.000000    0.343098   -0.939300

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  159.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.455076"
 Parameter: YPOS -> "-24.9287267"
 Parameter: ZPOS -> "73.9142461"
 Parameter: YPHI -> "265.331097"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.081398    0.000000    0.996682
    0.000000    1.000000    0.000000
   -0.996682    0.000000   -0.081398

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   94.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.455076"
 Parameter: YPOS -> "-24.9287267"
 Parameter: ZPOS -> "73.9142461"
 Parameter: ZPHI -> "337.698055"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.925197   -0.379488    0.000000
    0.379488    0.925197    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   22.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.455076 XMAX =  -42.455076 XAVE =  -42.455076
    YMIN =  -24.928727 YMAX =  -24.928727 YAVE =  -24.928727
    ZMIN =   73.914246 ZMAX =   73.914246 ZAVE =   73.914246
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.455076"
Evaluating: -42.455076+3.5
 Parameter: XMAX <- "-38.955076"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.9287267"
Evaluating: -24.9287267+3.5
 Parameter: YMAX <- "-21.4287267"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "73.9142461"
Evaluating: 73.9142461+3.5
 Parameter: ZMAX <- "77.4142461"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.455076"
Evaluating: -42.455076-3.5
 Parameter: XMIN <- "-45.955076"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.9287267"
Evaluating: -24.9287267-3.5
 Parameter: YMIN <- "-28.4287267"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "73.9142461"
Evaluating: 73.9142461-3.5
 Parameter: ZMIN <- "70.4142461"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.955076"
 Parameter: XMIN -> "-45.955076"
 Parameter: YMAX -> "-21.4287267"
 Parameter: YMIN -> "-28.4287267"
 Parameter: ZMAX -> "77.4142461"
 Parameter: ZMIN -> "70.4142461"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "74"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "74" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "74" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.883836075"
Evaluating: 112.065471*(0.883836075-0.5)
 Parameter: XPOS <- "43.0147705"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.130902242"
Evaluating: 112.065471*(0.130902242-0.5)
 Parameter: YPOS <- "-41.3631141"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.96409393"
Evaluating: 142.885239*(0.96409393-0.5)+2.93414115
 Parameter: ZPOS <- "69.2463133"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.2463133" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.2463133" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.0147705"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 43.0147705-0
 Parameter: XTRAN <- "43.0147705"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.3631141"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -41.3631141-0
 Parameter: YTRAN <- "-41.3631141"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.2463133"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 69.2463133-0
 Parameter: ZTRAN <- "69.2463133"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.0147705"
 Parameter: YTRAN -> "-41.3631141"
 Parameter: ZTRAN -> "69.2463133"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    43.014770  -41.363114   69.246313
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.657500849"
Evaluating: 0.657500849*360.0
 Parameter: XPHI <- "236.700306"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.22274598"
Evaluating: 0.22274598*360.0
 Parameter: YPHI <- "80.1885528"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.56506649"
Evaluating: 0.56506649*360.0
 Parameter: ZPHI <- "203.423936"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.0147705"
 Parameter: YPOS -> "-41.3631141"
 Parameter: ZPOS -> "69.2463133"
 Parameter: XPHI -> "236.700306"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.549018   -0.835810
    0.000000    0.835810   -0.549018

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  123.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.0147705"
 Parameter: YPOS -> "-41.3631141"
 Parameter: ZPOS -> "69.2463133"
 Parameter: YPHI -> "80.1885528"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.170406    0.000000   -0.985374
    0.000000    1.000000    0.000000
    0.985374    0.000000    0.170406

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   80.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.0147705"
 Parameter: YPOS -> "-41.3631141"
 Parameter: ZPOS -> "69.2463133"
 Parameter: ZPHI -> "203.423936"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.917589   -0.397531    0.000000
    0.397531   -0.917589    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  156.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.014770 XMAX =   43.014770 XAVE =   43.014770
    YMIN =  -41.363114 YMAX =  -41.363114 YAVE =  -41.363114
    ZMIN =   69.246313 ZMAX =   69.246313 ZAVE =   69.246313
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.0147705"
Evaluating: 43.0147705+3.5
 Parameter: XMAX <- "46.5147705"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.3631141"
Evaluating: -41.3631141+3.5
 Parameter: YMAX <- "-37.8631141"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.2463133"
Evaluating: 69.2463133+3.5
 Parameter: ZMAX <- "72.7463133"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.0147705"
Evaluating: 43.0147705-3.5
 Parameter: XMIN <- "39.5147705"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.3631141"
Evaluating: -41.3631141-3.5
 Parameter: YMIN <- "-44.8631141"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.2463133"
Evaluating: 69.2463133-3.5
 Parameter: ZMIN <- "65.7463133"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.5147705"
 Parameter: XMIN -> "39.5147705"
 Parameter: YMAX -> "-37.8631141"
 Parameter: YMIN -> "-44.8631141"
 Parameter: ZMAX -> "72.7463133"
 Parameter: ZMIN -> "65.7463133"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "75"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "75" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "75" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.699950206E-02"
Evaluating: 112.065471*(5.699950206E-02-0.5)
 Parameter: XPOS <- "-49.6450595"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.568266625"
Evaluating: 112.065471*(0.568266625-0.5)
 Parameter: YPOS <- "7.65033148"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.708203787"
Evaluating: 142.885239*(0.708203787-0.5)+2.93414115
 Parameter: ZPOS <- "32.683389"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.683389" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.683389" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-49.6450595"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -49.6450595-0
 Parameter: XTRAN <- "-49.6450595"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.65033148"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.65033148-0
 Parameter: YTRAN <- "7.65033148"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.683389"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.683389-0
 Parameter: ZTRAN <- "32.683389"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.6450595"
 Parameter: YTRAN -> "7.65033148"
 Parameter: ZTRAN -> "32.683389"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -49.645060    7.650331   32.683389
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.616314977"
Evaluating: 0.616314977*360.0
 Parameter: XPHI <- "221.873392"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938520509"
Evaluating: 0.938520509*360.0
 Parameter: YPHI <- "337.867383"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.899435536"
Evaluating: 0.899435536*360.0
 Parameter: ZPHI <- "323.796793"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-49.6450595"
 Parameter: YPOS -> "7.65033148"
 Parameter: ZPOS -> "32.683389"
 Parameter: XPHI -> "221.873392"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.744622   -0.667487
    0.000000    0.667487   -0.744622

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  138.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-49.6450595"
 Parameter: YPOS -> "7.65033148"
 Parameter: ZPOS -> "32.683389"
 Parameter: YPHI -> "337.867383"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.926314    0.000000    0.376752
    0.000000    1.000000    0.000000
   -0.376752    0.000000    0.926314

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   22.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-49.6450595"
 Parameter: YPOS -> "7.65033148"
 Parameter: ZPOS -> "32.683389"
 Parameter: ZPHI -> "323.796793"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.806927   -0.590651    0.000000
    0.590651    0.806927    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   36.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.645060 XMAX =  -49.645060 XAVE =  -49.645060
    YMIN =    7.650331 YMAX =    7.650331 YAVE =    7.650331
    ZMIN =   32.683389 ZMAX =   32.683389 ZAVE =   32.683389
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-49.6450595"
Evaluating: -49.6450595+3.5
 Parameter: XMAX <- "-46.1450595"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.65033148"
Evaluating: 7.65033148+3.5
 Parameter: YMAX <- "11.1503315"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.683389"
Evaluating: 32.683389+3.5
 Parameter: ZMAX <- "36.183389"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-49.6450595"
Evaluating: -49.6450595-3.5
 Parameter: XMIN <- "-53.1450595"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.65033148"
Evaluating: 7.65033148-3.5
 Parameter: YMIN <- "4.15033148"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.683389"
Evaluating: 32.683389-3.5
 Parameter: ZMIN <- "29.183389"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.1450595"
 Parameter: XMIN -> "-53.1450595"
 Parameter: YMAX -> "11.1503315"
 Parameter: YMIN -> "4.15033148"
 Parameter: ZMAX -> "36.183389"
 Parameter: ZMIN -> "29.183389"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "76"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "76" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "76" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.629733777"
Evaluating: 112.065471*(0.629733777-0.5)
 Parameter: XPOS <- "14.5386768"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.476906939E-02"
Evaluating: 112.065471*(7.476906939E-02-0.5)
 Parameter: YPOS <- "-47.6537045"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.317925974"
Evaluating: 142.885239*(0.317925974-0.5)+2.93414115
 Parameter: ZPOS <- "-23.0815496"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.0815496" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.5386768"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.5386768-0
 Parameter: XTRAN <- "14.5386768"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.6537045"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.6537045-0
 Parameter: YTRAN <- "-47.6537045"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.0815496"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.0815496-0
 Parameter: ZTRAN <- "-23.0815496"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.5386768"
 Parameter: YTRAN -> "-47.6537045"
 Parameter: ZTRAN -> "-23.0815496"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    14.538677  -47.653705  -23.081550
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.907329406"
Evaluating: 0.907329406*360.0
 Parameter: XPHI <- "326.638586"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.566894828"
Evaluating: 0.566894828*360.0
 Parameter: YPHI <- "204.082138"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.310584257"
Evaluating: 0.310584257*360.0
 Parameter: ZPHI <- "111.810333"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.5386768"
 Parameter: YPOS -> "-47.6537045"
 Parameter: ZPOS -> "-23.0815496"
 Parameter: XPHI -> "326.638586"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.835218   -0.549918
    0.000000    0.549918    0.835218

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   33.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.5386768"
 Parameter: YPOS -> "-47.6537045"
 Parameter: ZPOS -> "-23.0815496"
 Parameter: YPHI -> "204.082138"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.912961    0.000000    0.408046
    0.000000    1.000000    0.000000
   -0.408046    0.000000   -0.912961

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  155.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.5386768"
 Parameter: YPOS -> "-47.6537045"
 Parameter: ZPOS -> "-23.0815496"
 Parameter: ZPHI -> "111.810333"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.371535    0.928419    0.000000
   -0.928419   -0.371535    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  111.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.538677 XMAX =   14.538677 XAVE =   14.538677
    YMIN =  -47.653705 YMAX =  -47.653705 YAVE =  -47.653705
    ZMIN =  -23.081550 ZMAX =  -23.081550 ZAVE =  -23.081550
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.5386768"
Evaluating: 14.5386768+3.5
 Parameter: XMAX <- "18.0386768"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.6537045"
Evaluating: -47.6537045+3.5
 Parameter: YMAX <- "-44.1537045"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.0815496"
Evaluating: -23.0815496+3.5
 Parameter: ZMAX <- "-19.5815496"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.5386768"
Evaluating: 14.5386768-3.5
 Parameter: XMIN <- "11.0386768"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.6537045"
Evaluating: -47.6537045-3.5
 Parameter: YMIN <- "-51.1537045"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.0815496"
Evaluating: -23.0815496-3.5
 Parameter: ZMIN <- "-26.5815496"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.0386768"
 Parameter: XMIN -> "11.0386768"
 Parameter: YMAX -> "-44.1537045"
 Parameter: YMIN -> "-51.1537045"
 Parameter: ZMAX -> "-19.5815496"
 Parameter: ZMIN -> "-26.5815496"
 SELRPN>      3 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      1 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "77"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "77" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "77" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "1.971388248E-02"
Evaluating: 112.065471*(1.971388248E-02-0.5)
 Parameter: XPOS <- "-53.82349"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.866961187"
Evaluating: 112.065471*(0.866961187-0.5)
 Parameter: YPOS <- "41.1236783"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.176408655"
Evaluating: 142.885239*(0.176408655-0.5)+2.93414115
 Parameter: ZPOS <- "-43.3022855"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.3022855" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-53.82349"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -53.82349-0
 Parameter: XTRAN <- "-53.82349"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.1236783"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.1236783-0
 Parameter: YTRAN <- "41.1236783"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.3022855"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.3022855-0
 Parameter: ZTRAN <- "-43.3022855"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-53.82349"
 Parameter: YTRAN -> "41.1236783"
 Parameter: ZTRAN -> "-43.3022855"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -53.823490   41.123678  -43.302286
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.60974903"
Evaluating: 0.60974903*360.0
 Parameter: XPHI <- "219.509651"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.5471895"
Evaluating: 0.5471895*360.0
 Parameter: YPHI <- "196.98822"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.418045989"
Evaluating: 0.418045989*360.0
 Parameter: ZPHI <- "150.496556"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-53.82349"
 Parameter: YPOS -> "41.1236783"
 Parameter: ZPOS -> "-43.3022855"
 Parameter: XPHI -> "219.509651"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.771517   -0.636208
    0.000000    0.636208   -0.771517

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  140.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-53.82349"
 Parameter: YPOS -> "41.1236783"
 Parameter: ZPOS -> "-43.3022855"
 Parameter: YPHI -> "196.98822"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.956365    0.000000    0.292175
    0.000000    1.000000    0.000000
   -0.292175    0.000000   -0.956365

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  163.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-53.82349"
 Parameter: YPOS -> "41.1236783"
 Parameter: ZPOS -> "-43.3022855"
 Parameter: ZPHI -> "150.496556"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.870326    0.492476    0.000000
   -0.492476   -0.870326    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  150.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -53.823490 XMAX =  -53.823490 XAVE =  -53.823490
    YMIN =   41.123678 YMAX =   41.123678 YAVE =   41.123678
    ZMIN =  -43.302286 ZMAX =  -43.302286 ZAVE =  -43.302286
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-53.82349"
Evaluating: -53.82349+3.5
 Parameter: XMAX <- "-50.32349"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.1236783"
Evaluating: 41.1236783+3.5
 Parameter: YMAX <- "44.6236783"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.3022855"
Evaluating: -43.3022855+3.5
 Parameter: ZMAX <- "-39.8022855"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-53.82349"
Evaluating: -53.82349-3.5
 Parameter: XMIN <- "-57.32349"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.1236783"
Evaluating: 41.1236783-3.5
 Parameter: YMIN <- "37.6236783"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.3022855"
Evaluating: -43.3022855-3.5
 Parameter: ZMIN <- "-46.8022855"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-50.32349"
 Parameter: XMIN -> "-57.32349"
 Parameter: YMAX -> "44.6236783"
 Parameter: YMIN -> "37.6236783"
 Parameter: ZMAX -> "-39.8022855"
 Parameter: ZMIN -> "-46.8022855"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "78"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "78" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "78" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.381001283"
Evaluating: 112.065471*(0.381001283-0.5)
 Parameter: XPOS <- "-13.3356473"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.535893885"
Evaluating: 112.065471*(0.535893885-0.5)
 Parameter: YPOS <- "4.02246513"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.623950536"
Evaluating: 142.885239*(0.623950536-0.5)+2.93414115
 Parameter: ZPOS <- "20.6448431"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.6448431" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.6448431" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.3356473"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.3356473-0
 Parameter: XTRAN <- "-13.3356473"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.02246513"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 4.02246513-0
 Parameter: YTRAN <- "4.02246513"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.6448431"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 20.6448431-0
 Parameter: ZTRAN <- "20.6448431"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.3356473"
 Parameter: YTRAN -> "4.02246513"
 Parameter: ZTRAN -> "20.6448431"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -13.335647    4.022465   20.644843
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864554147"
Evaluating: 0.864554147*360.0
 Parameter: XPHI <- "311.239493"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.699617807"
Evaluating: 0.699617807*360.0
 Parameter: YPHI <- "251.862411"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.680607517"
Evaluating: 0.680607517*360.0
 Parameter: ZPHI <- "245.018706"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.3356473"
 Parameter: YPOS -> "4.02246513"
 Parameter: ZPOS -> "20.6448431"
 Parameter: XPHI -> "311.239493"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.659208   -0.751961
    0.000000    0.751961    0.659208

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   48.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.3356473"
 Parameter: YPOS -> "4.02246513"
 Parameter: ZPOS -> "20.6448431"
 Parameter: YPHI -> "251.862411"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.311300    0.000000    0.950312
    0.000000    1.000000    0.000000
   -0.950312    0.000000   -0.311300

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  108.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.3356473"
 Parameter: YPOS -> "4.02246513"
 Parameter: ZPOS -> "20.6448431"
 Parameter: ZPHI -> "245.018706"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.422322   -0.906446    0.000000
    0.906446   -0.422322    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  114.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.335647 XMAX =  -13.335647 XAVE =  -13.335647
    YMIN =    4.022465 YMAX =    4.022465 YAVE =    4.022465
    ZMIN =   20.644843 ZMAX =   20.644843 ZAVE =   20.644843
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.3356473"
Evaluating: -13.3356473+3.5
 Parameter: XMAX <- "-9.8356473"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.02246513"
Evaluating: 4.02246513+3.5
 Parameter: YMAX <- "7.52246513"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.6448431"
Evaluating: 20.6448431+3.5
 Parameter: ZMAX <- "24.1448431"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.3356473"
Evaluating: -13.3356473-3.5
 Parameter: XMIN <- "-16.8356473"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.02246513"
Evaluating: 4.02246513-3.5
 Parameter: YMIN <- "0.52246513"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.6448431"
Evaluating: 20.6448431-3.5
 Parameter: ZMIN <- "17.1448431"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.8356473"
 Parameter: XMIN -> "-16.8356473"
 Parameter: YMAX -> "7.52246513"
 Parameter: YMIN -> "0.52246513"
 Parameter: ZMAX -> "24.1448431"
 Parameter: ZMIN -> "17.1448431"
 SELRPN>     36 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     21 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53135 POS      POT      78       POT     -7254 PROB     GLU      481      N             4.1685
53135 POS      POT      78       POT     -7256 PROB     GLU      481      CA            3.6254
53135 POS      POT      78       POT     -7258 PROB     GLU      481      CB            2.5324
53135 POS      POT      78       POT     -7261 PROB     GLU      481      CG            3.3027
53135 POS      POT      78       POT     -7264 PROB     GLU      481      CD            3.1437
53135 POS      POT      78       POT     -7265 PROB     GLU      481      OE1           2.8960
53135 POS      POT      78       POT     -7266 PROB     GLU      481      OE2           3.9357
53135 POS      POT      78       POT     -7267 PROB     GLU      481      C             3.8000
53135 POS      POT      78       POT     -7268 PROB     GLU      481      O             3.7721
53135 POS      POT      78       POT     -7281 PROB     PHE      482      CZ            4.7748
53135 POS      POT      78       POT     -7285 PROB     PHE      482      CE2           4.6775
53135 POS      POT      78       POT     -8552 PROD     LYS      12       CA            5.0849
53135 POS      POT      78       POT     -8570 PROD     LYS      12       C             4.2730
53135 POS      POT      78       POT     -8572 PROD     PRO      13       N             3.1770
53135 POS      POT      78       POT     -8573 PROD     PRO      13       CD            2.7920
53135 POS      POT      78       POT     -8576 PROD     PRO      13       CA            2.9468
53135 POS      POT      78       POT     -8578 PROD     PRO      13       CB            2.3925
53135 POS      POT      78       POT     -8581 PROD     PRO      13       CG            1.8307
53135 POS      POT      78       POT     -8584 PROD     PRO      13       C             2.8628
53135 POS      POT      78       POT     -8585 PROD     PRO      13       O             2.5779
53135 POS      POT      78       POT     -**** PROF     LEU      156      CD1           4.7058
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        21
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "21"
 Comparing "21" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "78" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.588557683"
Evaluating: 112.065471*(0.588557683-0.5)
 Parameter: XPOS <- "9.92425846"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.141078008"
Evaluating: 112.065471*(0.141078008-0.5)
 Parameter: YPOS <- "-40.2227621"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.23574593"
Evaluating: 142.885239*(0.23574593-0.5)+2.93414115
 Parameter: ZPOS <- "-34.8238648"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.8238648" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.335647 XMAX =  -13.335647 XAVE =  -13.335647
    YMIN =    4.022465 YMAX =    4.022465 YAVE =    4.022465
    ZMIN =   20.644843 ZMAX =   20.644843 ZAVE =   20.644843
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.92425846"
 RDCMND substituted energy or value "?XAVE" to "-13.3356473"
Evaluating: 9.92425846--13.3356473
 Parameter: XTRAN <- "23.2599058"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.2227621"
 RDCMND substituted energy or value "?YAVE" to "4.02246513"
Evaluating: -40.2227621-4.02246513
 Parameter: YTRAN <- "-44.2452272"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.8238648"
 RDCMND substituted energy or value "?ZAVE" to "20.6448431"
Evaluating: -34.8238648-20.6448431
 Parameter: ZTRAN <- "-55.4687079"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.2599058"
 Parameter: YTRAN -> "-44.2452272"
 Parameter: ZTRAN -> "-55.4687079"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    23.259906  -44.245227  -55.468708
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.958436677E-02"
Evaluating: 3.958436677E-02*360.0
 Parameter: XPHI <- "14.250372"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.486265935"
Evaluating: 0.486265935*360.0
 Parameter: YPHI <- "175.055737"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.874248527"
Evaluating: 0.874248527*360.0
 Parameter: ZPHI <- "314.72947"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.92425846"
 Parameter: YPOS -> "-40.2227621"
 Parameter: ZPOS -> "-34.8238648"
 Parameter: XPHI -> "14.250372"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.969229    0.246160
    0.000000   -0.246160    0.969229

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   14.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.92425846"
 Parameter: YPOS -> "-40.2227621"
 Parameter: ZPOS -> "-34.8238648"
 Parameter: YPHI -> "175.055737"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.996279    0.000000   -0.086187
    0.000000    1.000000    0.000000
    0.086187    0.000000   -0.996279

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  175.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.92425846"
 Parameter: YPOS -> "-40.2227621"
 Parameter: ZPOS -> "-34.8238648"
 Parameter: ZPHI -> "314.72947"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.703760   -0.710438    0.000000
    0.710438    0.703760    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.924258 XMAX =    9.924258 XAVE =    9.924258
    YMIN =  -40.222762 YMAX =  -40.222762 YAVE =  -40.222762
    ZMIN =  -34.823865 ZMAX =  -34.823865 ZAVE =  -34.823865
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.92425841"
Evaluating: 9.92425841+3.5
 Parameter: XMAX <- "13.4242584"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.2227621"
Evaluating: -40.2227621+3.5
 Parameter: YMAX <- "-36.7227621"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.8238648"
Evaluating: -34.8238648+3.5
 Parameter: ZMAX <- "-31.3238648"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.92425841"
Evaluating: 9.92425841-3.5
 Parameter: XMIN <- "6.42425841"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.2227621"
Evaluating: -40.2227621-3.5
 Parameter: YMIN <- "-43.7227621"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.8238648"
Evaluating: -34.8238648-3.5
 Parameter: ZMIN <- "-38.3238648"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.4242584"
 Parameter: XMIN -> "6.42425841"
 Parameter: YMAX -> "-36.7227621"
 Parameter: YMIN -> "-43.7227621"
 Parameter: ZMAX -> "-31.3238648"
 Parameter: ZMIN -> "-38.3238648"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "79"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "79" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "79" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.605504448"
Evaluating: 112.065471*(0.605504448-0.5)
 Parameter: XPOS <- "11.8234057"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.985078039"
Evaluating: 112.065471*(0.985078039-0.5)
 Parameter: YPOS <- "54.3604989"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.390996076"
Evaluating: 142.885239*(0.390996076-0.5)+2.93414115
 Parameter: ZPOS <- "-12.6409106"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.6409106" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.6409106" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "79" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.52005495"
Evaluating: 112.065471*(0.52005495-0.5)
 Parameter: XPOS <- "2.24746742"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.708568134"
Evaluating: 112.065471*(0.708568134-0.5)
 Parameter: YPOS <- "23.3732862"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.391780378"
Evaluating: 142.885239*(0.391780378-0.5)+2.93414115
 Parameter: ZPOS <- "-12.5288454"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.5288454" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.5288454" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "79" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.839066281E-03"
Evaluating: 112.065471*(7.839066281E-03-0.5)
 Parameter: XPOS <- "-55.1542468"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.875688774"
Evaluating: 112.065471*(0.875688774-0.5)
 Parameter: YPOS <- "42.1017394"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.575341541"
Evaluating: 142.885239*(0.575341541-0.5)+2.93414115
 Parameter: ZPOS <- "13.6993352"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.6993352" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.6993352" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "79" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.560268161"
Evaluating: 112.065471*(0.560268161-0.5)
 Parameter: XPOS <- "6.75397985"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.498480802"
Evaluating: 112.065471*(0.498480802-0.5)
 Parameter: YPOS <- "-0.170249639"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.861095602"
Evaluating: 142.885239*(0.861095602-0.5)+2.93414115
 Parameter: ZPOS <- "54.5293725"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.5293725" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.5293725" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.75397985"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.75397985-0
 Parameter: XTRAN <- "6.75397985"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.170249639"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.170249639-0
 Parameter: YTRAN <- "-0.170249639"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.5293725"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 54.5293725-0
 Parameter: ZTRAN <- "54.5293725"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.75397985"
 Parameter: YTRAN -> "-0.170249639"
 Parameter: ZTRAN -> "54.5293725"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     6.753980   -0.170250   54.529373
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.699531498"
Evaluating: 0.699531498*360.0
 Parameter: XPHI <- "251.831339"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.31867403"
Evaluating: 0.31867403*360.0
 Parameter: YPHI <- "114.722651"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.169818663"
Evaluating: 0.169818663*360.0
 Parameter: ZPHI <- "61.1347187"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.75397985"
 Parameter: YPOS -> "-0.170249639"
 Parameter: ZPOS -> "54.5293725"
 Parameter: XPHI -> "251.831339"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.311815   -0.950143
    0.000000    0.950143   -0.311815

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  108.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.75397985"
 Parameter: YPOS -> "-0.170249639"
 Parameter: ZPOS -> "54.5293725"
 Parameter: YPHI -> "114.722651"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.418226    0.000000   -0.908343
    0.000000    1.000000    0.000000
    0.908343    0.000000   -0.418226

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  114.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.75397985"
 Parameter: YPOS -> "-0.170249639"
 Parameter: ZPOS -> "54.5293725"
 Parameter: ZPHI -> "61.1347187"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.482752    0.875757    0.000000
   -0.875757    0.482752    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   61.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.753980 XMAX =    6.753980 XAVE =    6.753980
    YMIN =   -0.170250 YMAX =   -0.170250 YAVE =   -0.170250
    ZMIN =   54.529373 ZMAX =   54.529373 ZAVE =   54.529373
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.75397985"
Evaluating: 6.75397985+3.5
 Parameter: XMAX <- "10.2539799"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.170249639"
Evaluating: -0.170249639+3.5
 Parameter: YMAX <- "3.32975036"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.5293725"
Evaluating: 54.5293725+3.5
 Parameter: ZMAX <- "58.0293725"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.75397985"
Evaluating: 6.75397985-3.5
 Parameter: XMIN <- "3.25397985"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.170249639"
Evaluating: -0.170249639-3.5
 Parameter: YMIN <- "-3.67024964"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.5293725"
Evaluating: 54.5293725-3.5
 Parameter: ZMIN <- "51.0293725"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.2539799"
 Parameter: XMIN -> "3.25397985"
 Parameter: YMAX -> "3.32975036"
 Parameter: YMIN -> "-3.67024964"
 Parameter: ZMAX -> "58.0293725"
 Parameter: ZMIN -> "51.0293725"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "80"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "80" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "80" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.496447069"
Evaluating: 112.065471*(0.496447069-0.5)
 Parameter: XPOS <- "-0.398160886"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.912316678"
Evaluating: 112.065471*(0.912316678-0.5)
 Parameter: YPOS <- "46.2064627"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.573751221"
Evaluating: 142.885239*(0.573751221-0.5)+2.93414115
 Parameter: ZPOS <- "13.472102"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.472102" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.472102" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "80" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.302419018"
Evaluating: 112.065471*(0.302419018-0.5)
 Parameter: XPOS <- "-22.1420058"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.889479515"
Evaluating: 112.065471*(0.889479515-0.5)
 Parameter: YPOS <- "43.6472053"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.259812345"
Evaluating: 142.885239*(0.259812345-0.5)+2.93414115
 Parameter: ZPOS <- "-31.3851293"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.3851293" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.1420058"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.1420058-0
 Parameter: XTRAN <- "-22.1420058"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.6472053"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 43.6472053-0
 Parameter: YTRAN <- "43.6472053"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.3851293"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.3851293-0
 Parameter: ZTRAN <- "-31.3851293"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.1420058"
 Parameter: YTRAN -> "43.6472053"
 Parameter: ZTRAN -> "-31.3851293"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -22.142006   43.647205  -31.385129
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.384045573"
Evaluating: 0.384045573*360.0
 Parameter: XPHI <- "138.256406"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.367221983"
Evaluating: 0.367221983*360.0
 Parameter: YPHI <- "132.199914"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.409389598"
Evaluating: 0.409389598*360.0
 Parameter: ZPHI <- "147.380255"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.1420058"
 Parameter: YPOS -> "43.6472053"
 Parameter: ZPOS -> "-31.3851293"
 Parameter: XPHI -> "138.256406"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.746132    0.665798
    0.000000   -0.665798   -0.746132

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  138.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.1420058"
 Parameter: YPOS -> "43.6472053"
 Parameter: ZPOS -> "-31.3851293"
 Parameter: YPHI -> "132.199914"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.671719    0.000000   -0.740806
    0.000000    1.000000    0.000000
    0.740806    0.000000   -0.671719

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  132.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.1420058"
 Parameter: YPOS -> "43.6472053"
 Parameter: ZPOS -> "-31.3851293"
 Parameter: ZPHI -> "147.380255"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.842267    0.539061    0.000000
   -0.539061   -0.842267    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  147.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.142006 XMAX =  -22.142006 XAVE =  -22.142006
    YMIN =   43.647205 YMAX =   43.647205 YAVE =   43.647205
    ZMIN =  -31.385129 ZMAX =  -31.385129 ZAVE =  -31.385129
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.1420058"
Evaluating: -22.1420058+3.5
 Parameter: XMAX <- "-18.6420058"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.6472053"
Evaluating: 43.6472053+3.5
 Parameter: YMAX <- "47.1472053"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.3851293"
Evaluating: -31.3851293+3.5
 Parameter: ZMAX <- "-27.8851293"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.1420058"
Evaluating: -22.1420058-3.5
 Parameter: XMIN <- "-25.6420058"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.6472053"
Evaluating: 43.6472053-3.5
 Parameter: YMIN <- "40.1472053"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.3851293"
Evaluating: -31.3851293-3.5
 Parameter: ZMIN <- "-34.8851293"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.6420058"
 Parameter: XMIN -> "-25.6420058"
 Parameter: YMAX -> "47.1472053"
 Parameter: YMIN -> "40.1472053"
 Parameter: ZMAX -> "-27.8851293"
 Parameter: ZMIN -> "-34.8851293"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "81"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "81" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "81" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.418301445"
Evaluating: 112.065471*(0.418301445-0.5)
 Parameter: XPOS <- "-9.15558705"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.660187021"
Evaluating: 112.065471*(0.660187021-0.5)
 Parameter: YPOS <- "17.951434"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.674669611"
Evaluating: 142.885239*(0.674669611-0.5)+2.93414115
 Parameter: ZPOS <- "27.8918503"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.8918503" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.8918503" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.15558705"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.15558705-0
 Parameter: XTRAN <- "-9.15558705"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.951434"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.951434-0
 Parameter: YTRAN <- "17.951434"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.8918503"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.8918503-0
 Parameter: ZTRAN <- "27.8918503"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.15558705"
 Parameter: YTRAN -> "17.951434"
 Parameter: ZTRAN -> "27.8918503"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -9.155587   17.951434   27.891850
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313285082"
Evaluating: 0.313285082*360.0
 Parameter: XPHI <- "112.78263"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179043152"
Evaluating: 0.179043152*360.0
 Parameter: YPHI <- "64.4555347"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.649323651"
Evaluating: 0.649323651*360.0
 Parameter: ZPHI <- "233.756514"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.15558705"
 Parameter: YPOS -> "17.951434"
 Parameter: ZPOS -> "27.8918503"
 Parameter: XPHI -> "112.78263"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.387236    0.921981
    0.000000   -0.921981   -0.387236

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.15558705"
 Parameter: YPOS -> "17.951434"
 Parameter: ZPOS -> "27.8918503"
 Parameter: YPHI -> "64.4555347"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.431211    0.000000   -0.902251
    0.000000    1.000000    0.000000
    0.902251    0.000000    0.431211

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   64.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.15558705"
 Parameter: YPOS -> "17.951434"
 Parameter: ZPOS -> "27.8918503"
 Parameter: ZPHI -> "233.756514"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.591218   -0.806512    0.000000
    0.806512   -0.591218    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  126.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.155587 XMAX =   -9.155587 XAVE =   -9.155587
    YMIN =   17.951434 YMAX =   17.951434 YAVE =   17.951434
    ZMIN =   27.891850 ZMAX =   27.891850 ZAVE =   27.891850
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.15558705"
Evaluating: -9.15558705+3.5
 Parameter: XMAX <- "-5.65558705"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.951434"
Evaluating: 17.951434+3.5
 Parameter: YMAX <- "21.451434"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.8918503"
Evaluating: 27.8918503+3.5
 Parameter: ZMAX <- "31.3918503"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.15558705"
Evaluating: -9.15558705-3.5
 Parameter: XMIN <- "-12.655587"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.951434"
Evaluating: 17.951434-3.5
 Parameter: YMIN <- "14.451434"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.8918503"
Evaluating: 27.8918503-3.5
 Parameter: ZMIN <- "24.3918503"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.65558705"
 Parameter: XMIN -> "-12.655587"
 Parameter: YMAX -> "21.451434"
 Parameter: YMIN -> "14.451434"
 Parameter: ZMAX -> "31.3918503"
 Parameter: ZMIN -> "24.3918503"
 SELRPN>      8 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      4 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53138 POS      POT      81       POT     -**** PROF     GLN      208      CG            4.9641
53138 POS      POT      81       POT     -**** PROF     GLN      208      CD            3.6443
53138 POS      POT      81       POT     -**** PROF     GLN      208      OE1           3.8825
53138 POS      POT      81       POT     -**** PROF     GLN      208      NE2           2.5981
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "81" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.788375209"
Evaluating: 112.065471*(0.788375209-0.5)
 Parameter: XPOS <- "32.3169036"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.416711775"
Evaluating: 112.065471*(0.416711775-0.5)
 Parameter: YPOS <- "-9.33373416"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.60709511"
Evaluating: 142.885239*(0.60709511-0.5)+2.93414115
 Parameter: ZPOS <- "18.2364515"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.2364515" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.2364515" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.155587 XMAX =   -9.155587 XAVE =   -9.155587
    YMIN =   17.951434 YMAX =   17.951434 YAVE =   17.951434
    ZMIN =   27.891850 ZMAX =   27.891850 ZAVE =   27.891850
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.3169036"
 RDCMND substituted energy or value "?XAVE" to "-9.15558705"
Evaluating: 32.3169036--9.15558705
 Parameter: XTRAN <- "41.4724907"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.33373416"
 RDCMND substituted energy or value "?YAVE" to "17.951434"
Evaluating: -9.33373416-17.951434
 Parameter: YTRAN <- "-27.2851682"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.2364515"
 RDCMND substituted energy or value "?ZAVE" to "27.8918503"
Evaluating: 18.2364515-27.8918503
 Parameter: ZTRAN <- "-9.6553988"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.4724907"
 Parameter: YTRAN -> "-27.2851682"
 Parameter: ZTRAN -> "-9.6553988"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    41.472491  -27.285168   -9.655399
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.968296911"
Evaluating: 0.968296911*360.0
 Parameter: XPHI <- "348.586888"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.444738824"
Evaluating: 0.444738824*360.0
 Parameter: YPHI <- "160.105977"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.576949309"
Evaluating: 0.576949309*360.0
 Parameter: ZPHI <- "207.701751"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.3169036"
 Parameter: YPOS -> "-9.33373416"
 Parameter: ZPOS -> "18.2364515"
 Parameter: XPHI -> "348.586888"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.980226   -0.197882
    0.000000    0.197882    0.980226

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   11.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.3169036"
 Parameter: YPOS -> "-9.33373416"
 Parameter: ZPOS -> "18.2364515"
 Parameter: YPHI -> "160.105977"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.940324    0.000000   -0.340281
    0.000000    1.000000    0.000000
    0.340281    0.000000   -0.940324

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  160.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.3169036"
 Parameter: YPOS -> "-9.33373416"
 Parameter: ZPOS -> "18.2364515"
 Parameter: ZPHI -> "207.701751"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.885379   -0.464869    0.000000
    0.464869   -0.885379    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  152.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.316904 XMAX =   32.316904 XAVE =   32.316904
    YMIN =   -9.333734 YMAX =   -9.333734 YAVE =   -9.333734
    ZMIN =   18.236452 ZMAX =   18.236452 ZAVE =   18.236452
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.3169037"
Evaluating: 32.3169037+3.5
 Parameter: XMAX <- "35.8169037"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.33373415"
Evaluating: -9.33373415+3.5
 Parameter: YMAX <- "-5.83373415"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.2364515"
Evaluating: 18.2364515+3.5
 Parameter: ZMAX <- "21.7364515"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.3169037"
Evaluating: 32.3169037-3.5
 Parameter: XMIN <- "28.8169037"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.33373415"
Evaluating: -9.33373415-3.5
 Parameter: YMIN <- "-12.8337341"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.2364515"
Evaluating: 18.2364515-3.5
 Parameter: ZMIN <- "14.7364515"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.8169037"
 Parameter: XMIN -> "28.8169037"
 Parameter: YMAX -> "-5.83373415"
 Parameter: YMIN -> "-12.8337341"
 Parameter: ZMAX -> "21.7364515"
 Parameter: ZMIN -> "14.7364515"
 SELRPN>     14 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      7 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53138 POS      POT      81       POT     -**** MEMB     POPC     41       C13           3.3513
53138 POS      POT      81       POT     -**** MEMB     POPC     41       P             3.3379
53138 POS      POT      81       POT     -**** MEMB     POPC     41       O14           2.2865
53138 POS      POT      81       POT     -**** MEMB     POPC     41       O11           3.4096
53138 POS      POT      81       POT     -**** MEMB     POPC     41       C1            3.2570
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "81" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.320544151"
Evaluating: 112.065471*(0.320544151-0.5)
 Parameter: XPOS <- "-20.1108042"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.650038305"
Evaluating: 112.065471*(0.650038305-0.5)
 Parameter: YPOS <- "16.8141133"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "6.14258101E-02"
Evaluating: 142.885239*(6.14258101E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-59.7316368"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-59.7316368" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.316904 XMAX =   32.316904 XAVE =   32.316904
    YMIN =   -9.333734 YMAX =   -9.333734 YAVE =   -9.333734
    ZMIN =   18.236452 ZMAX =   18.236452 ZAVE =   18.236452
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.1108042"
 RDCMND substituted energy or value "?XAVE" to "32.3169037"
Evaluating: -20.1108042-32.3169037
 Parameter: XTRAN <- "-52.4277079"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.8141133"
 RDCMND substituted energy or value "?YAVE" to "-9.33373415"
Evaluating: 16.8141133--9.33373415
 Parameter: YTRAN <- "26.1478475"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-59.7316368"
 RDCMND substituted energy or value "?ZAVE" to "18.2364515"
Evaluating: -59.7316368-18.2364515
 Parameter: ZTRAN <- "-77.9680883"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.4277079"
 Parameter: YTRAN -> "26.1478475"
 Parameter: ZTRAN -> "-77.9680883"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -52.427708   26.147848  -77.968088
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.56793308"
Evaluating: 0.56793308*360.0
 Parameter: XPHI <- "204.455909"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.95281586"
Evaluating: 0.95281586*360.0
 Parameter: YPHI <- "343.01371"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.888728303"
Evaluating: 0.888728303*360.0
 Parameter: ZPHI <- "319.942189"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.1108042"
 Parameter: YPOS -> "16.8141133"
 Parameter: ZPOS -> "-59.7316368"
 Parameter: XPHI -> "204.455909"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.910280   -0.413993
    0.000000    0.413993   -0.910280

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  155.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.1108042"
 Parameter: YPOS -> "16.8141133"
 Parameter: ZPOS -> "-59.7316368"
 Parameter: YPHI -> "343.01371"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.956375    0.000000    0.292143
    0.000000    1.000000    0.000000
   -0.292143    0.000000    0.956375

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   16.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.1108042"
 Parameter: YPOS -> "16.8141133"
 Parameter: ZPOS -> "-59.7316368"
 Parameter: ZPHI -> "319.942189"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.765395   -0.643560    0.000000
    0.643560    0.765395    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   40.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.110804 XMAX =  -20.110804 XAVE =  -20.110804
    YMIN =   16.814113 YMAX =   16.814113 YAVE =   16.814113
    ZMIN =  -59.731637 ZMAX =  -59.731637 ZAVE =  -59.731637
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.1108042"
Evaluating: -20.1108042+3.5
 Parameter: XMAX <- "-16.6108042"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.8141132"
Evaluating: 16.8141132+3.5
 Parameter: YMAX <- "20.3141132"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-59.7316368"
Evaluating: -59.7316368+3.5
 Parameter: ZMAX <- "-56.2316368"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.1108042"
Evaluating: -20.1108042-3.5
 Parameter: XMIN <- "-23.6108042"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.8141132"
Evaluating: 16.8141132-3.5
 Parameter: YMIN <- "13.3141132"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-59.7316368"
Evaluating: -59.7316368-3.5
 Parameter: ZMIN <- "-63.2316368"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.6108042"
 Parameter: XMIN -> "-23.6108042"
 Parameter: YMAX -> "20.3141132"
 Parameter: YMIN -> "13.3141132"
 Parameter: ZMAX -> "-56.2316368"
 Parameter: ZMIN -> "-63.2316368"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "82"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "82" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "82" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.160011382"
Evaluating: 112.065471*(0.160011382-0.5)
 Parameter: XPOS <- "-38.1009846"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.290175426"
Evaluating: 112.065471*(0.290175426-0.5)
 Parameter: YPOS <- "-23.5140897"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.407692534"
Evaluating: 142.885239*(0.407692534-0.5)+2.93414115
 Parameter: ZPOS <- "-10.2552332"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.2552332" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.2552332" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "82" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.984910254"
Evaluating: 112.065471*(0.984910254-0.5)
 Parameter: XPOS <- "54.341696"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.721572679"
Evaluating: 112.065471*(0.721572679-0.5)
 Parameter: YPOS <- "24.8306466"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.605951247"
Evaluating: 142.885239*(0.605951247-0.5)+2.93414115
 Parameter: ZPOS <- "18.0730104"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.0730104" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.0730104" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "54.341696"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 54.341696-0
 Parameter: XTRAN <- "54.341696"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.8306466"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.8306466-0
 Parameter: YTRAN <- "24.8306466"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.0730104"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 18.0730104-0
 Parameter: ZTRAN <- "18.0730104"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "54.341696"
 Parameter: YTRAN -> "24.8306466"
 Parameter: ZTRAN -> "18.0730104"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    54.341696   24.830647   18.073010
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.343213627"
Evaluating: 0.343213627*360.0
 Parameter: XPHI <- "123.556906"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.979389344"
Evaluating: 0.979389344*360.0
 Parameter: YPHI <- "352.580164"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.246608482E-03"
Evaluating: 8.246608482E-03*360.0
 Parameter: ZPHI <- "2.96877905"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "54.341696"
 Parameter: YPOS -> "24.8306466"
 Parameter: ZPOS -> "18.0730104"
 Parameter: XPHI -> "123.556906"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.552765    0.833337
    0.000000   -0.833337   -0.552765

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  123.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "54.341696"
 Parameter: YPOS -> "24.8306466"
 Parameter: ZPOS -> "18.0730104"
 Parameter: YPHI -> "352.580164"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.991627    0.000000    0.129139
    0.000000    1.000000    0.000000
   -0.129139    0.000000    0.991627

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    7.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "54.341696"
 Parameter: YPOS -> "24.8306466"
 Parameter: ZPOS -> "18.0730104"
 Parameter: ZPHI -> "2.96877905"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.998658    0.051792    0.000000
   -0.051792    0.998658    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    2.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   54.341696 XMAX =   54.341696 XAVE =   54.341696
    YMIN =   24.830647 YMAX =   24.830647 YAVE =   24.830647
    ZMIN =   18.073010 ZMAX =   18.073010 ZAVE =   18.073010
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "54.341696"
Evaluating: 54.341696+3.5
 Parameter: XMAX <- "57.841696"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.8306466"
Evaluating: 24.8306466+3.5
 Parameter: YMAX <- "28.3306466"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.0730104"
Evaluating: 18.0730104+3.5
 Parameter: ZMAX <- "21.5730104"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "54.341696"
Evaluating: 54.341696-3.5
 Parameter: XMIN <- "50.841696"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.8306466"
Evaluating: 24.8306466-3.5
 Parameter: YMIN <- "21.3306466"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.0730104"
Evaluating: 18.0730104-3.5
 Parameter: ZMIN <- "14.5730104"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.841696"
 Parameter: XMIN -> "50.841696"
 Parameter: YMAX -> "28.3306466"
 Parameter: YMIN -> "21.3306466"
 Parameter: ZMAX -> "21.5730104"
 Parameter: ZMIN -> "14.5730104"
 SELRPN>     33 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     18 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53139 POS      POT      82       POT     -**** MEMB     POPC     117      O11           3.0345
53139 POS      POT      82       POT     -**** MEMB     POPC     117      C1            2.6785
53139 POS      POT      82       POT     -**** MEMB     POPC     117      C2            2.3584
53139 POS      POT      82       POT     -**** MEMB     POPC     117      O21           3.5205
53139 POS      POT      82       POT     -**** MEMB     POPC     117      C3            1.3241
53139 POS      POT      82       POT     -**** MEMB     POPC     117      O31           1.7531
53139 POS      POT      82       POT     -**** MEMB     POPC     117      C31           2.9994
53139 POS      POT      82       POT     -**** MEMB     POPC     117      O32           3.6911
53139 POS      POT      82       POT     -**** MEMB     POPC     136      N             3.7526
53139 POS      POT      82       POT     -**** MEMB     POPC     136      C12           3.5774
53139 POS      POT      82       POT     -**** MEMB     POPC     136      C15           2.8796
53139 POS      POT      82       POT     -**** MEMB     POPC     136      C11           3.2467
53139 POS      POT      82       POT     -**** MEMB     POPC     136      P             2.5982
53139 POS      POT      82       POT     -**** MEMB     POPC     136      O13           1.7820
53139 POS      POT      82       POT     -**** MEMB     POPC     136      O12           2.3272
53139 POS      POT      82       POT     -**** MEMB     POPC     136      O11           3.7297
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        16
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "16"
 Comparing "16" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "82" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.794790824"
Evaluating: 112.065471*(0.794790824-0.5)
 Parameter: XPOS <- "33.0358725"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.191295996"
Evaluating: 112.065471*(0.191295996-0.5)
 Parameter: YPOS <- "-34.5950596"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.858833324"
Evaluating: 142.885239*(0.858833324-0.5)+2.93414115
 Parameter: ZPOS <- "54.2061264"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.2061264" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.2061264" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   54.341696 XMAX =   54.341696 XAVE =   54.341696
    YMIN =   24.830647 YMAX =   24.830647 YAVE =   24.830647
    ZMIN =   18.073010 ZMAX =   18.073010 ZAVE =   18.073010
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.0358725"
 RDCMND substituted energy or value "?XAVE" to "54.341696"
Evaluating: 33.0358725-54.341696
 Parameter: XTRAN <- "-21.3058235"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.5950596"
 RDCMND substituted energy or value "?YAVE" to "24.8306466"
Evaluating: -34.5950596-24.8306466
 Parameter: YTRAN <- "-59.4257062"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.2061264"
 RDCMND substituted energy or value "?ZAVE" to "18.0730104"
Evaluating: 54.2061264-18.0730104
 Parameter: ZTRAN <- "36.133116"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.3058235"
 Parameter: YTRAN -> "-59.4257062"
 Parameter: ZTRAN -> "36.133116"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -21.305823  -59.425706   36.133116
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.80933038"
Evaluating: 0.80933038*360.0
 Parameter: XPHI <- "291.358937"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.560150549"
Evaluating: 0.560150549*360.0
 Parameter: YPHI <- "201.654198"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.292644227"
Evaluating: 0.292644227*360.0
 Parameter: ZPHI <- "105.351922"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.0358725"
 Parameter: YPOS -> "-34.5950596"
 Parameter: ZPOS -> "54.2061264"
 Parameter: XPHI -> "291.358937"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.364209   -0.931317
    0.000000    0.931317    0.364209

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   68.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.0358725"
 Parameter: YPOS -> "-34.5950596"
 Parameter: ZPOS -> "54.2061264"
 Parameter: YPHI -> "201.654198"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.929428    0.000000    0.369004
    0.000000    1.000000    0.000000
   -0.369004    0.000000   -0.929428

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  158.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.0358725"
 Parameter: YPOS -> "-34.5950596"
 Parameter: ZPOS -> "54.2061264"
 Parameter: ZPHI -> "105.351922"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.264747    0.964318    0.000000
   -0.964318   -0.264747    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  105.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.035873 XMAX =   33.035873 XAVE =   33.035873
    YMIN =  -34.595060 YMAX =  -34.595060 YAVE =  -34.595060
    ZMIN =   54.206126 ZMAX =   54.206126 ZAVE =   54.206126
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.0358725"
Evaluating: 33.0358725+3.5
 Parameter: XMAX <- "36.5358725"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.5950596"
Evaluating: -34.5950596+3.5
 Parameter: YMAX <- "-31.0950596"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.2061264"
Evaluating: 54.2061264+3.5
 Parameter: ZMAX <- "57.7061264"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.0358725"
Evaluating: 33.0358725-3.5
 Parameter: XMIN <- "29.5358725"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.5950596"
Evaluating: -34.5950596-3.5
 Parameter: YMIN <- "-38.0950596"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.2061264"
Evaluating: 54.2061264-3.5
 Parameter: ZMIN <- "50.7061264"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.5358725"
 Parameter: XMIN -> "29.5358725"
 Parameter: YMAX -> "-31.0950596"
 Parameter: YMIN -> "-38.0950596"
 Parameter: ZMAX -> "57.7061264"
 Parameter: ZMIN -> "50.7061264"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "83"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "83" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "83" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.956388019E-02"
Evaluating: 112.065471*(4.956388019E-02-0.5)
 Parameter: XPOS <- "-50.4783359"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.356582946"
Evaluating: 112.065471*(0.356582946-0.5)
 Parameter: YPOS <- "-16.0720997"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.178895435"
Evaluating: 142.885239*(0.178895435-0.5)+2.93414115
 Parameter: ZPOS <- "-42.9469614"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.9469614" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.4783359"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -50.4783359-0
 Parameter: XTRAN <- "-50.4783359"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.0720997"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -16.0720997-0
 Parameter: YTRAN <- "-16.0720997"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.9469614"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.9469614-0
 Parameter: ZTRAN <- "-42.9469614"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.4783359"
 Parameter: YTRAN -> "-16.0720997"
 Parameter: ZTRAN -> "-42.9469614"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -50.478336  -16.072100  -42.946961
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.345805775"
Evaluating: 0.345805775*360.0
 Parameter: XPHI <- "124.490079"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.107472216"
Evaluating: 0.107472216*360.0
 Parameter: YPHI <- "38.6899978"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.114781596"
Evaluating: 0.114781596*360.0
 Parameter: ZPHI <- "41.3213746"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.4783359"
 Parameter: YPOS -> "-16.0720997"
 Parameter: ZPOS -> "-42.9469614"
 Parameter: XPHI -> "124.490079"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.566264    0.824224
    0.000000   -0.824224   -0.566264

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  124.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.4783359"
 Parameter: YPOS -> "-16.0720997"
 Parameter: ZPOS -> "-42.9469614"
 Parameter: YPHI -> "38.6899978"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.780540    0.000000   -0.625106
    0.000000    1.000000    0.000000
    0.625106    0.000000    0.780540

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   38.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.4783359"
 Parameter: YPOS -> "-16.0720997"
 Parameter: ZPOS -> "-42.9469614"
 Parameter: ZPHI -> "41.3213746"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.751018    0.660282    0.000000
   -0.660282    0.751018    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   41.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.478336 XMAX =  -50.478336 XAVE =  -50.478336
    YMIN =  -16.072100 YMAX =  -16.072100 YAVE =  -16.072100
    ZMIN =  -42.946961 ZMAX =  -42.946961 ZAVE =  -42.946961
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.4783359"
Evaluating: -50.4783359+3.5
 Parameter: XMAX <- "-46.9783359"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.0720997"
Evaluating: -16.0720997+3.5
 Parameter: YMAX <- "-12.5720997"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.9469614"
Evaluating: -42.9469614+3.5
 Parameter: ZMAX <- "-39.4469614"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.4783359"
Evaluating: -50.4783359-3.5
 Parameter: XMIN <- "-53.9783359"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.0720997"
Evaluating: -16.0720997-3.5
 Parameter: YMIN <- "-19.5720997"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.9469614"
Evaluating: -42.9469614-3.5
 Parameter: ZMIN <- "-46.4469614"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.9783359"
 Parameter: XMIN -> "-53.9783359"
 Parameter: YMAX -> "-12.5720997"
 Parameter: YMIN -> "-19.5720997"
 Parameter: ZMAX -> "-39.4469614"
 Parameter: ZMIN -> "-46.4469614"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "84"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "84" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "84" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.721092891"
Evaluating: 112.065471*(0.721092891-0.5)
 Parameter: XPOS <- "24.776879"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.972547348"
Evaluating: 112.065471*(0.972547348-0.5)
 Parameter: YPOS <- "52.9562411"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.60885593"
Evaluating: 142.885239*(0.60885593-0.5)+2.93414115
 Parameter: ZPOS <- "18.4880467"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.4880467" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.4880467" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.776879"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.776879-0
 Parameter: XTRAN <- "24.776879"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "52.9562411"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 52.9562411-0
 Parameter: YTRAN <- "52.9562411"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.4880467"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 18.4880467-0
 Parameter: ZTRAN <- "18.4880467"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.776879"
 Parameter: YTRAN -> "52.9562411"
 Parameter: ZTRAN -> "18.4880467"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    24.776879   52.956241   18.488047
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.172420041"
Evaluating: 0.172420041*360.0
 Parameter: XPHI <- "62.0712148"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.995074507"
Evaluating: 0.995074507*360.0
 Parameter: YPHI <- "358.226823"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.717411159"
Evaluating: 0.717411159*360.0
 Parameter: ZPHI <- "258.268017"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.776879"
 Parameter: YPOS -> "52.9562411"
 Parameter: ZPOS -> "18.4880467"
 Parameter: XPHI -> "62.0712148"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.468374    0.883530
    0.000000   -0.883530    0.468374

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   62.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.776879"
 Parameter: YPOS -> "52.9562411"
 Parameter: ZPOS -> "18.4880467"
 Parameter: YPHI -> "358.226823"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.999521    0.000000    0.030943
    0.000000    1.000000    0.000000
   -0.030943    0.000000    0.999521

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    1.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.776879"
 Parameter: YPOS -> "52.9562411"
 Parameter: ZPOS -> "18.4880467"
 Parameter: ZPHI -> "258.268017"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.203334   -0.979109    0.000000
    0.979109   -0.203334    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  101.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.776879 XMAX =   24.776879 XAVE =   24.776879
    YMIN =   52.956241 YMAX =   52.956241 YAVE =   52.956241
    ZMIN =   18.488047 ZMAX =   18.488047 ZAVE =   18.488047
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.776879"
Evaluating: 24.776879+3.5
 Parameter: XMAX <- "28.276879"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "52.9562411"
Evaluating: 52.9562411+3.5
 Parameter: YMAX <- "56.4562411"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.4880467"
Evaluating: 18.4880467+3.5
 Parameter: ZMAX <- "21.9880467"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.776879"
Evaluating: 24.776879-3.5
 Parameter: XMIN <- "21.276879"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "52.9562411"
Evaluating: 52.9562411-3.5
 Parameter: YMIN <- "49.4562411"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.4880467"
Evaluating: 18.4880467-3.5
 Parameter: ZMIN <- "14.9880467"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.276879"
 Parameter: XMIN -> "21.276879"
 Parameter: YMAX -> "56.4562411"
 Parameter: YMIN -> "49.4562411"
 Parameter: ZMAX -> "21.9880467"
 Parameter: ZMIN -> "14.9880467"
 SELRPN>     31 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     12 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53141 POS      POT      84       POT     -**** MEMB     POPC     121      N             2.1247
53141 POS      POT      84       POT     -**** MEMB     POPC     121      C12           2.0981
53141 POS      POT      84       POT     -**** MEMB     POPC     121      C13           2.1173
53141 POS      POT      84       POT     -**** MEMB     POPC     121      C14           3.5998
53141 POS      POT      84       POT     -**** MEMB     POPC     121      C15           2.3561
53141 POS      POT      84       POT     -**** MEMB     POPC     121      C11           3.0418
53141 POS      POT      84       POT     -**** MEMB     POPC     121      O14           3.7922
53141 POS      POT      84       POT     -**** MEMB     POPC     121      O12           2.9435
53141 POS      POT      84       POT     -**** MEMB     POPC     126      C13           3.5826
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "84" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.731608984"
Evaluating: 112.065471*(0.731608984-0.5)
 Parameter: XPOS <- "25.9553699"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.699769179"
Evaluating: 112.065471*(0.699769179-0.5)
 Parameter: YPOS <- "22.3872271"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.463918984"
Evaluating: 142.885239*(0.463918984-0.5)+2.93414115
 Parameter: ZPOS <- "-2.22130344"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.22130344" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.22130344" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "84" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.860684758"
Evaluating: 112.065471*(0.860684758-0.5)
 Parameter: XPOS <- "40.4203073"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.698336822"
Evaluating: 112.065471*(0.698336822-0.5)
 Parameter: YPOS <- "22.2267094"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "5.049817901E-02"
Evaluating: 142.885239*(5.049817901E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-61.293034"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-61.293034" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.776879 XMAX =   24.776879 XAVE =   24.776879
    YMIN =   52.956241 YMAX =   52.956241 YAVE =   52.956241
    ZMIN =   18.488047 ZMAX =   18.488047 ZAVE =   18.488047
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.4203073"
 RDCMND substituted energy or value "?XAVE" to "24.776879"
Evaluating: 40.4203073-24.776879
 Parameter: XTRAN <- "15.6434283"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.2267094"
 RDCMND substituted energy or value "?YAVE" to "52.9562411"
Evaluating: 22.2267094-52.9562411
 Parameter: YTRAN <- "-30.7295317"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-61.293034"
 RDCMND substituted energy or value "?ZAVE" to "18.4880467"
Evaluating: -61.293034-18.4880467
 Parameter: ZTRAN <- "-79.7810807"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.6434283"
 Parameter: YTRAN -> "-30.7295317"
 Parameter: ZTRAN -> "-79.7810807"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    15.643428  -30.729532  -79.781081
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.364780223E-04"
Evaluating: 3.364780223E-04*360.0
 Parameter: XPHI <- "0.121132088"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.438257487E-02"
Evaluating: 3.438257487E-02*360.0
 Parameter: YPHI <- "12.377727"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.569730285"
Evaluating: 0.569730285*360.0
 Parameter: ZPHI <- "205.102903"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.4203073"
 Parameter: YPOS -> "22.2267094"
 Parameter: ZPOS -> "-61.293034"
 Parameter: XPHI -> "0.121132088"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999998    0.002114
    0.000000   -0.002114    0.999998

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    0.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.4203073"
 Parameter: YPOS -> "22.2267094"
 Parameter: ZPOS -> "-61.293034"
 Parameter: YPHI -> "12.377727"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.976756    0.000000   -0.214356
    0.000000    1.000000    0.000000
    0.214356    0.000000    0.976756

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   12.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.4203073"
 Parameter: YPOS -> "22.2267094"
 Parameter: ZPOS -> "-61.293034"
 Parameter: ZPHI -> "205.102903"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.905547   -0.424245    0.000000
    0.424245   -0.905547    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  154.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.420307 XMAX =   40.420307 XAVE =   40.420307
    YMIN =   22.226709 YMAX =   22.226709 YAVE =   22.226709
    ZMIN =  -61.293034 ZMAX =  -61.293034 ZAVE =  -61.293034
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.4203073"
Evaluating: 40.4203073+3.5
 Parameter: XMAX <- "43.9203073"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.2267094"
Evaluating: 22.2267094+3.5
 Parameter: YMAX <- "25.7267094"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-61.293034"
Evaluating: -61.293034+3.5
 Parameter: ZMAX <- "-57.793034"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.4203073"
Evaluating: 40.4203073-3.5
 Parameter: XMIN <- "36.9203073"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.2267094"
Evaluating: 22.2267094-3.5
 Parameter: YMIN <- "18.7267094"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-61.293034"
Evaluating: -61.293034-3.5
 Parameter: ZMIN <- "-64.793034"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.9203073"
 Parameter: XMIN -> "36.9203073"
 Parameter: YMAX -> "25.7267094"
 Parameter: YMIN -> "18.7267094"
 Parameter: ZMAX -> "-57.793034"
 Parameter: ZMIN -> "-64.793034"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "85"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "85" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "85" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.230097507"
Evaluating: 112.065471*(0.230097507-0.5)
 Parameter: XPOS <- "-30.24675"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.905823575"
Evaluating: 112.065471*(0.905823575-0.5)
 Parameter: YPOS <- "45.4788101"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "7.113568372E-02"
Evaluating: 142.885239*(7.113568372E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-58.3442392"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-58.3442392" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.24675"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.24675-0
 Parameter: XTRAN <- "-30.24675"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.4788101"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.4788101-0
 Parameter: YTRAN <- "45.4788101"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-58.3442392"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -58.3442392-0
 Parameter: ZTRAN <- "-58.3442392"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.24675"
 Parameter: YTRAN -> "45.4788101"
 Parameter: ZTRAN -> "-58.3442392"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -30.246750   45.478810  -58.344239
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.582410746"
Evaluating: 0.582410746*360.0
 Parameter: XPHI <- "209.667869"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.515489412"
Evaluating: 0.515489412*360.0
 Parameter: YPHI <- "185.576188"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.400588689"
Evaluating: 0.400588689*360.0
 Parameter: ZPHI <- "144.211928"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.24675"
 Parameter: YPOS -> "45.4788101"
 Parameter: ZPOS -> "-58.3442392"
 Parameter: XPHI -> "209.667869"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.868909   -0.494971
    0.000000    0.494971   -0.868909

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  150.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.24675"
 Parameter: YPOS -> "45.4788101"
 Parameter: ZPOS -> "-58.3442392"
 Parameter: YPHI -> "185.576188"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.995268    0.000000    0.097169
    0.000000    1.000000    0.000000
   -0.097169    0.000000   -0.995268

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  174.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.24675"
 Parameter: YPOS -> "45.4788101"
 Parameter: ZPOS -> "-58.3442392"
 Parameter: ZPHI -> "144.211928"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.811186    0.584789    0.000000
   -0.584789   -0.811186    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  144.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.246750 XMAX =  -30.246750 XAVE =  -30.246750
    YMIN =   45.478810 YMAX =   45.478810 YAVE =   45.478810
    ZMIN =  -58.344239 ZMAX =  -58.344239 ZAVE =  -58.344239
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.24675"
Evaluating: -30.24675+3.5
 Parameter: XMAX <- "-26.74675"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.4788101"
Evaluating: 45.4788101+3.5
 Parameter: YMAX <- "48.9788101"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-58.3442392"
Evaluating: -58.3442392+3.5
 Parameter: ZMAX <- "-54.8442392"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.24675"
Evaluating: -30.24675-3.5
 Parameter: XMIN <- "-33.74675"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.4788101"
Evaluating: 45.4788101-3.5
 Parameter: YMIN <- "41.9788101"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-58.3442392"
Evaluating: -58.3442392-3.5
 Parameter: ZMIN <- "-61.8442392"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.74675"
 Parameter: XMIN -> "-33.74675"
 Parameter: YMAX -> "48.9788101"
 Parameter: YMIN -> "41.9788101"
 Parameter: ZMAX -> "-54.8442392"
 Parameter: ZMIN -> "-61.8442392"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "86"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "86" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "86"
Evaluating: 86
 Parameter: J <- "86"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "86" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "86"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.483148716"
Evaluating: 112.065471*(0.483148716-0.5)
 Parameter: XPOS <- "-1.88844708"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.109793341"
Evaluating: 112.065471*(0.109793341-0.5)
 Parameter: YPOS <- "-43.728693"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.501458271"
Evaluating: 142.885239*(0.501458271-0.5)+2.93414115
 Parameter: ZPOS <- "3.14250655"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.14250655" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.14250655" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "86"
Evaluating: 86
 Parameter: J <- "86"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "86" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "86"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.734344824"
Evaluating: 112.065471*(0.734344824-0.5)
 Parameter: XPOS <- "26.2619631"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.307576048"
Evaluating: 112.065471*(0.307576048-0.5)
 Parameter: YPOS <- "-21.5640808"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.693913014"
Evaluating: 142.885239*(0.693913014-0.5)+2.93414115
 Parameter: ZPOS <- "30.6414485"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.6414485" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.6414485" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.2619631"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.2619631-0
 Parameter: XTRAN <- "26.2619631"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.5640808"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.5640808-0
 Parameter: YTRAN <- "-21.5640808"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.6414485"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.6414485-0
 Parameter: ZTRAN <- "30.6414485"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.2619631"
 Parameter: YTRAN -> "-21.5640808"
 Parameter: ZTRAN -> "30.6414485"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    26.261963  -21.564081   30.641448
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.529437794"
Evaluating: 0.529437794*360.0
 Parameter: XPHI <- "190.597606"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.718541164"
Evaluating: 0.718541164*360.0
 Parameter: YPHI <- "258.674819"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.744280742"
Evaluating: 0.744280742*360.0
 Parameter: ZPHI <- "267.941067"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.2619631"
 Parameter: YPOS -> "-21.5640808"
 Parameter: ZPOS -> "30.6414485"
 Parameter: XPHI -> "190.597606"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.982943   -0.183910
    0.000000    0.183910   -0.982943

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  169.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.2619631"
 Parameter: YPOS -> "-21.5640808"
 Parameter: ZPOS -> "30.6414485"
 Parameter: YPHI -> "258.674819"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.196377    0.000000    0.980528
    0.000000    1.000000    0.000000
   -0.980528    0.000000   -0.196377

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  101.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.2619631"
 Parameter: YPOS -> "-21.5640808"
 Parameter: ZPOS -> "30.6414485"
 Parameter: ZPHI -> "267.941067"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.035927   -0.999354    0.000000
    0.999354   -0.035927    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   92.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.261963 XMAX =   26.261963 XAVE =   26.261963
    YMIN =  -21.564081 YMAX =  -21.564081 YAVE =  -21.564081
    ZMIN =   30.641448 ZMAX =   30.641448 ZAVE =   30.641448
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.2619631"
Evaluating: 26.2619631+3.5
 Parameter: XMAX <- "29.7619631"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.5640808"
Evaluating: -21.5640808+3.5
 Parameter: YMAX <- "-18.0640808"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.6414485"
Evaluating: 30.6414485+3.5
 Parameter: ZMAX <- "34.1414485"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.2619631"
Evaluating: 26.2619631-3.5
 Parameter: XMIN <- "22.7619631"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.5640808"
Evaluating: -21.5640808-3.5
 Parameter: YMIN <- "-25.0640808"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.6414485"
Evaluating: 30.6414485-3.5
 Parameter: ZMIN <- "27.1414485"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.7619631"
 Parameter: XMIN -> "22.7619631"
 Parameter: YMAX -> "-18.0640808"
 Parameter: YMIN -> "-25.0640808"
 Parameter: ZMAX -> "34.1414485"
 Parameter: ZMIN -> "27.1414485"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "87"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "87" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "87" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.781987923"
Evaluating: 112.065471*(0.781987923-0.5)
 Parameter: XPOS <- "31.6011094"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.35763905"
Evaluating: 112.065471*(0.35763905-0.5)
 Parameter: YPOS <- "-15.9537469"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.641213211"
Evaluating: 142.885239*(0.641213211-0.5)+2.93414115
 Parameter: ZPOS <- "23.1114246"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.1114246" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.1114246" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.6011094"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.6011094-0
 Parameter: XTRAN <- "31.6011094"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.9537469"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.9537469-0
 Parameter: YTRAN <- "-15.9537469"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.1114246"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.1114246-0
 Parameter: ZTRAN <- "23.1114246"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.6011094"
 Parameter: YTRAN -> "-15.9537469"
 Parameter: ZTRAN -> "23.1114246"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    31.601109  -15.953747   23.111425
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.488889794"
Evaluating: 0.488889794*360.0
 Parameter: XPHI <- "176.000326"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.333559651"
Evaluating: 0.333559651*360.0
 Parameter: YPHI <- "120.081474"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.698325738"
Evaluating: 0.698325738*360.0
 Parameter: ZPHI <- "251.397266"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.6011094"
 Parameter: YPOS -> "-15.9537469"
 Parameter: ZPOS -> "23.1114246"
 Parameter: XPHI -> "176.000326"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.997564    0.069751
    0.000000   -0.069751   -0.997564

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  176.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.6011094"
 Parameter: YPOS -> "-15.9537469"
 Parameter: ZPOS -> "23.1114246"
 Parameter: YPHI -> "120.081474"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.501231    0.000000   -0.865314
    0.000000    1.000000    0.000000
    0.865314    0.000000   -0.501231

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  120.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.6011094"
 Parameter: YPOS -> "-15.9537469"
 Parameter: ZPOS -> "23.1114246"
 Parameter: ZPHI -> "251.397266"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.319005   -0.947753    0.000000
    0.947753   -0.319005    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  108.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.601109 XMAX =   31.601109 XAVE =   31.601109
    YMIN =  -15.953747 YMAX =  -15.953747 YAVE =  -15.953747
    ZMIN =   23.111425 ZMAX =   23.111425 ZAVE =   23.111425
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.6011094"
Evaluating: 31.6011094+3.5
 Parameter: XMAX <- "35.1011094"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.9537469"
Evaluating: -15.9537469+3.5
 Parameter: YMAX <- "-12.4537469"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.1114246"
Evaluating: 23.1114246+3.5
 Parameter: ZMAX <- "26.6114246"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.6011094"
Evaluating: 31.6011094-3.5
 Parameter: XMIN <- "28.1011094"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.9537469"
Evaluating: -15.9537469-3.5
 Parameter: YMIN <- "-19.4537469"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.1114246"
Evaluating: 23.1114246-3.5
 Parameter: ZMIN <- "19.6114246"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.1011094"
 Parameter: XMIN -> "28.1011094"
 Parameter: YMAX -> "-12.4537469"
 Parameter: YMIN -> "-19.4537469"
 Parameter: ZMAX -> "26.6114246"
 Parameter: ZMIN -> "19.6114246"
 SELRPN>      4 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      1 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "88"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "88" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "88"
Evaluating: 88
 Parameter: J <- "88"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "88" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.683338147"
Evaluating: 112.065471*(0.683338147-0.5)
 Parameter: XPOS <- "20.5458758"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.615902226"
Evaluating: 112.065471*(0.615902226-0.5)
 Parameter: YPOS <- "12.9886375"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.247509953"
Evaluating: 142.885239*(0.247509953-0.5)+2.93414115
 Parameter: ZPOS <- "-33.1429596"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.1429596" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.5458758"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.5458758-0
 Parameter: XTRAN <- "20.5458758"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.9886375"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.9886375-0
 Parameter: YTRAN <- "12.9886375"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.1429596"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.1429596-0
 Parameter: ZTRAN <- "-33.1429596"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.5458758"
 Parameter: YTRAN -> "12.9886375"
 Parameter: ZTRAN -> "-33.1429596"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    20.545876   12.988637  -33.142960
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.497373798"
Evaluating: 0.497373798*360.0
 Parameter: XPHI <- "179.054567"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.696956269"
Evaluating: 0.696956269*360.0
 Parameter: YPHI <- "250.904257"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.512876377"
Evaluating: 0.512876377*360.0
 Parameter: ZPHI <- "184.635496"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.5458758"
 Parameter: YPOS -> "12.9886375"
 Parameter: ZPOS -> "-33.1429596"
 Parameter: XPHI -> "179.054567"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999864    0.016500
    0.000000   -0.016500   -0.999864

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  179.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.5458758"
 Parameter: YPOS -> "12.9886375"
 Parameter: ZPOS -> "-33.1429596"
 Parameter: YPHI -> "250.904257"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.327148    0.000000    0.944973
    0.000000    1.000000    0.000000
   -0.944973    0.000000   -0.327148

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  109.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.5458758"
 Parameter: YPOS -> "12.9886375"
 Parameter: ZPOS -> "-33.1429596"
 Parameter: ZPHI -> "184.635496"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.996729   -0.080816    0.000000
    0.080816   -0.996729    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  175.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.545876 XMAX =   20.545876 XAVE =   20.545876
    YMIN =   12.988637 YMAX =   12.988637 YAVE =   12.988637
    ZMIN =  -33.142960 ZMAX =  -33.142960 ZAVE =  -33.142960
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.5458758"
Evaluating: 20.5458758+3.5
 Parameter: XMAX <- "24.0458758"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.9886375"
Evaluating: 12.9886375+3.5
 Parameter: YMAX <- "16.4886375"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.1429596"
Evaluating: -33.1429596+3.5
 Parameter: ZMAX <- "-29.6429596"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.5458758"
Evaluating: 20.5458758-3.5
 Parameter: XMIN <- "17.0458758"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.9886375"
Evaluating: 12.9886375-3.5
 Parameter: YMIN <- "9.4886375"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.1429596"
Evaluating: -33.1429596-3.5
 Parameter: ZMIN <- "-36.6429596"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.0458758"
 Parameter: XMIN -> "17.0458758"
 Parameter: YMAX -> "16.4886375"
 Parameter: YMIN -> "9.4886375"
 Parameter: ZMAX -> "-29.6429596"
 Parameter: ZMIN -> "-36.6429596"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "89"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "89" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "89" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "89"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.642235197"
Evaluating: 112.065471*(0.642235197-0.5)
 Parameter: XPOS <- "15.9396543"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.134714465"
Evaluating: 112.065471*(0.134714465-0.5)
 Parameter: YPOS <- "-40.9358955"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.634446177"
Evaluating: 142.885239*(0.634446177-0.5)+2.93414115
 Parameter: ZPOS <- "22.1445153"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.1445153" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.1445153" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.9396543"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.9396543-0
 Parameter: XTRAN <- "15.9396543"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.9358955"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.9358955-0
 Parameter: YTRAN <- "-40.9358955"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.1445153"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.1445153-0
 Parameter: ZTRAN <- "22.1445153"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.9396543"
 Parameter: YTRAN -> "-40.9358955"
 Parameter: ZTRAN -> "22.1445153"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    15.939654  -40.935896   22.144515
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.174426618"
Evaluating: 0.174426618*360.0
 Parameter: XPHI <- "62.7935825"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.390708229"
Evaluating: 0.390708229*360.0
 Parameter: YPHI <- "140.654962"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.983806986"
Evaluating: 0.983806986*360.0
 Parameter: ZPHI <- "354.170515"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.9396543"
 Parameter: YPOS -> "-40.9358955"
 Parameter: ZPOS -> "22.1445153"
 Parameter: XPHI -> "62.7935825"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.457198    0.889365
    0.000000   -0.889365    0.457198

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   62.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.9396543"
 Parameter: YPOS -> "-40.9358955"
 Parameter: ZPOS -> "22.1445153"
 Parameter: YPHI -> "140.654962"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.773342    0.000000   -0.633989
    0.000000    1.000000    0.000000
    0.633989    0.000000   -0.773342

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  140.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.9396543"
 Parameter: YPOS -> "-40.9358955"
 Parameter: ZPOS -> "22.1445153"
 Parameter: ZPHI -> "354.170515"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.994829   -0.101568    0.000000
    0.101568    0.994829    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    5.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.939654 XMAX =   15.939654 XAVE =   15.939654
    YMIN =  -40.935896 YMAX =  -40.935896 YAVE =  -40.935896
    ZMIN =   22.144515 ZMAX =   22.144515 ZAVE =   22.144515
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.9396543"
Evaluating: 15.9396543+3.5
 Parameter: XMAX <- "19.4396543"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.9358955"
Evaluating: -40.9358955+3.5
 Parameter: YMAX <- "-37.4358955"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.1445153"
Evaluating: 22.1445153+3.5
 Parameter: ZMAX <- "25.6445153"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.9396543"
Evaluating: 15.9396543-3.5
 Parameter: XMIN <- "12.4396543"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.9358955"
Evaluating: -40.9358955-3.5
 Parameter: YMIN <- "-44.4358955"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.1445153"
Evaluating: 22.1445153-3.5
 Parameter: ZMIN <- "18.6445153"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.4396543"
 Parameter: XMIN -> "12.4396543"
 Parameter: YMAX -> "-37.4358955"
 Parameter: YMIN -> "-44.4358955"
 Parameter: ZMAX -> "25.6445153"
 Parameter: ZMIN -> "18.6445153"
 SELRPN>      9 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      4 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "90"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "90" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "90" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.255696082"
Evaluating: 112.065471*(0.255696082-0.5)
 Parameter: XPOS <- "-27.3780336"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.21535907"
Evaluating: 112.065471*(0.21535907-0.5)
 Parameter: YPOS <- "-31.8984199"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.218102328"
Evaluating: 142.885239*(0.218102328-0.5)+2.93414115
 Parameter: ZPOS <- "-37.3448751"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.3448751" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.3780336"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.3780336-0
 Parameter: XTRAN <- "-27.3780336"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.8984199"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.8984199-0
 Parameter: YTRAN <- "-31.8984199"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.3448751"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.3448751-0
 Parameter: ZTRAN <- "-37.3448751"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.3780336"
 Parameter: YTRAN -> "-31.8984199"
 Parameter: ZTRAN -> "-37.3448751"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -27.378034  -31.898420  -37.344875
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671014967"
Evaluating: 0.671014967*360.0
 Parameter: XPHI <- "241.565388"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.9201148"
Evaluating: 0.9201148*360.0
 Parameter: YPHI <- "331.241328"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.318872802E-02"
Evaluating: 8.318872802E-02*360.0
 Parameter: ZPHI <- "29.9479421"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.3780336"
 Parameter: YPOS -> "-31.8984199"
 Parameter: ZPOS -> "-37.3448751"
 Parameter: XPHI -> "241.565388"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.476156   -0.879361
    0.000000    0.879361   -0.476156

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.3780336"
 Parameter: YPOS -> "-31.8984199"
 Parameter: ZPOS -> "-37.3448751"
 Parameter: YPHI -> "331.241328"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.876654    0.000000    0.481121
    0.000000    1.000000    0.000000
   -0.481121    0.000000    0.876654

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   28.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.3780336"
 Parameter: YPOS -> "-31.8984199"
 Parameter: ZPOS -> "-37.3448751"
 Parameter: ZPHI -> "29.9479421"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.866479    0.499213    0.000000
   -0.499213    0.866479    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   29.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.378034 XMAX =  -27.378034 XAVE =  -27.378034
    YMIN =  -31.898420 YMAX =  -31.898420 YAVE =  -31.898420
    ZMIN =  -37.344875 ZMAX =  -37.344875 ZAVE =  -37.344875
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.3780336"
Evaluating: -27.3780336+3.5
 Parameter: XMAX <- "-23.8780336"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.8984199"
Evaluating: -31.8984199+3.5
 Parameter: YMAX <- "-28.3984199"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.3448751"
Evaluating: -37.3448751+3.5
 Parameter: ZMAX <- "-33.8448751"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.3780336"
Evaluating: -27.3780336-3.5
 Parameter: XMIN <- "-30.8780336"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.8984199"
Evaluating: -31.8984199-3.5
 Parameter: YMIN <- "-35.3984199"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.3448751"
Evaluating: -37.3448751-3.5
 Parameter: ZMIN <- "-40.8448751"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.8780336"
 Parameter: XMIN -> "-30.8780336"
 Parameter: YMAX -> "-28.3984199"
 Parameter: YMIN -> "-35.3984199"
 Parameter: ZMAX -> "-33.8448751"
 Parameter: ZMIN -> "-40.8448751"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "91"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "91" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "91" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "91"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.658591476"
Evaluating: 112.065471*(0.658591476-0.5)
 Parameter: XPOS <- "17.7726285"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.480580595"
Evaluating: 112.065471*(0.480580595-0.5)
 Parameter: YPOS <- "-2.17624477"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.344295403"
Evaluating: 142.885239*(0.344295403-0.5)+2.93414115
 Parameter: ZPOS <- "-19.3137474"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.3137474" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.7726285"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.7726285-0
 Parameter: XTRAN <- "17.7726285"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.17624477"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.17624477-0
 Parameter: YTRAN <- "-2.17624477"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.3137474"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.3137474-0
 Parameter: ZTRAN <- "-19.3137474"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.7726285"
 Parameter: YTRAN -> "-2.17624477"
 Parameter: ZTRAN -> "-19.3137474"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    17.772628   -2.176245  -19.313747
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.149176812"
Evaluating: 0.149176812*360.0
 Parameter: XPHI <- "53.7036523"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499565381"
Evaluating: 0.499565381*360.0
 Parameter: YPHI <- "179.843537"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.228213902"
Evaluating: 0.228213902*360.0
 Parameter: ZPHI <- "82.1570047"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.7726285"
 Parameter: YPOS -> "-2.17624477"
 Parameter: ZPOS -> "-19.3137474"
 Parameter: XPHI -> "53.7036523"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.591962    0.805966
    0.000000   -0.805966    0.591962

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   53.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.7726285"
 Parameter: YPOS -> "-2.17624477"
 Parameter: ZPOS -> "-19.3137474"
 Parameter: YPHI -> "179.843537"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.999996    0.000000   -0.002731
    0.000000    1.000000    0.000000
    0.002731    0.000000   -0.999996

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  179.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.7726285"
 Parameter: YPOS -> "-2.17624477"
 Parameter: ZPOS -> "-19.3137474"
 Parameter: ZPHI -> "82.1570047"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.136459    0.990646    0.000000
   -0.990646    0.136459    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   82.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.772628 XMAX =   17.772628 XAVE =   17.772628
    YMIN =   -2.176245 YMAX =   -2.176245 YAVE =   -2.176245
    ZMIN =  -19.313747 ZMAX =  -19.313747 ZAVE =  -19.313747
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.7726285"
Evaluating: 17.7726285+3.5
 Parameter: XMAX <- "21.2726285"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.17624477"
Evaluating: -2.17624477+3.5
 Parameter: YMAX <- "1.32375523"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.3137474"
Evaluating: -19.3137474+3.5
 Parameter: ZMAX <- "-15.8137474"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.7726285"
Evaluating: 17.7726285-3.5
 Parameter: XMIN <- "14.2726285"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.17624477"
Evaluating: -2.17624477-3.5
 Parameter: YMIN <- "-5.67624477"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.3137474"
Evaluating: -19.3137474-3.5
 Parameter: ZMIN <- "-22.8137474"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.2726285"
 Parameter: XMIN -> "14.2726285"
 Parameter: YMAX -> "1.32375523"
 Parameter: YMIN -> "-5.67624477"
 Parameter: ZMAX -> "-15.8137474"
 Parameter: ZMIN -> "-22.8137474"
 SELRPN>     33 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     16 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53148 POS      POT      91       POT     -2783 PROB     ILE      201      CA            3.2546
53148 POS      POT      91       POT     -2785 PROB     ILE      201      CB            2.7297
53148 POS      POT      91       POT     -2787 PROB     ILE      201      CG2           2.0344
53148 POS      POT      91       POT     -2791 PROB     ILE      201      CG1           2.8550
53148 POS      POT      91       POT     -2794 PROB     ILE      201      CD            3.7783
53148 POS      POT      91       POT     -2798 PROB     ILE      201      C             3.9053
53148 POS      POT      91       POT     -2799 PROB     ILE      201      O             3.7733
53148 POS      POT      91       POT     -2857 PROB     LEU      205      CD1           4.1435
53148 POS      POT      91       POT     -3182 PROB     PHE      225      CG            4.0798
53148 POS      POT      91       POT     -3183 PROB     PHE      225      CD1           2.9655
53148 POS      POT      91       POT     -3185 PROB     PHE      225      CE1           1.9931
53148 POS      POT      91       POT     -3187 PROB     PHE      225      CZ            2.6327
53148 POS      POT      91       POT     -3246 PROB     TRP      229      CD1           3.2779
53148 POS      POT      91       POT     -3248 PROB     TRP      229      NE1           2.4581
53148 POS      POT      91       POT     -3250 PROB     TRP      229      CE2           3.1733
53148 POS      POT      91       POT     -3256 PROB     TRP      229      CZ2           3.6007
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        16
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "16"
 Comparing "16" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "91" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "91"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.36194453"
Evaluating: 112.065471*(0.36194453-0.5)
 Parameter: XPOS <- "-15.4712513"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.856089192"
Evaluating: 112.065471*(0.856089192-0.5)
 Parameter: YPOS <- "39.905303"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.368714735"
Evaluating: 142.885239*(0.368714735-0.5)+2.93414115
 Parameter: ZPOS <- "-15.8245853"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.8245853" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.772628 XMAX =   17.772628 XAVE =   17.772628
    YMIN =   -2.176245 YMAX =   -2.176245 YAVE =   -2.176245
    ZMIN =  -19.313747 ZMAX =  -19.313747 ZAVE =  -19.313747
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-15.4712513"
 RDCMND substituted energy or value "?XAVE" to "17.7726285"
Evaluating: -15.4712513-17.7726285
 Parameter: XTRAN <- "-33.2438798"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.905303"
 RDCMND substituted energy or value "?YAVE" to "-2.17624477"
Evaluating: 39.905303--2.17624477
 Parameter: YTRAN <- "42.0815478"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.8245853"
 RDCMND substituted energy or value "?ZAVE" to "-19.3137474"
Evaluating: -15.8245853--19.3137474
 Parameter: ZTRAN <- "3.4891621"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.2438798"
 Parameter: YTRAN -> "42.0815478"
 Parameter: ZTRAN -> "3.4891621"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -33.243880   42.081548    3.489162
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.234072507"
Evaluating: 0.234072507*360.0
 Parameter: XPHI <- "84.2661025"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.470851385"
Evaluating: 0.470851385*360.0
 Parameter: YPHI <- "169.506499"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.12894709"
Evaluating: 0.12894709*360.0
 Parameter: ZPHI <- "46.4209524"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-15.4712513"
 Parameter: YPOS -> "39.905303"
 Parameter: ZPOS -> "-15.8245853"
 Parameter: XPHI -> "84.2661025"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.099908    0.994997
    0.000000   -0.994997    0.099908

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   84.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-15.4712513"
 Parameter: YPOS -> "39.905303"
 Parameter: ZPOS -> "-15.8245853"
 Parameter: YPHI -> "169.506499"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.983276    0.000000   -0.182124
    0.000000    1.000000    0.000000
    0.182124    0.000000   -0.983276

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  169.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-15.4712513"
 Parameter: YPOS -> "39.905303"
 Parameter: ZPOS -> "-15.8245853"
 Parameter: ZPHI -> "46.4209524"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.689355    0.724424    0.000000
   -0.724424    0.689355    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   46.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.471251 XMAX =  -15.471251 XAVE =  -15.471251
    YMIN =   39.905303 YMAX =   39.905303 YAVE =   39.905303
    ZMIN =  -15.824585 ZMAX =  -15.824585 ZAVE =  -15.824585
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-15.4712513"
Evaluating: -15.4712513+3.5
 Parameter: XMAX <- "-11.9712513"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.905303"
Evaluating: 39.905303+3.5
 Parameter: YMAX <- "43.405303"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.8245853"
Evaluating: -15.8245853+3.5
 Parameter: ZMAX <- "-12.3245853"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-15.4712513"
Evaluating: -15.4712513-3.5
 Parameter: XMIN <- "-18.9712513"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.905303"
Evaluating: 39.905303-3.5
 Parameter: YMIN <- "36.405303"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.8245853"
Evaluating: -15.8245853-3.5
 Parameter: ZMIN <- "-19.3245853"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.9712513"
 Parameter: XMIN -> "-18.9712513"
 Parameter: YMAX -> "43.405303"
 Parameter: YMIN -> "36.405303"
 Parameter: ZMAX -> "-12.3245853"
 Parameter: ZMIN -> "-19.3245853"
 SELRPN>     27 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     13 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53148 POS      POT      91       POT     -**** MEMB     POPC     194      C1            3.9532
53148 POS      POT      91       POT     -**** MEMB     POPC     194      C2            3.9746
53148 POS      POT      91       POT     -**** MEMB     POPC     194      C3            3.0239
53148 POS      POT      91       POT     -**** MEMB     POPC     194      O31           1.5847
53148 POS      POT      91       POT     -**** MEMB     POPC     194      C31           1.7852
53148 POS      POT      91       POT     -**** MEMB     POPC     194      O32           2.9769
53148 POS      POT      91       POT     -**** MEMB     POPC     194      C32           1.4585
53148 POS      POT      91       POT     -**** MEMB     POPC     194      C33           2.2183
53148 POS      POT      91       POT     -**** MEMB     POPC     194      C34           3.1255
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "91" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "91"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.224002549"
Evaluating: 112.065471*(0.224002549-0.5)
 Parameter: XPOS <- "-30.9297843"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.320783952"
Evaluating: 112.065471*(0.320783952-0.5)
 Parameter: YPOS <- "-20.0839308"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.682412652"
Evaluating: 142.885239*(0.682412652-0.5)+2.93414115
 Parameter: ZPOS <- "28.9982165"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.9982165" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.9982165" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.471251 XMAX =  -15.471251 XAVE =  -15.471251
    YMIN =   39.905303 YMAX =   39.905303 YAVE =   39.905303
    ZMIN =  -15.824585 ZMAX =  -15.824585 ZAVE =  -15.824585
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.9297843"
 RDCMND substituted energy or value "?XAVE" to "-15.4712513"
Evaluating: -30.9297843--15.4712513
 Parameter: XTRAN <- "-15.458533"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.0839308"
 RDCMND substituted energy or value "?YAVE" to "39.905303"
Evaluating: -20.0839308-39.905303
 Parameter: YTRAN <- "-59.9892338"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.9982165"
 RDCMND substituted energy or value "?ZAVE" to "-15.8245853"
Evaluating: 28.9982165--15.8245853
 Parameter: ZTRAN <- "44.8228018"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.458533"
 Parameter: YTRAN -> "-59.9892338"
 Parameter: ZTRAN -> "44.8228018"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -15.458533  -59.989234   44.822802
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.756773211"
Evaluating: 0.756773211*360.0
 Parameter: XPHI <- "272.438356"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.973553475"
Evaluating: 0.973553475*360.0
 Parameter: YPHI <- "350.479251"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.108590233"
Evaluating: 0.108590233*360.0
 Parameter: ZPHI <- "39.0924839"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.9297843"
 Parameter: YPOS -> "-20.0839308"
 Parameter: ZPOS -> "28.9982165"
 Parameter: XPHI -> "272.438356"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.042544   -0.999095
    0.000000    0.999095    0.042544

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   87.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.9297843"
 Parameter: YPOS -> "-20.0839308"
 Parameter: ZPOS -> "28.9982165"
 Parameter: YPHI -> "350.479251"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.986226    0.000000    0.165405
    0.000000    1.000000    0.000000
   -0.165405    0.000000    0.986226

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    9.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.9297843"
 Parameter: YPOS -> "-20.0839308"
 Parameter: ZPOS -> "28.9982165"
 Parameter: ZPHI -> "39.0924839"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.776129    0.630574    0.000000
   -0.630574    0.776129    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   39.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.929784 XMAX =  -30.929784 XAVE =  -30.929784
    YMIN =  -20.083931 YMAX =  -20.083931 YAVE =  -20.083931
    ZMIN =   28.998216 ZMAX =   28.998216 ZAVE =   28.998216
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.9297843"
Evaluating: -30.9297843+3.5
 Parameter: XMAX <- "-27.4297843"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.0839308"
Evaluating: -20.0839308+3.5
 Parameter: YMAX <- "-16.5839308"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.9982165"
Evaluating: 28.9982165+3.5
 Parameter: ZMAX <- "32.4982165"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.9297843"
Evaluating: -30.9297843-3.5
 Parameter: XMIN <- "-34.4297843"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.0839308"
Evaluating: -20.0839308-3.5
 Parameter: YMIN <- "-23.5839308"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.9982165"
Evaluating: 28.9982165-3.5
 Parameter: ZMIN <- "25.4982165"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.4297843"
 Parameter: XMIN -> "-34.4297843"
 Parameter: YMAX -> "-16.5839308"
 Parameter: YMIN -> "-23.5839308"
 Parameter: ZMAX -> "32.4982165"
 Parameter: ZMIN -> "25.4982165"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "92"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "92" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "92" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "92"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.572728067"
Evaluating: 112.065471*(0.572728067-0.5)
 Parameter: XPOS <- "8.15030508"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.178288585"
Evaluating: 112.065471*(0.178288585-0.5)
 Parameter: YPOS <- "-36.0527412"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.191531037"
Evaluating: 142.885239*(0.191531037-0.5)+2.93414115
 Parameter: ZPOS <- "-41.1415204"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.1415204" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.15030508"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.15030508-0
 Parameter: XTRAN <- "8.15030508"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.0527412"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -36.0527412-0
 Parameter: YTRAN <- "-36.0527412"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.1415204"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.1415204-0
 Parameter: ZTRAN <- "-41.1415204"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.15030508"
 Parameter: YTRAN -> "-36.0527412"
 Parameter: ZTRAN -> "-41.1415204"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     8.150305  -36.052741  -41.141520
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.404974549E-02"
Evaluating: 1.404974549E-02*360.0
 Parameter: XPHI <- "5.05790838"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.154443555"
Evaluating: 0.154443555*360.0
 Parameter: YPHI <- "55.5996798"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126914418"
Evaluating: 0.126914418*360.0
 Parameter: ZPHI <- "45.6891905"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.15030508"
 Parameter: YPOS -> "-36.0527412"
 Parameter: ZPOS -> "-41.1415204"
 Parameter: XPHI -> "5.05790838"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.996106    0.088163
    0.000000   -0.088163    0.996106

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    5.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.15030508"
 Parameter: YPOS -> "-36.0527412"
 Parameter: ZPOS -> "-41.1415204"
 Parameter: YPHI -> "55.5996798"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.564972    0.000000   -0.825110
    0.000000    1.000000    0.000000
    0.825110    0.000000    0.564972

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   55.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.15030508"
 Parameter: YPOS -> "-36.0527412"
 Parameter: ZPOS -> "-41.1415204"
 Parameter: ZPHI -> "45.6891905"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.698550    0.715561    0.000000
   -0.715561    0.698550    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   45.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.150305 XMAX =    8.150305 XAVE =    8.150305
    YMIN =  -36.052741 YMAX =  -36.052741 YAVE =  -36.052741
    ZMIN =  -41.141520 ZMAX =  -41.141520 ZAVE =  -41.141520
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.15030508"
Evaluating: 8.15030508+3.5
 Parameter: XMAX <- "11.6503051"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.0527412"
Evaluating: -36.0527412+3.5
 Parameter: YMAX <- "-32.5527412"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.1415204"
Evaluating: -41.1415204+3.5
 Parameter: ZMAX <- "-37.6415204"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.15030508"
Evaluating: 8.15030508-3.5
 Parameter: XMIN <- "4.65030508"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.0527412"
Evaluating: -36.0527412-3.5
 Parameter: YMIN <- "-39.5527412"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.1415204"
Evaluating: -41.1415204-3.5
 Parameter: ZMIN <- "-44.6415204"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.6503051"
 Parameter: XMIN -> "4.65030508"
 Parameter: YMAX -> "-32.5527412"
 Parameter: YMIN -> "-39.5527412"
 Parameter: ZMAX -> "-37.6415204"
 Parameter: ZMIN -> "-44.6415204"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "93"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "93" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "93" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.125524137"
Evaluating: 112.065471*(0.125524137-0.5)
 Parameter: XPOS <- "-41.965814"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.60736633"
Evaluating: 112.065471*(0.60736633-0.5)
 Parameter: YPOS <- "12.0320583"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.562593808"
Evaluating: 142.885239*(0.562593808-0.5)+2.93414115
 Parameter: ZPOS <- "11.8778724"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.8778724" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.8778724" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "93" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.796037307"
Evaluating: 112.065471*(0.796037307-0.5)
 Parameter: XPOS <- "33.1755602"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.52019217"
Evaluating: 112.065471*(0.52019217-0.5)
 Parameter: YPOS <- "2.26284504"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.715475211"
Evaluating: 142.885239*(0.715475211-0.5)+2.93414115
 Parameter: ZPOS <- "33.7223682"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.7223682" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.7223682" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.1755602"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.1755602-0
 Parameter: XTRAN <- "33.1755602"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.26284504"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.26284504-0
 Parameter: YTRAN <- "2.26284504"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.7223682"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.7223682-0
 Parameter: ZTRAN <- "33.7223682"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.1755602"
 Parameter: YTRAN -> "2.26284504"
 Parameter: ZTRAN -> "33.7223682"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    33.175560    2.262845   33.722368
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.110086677"
Evaluating: 0.110086677*360.0
 Parameter: XPHI <- "39.6312037"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.588743101E-02"
Evaluating: 5.588743101E-02*360.0
 Parameter: YPHI <- "20.1194752"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.401151203"
Evaluating: 0.401151203*360.0
 Parameter: ZPHI <- "144.414433"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.1755602"
 Parameter: YPOS -> "2.26284504"
 Parameter: ZPOS -> "33.7223682"
 Parameter: XPHI -> "39.6312037"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.770166    0.637844
    0.000000   -0.637844    0.770166

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   39.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.1755602"
 Parameter: YPOS -> "2.26284504"
 Parameter: ZPOS -> "33.7223682"
 Parameter: YPHI -> "20.1194752"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.938977    0.000000   -0.343979
    0.000000    1.000000    0.000000
    0.343979    0.000000    0.938977

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   20.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.1755602"
 Parameter: YPOS -> "2.26284504"
 Parameter: ZPOS -> "33.7223682"
 Parameter: ZPHI -> "144.414433"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.813247    0.581918    0.000000
   -0.581918   -0.813247    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  144.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.175560 XMAX =   33.175560 XAVE =   33.175560
    YMIN =    2.262845 YMAX =    2.262845 YAVE =    2.262845
    ZMIN =   33.722368 ZMAX =   33.722368 ZAVE =   33.722368
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.1755602"
Evaluating: 33.1755602+3.5
 Parameter: XMAX <- "36.6755602"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.26284504"
Evaluating: 2.26284504+3.5
 Parameter: YMAX <- "5.76284504"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.7223682"
Evaluating: 33.7223682+3.5
 Parameter: ZMAX <- "37.2223682"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.1755602"
Evaluating: 33.1755602-3.5
 Parameter: XMIN <- "29.6755602"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.26284504"
Evaluating: 2.26284504-3.5
 Parameter: YMIN <- "-1.23715496"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.7223682"
Evaluating: 33.7223682-3.5
 Parameter: ZMIN <- "30.2223682"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.6755602"
 Parameter: XMIN -> "29.6755602"
 Parameter: YMAX -> "5.76284504"
 Parameter: YMIN -> "-1.23715496"
 Parameter: ZMAX -> "37.2223682"
 Parameter: ZMIN -> "30.2223682"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "94"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "94" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "94"
Evaluating: 94
 Parameter: J <- "94"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "94" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "94"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "1.575097882E-02"
Evaluating: 112.065471*(1.575097882E-02-0.5)
 Parameter: XPOS <- "-54.2675946"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.54183859"
Evaluating: 112.065471*(0.54183859-0.5)
 Parameter: YPOS <- "4.68866129"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.792100577"
Evaluating: 142.885239*(0.792100577-0.5)+2.93414115
 Parameter: ZPOS <- "44.6710019"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.6710019" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.6710019" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-54.2675946"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -54.2675946-0
 Parameter: XTRAN <- "-54.2675946"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.68866129"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 4.68866129-0
 Parameter: YTRAN <- "4.68866129"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.6710019"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.6710019-0
 Parameter: ZTRAN <- "44.6710019"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-54.2675946"
 Parameter: YTRAN -> "4.68866129"
 Parameter: ZTRAN -> "44.6710019"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -54.267595    4.688661   44.671002
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.474243945E-02"
Evaluating: 8.474243945E-02*360.0
 Parameter: XPHI <- "30.5072782"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.900891651"
Evaluating: 0.900891651*360.0
 Parameter: YPHI <- "324.320994"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.963174087"
Evaluating: 0.963174087*360.0
 Parameter: ZPHI <- "346.742671"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-54.2675946"
 Parameter: YPOS -> "4.68866129"
 Parameter: ZPOS -> "44.6710019"
 Parameter: XPHI -> "30.5072782"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.861565    0.507648
    0.000000   -0.507648    0.861565

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   30.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-54.2675946"
 Parameter: YPOS -> "4.68866129"
 Parameter: ZPOS -> "44.6710019"
 Parameter: YPHI -> "324.320994"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.812297    0.000000    0.583244
    0.000000    1.000000    0.000000
   -0.583244    0.000000    0.812297

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   35.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-54.2675946"
 Parameter: YPOS -> "4.68866129"
 Parameter: ZPOS -> "44.6710019"
 Parameter: ZPHI -> "346.742671"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.973350   -0.229325    0.000000
    0.229325    0.973350    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   13.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -54.267595 XMAX =  -54.267595 XAVE =  -54.267595
    YMIN =    4.688661 YMAX =    4.688661 YAVE =    4.688661
    ZMIN =   44.671002 ZMAX =   44.671002 ZAVE =   44.671002
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-54.2675946"
Evaluating: -54.2675946+3.5
 Parameter: XMAX <- "-50.7675946"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.68866129"
Evaluating: 4.68866129+3.5
 Parameter: YMAX <- "8.18866129"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.6710019"
Evaluating: 44.6710019+3.5
 Parameter: ZMAX <- "48.1710019"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-54.2675946"
Evaluating: -54.2675946-3.5
 Parameter: XMIN <- "-57.7675946"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.68866129"
Evaluating: 4.68866129-3.5
 Parameter: YMIN <- "1.18866129"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.6710019"
Evaluating: 44.6710019-3.5
 Parameter: ZMIN <- "41.1710019"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-50.7675946"
 Parameter: XMIN -> "-57.7675946"
 Parameter: YMAX -> "8.18866129"
 Parameter: YMIN -> "1.18866129"
 Parameter: ZMAX -> "48.1710019"
 Parameter: ZMIN -> "41.1710019"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "95"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "95" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "95" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "95"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.885287012"
Evaluating: 112.065471*(0.885287012-0.5)
 Parameter: XPOS <- "43.1773705"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.62617281"
Evaluating: 112.065471*(0.62617281-0.5)
 Parameter: YPOS <- "14.1396154"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.745570525"
Evaluating: 142.885239*(0.745570525-0.5)+2.93414115
 Parameter: ZPOS <- "38.0225443"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.0225443" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.0225443" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.1773705"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 43.1773705-0
 Parameter: XTRAN <- "43.1773705"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.1396154"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.1396154-0
 Parameter: YTRAN <- "14.1396154"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.0225443"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.0225443-0
 Parameter: ZTRAN <- "38.0225443"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.1773705"
 Parameter: YTRAN -> "14.1396154"
 Parameter: ZTRAN -> "38.0225443"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    43.177371   14.139615   38.022544
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.171598684"
Evaluating: 0.171598684*360.0
 Parameter: XPHI <- "61.7755262"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.910594985"
Evaluating: 0.910594985*360.0
 Parameter: YPHI <- "327.814195"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.354795346"
Evaluating: 0.354795346*360.0
 Parameter: ZPHI <- "127.726325"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.1773705"
 Parameter: YPOS -> "14.1396154"
 Parameter: ZPOS -> "38.0225443"
 Parameter: XPHI -> "61.7755262"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.472927    0.881102
    0.000000   -0.881102    0.472927

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   61.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.1773705"
 Parameter: YPOS -> "14.1396154"
 Parameter: ZPOS -> "38.0225443"
 Parameter: YPHI -> "327.814195"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.846325    0.000000    0.532667
    0.000000    1.000000    0.000000
   -0.532667    0.000000    0.846325

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   32.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.1773705"
 Parameter: YPOS -> "14.1396154"
 Parameter: ZPOS -> "38.0225443"
 Parameter: ZPHI -> "127.726325"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.611891    0.790942    0.000000
   -0.790942   -0.611891    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  127.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.177371 XMAX =   43.177371 XAVE =   43.177371
    YMIN =   14.139615 YMAX =   14.139615 YAVE =   14.139615
    ZMIN =   38.022544 ZMAX =   38.022544 ZAVE =   38.022544
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.1773705"
Evaluating: 43.1773705+3.5
 Parameter: XMAX <- "46.6773705"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.1396154"
Evaluating: 14.1396154+3.5
 Parameter: YMAX <- "17.6396154"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.0225443"
Evaluating: 38.0225443+3.5
 Parameter: ZMAX <- "41.5225443"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.1773705"
Evaluating: 43.1773705-3.5
 Parameter: XMIN <- "39.6773705"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.1396154"
Evaluating: 14.1396154-3.5
 Parameter: YMIN <- "10.6396154"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.0225443"
Evaluating: 38.0225443-3.5
 Parameter: ZMIN <- "34.5225443"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.6773705"
 Parameter: XMIN -> "39.6773705"
 Parameter: YMAX -> "17.6396154"
 Parameter: YMIN -> "10.6396154"
 Parameter: ZMAX -> "41.5225443"
 Parameter: ZMIN -> "34.5225443"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "96"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "96" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "96" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.783509321"
Evaluating: 112.065471*(0.783509321-0.5)
 Parameter: XPOS <- "31.7716056"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.402401019"
Evaluating: 112.065471*(0.402401019-0.5)
 Parameter: YPOS <- "-10.9374758"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.38520045"
Evaluating: 142.885239*(0.38520045-0.5)+2.93414115
 Parameter: ZPOS <- "-13.46902"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.46902" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.46902" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "96" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.716762991"
Evaluating: 112.065471*(0.716762991-0.5)
 Parameter: XPOS <- "24.2916467"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.930273612"
Evaluating: 112.065471*(0.930273612-0.5)
 Parameter: YPOS <- "48.218815"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.790690076"
Evaluating: 142.885239*(0.790690076-0.5)+2.93414115
 Parameter: ZPOS <- "44.4694621"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.4694621" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.4694621" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.2916467"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.2916467-0
 Parameter: XTRAN <- "24.2916467"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "48.218815"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 48.218815-0
 Parameter: YTRAN <- "48.218815"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.4694621"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.4694621-0
 Parameter: ZTRAN <- "44.4694621"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.2916467"
 Parameter: YTRAN -> "48.218815"
 Parameter: ZTRAN -> "44.4694621"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    24.291647   48.218815   44.469462
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.148325677"
Evaluating: 0.148325677*360.0
 Parameter: XPHI <- "53.3972437"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.405624077"
Evaluating: 0.405624077*360.0
 Parameter: YPHI <- "146.024668"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.294595831"
Evaluating: 0.294595831*360.0
 Parameter: ZPHI <- "106.054499"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.2916467"
 Parameter: YPOS -> "48.218815"
 Parameter: ZPOS -> "44.4694621"
 Parameter: XPHI -> "53.3972437"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.596263    0.802789
    0.000000   -0.802789    0.596263

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   53.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.2916467"
 Parameter: YPOS -> "48.218815"
 Parameter: ZPOS -> "44.4694621"
 Parameter: YPHI -> "146.024668"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.829278    0.000000   -0.558836
    0.000000    1.000000    0.000000
    0.558836    0.000000   -0.829278

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  146.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.2916467"
 Parameter: YPOS -> "48.218815"
 Parameter: ZPOS -> "44.4694621"
 Parameter: ZPHI -> "106.054499"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.276552    0.960999    0.000000
   -0.960999   -0.276552    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  106.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.291647 XMAX =   24.291647 XAVE =   24.291647
    YMIN =   48.218815 YMAX =   48.218815 YAVE =   48.218815
    ZMIN =   44.469462 ZMAX =   44.469462 ZAVE =   44.469462
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.2916467"
Evaluating: 24.2916467+3.5
 Parameter: XMAX <- "27.7916467"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "48.218815"
Evaluating: 48.218815+3.5
 Parameter: YMAX <- "51.718815"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.4694621"
Evaluating: 44.4694621+3.5
 Parameter: ZMAX <- "47.9694621"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.2916467"
Evaluating: 24.2916467-3.5
 Parameter: XMIN <- "20.7916467"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "48.218815"
Evaluating: 48.218815-3.5
 Parameter: YMIN <- "44.718815"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.4694621"
Evaluating: 44.4694621-3.5
 Parameter: ZMIN <- "40.9694621"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.7916467"
 Parameter: XMIN -> "20.7916467"
 Parameter: YMAX -> "51.718815"
 Parameter: YMIN -> "44.718815"
 Parameter: ZMAX -> "47.9694621"
 Parameter: ZMIN -> "40.9694621"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "97"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "97" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "97" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.911143877"
Evaluating: 112.065471*(0.911143877-0.5)
 Parameter: XPOS <- "46.0750322"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.278409984"
Evaluating: 112.065471*(0.278409984-0.5)
 Parameter: YPOS <- "-24.8325895"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.601352929"
Evaluating: 142.885239*(0.601352929-0.5)+2.93414115
 Parameter: ZPOS <- "17.4159786"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.4159786" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.4159786" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.0750322"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.0750322-0
 Parameter: XTRAN <- "46.0750322"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.8325895"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.8325895-0
 Parameter: YTRAN <- "-24.8325895"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.4159786"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.4159786-0
 Parameter: ZTRAN <- "17.4159786"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.0750322"
 Parameter: YTRAN -> "-24.8325895"
 Parameter: ZTRAN -> "17.4159786"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    46.075032  -24.832590   17.415979
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.297408313"
Evaluating: 0.297408313*360.0
 Parameter: XPHI <- "107.066993"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.205869413"
Evaluating: 0.205869413*360.0
 Parameter: YPHI <- "74.1129887"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.620731626"
Evaluating: 0.620731626*360.0
 Parameter: ZPHI <- "223.463385"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.0750322"
 Parameter: YPOS -> "-24.8325895"
 Parameter: ZPOS -> "17.4159786"
 Parameter: XPHI -> "107.066993"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.293490    0.955962
    0.000000   -0.955962   -0.293490

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  107.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.0750322"
 Parameter: YPOS -> "-24.8325895"
 Parameter: ZPOS -> "17.4159786"
 Parameter: YPHI -> "74.1129887"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.273741    0.000000   -0.961803
    0.000000    1.000000    0.000000
    0.961803    0.000000    0.273741

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   74.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.0750322"
 Parameter: YPOS -> "-24.8325895"
 Parameter: ZPOS -> "17.4159786"
 Parameter: ZPHI -> "223.463385"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.725814   -0.687891    0.000000
    0.687891   -0.725814    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  136.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.075032 XMAX =   46.075032 XAVE =   46.075032
    YMIN =  -24.832590 YMAX =  -24.832590 YAVE =  -24.832590
    ZMIN =   17.415979 ZMAX =   17.415979 ZAVE =   17.415979
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.0750322"
Evaluating: 46.0750322+3.5
 Parameter: XMAX <- "49.5750322"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.8325895"
Evaluating: -24.8325895+3.5
 Parameter: YMAX <- "-21.3325895"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.4159786"
Evaluating: 17.4159786+3.5
 Parameter: ZMAX <- "20.9159786"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.0750322"
Evaluating: 46.0750322-3.5
 Parameter: XMIN <- "42.5750322"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.8325895"
Evaluating: -24.8325895-3.5
 Parameter: YMIN <- "-28.3325895"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.4159786"
Evaluating: 17.4159786-3.5
 Parameter: ZMIN <- "13.9159786"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.5750322"
 Parameter: XMIN -> "42.5750322"
 Parameter: YMAX -> "-21.3325895"
 Parameter: YMIN -> "-28.3325895"
 Parameter: ZMAX -> "20.9159786"
 Parameter: ZMIN -> "13.9159786"
 SELRPN>     28 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     17 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53154 POS      POT      97       POT     -**** MEMB     POPC     74       P             3.3183
53154 POS      POT      97       POT     -**** MEMB     POPC     74       O14           3.6224
53154 POS      POT      97       POT     -**** MEMB     POPC     74       O12           3.7246
53154 POS      POT      97       POT     -**** MEMB     POPC     74       O11           2.0890
53154 POS      POT      97       POT     -**** MEMB     POPC     74       C1            2.7526
53154 POS      POT      97       POT     -**** MEMB     POPC     74       C2            2.6099
53154 POS      POT      97       POT     -**** MEMB     POPC     74       O21           2.6328
53154 POS      POT      97       POT     -**** MEMB     POPC     74       C21           1.9827
53154 POS      POT      97       POT     -**** MEMB     POPC     74       O22           1.1838
53154 POS      POT      97       POT     -**** MEMB     POPC     74       C22           3.3274
53154 POS      POT      97       POT     -**** MEMB     POPC     74       C23           3.5459
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "97" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.352775085"
Evaluating: 112.065471*(0.352775085-0.5)
 Parameter: XPOS <- "-16.4988294"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.844693027"
Evaluating: 112.065471*(0.844693027-0.5)
 Parameter: YPOS <- "38.6281864"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.44590386"
Evaluating: 142.885239*(0.44590386-0.5)+2.93414115
 Parameter: ZPOS <- "-4.79539874"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.79539874" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.79539874" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "97" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.787895007"
Evaluating: 112.065471*(0.787895007-0.5)
 Parameter: XPOS <- "32.2630896"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.737194306"
Evaluating: 112.065471*(0.737194306-0.5)
 Parameter: YPOS <- "26.5812916"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.612556225"
Evaluating: 142.885239*(0.612556225-0.5)+2.93414115
 Parameter: ZPOS <- "19.0167643"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.0167643" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.0167643" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.075032 XMAX =   46.075032 XAVE =   46.075032
    YMIN =  -24.832590 YMAX =  -24.832590 YAVE =  -24.832590
    ZMIN =   17.415979 ZMAX =   17.415979 ZAVE =   17.415979
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.2630896"
 RDCMND substituted energy or value "?XAVE" to "46.0750322"
Evaluating: 32.2630896-46.0750322
 Parameter: XTRAN <- "-13.8119426"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.5812916"
 RDCMND substituted energy or value "?YAVE" to "-24.8325895"
Evaluating: 26.5812916--24.8325895
 Parameter: YTRAN <- "51.4138811"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.0167643"
 RDCMND substituted energy or value "?ZAVE" to "17.4159786"
Evaluating: 19.0167643-17.4159786
 Parameter: ZTRAN <- "1.6007857"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.8119426"
 Parameter: YTRAN -> "51.4138811"
 Parameter: ZTRAN -> "1.6007857"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -13.811943   51.413881    1.600786
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.362023455"
Evaluating: 0.362023455*360.0
 Parameter: XPHI <- "130.328444"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.349727709"
Evaluating: 0.349727709*360.0
 Parameter: YPHI <- "125.901975"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905509805"
Evaluating: 0.905509805*360.0
 Parameter: ZPHI <- "325.98353"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.2630896"
 Parameter: YPOS -> "26.5812916"
 Parameter: ZPOS -> "19.0167643"
 Parameter: XPHI -> "130.328444"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.647168    0.762347
    0.000000   -0.762347   -0.647168

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  130.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.2630896"
 Parameter: YPOS -> "26.5812916"
 Parameter: ZPOS -> "19.0167643"
 Parameter: YPHI -> "125.901975"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.586400    0.000000   -0.810021
    0.000000    1.000000    0.000000
    0.810021    0.000000   -0.586400

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  125.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.2630896"
 Parameter: YPOS -> "26.5812916"
 Parameter: ZPOS -> "19.0167643"
 Parameter: ZPHI -> "325.98353"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.828877   -0.559431    0.000000
    0.559431    0.828877    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.263090 XMAX =   32.263090 XAVE =   32.263090
    YMIN =   26.581292 YMAX =   26.581292 YAVE =   26.581292
    ZMIN =   19.016764 ZMAX =   19.016764 ZAVE =   19.016764
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.2630896"
Evaluating: 32.2630896+3.5
 Parameter: XMAX <- "35.7630896"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.5812916"
Evaluating: 26.5812916+3.5
 Parameter: YMAX <- "30.0812916"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.0167643"
Evaluating: 19.0167643+3.5
 Parameter: ZMAX <- "22.5167643"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.2630896"
Evaluating: 32.2630896-3.5
 Parameter: XMIN <- "28.7630896"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.5812916"
Evaluating: 26.5812916-3.5
 Parameter: YMIN <- "23.0812916"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.0167643"
Evaluating: 19.0167643-3.5
 Parameter: ZMIN <- "15.5167643"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.7630896"
 Parameter: XMIN -> "28.7630896"
 Parameter: YMAX -> "30.0812916"
 Parameter: YMIN -> "23.0812916"
 Parameter: ZMAX -> "22.5167643"
 Parameter: ZMIN -> "15.5167643"
 SELRPN>     13 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      3 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53154 POS      POT      97       POT     -**** MEMB     POPC     52       C12           3.6637
53154 POS      POT      97       POT     -**** MEMB     POPC     52       C11           2.9936
53154 POS      POT      97       POT     -**** MEMB     POPC     79       C14           3.6317
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "97" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.187516489"
Evaluating: 112.065471*(0.187516489-0.5)
 Parameter: XPOS <- "-35.0186118"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.30323405"
Evaluating: 112.065471*(0.30323405-0.5)
 Parameter: YPOS <- "-22.0506689"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.62455895"
Evaluating: 142.885239*(0.62455895-0.5)+2.93414115
 Parameter: ZPOS <- "20.7317765"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.7317765" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.7317765" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.263090 XMAX =   32.263090 XAVE =   32.263090
    YMIN =   26.581292 YMAX =   26.581292 YAVE =   26.581292
    ZMIN =   19.016764 ZMAX =   19.016764 ZAVE =   19.016764
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.0186118"
 RDCMND substituted energy or value "?XAVE" to "32.2630896"
Evaluating: -35.0186118-32.2630896
 Parameter: XTRAN <- "-67.2817014"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.0506689"
 RDCMND substituted energy or value "?YAVE" to "26.5812916"
Evaluating: -22.0506689-26.5812916
 Parameter: YTRAN <- "-48.6319605"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.7317765"
 RDCMND substituted energy or value "?ZAVE" to "19.0167643"
Evaluating: 20.7317765-19.0167643
 Parameter: ZTRAN <- "1.7150122"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-67.2817014"
 Parameter: YTRAN -> "-48.6319605"
 Parameter: ZTRAN -> "1.7150122"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -67.281701  -48.631960    1.715012
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314572868"
Evaluating: 0.314572868*360.0
 Parameter: XPHI <- "113.246232"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.765886436"
Evaluating: 0.765886436*360.0
 Parameter: YPHI <- "275.719117"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.630357461"
Evaluating: 0.630357461*360.0
 Parameter: ZPHI <- "226.928686"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.0186118"
 Parameter: YPOS -> "-22.0506689"
 Parameter: ZPOS -> "20.7317765"
 Parameter: XPHI -> "113.246232"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.394683    0.918817
    0.000000   -0.918817   -0.394683

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.0186118"
 Parameter: YPOS -> "-22.0506689"
 Parameter: ZPOS -> "20.7317765"
 Parameter: YPHI -> "275.719117"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.099652    0.000000    0.995022
    0.000000    1.000000    0.000000
   -0.995022    0.000000    0.099652

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   84.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.0186118"
 Parameter: YPOS -> "-22.0506689"
 Parameter: ZPOS -> "20.7317765"
 Parameter: ZPHI -> "226.928686"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.682908   -0.730504    0.000000
    0.730504   -0.682908    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  133.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.018612 XMAX =  -35.018612 XAVE =  -35.018612
    YMIN =  -22.050669 YMAX =  -22.050669 YAVE =  -22.050669
    ZMIN =   20.731776 ZMAX =   20.731776 ZAVE =   20.731776
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.0186118"
Evaluating: -35.0186118+3.5
 Parameter: XMAX <- "-31.5186118"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.0506689"
Evaluating: -22.0506689+3.5
 Parameter: YMAX <- "-18.5506689"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.7317765"
Evaluating: 20.7317765+3.5
 Parameter: ZMAX <- "24.2317765"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.0186118"
Evaluating: -35.0186118-3.5
 Parameter: XMIN <- "-38.5186118"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.0506689"
Evaluating: -22.0506689-3.5
 Parameter: YMIN <- "-25.5506689"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.7317765"
Evaluating: 20.7317765-3.5
 Parameter: ZMIN <- "17.2317765"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-31.5186118"
 Parameter: XMIN -> "-38.5186118"
 Parameter: YMAX -> "-18.5506689"
 Parameter: YMIN -> "-25.5506689"
 Parameter: ZMAX -> "24.2317765"
 Parameter: ZMIN -> "17.2317765"
 SELRPN>     26 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      9 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53154 POS      POT      97       POT     -**** MEMB     POPC     15       C12           3.1898
53154 POS      POT      97       POT     -**** MEMB     POPC     30       N             2.5314
53154 POS      POT      97       POT     -**** MEMB     POPC     30       C12           3.5962
53154 POS      POT      97       POT     -**** MEMB     POPC     30       C13           3.4484
53154 POS      POT      97       POT     -**** MEMB     POPC     30       C14           2.8895
53154 POS      POT      97       POT     -**** MEMB     POPC     30       C15           1.2613
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "97" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.501069512"
Evaluating: 112.065471*(0.501069512-0.5)
 Parameter: XPOS <- "0.119855366"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.459170567E-02"
Evaluating: 112.065471*(5.459170567E-02-0.5)
 Parameter: YPOS <- "-49.9148903"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.599223347"
Evaluating: 142.885239*(0.599223347-0.5)+2.93414115
 Parameter: ZPOS <- "17.1116928"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.1116928" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.1116928" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.018612 XMAX =  -35.018612 XAVE =  -35.018612
    YMIN =  -22.050669 YMAX =  -22.050669 YAVE =  -22.050669
    ZMIN =   20.731776 ZMAX =   20.731776 ZAVE =   20.731776
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.119855366"
 RDCMND substituted energy or value "?XAVE" to "-35.0186118"
Evaluating: 0.119855366--35.0186118
 Parameter: XTRAN <- "35.1384672"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.9148903"
 RDCMND substituted energy or value "?YAVE" to "-22.0506689"
Evaluating: -49.9148903--22.0506689
 Parameter: YTRAN <- "-27.8642214"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.1116928"
 RDCMND substituted energy or value "?ZAVE" to "20.7317765"
Evaluating: 17.1116928-20.7317765
 Parameter: ZTRAN <- "-3.6200837"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.1384672"
 Parameter: YTRAN -> "-27.8642214"
 Parameter: ZTRAN -> "-3.6200837"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    35.138467  -27.864221   -3.620084
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.194911139"
Evaluating: 0.194911139*360.0
 Parameter: XPHI <- "70.16801"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.80418094E-02"
Evaluating: 3.80418094E-02*360.0
 Parameter: YPHI <- "13.6950514"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.441680709"
Evaluating: 0.441680709*360.0
 Parameter: ZPHI <- "159.005055"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.119855366"
 Parameter: YPOS -> "-49.9148903"
 Parameter: ZPOS -> "17.1116928"
 Parameter: XPHI -> "70.16801"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.339263    0.940691
    0.000000   -0.940691    0.339263

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   70.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.119855366"
 Parameter: YPOS -> "-49.9148903"
 Parameter: ZPOS -> "17.1116928"
 Parameter: YPHI -> "13.6950514"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.971570    0.000000   -0.236754
    0.000000    1.000000    0.000000
    0.236754    0.000000    0.971570

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   13.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.119855366"
 Parameter: YPOS -> "-49.9148903"
 Parameter: ZPOS -> "17.1116928"
 Parameter: ZPHI -> "159.005055"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.933612    0.358286    0.000000
   -0.358286   -0.933612    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  159.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.119855 XMAX =    0.119855 XAVE =    0.119855
    YMIN =  -49.914890 YMAX =  -49.914890 YAVE =  -49.914890
    ZMIN =   17.111693 ZMAX =   17.111693 ZAVE =   17.111693
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.119855335"
Evaluating: 0.119855335+3.5
 Parameter: XMAX <- "3.61985534"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.9148903"
Evaluating: -49.9148903+3.5
 Parameter: YMAX <- "-46.4148903"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.1116928"
Evaluating: 17.1116928+3.5
 Parameter: ZMAX <- "20.6116928"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.119855335"
Evaluating: 0.119855335-3.5
 Parameter: XMIN <- "-3.38014466"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.9148903"
Evaluating: -49.9148903-3.5
 Parameter: YMIN <- "-53.4148903"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.1116928"
Evaluating: 17.1116928-3.5
 Parameter: ZMIN <- "13.6116928"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.61985534"
 Parameter: XMIN -> "-3.38014466"
 Parameter: YMAX -> "-46.4148903"
 Parameter: YMIN -> "-53.4148903"
 Parameter: ZMAX -> "20.6116928"
 Parameter: ZMIN -> "13.6116928"
 SELRPN>     37 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     23 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53154 POS      POT      97       POT     -**** MEMB     POPC     70       C12           3.2395
53154 POS      POT      97       POT     -**** MEMB     POPC     70       C11           1.9076
53154 POS      POT      97       POT     -**** MEMB     POPC     70       P             3.1851
53154 POS      POT      97       POT     -**** MEMB     POPC     70       O13           3.2587
53154 POS      POT      97       POT     -**** MEMB     POPC     70       O12           2.5787
53154 POS      POT      97       POT     -**** MEMB     POPC     70       O11           3.0214
53154 POS      POT      97       POT     -**** MEMB     POPC     70       C1            2.5492
53154 POS      POT      97       POT     -**** MEMB     POPC     70       C2            2.9440
53154 POS      POT      97       POT     -**** MEMB     POPC     70       O21           2.5768
53154 POS      POT      97       POT     -**** MEMB     POPC     70       C21           1.9976
53154 POS      POT      97       POT     -**** MEMB     POPC     70       O22           1.6996
53154 POS      POT      97       POT     -**** MEMB     POPC     70       C22           2.8464
53154 POS      POT      97       POT     -**** MEMB     POPC     70       C23           3.8586
53154 POS      POT      97       POT     -**** MEMB     POPC     80       C1            3.6546
53154 POS      POT      97       POT     -**** MEMB     POPC     80       C2            3.5115
53154 POS      POT      97       POT     -**** MEMB     POPC     80       O21           3.6268
53154 POS      POT      97       POT     -**** MEMB     POPC     80       C21           2.7771
53154 POS      POT      97       POT     -**** MEMB     POPC     80       O22           1.5813
53154 POS      POT      97       POT     -**** MEMB     POPC     80       C22           3.9591
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        19
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "97" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.487318953"
Evaluating: 112.065471*(0.487318953-0.5)
 Parameter: XPOS <- "-1.4211075"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.477811232E-02"
Evaluating: 112.065471*(5.477811232E-02-0.5)
 Parameter: YPOS <- "-49.8940005"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.222390268"
Evaluating: 142.885239*(0.222390268-0.5)+2.93414115
 Parameter: ZPOS <- "-36.7321918"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.7321918" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.119855 XMAX =    0.119855 XAVE =    0.119855
    YMIN =  -49.914890 YMAX =  -49.914890 YAVE =  -49.914890
    ZMIN =   17.111693 ZMAX =   17.111693 ZAVE =   17.111693
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.4211075"
 RDCMND substituted energy or value "?XAVE" to "0.119855335"
Evaluating: -1.4211075-0.119855335
 Parameter: XTRAN <- "-1.54096283"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.8940005"
 RDCMND substituted energy or value "?YAVE" to "-49.9148903"
Evaluating: -49.8940005--49.9148903
 Parameter: YTRAN <- "2.08898E-02"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.7321918"
 RDCMND substituted energy or value "?ZAVE" to "17.1116928"
Evaluating: -36.7321918-17.1116928
 Parameter: ZTRAN <- "-53.8438846"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.54096283"
 Parameter: YTRAN -> "2.08898E-02"
 Parameter: ZTRAN -> "-53.8438846"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -1.540963    0.020890  -53.843885
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.748096923E-02"
Evaluating: 9.748096923E-02*360.0
 Parameter: XPHI <- "35.0931489"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.683125271"
Evaluating: 0.683125271*360.0
 Parameter: YPHI <- "245.925098"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720349024"
Evaluating: 0.720349024*360.0
 Parameter: ZPHI <- "259.325649"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.4211075"
 Parameter: YPOS -> "-49.8940005"
 Parameter: ZPOS -> "-36.7321918"
 Parameter: XPHI -> "35.0931489"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.818218    0.574907
    0.000000   -0.574907    0.818218

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   35.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.4211075"
 Parameter: YPOS -> "-49.8940005"
 Parameter: ZPOS -> "-36.7321918"
 Parameter: YPHI -> "245.925098"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.407931    0.000000    0.913013
    0.000000    1.000000    0.000000
   -0.913013    0.000000   -0.407931

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  114.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.4211075"
 Parameter: YPOS -> "-49.8940005"
 Parameter: ZPOS -> "-36.7321918"
 Parameter: ZPHI -> "259.325649"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.185227   -0.982696    0.000000
    0.982696   -0.185227    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  100.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.421107 XMAX =   -1.421107 XAVE =   -1.421107
    YMIN =  -49.894000 YMAX =  -49.894000 YAVE =  -49.894000
    ZMIN =  -36.732192 ZMAX =  -36.732192 ZAVE =  -36.732192
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.4211075"
Evaluating: -1.4211075+3.5
 Parameter: XMAX <- "2.0788925"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.8940005"
Evaluating: -49.8940005+3.5
 Parameter: YMAX <- "-46.3940005"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.7321918"
Evaluating: -36.7321918+3.5
 Parameter: ZMAX <- "-33.2321918"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.4211075"
Evaluating: -1.4211075-3.5
 Parameter: XMIN <- "-4.9211075"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.8940005"
Evaluating: -49.8940005-3.5
 Parameter: YMIN <- "-53.3940005"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.7321918"
Evaluating: -36.7321918-3.5
 Parameter: ZMIN <- "-40.2321918"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.0788925"
 Parameter: XMIN -> "-4.9211075"
 Parameter: YMAX -> "-46.3940005"
 Parameter: YMIN -> "-53.3940005"
 Parameter: ZMAX -> "-33.2321918"
 Parameter: ZMIN -> "-40.2321918"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "98"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "98" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "98" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "98"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.506492593"
Evaluating: 112.065471*(0.506492593-0.5)
 Parameter: XPOS <- "0.727595493"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.994597063"
Evaluating: 112.065471*(0.994597063-0.5)
 Parameter: YPOS <- "55.4272528"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.871998635"
Evaluating: 142.885239*(0.871998635-0.5)+2.93414115
 Parameter: ZPOS <- "56.087255"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.087255" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.087255" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.727595493"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.727595493-0
 Parameter: XTRAN <- "0.727595493"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "55.4272528"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 55.4272528-0
 Parameter: YTRAN <- "55.4272528"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.087255"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 56.087255-0
 Parameter: ZTRAN <- "56.087255"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.727595493"
 Parameter: YTRAN -> "55.4272528"
 Parameter: ZTRAN -> "56.087255"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     0.727595   55.427253   56.087255
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.554809139"
Evaluating: 0.554809139*360.0
 Parameter: XPHI <- "199.73129"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.271064238"
Evaluating: 0.271064238*360.0
 Parameter: YPHI <- "97.5831257"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.178970575"
Evaluating: 0.178970575*360.0
 Parameter: ZPHI <- "64.429407"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.727595493"
 Parameter: YPOS -> "55.4272528"
 Parameter: ZPOS -> "56.087255"
 Parameter: XPHI -> "199.73129"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.941286   -0.337609
    0.000000    0.337609   -0.941286

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  160.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.727595493"
 Parameter: YPOS -> "55.4272528"
 Parameter: ZPOS -> "56.087255"
 Parameter: YPHI -> "97.5831257"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.131964    0.000000   -0.991254
    0.000000    1.000000    0.000000
    0.991254    0.000000   -0.131964

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   97.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.727595493"
 Parameter: YPOS -> "55.4272528"
 Parameter: ZPOS -> "56.087255"
 Parameter: ZPHI -> "64.429407"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.431623    0.902054    0.000000
   -0.902054    0.431623    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   64.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.727595 XMAX =    0.727595 XAVE =    0.727595
    YMIN =   55.427253 YMAX =   55.427253 YAVE =   55.427253
    ZMIN =   56.087255 ZMAX =   56.087255 ZAVE =   56.087255
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.727595493"
Evaluating: 0.727595493+3.5
 Parameter: XMAX <- "4.22759549"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "55.4272528"
Evaluating: 55.4272528+3.5
 Parameter: YMAX <- "58.9272528"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.087255"
Evaluating: 56.087255+3.5
 Parameter: ZMAX <- "59.587255"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.727595493"
Evaluating: 0.727595493-3.5
 Parameter: XMIN <- "-2.77240451"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "55.4272528"
Evaluating: 55.4272528-3.5
 Parameter: YMIN <- "51.9272528"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.087255"
Evaluating: 56.087255-3.5
 Parameter: ZMIN <- "52.587255"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.22759549"
 Parameter: XMIN -> "-2.77240451"
 Parameter: YMAX -> "58.9272528"
 Parameter: YMIN -> "51.9272528"
 Parameter: ZMAX -> "59.587255"
 Parameter: ZMIN -> "52.587255"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "99"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "99" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "99" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.971897102"
Evaluating: 112.065471*(0.971897102-0.5)
 Parameter: XPOS <- "52.883371"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.21276488"
Evaluating: 112.065471*(0.21276488-0.5)
 Parameter: YPOS <- "-32.189139"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.805046556"
Evaluating: 142.885239*(0.805046556-0.5)+2.93414115
 Parameter: ZPOS <- "46.5207912"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.5207912" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.5207912" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "52.883371"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 52.883371-0
 Parameter: XTRAN <- "52.883371"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.189139"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.189139-0
 Parameter: YTRAN <- "-32.189139"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.5207912"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.5207912-0
 Parameter: ZTRAN <- "46.5207912"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.883371"
 Parameter: YTRAN -> "-32.189139"
 Parameter: ZTRAN -> "46.5207912"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    52.883371  -32.189139   46.520791
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.397886609"
Evaluating: 0.397886609*360.0
 Parameter: XPHI <- "143.239179"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.708202193"
Evaluating: 0.708202193*360.0
 Parameter: YPHI <- "254.952789"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.329974283"
Evaluating: 0.329974283*360.0
 Parameter: ZPHI <- "118.790742"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "52.883371"
 Parameter: YPOS -> "-32.189139"
 Parameter: ZPOS -> "46.5207912"
 Parameter: XPHI -> "143.239179"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.801141    0.598476
    0.000000   -0.598476   -0.801141

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  143.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "52.883371"
 Parameter: YPOS -> "-32.189139"
 Parameter: ZPOS -> "46.5207912"
 Parameter: YPHI -> "254.952789"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.259615    0.000000    0.965712
    0.000000    1.000000    0.000000
   -0.965712    0.000000   -0.259615

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  105.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "52.883371"
 Parameter: YPOS -> "-32.189139"
 Parameter: ZPOS -> "46.5207912"
 Parameter: ZPHI -> "118.790742"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.481612    0.876385    0.000000
   -0.876385   -0.481612    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  118.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   52.883371 XMAX =   52.883371 XAVE =   52.883371
    YMIN =  -32.189139 YMAX =  -32.189139 YAVE =  -32.189139
    ZMIN =   46.520791 ZMAX =   46.520791 ZAVE =   46.520791
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "52.883371"
Evaluating: 52.883371+3.5
 Parameter: XMAX <- "56.383371"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.189139"
Evaluating: -32.189139+3.5
 Parameter: YMAX <- "-28.689139"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.5207912"
Evaluating: 46.5207912+3.5
 Parameter: ZMAX <- "50.0207912"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "52.883371"
Evaluating: 52.883371-3.5
 Parameter: XMIN <- "49.383371"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.189139"
Evaluating: -32.189139-3.5
 Parameter: YMIN <- "-35.689139"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.5207912"
Evaluating: 46.5207912-3.5
 Parameter: ZMIN <- "43.0207912"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "56.383371"
 Parameter: XMIN -> "49.383371"
 Parameter: YMAX -> "-28.689139"
 Parameter: YMIN -> "-35.689139"
 Parameter: ZMAX -> "50.0207912"
 Parameter: ZMIN -> "43.0207912"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "100"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "100" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "100"
Evaluating: 100
 Parameter: J <- "100"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "100" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "100"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "6.829869824E-02"
Evaluating: 112.065471*(6.829869824E-02-0.5)
 Parameter: XPOS <- "-48.3788097"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.669499439"
Evaluating: 112.065471*(0.669499439-0.5)
 Parameter: YPOS <- "18.9950345"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.790525233"
Evaluating: 142.885239*(0.790525233-0.5)+2.93414115
 Parameter: ZPOS <- "44.4459085"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.4459085" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.4459085" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-48.3788097"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -48.3788097-0
 Parameter: XTRAN <- "-48.3788097"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.9950345"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 18.9950345-0
 Parameter: YTRAN <- "18.9950345"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.4459085"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.4459085-0
 Parameter: ZTRAN <- "44.4459085"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-48.3788097"
 Parameter: YTRAN -> "18.9950345"
 Parameter: ZTRAN -> "44.4459085"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -48.378810   18.995034   44.445909
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.478425784"
Evaluating: 0.478425784*360.0
 Parameter: XPHI <- "172.233282"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.687677103"
Evaluating: 0.687677103*360.0
 Parameter: YPHI <- "247.563757"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.593436783"
Evaluating: 0.593436783*360.0
 Parameter: ZPHI <- "213.637242"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-48.3788097"
 Parameter: YPOS -> "18.9950345"
 Parameter: ZPOS -> "44.4459085"
 Parameter: XPHI -> "172.233282"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.990827    0.135140
    0.000000   -0.135140   -0.990827

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  172.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-48.3788097"
 Parameter: YPOS -> "18.9950345"
 Parameter: ZPOS -> "44.4459085"
 Parameter: YPHI -> "247.563757"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.381655    0.000000    0.924305
    0.000000    1.000000    0.000000
   -0.924305    0.000000   -0.381655

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  112.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-48.3788097"
 Parameter: YPOS -> "18.9950345"
 Parameter: ZPOS -> "44.4459085"
 Parameter: ZPHI -> "213.637242"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.832561   -0.553933    0.000000
    0.553933   -0.832561    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  146.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -48.378810 XMAX =  -48.378810 XAVE =  -48.378810
    YMIN =   18.995034 YMAX =   18.995034 YAVE =   18.995034
    ZMIN =   44.445909 ZMAX =   44.445909 ZAVE =   44.445909
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-48.3788097"
Evaluating: -48.3788097+3.5
 Parameter: XMAX <- "-44.8788097"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.9950345"
Evaluating: 18.9950345+3.5
 Parameter: YMAX <- "22.4950345"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.4459085"
Evaluating: 44.4459085+3.5
 Parameter: ZMAX <- "47.9459085"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-48.3788097"
Evaluating: -48.3788097-3.5
 Parameter: XMIN <- "-51.8788097"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.9950345"
Evaluating: 18.9950345-3.5
 Parameter: YMIN <- "15.4950345"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.4459085"
Evaluating: 44.4459085-3.5
 Parameter: ZMIN <- "40.9459085"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.8788097"
 Parameter: XMIN -> "-51.8788097"
 Parameter: YMAX -> "22.4950345"
 Parameter: YMIN -> "15.4950345"
 Parameter: ZMAX -> "47.9459085"
 Parameter: ZMIN -> "40.9459085"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "101"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "101" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "101" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.49614092"
Evaluating: 112.065471*(0.49614092-0.5)
 Parameter: XPOS <- "-0.432469618"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.545561575"
Evaluating: 112.065471*(0.545561575-0.5)
 Parameter: YPOS <- "5.10587936"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.621058718"
Evaluating: 142.885239*(0.621058718-0.5)+2.93414115
 Parameter: ZPOS <- "20.231645"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.231645" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.231645" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.432469618"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.432469618-0
 Parameter: XTRAN <- "-0.432469618"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.10587936"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.10587936-0
 Parameter: YTRAN <- "5.10587936"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.231645"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 20.231645-0
 Parameter: ZTRAN <- "20.231645"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.432469618"
 Parameter: YTRAN -> "5.10587936"
 Parameter: ZTRAN -> "20.231645"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -0.432470    5.105879   20.231645
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.489003335"
Evaluating: 0.489003335*360.0
 Parameter: XPHI <- "176.041201"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.366802292"
Evaluating: 0.366802292*360.0
 Parameter: YPHI <- "132.048825"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.207923551"
Evaluating: 0.207923551*360.0
 Parameter: ZPHI <- "74.8524784"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.432469618"
 Parameter: YPOS -> "5.10587936"
 Parameter: ZPOS -> "20.231645"
 Parameter: XPHI -> "176.041201"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.997614    0.069039
    0.000000   -0.069039   -0.997614

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  176.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.432469618"
 Parameter: YPOS -> "5.10587936"
 Parameter: ZPOS -> "20.231645"
 Parameter: YPHI -> "132.048825"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.669764    0.000000   -0.742574
    0.000000    1.000000    0.000000
    0.742574    0.000000   -0.669764

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  132.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.432469618"
 Parameter: YPOS -> "5.10587936"
 Parameter: ZPOS -> "20.231645"
 Parameter: ZPHI -> "74.8524784"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.261305    0.965256    0.000000
   -0.965256    0.261305    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   74.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.432470 XMAX =   -0.432470 XAVE =   -0.432470
    YMIN =    5.105879 YMAX =    5.105879 YAVE =    5.105879
    ZMIN =   20.231645 ZMAX =   20.231645 ZAVE =   20.231645
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.432469618"
Evaluating: -0.432469618+3.5
 Parameter: XMAX <- "3.06753038"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.10587936"
Evaluating: 5.10587936+3.5
 Parameter: YMAX <- "8.60587936"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.231645"
Evaluating: 20.231645+3.5
 Parameter: ZMAX <- "23.731645"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.432469618"
Evaluating: -0.432469618-3.5
 Parameter: XMIN <- "-3.93246962"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.10587936"
Evaluating: 5.10587936-3.5
 Parameter: YMIN <- "1.60587936"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.231645"
Evaluating: 20.231645-3.5
 Parameter: ZMIN <- "16.731645"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.06753038"
 Parameter: XMIN -> "-3.93246962"
 Parameter: YMAX -> "8.60587936"
 Parameter: YMIN -> "1.60587936"
 Parameter: ZMAX -> "23.731645"
 Parameter: ZMIN -> "16.731645"
 SELRPN>     33 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     17 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53158 POS      POT      101      POT     -**** PROF     THR      184      CA            3.5369
53158 POS      POT      101      POT     -**** PROF     THR      184      CB            2.8494
53158 POS      POT      101      POT     -**** PROF     THR      184      OG1           1.6615
53158 POS      POT      101      POT     -**** PROF     THR      184      CG2           3.2357
53158 POS      POT      101      POT     -**** PROF     THR      184      C             3.4041
53158 POS      POT      101      POT     -**** PROF     THR      184      O             4.1990
53158 POS      POT      101      POT     -**** PROF     ILE      185      N             3.0702
53158 POS      POT      101      POT     -**** PROF     ILE      185      CA            3.5448
53158 POS      POT      101      POT     -**** PROF     ILE      185      C             2.9925
53158 POS      POT      101      POT     -**** PROF     ILE      185      O             3.4016
53158 POS      POT      101      POT     -**** PROF     PRO      186      N             2.8936
53158 POS      POT      101      POT     -**** PROF     PRO      186      CD            3.1970
53158 POS      POT      101      POT     -**** PROF     PRO      186      CA            3.3202
53158 POS      POT      101      POT     -**** PROF     VAL      190      N             4.8619
53158 POS      POT      101      POT     -**** PROF     VAL      190      O             3.3004
53158 POS      POT      101      POT     -**** PROF     LYS      191      CD            5.1585
53158 POS      POT      101      POT     -**** PROF     LYS      191      CE            4.0135
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        17
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "17"
 Comparing "17" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "101" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.66665305"
Evaluating: 112.065471*(0.66665305-0.5)
 Parameter: XPOS <- "18.6760525"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.86822176"
Evaluating: 112.065471*(0.86822176-0.5)
 Parameter: YPOS <- "41.264945"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.603056408"
Evaluating: 142.885239*(0.603056408-0.5)+2.93414115
 Parameter: ZPOS <- "17.6593806"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.6593806" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.6593806" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.432470 XMAX =   -0.432470 XAVE =   -0.432470
    YMIN =    5.105879 YMAX =    5.105879 YAVE =    5.105879
    ZMIN =   20.231645 ZMAX =   20.231645 ZAVE =   20.231645
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.6760525"
 RDCMND substituted energy or value "?XAVE" to "-0.432469618"
Evaluating: 18.6760525--0.432469618
 Parameter: XTRAN <- "19.1085221"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.264945"
 RDCMND substituted energy or value "?YAVE" to "5.10587936"
Evaluating: 41.264945-5.10587936
 Parameter: YTRAN <- "36.1590656"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.6593806"
 RDCMND substituted energy or value "?ZAVE" to "20.231645"
Evaluating: 17.6593806-20.231645
 Parameter: ZTRAN <- "-2.5722644"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.1085221"
 Parameter: YTRAN -> "36.1590656"
 Parameter: ZTRAN -> "-2.5722644"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    19.108522   36.159066   -2.572264
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.748314847"
Evaluating: 0.748314847*360.0
 Parameter: XPHI <- "269.393345"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.751732785"
Evaluating: 0.751732785*360.0
 Parameter: YPHI <- "270.623803"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.522332308"
Evaluating: 0.522332308*360.0
 Parameter: ZPHI <- "188.039631"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.6760525"
 Parameter: YPOS -> "41.264945"
 Parameter: ZPOS -> "17.6593806"
 Parameter: XPHI -> "269.393345"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.010588   -0.999944
    0.000000    0.999944   -0.010588

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   90.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.6760525"
 Parameter: YPOS -> "41.264945"
 Parameter: ZPOS -> "17.6593806"
 Parameter: YPHI -> "270.623803"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.010887    0.000000    0.999941
    0.000000    1.000000    0.000000
   -0.999941    0.000000    0.010887

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   89.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.6760525"
 Parameter: YPOS -> "41.264945"
 Parameter: ZPOS -> "17.6593806"
 Parameter: ZPHI -> "188.039631"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.990172   -0.139858    0.000000
    0.139858   -0.990172    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  171.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.676053 XMAX =   18.676053 XAVE =   18.676053
    YMIN =   41.264945 YMAX =   41.264945 YAVE =   41.264945
    ZMIN =   17.659381 ZMAX =   17.659381 ZAVE =   17.659381
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.6760525"
Evaluating: 18.6760525+3.5
 Parameter: XMAX <- "22.1760525"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.264945"
Evaluating: 41.264945+3.5
 Parameter: YMAX <- "44.764945"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.6593806"
Evaluating: 17.6593806+3.5
 Parameter: ZMAX <- "21.1593806"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.6760525"
Evaluating: 18.6760525-3.5
 Parameter: XMIN <- "15.1760525"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.264945"
Evaluating: 41.264945-3.5
 Parameter: YMIN <- "37.764945"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.6593806"
Evaluating: 17.6593806-3.5
 Parameter: ZMIN <- "14.1593806"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.1760525"
 Parameter: XMIN -> "15.1760525"
 Parameter: YMAX -> "44.764945"
 Parameter: YMIN -> "37.764945"
 Parameter: ZMAX -> "21.1593806"
 Parameter: ZMIN -> "14.1593806"
 SELRPN>     30 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     14 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53158 POS      POT      101      POT     -**** MEMB     POPC     51       C12           3.2242
53158 POS      POT      101      POT     -**** MEMB     POPC     51       C11           3.3147
53158 POS      POT      101      POT     -**** MEMB     POPC     51       O21           3.3603
53158 POS      POT      101      POT     -**** MEMB     POPC     51       C21           2.8830
53158 POS      POT      101      POT     -**** MEMB     POPC     51       O22           3.4594
53158 POS      POT      101      POT     -**** MEMB     POPC     51       C22           2.3969
53158 POS      POT      101      POT     -**** MEMB     POPC     51       C23           1.0587
53158 POS      POT      101      POT     -**** MEMB     POPC     51       C24           1.0729
53158 POS      POT      101      POT     -**** MEMB     POPC     51       C25           2.5423
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "101" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.265565027"
Evaluating: 112.065471*(0.265565027-0.5)
 Parameter: XPOS <- "-26.2720657"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "9.213441658E-02"
Evaluating: 112.065471*(9.213441658E-02-0.5)
 Parameter: YPOS <- "-45.7076487"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.165876619"
Evaluating: 142.885239*(0.165876619-0.5)+2.93414115
 Parameter: ZPOS <- "-44.807158"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.807158" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.676053 XMAX =   18.676053 XAVE =   18.676053
    YMIN =   41.264945 YMAX =   41.264945 YAVE =   41.264945
    ZMIN =   17.659381 ZMAX =   17.659381 ZAVE =   17.659381
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.2720657"
 RDCMND substituted energy or value "?XAVE" to "18.6760525"
Evaluating: -26.2720657-18.6760525
 Parameter: XTRAN <- "-44.9481182"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.7076487"
 RDCMND substituted energy or value "?YAVE" to "41.264945"
Evaluating: -45.7076487-41.264945
 Parameter: YTRAN <- "-86.9725937"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.807158"
 RDCMND substituted energy or value "?ZAVE" to "17.6593806"
Evaluating: -44.807158-17.6593806
 Parameter: ZTRAN <- "-62.4665386"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.9481182"
 Parameter: YTRAN -> "-86.9725937"
 Parameter: ZTRAN -> "-62.4665386"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -44.948118  -86.972594  -62.466539
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.680997813"
Evaluating: 0.680997813*360.0
 Parameter: XPHI <- "245.159213"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.73702297"
Evaluating: 0.73702297*360.0
 Parameter: YPHI <- "265.328269"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.484357454"
Evaluating: 0.484357454*360.0
 Parameter: ZPHI <- "174.368683"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.2720657"
 Parameter: YPOS -> "-45.7076487"
 Parameter: ZPOS -> "-44.807158"
 Parameter: XPHI -> "245.159213"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.420098   -0.907479
    0.000000    0.907479   -0.420098

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  114.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.2720657"
 Parameter: YPOS -> "-45.7076487"
 Parameter: ZPOS -> "-44.807158"
 Parameter: YPHI -> "265.328269"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.081447    0.000000    0.996678
    0.000000    1.000000    0.000000
   -0.996678    0.000000   -0.081447

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   94.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.2720657"
 Parameter: YPOS -> "-45.7076487"
 Parameter: ZPOS -> "-44.807158"
 Parameter: ZPHI -> "174.368683"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.995174    0.098127    0.000000
   -0.098127   -0.995174    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  174.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.272066 XMAX =  -26.272066 XAVE =  -26.272066
    YMIN =  -45.707649 YMAX =  -45.707649 YAVE =  -45.707649
    ZMIN =  -44.807158 ZMAX =  -44.807158 ZAVE =  -44.807158
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.2720657"
Evaluating: -26.2720657+3.5
 Parameter: XMAX <- "-22.7720657"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.7076487"
Evaluating: -45.7076487+3.5
 Parameter: YMAX <- "-42.2076487"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.807158"
Evaluating: -44.807158+3.5
 Parameter: ZMAX <- "-41.307158"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.2720657"
Evaluating: -26.2720657-3.5
 Parameter: XMIN <- "-29.7720657"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.7076487"
Evaluating: -45.7076487-3.5
 Parameter: YMIN <- "-49.2076487"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.807158"
Evaluating: -44.807158-3.5
 Parameter: ZMIN <- "-48.307158"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-22.7720657"
 Parameter: XMIN -> "-29.7720657"
 Parameter: YMAX -> "-42.2076487"
 Parameter: YMIN -> "-49.2076487"
 Parameter: ZMAX -> "-41.307158"
 Parameter: ZMIN -> "-48.307158"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "102"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "102" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "102" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.192716138"
Evaluating: 112.065471*(0.192716138-0.5)
 Parameter: XPOS <- "-34.4359107"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.977611144"
Evaluating: 112.065471*(0.977611144-0.5)
 Parameter: YPOS <- "53.5237178"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "4.795944008E-02"
Evaluating: 142.885239*(4.795944008E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-61.6557823"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-61.6557823" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.4359107"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.4359107-0
 Parameter: XTRAN <- "-34.4359107"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "53.5237178"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 53.5237178-0
 Parameter: YTRAN <- "53.5237178"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-61.6557823"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -61.6557823-0
 Parameter: ZTRAN <- "-61.6557823"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.4359107"
 Parameter: YTRAN -> "53.5237178"
 Parameter: ZTRAN -> "-61.6557823"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -34.435911   53.523718  -61.655782
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335506947"
Evaluating: 0.335506947*360.0
 Parameter: XPHI <- "120.782501"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.482595345"
Evaluating: 0.482595345*360.0
 Parameter: YPHI <- "173.734324"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.972742616"
Evaluating: 0.972742616*360.0
 Parameter: ZPHI <- "350.187342"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.4359107"
 Parameter: YPOS -> "53.5237178"
 Parameter: ZPOS -> "-61.6557823"
 Parameter: XPHI -> "120.782501"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.511781    0.859116
    0.000000   -0.859116   -0.511781

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  120.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.4359107"
 Parameter: YPOS -> "53.5237178"
 Parameter: ZPOS -> "-61.6557823"
 Parameter: YPHI -> "173.734324"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.994027    0.000000   -0.109139
    0.000000    1.000000    0.000000
    0.109139    0.000000   -0.994027

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  173.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.4359107"
 Parameter: YPOS -> "53.5237178"
 Parameter: ZPOS -> "-61.6557823"
 Parameter: ZPHI -> "350.187342"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.985370   -0.170427    0.000000
    0.170427    0.985370    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    9.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.435911 XMAX =  -34.435911 XAVE =  -34.435911
    YMIN =   53.523718 YMAX =   53.523718 YAVE =   53.523718
    ZMIN =  -61.655782 ZMAX =  -61.655782 ZAVE =  -61.655782
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.4359107"
Evaluating: -34.4359107+3.5
 Parameter: XMAX <- "-30.9359107"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "53.5237178"
Evaluating: 53.5237178+3.5
 Parameter: YMAX <- "57.0237178"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-61.6557823"
Evaluating: -61.6557823+3.5
 Parameter: ZMAX <- "-58.1557823"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.4359107"
Evaluating: -34.4359107-3.5
 Parameter: XMIN <- "-37.9359107"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "53.5237178"
Evaluating: 53.5237178-3.5
 Parameter: YMIN <- "50.0237178"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-61.6557823"
Evaluating: -61.6557823-3.5
 Parameter: ZMIN <- "-65.1557823"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.9359107"
 Parameter: XMIN -> "-37.9359107"
 Parameter: YMAX -> "57.0237178"
 Parameter: YMIN -> "50.0237178"
 Parameter: ZMAX -> "-58.1557823"
 Parameter: ZMIN -> "-65.1557823"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "103"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "103" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "103"
Evaluating: 103
 Parameter: J <- "103"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "103" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "103"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.92497138"
Evaluating: 112.065471*(0.92497138-0.5)
 Parameter: XPOS <- "47.6246179"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.669643454"
Evaluating: 112.065471*(0.669643454-0.5)
 Parameter: YPOS <- "19.0111736"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.203076081"
Evaluating: 142.885239*(0.203076081-0.5)+2.93414115
 Parameter: ZPOS <- "-39.491904"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.491904" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.6246179"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 47.6246179-0
 Parameter: XTRAN <- "47.6246179"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.0111736"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.0111736-0
 Parameter: YTRAN <- "19.0111736"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.491904"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.491904-0
 Parameter: ZTRAN <- "-39.491904"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.6246179"
 Parameter: YTRAN -> "19.0111736"
 Parameter: ZTRAN -> "-39.491904"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    47.624618   19.011174  -39.491904
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.480006366"
Evaluating: 0.480006366*360.0
 Parameter: XPHI <- "172.802292"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.265842296"
Evaluating: 0.265842296*360.0
 Parameter: YPHI <- "95.7032266"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.758525669"
Evaluating: 0.758525669*360.0
 Parameter: ZPHI <- "273.069241"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.6246179"
 Parameter: YPOS -> "19.0111736"
 Parameter: ZPOS -> "-39.491904"
 Parameter: XPHI -> "172.802292"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.992120    0.125294
    0.000000   -0.125294   -0.992120

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  172.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.6246179"
 Parameter: YPOS -> "19.0111736"
 Parameter: ZPOS -> "-39.491904"
 Parameter: YPHI -> "95.7032266"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.099376    0.000000   -0.995050
    0.000000    1.000000    0.000000
    0.995050    0.000000   -0.099376

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   95.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.6246179"
 Parameter: YPOS -> "19.0111736"
 Parameter: ZPOS -> "-39.491904"
 Parameter: ZPHI -> "273.069241"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.053543   -0.998566    0.000000
    0.998566    0.053543    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   86.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.624618 XMAX =   47.624618 XAVE =   47.624618
    YMIN =   19.011174 YMAX =   19.011174 YAVE =   19.011174
    ZMIN =  -39.491904 ZMAX =  -39.491904 ZAVE =  -39.491904
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.6246179"
Evaluating: 47.6246179+3.5
 Parameter: XMAX <- "51.1246179"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.0111736"
Evaluating: 19.0111736+3.5
 Parameter: YMAX <- "22.5111736"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.491904"
Evaluating: -39.491904+3.5
 Parameter: ZMAX <- "-35.991904"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.6246179"
Evaluating: 47.6246179-3.5
 Parameter: XMIN <- "44.1246179"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.0111736"
Evaluating: 19.0111736-3.5
 Parameter: YMIN <- "15.5111736"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.491904"
Evaluating: -39.491904-3.5
 Parameter: ZMIN <- "-42.991904"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.1246179"
 Parameter: XMIN -> "44.1246179"
 Parameter: YMAX -> "22.5111736"
 Parameter: YMIN -> "15.5111736"
 Parameter: ZMAX -> "-35.991904"
 Parameter: ZMIN -> "-42.991904"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "104"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "104" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "104"
Evaluating: 104
 Parameter: J <- "104"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "104" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.494717568"
Evaluating: 112.065471*(0.494717568-0.5)
 Parameter: XPOS <- "-0.59197823"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.356589927"
Evaluating: 112.065471*(0.356589927-0.5)
 Parameter: YPOS <- "-16.0713174"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.487861015"
Evaluating: 142.885239*(0.487861015-0.5)+2.93414115
 Parameter: ZPOS <- "1.19965938"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.19965938" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.19965938" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "104"
Evaluating: 104
 Parameter: J <- "104"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "104" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.455636052"
Evaluating: 112.065471*(0.455636052-0.5)
 Parameter: XPOS <- "-4.97166673"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.707963106"
Evaluating: 112.065471*(0.707963106-0.5)
 Parameter: YPOS <- "23.3054834"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.483717338"
Evaluating: 142.885239*(0.483717338-0.5)+2.93414115
 Parameter: ZPOS <- "0.607589099"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.607589099" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.607589099" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "104"
Evaluating: 104
 Parameter: J <- "104"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "104" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.971624346"
Evaluating: 112.065471*(0.971624346-0.5)
 Parameter: XPOS <- "52.8528045"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.313897467E-02"
Evaluating: 112.065471*(7.313897467E-02-0.5)
 Parameter: YPOS <- "-47.8363819"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.147585256"
Evaluating: 142.885239*(0.147585256-0.5)+2.93414115
 Parameter: ZPOS <- "-47.4207238"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.4207238" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "52.8528045"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 52.8528045-0
 Parameter: XTRAN <- "52.8528045"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.8363819"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.8363819-0
 Parameter: YTRAN <- "-47.8363819"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.4207238"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -47.4207238-0
 Parameter: ZTRAN <- "-47.4207238"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.8528045"
 Parameter: YTRAN -> "-47.8363819"
 Parameter: ZTRAN -> "-47.4207238"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    52.852804  -47.836382  -47.420724
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137092911"
Evaluating: 0.137092911*360.0
 Parameter: XPHI <- "49.353448"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.113442526"
Evaluating: 0.113442526*360.0
 Parameter: YPHI <- "40.8393094"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.906357014E-02"
Evaluating: 1.906357014E-02*360.0
 Parameter: ZPHI <- "6.86288525"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "52.8528045"
 Parameter: YPOS -> "-47.8363819"
 Parameter: ZPOS -> "-47.4207238"
 Parameter: XPHI -> "49.353448"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.651391    0.758742
    0.000000   -0.758742    0.651391

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   49.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "52.8528045"
 Parameter: YPOS -> "-47.8363819"
 Parameter: ZPOS -> "-47.4207238"
 Parameter: YPHI -> "40.8393094"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.756547    0.000000   -0.653940
    0.000000    1.000000    0.000000
    0.653940    0.000000    0.756547

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   40.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "52.8528045"
 Parameter: YPOS -> "-47.8363819"
 Parameter: ZPOS -> "-47.4207238"
 Parameter: ZPHI -> "6.86288525"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.992835    0.119494    0.000000
   -0.119494    0.992835    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   52.852804 XMAX =   52.852804 XAVE =   52.852804
    YMIN =  -47.836382 YMAX =  -47.836382 YAVE =  -47.836382
    ZMIN =  -47.420724 ZMAX =  -47.420724 ZAVE =  -47.420724
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "52.8528045"
Evaluating: 52.8528045+3.5
 Parameter: XMAX <- "56.3528045"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.8363819"
Evaluating: -47.8363819+3.5
 Parameter: YMAX <- "-44.3363819"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.4207238"
Evaluating: -47.4207238+3.5
 Parameter: ZMAX <- "-43.9207238"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "52.8528045"
Evaluating: 52.8528045-3.5
 Parameter: XMIN <- "49.3528045"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.8363819"
Evaluating: -47.8363819-3.5
 Parameter: YMIN <- "-51.3363819"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.4207238"
Evaluating: -47.4207238-3.5
 Parameter: ZMIN <- "-50.9207238"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "56.3528045"
 Parameter: XMIN -> "49.3528045"
 Parameter: YMAX -> "-44.3363819"
 Parameter: YMIN -> "-51.3363819"
 Parameter: ZMAX -> "-43.9207238"
 Parameter: ZMIN -> "-50.9207238"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "105"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "105" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "105" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.200000377"
Evaluating: 112.065471*(0.200000377-0.5)
 Parameter: XPOS <- "-33.6195991"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.880500472"
Evaluating: 112.065471*(0.880500472-0.5)
 Parameter: YPOS <- "42.6409646"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.708838873"
Evaluating: 142.885239*(0.708838873-0.5)+2.93414115
 Parameter: ZPOS <- "32.7741334"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.7741334" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.7741334" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.6195991"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.6195991-0
 Parameter: XTRAN <- "-33.6195991"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.6409646"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.6409646-0
 Parameter: YTRAN <- "42.6409646"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.7741334"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.7741334-0
 Parameter: ZTRAN <- "32.7741334"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.6195991"
 Parameter: YTRAN -> "42.6409646"
 Parameter: ZTRAN -> "32.7741334"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -33.619599   42.640965   32.774133
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.208087556"
Evaluating: 0.208087556*360.0
 Parameter: XPHI <- "74.9115202"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.550667486"
Evaluating: 0.550667486*360.0
 Parameter: YPHI <- "198.240295"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.177331388"
Evaluating: 0.177331388*360.0
 Parameter: ZPHI <- "63.8392997"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.6195991"
 Parameter: YPOS -> "42.6409646"
 Parameter: ZPOS -> "32.7741334"
 Parameter: XPHI -> "74.9115202"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.260310    0.965525
    0.000000   -0.965525    0.260310

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   74.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.6195991"
 Parameter: YPOS -> "42.6409646"
 Parameter: ZPOS -> "32.7741334"
 Parameter: YPHI -> "198.240295"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.949752    0.000000    0.313003
    0.000000    1.000000    0.000000
   -0.313003    0.000000   -0.949752

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  161.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.6195991"
 Parameter: YPOS -> "42.6409646"
 Parameter: ZPOS -> "32.7741334"
 Parameter: ZPHI -> "63.8392997"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.440890    0.897561    0.000000
   -0.897561    0.440890    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   63.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.619599 XMAX =  -33.619599 XAVE =  -33.619599
    YMIN =   42.640965 YMAX =   42.640965 YAVE =   42.640965
    ZMIN =   32.774133 ZMAX =   32.774133 ZAVE =   32.774133
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.6195991"
Evaluating: -33.6195991+3.5
 Parameter: XMAX <- "-30.1195991"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.6409646"
Evaluating: 42.6409646+3.5
 Parameter: YMAX <- "46.1409646"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.7741334"
Evaluating: 32.7741334+3.5
 Parameter: ZMAX <- "36.2741334"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.6195991"
Evaluating: -33.6195991-3.5
 Parameter: XMIN <- "-37.1195991"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.6409646"
Evaluating: 42.6409646-3.5
 Parameter: YMIN <- "39.1409646"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.7741334"
Evaluating: 32.7741334-3.5
 Parameter: ZMIN <- "29.2741334"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.1195991"
 Parameter: XMIN -> "-37.1195991"
 Parameter: YMAX -> "46.1409646"
 Parameter: YMIN -> "39.1409646"
 Parameter: ZMAX -> "36.2741334"
 Parameter: ZMIN -> "29.2741334"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      1 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53162 POS      POT      105      POT     -**** POS      POT      71       POT           3.9262
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "105" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "3.618126476E-02"
Evaluating: 112.065471*(3.618126476E-02-0.5)
 Parameter: XPOS <- "-51.978065"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.51462862"
Evaluating: 112.065471*(0.51462862-0.5)
 Parameter: YPOS <- "1.63936319"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.319200812"
Evaluating: 142.885239*(0.319200812-0.5)+2.93414115
 Parameter: ZPOS <- "-22.899394"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.899394" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.619599 XMAX =  -33.619599 XAVE =  -33.619599
    YMIN =   42.640965 YMAX =   42.640965 YAVE =   42.640965
    ZMIN =   32.774133 ZMAX =   32.774133 ZAVE =   32.774133
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.978065"
 RDCMND substituted energy or value "?XAVE" to "-33.6195991"
Evaluating: -51.978065--33.6195991
 Parameter: XTRAN <- "-18.3584659"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.63936319"
 RDCMND substituted energy or value "?YAVE" to "42.6409646"
Evaluating: 1.63936319-42.6409646
 Parameter: YTRAN <- "-41.0016014"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.899394"
 RDCMND substituted energy or value "?ZAVE" to "32.7741334"
Evaluating: -22.899394-32.7741334
 Parameter: ZTRAN <- "-55.6735274"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.3584659"
 Parameter: YTRAN -> "-41.0016014"
 Parameter: ZTRAN -> "-55.6735274"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -18.358466  -41.001601  -55.673527
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.838234017"
Evaluating: 0.838234017*360.0
 Parameter: XPHI <- "301.764246"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.314297518E-02"
Evaluating: 2.314297518E-02*360.0
 Parameter: YPHI <- "8.33147106"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.191878324E-02"
Evaluating: 2.191878324E-02*360.0
 Parameter: ZPHI <- "7.89076197"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.978065"
 Parameter: YPOS -> "1.63936319"
 Parameter: ZPOS -> "-22.899394"
 Parameter: XPHI -> "301.764246"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.526425   -0.850221
    0.000000    0.850221    0.526425

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.978065"
 Parameter: YPOS -> "1.63936319"
 Parameter: ZPOS -> "-22.899394"
 Parameter: YPHI -> "8.33147106"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.989446    0.000000   -0.144900
    0.000000    1.000000    0.000000
    0.144900    0.000000    0.989446

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    8.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.978065"
 Parameter: YPOS -> "1.63936319"
 Parameter: ZPOS -> "-22.899394"
 Parameter: ZPHI -> "7.89076197"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.990532    0.137285    0.000000
   -0.137285    0.990532    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    7.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.978065 XMAX =  -51.978065 XAVE =  -51.978065
    YMIN =    1.639363 YMAX =    1.639363 YAVE =    1.639363
    ZMIN =  -22.899394 ZMAX =  -22.899394 ZAVE =  -22.899394
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.978065"
Evaluating: -51.978065+3.5
 Parameter: XMAX <- "-48.478065"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.6393632"
Evaluating: 1.6393632+3.5
 Parameter: YMAX <- "5.1393632"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.899394"
Evaluating: -22.899394+3.5
 Parameter: ZMAX <- "-19.399394"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.978065"
Evaluating: -51.978065-3.5
 Parameter: XMIN <- "-55.478065"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.6393632"
Evaluating: 1.6393632-3.5
 Parameter: YMIN <- "-1.8606368"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.899394"
Evaluating: -22.899394-3.5
 Parameter: ZMIN <- "-26.399394"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-48.478065"
 Parameter: XMIN -> "-55.478065"
 Parameter: YMAX -> "5.1393632"
 Parameter: YMIN -> "-1.8606368"
 Parameter: ZMAX -> "-19.399394"
 Parameter: ZMIN -> "-26.399394"
 SELRPN>     11 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      4 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53162 POS      POT      105      POT     -**** MEMB     POPC     245      N             3.3119
53162 POS      POT      105      POT     -**** MEMB     POPC     245      C12           3.3952
53162 POS      POT      105      POT     -**** MEMB     POPC     245      C15           2.1087
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "105" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.680424933"
Evaluating: 112.065471*(0.680424933-0.5)
 Parameter: XPOS <- "20.2194051"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.271269858"
Evaluating: 112.065471*(0.271269858-0.5)
 Parameter: YPOS <- "-25.6327511"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.961123778"
Evaluating: 142.885239*(0.961123778-0.5)+2.93414115
 Parameter: ZPOS <- "68.8219224"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "68.8219224" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "68.8219224" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.978065 XMAX =  -51.978065 XAVE =  -51.978065
    YMIN =    1.639363 YMAX =    1.639363 YAVE =    1.639363
    ZMIN =  -22.899394 ZMAX =  -22.899394 ZAVE =  -22.899394
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.2194051"
 RDCMND substituted energy or value "?XAVE" to "-51.978065"
Evaluating: 20.2194051--51.978065
 Parameter: XTRAN <- "72.1974701"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.6327511"
 RDCMND substituted energy or value "?YAVE" to "1.6393632"
Evaluating: -25.6327511-1.6393632
 Parameter: YTRAN <- "-27.2721143"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "68.8219224"
 RDCMND substituted energy or value "?ZAVE" to "-22.899394"
Evaluating: 68.8219224--22.899394
 Parameter: ZTRAN <- "91.7213164"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "72.1974701"
 Parameter: YTRAN -> "-27.2721143"
 Parameter: ZTRAN -> "91.7213164"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    72.197470  -27.272114   91.721316
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.166109461"
Evaluating: 0.166109461*360.0
 Parameter: XPHI <- "59.799406"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.385890877"
Evaluating: 0.385890877*360.0
 Parameter: YPHI <- "138.920716"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.407752744"
Evaluating: 0.407752744*360.0
 Parameter: ZPHI <- "146.790988"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.2194051"
 Parameter: YPOS -> "-25.6327511"
 Parameter: ZPOS -> "68.8219224"
 Parameter: XPHI -> "59.799406"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.503029    0.864270
    0.000000   -0.864270    0.503029

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   59.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.2194051"
 Parameter: YPOS -> "-25.6327511"
 Parameter: ZPOS -> "68.8219224"
 Parameter: YPHI -> "138.920716"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.753801    0.000000   -0.657103
    0.000000    1.000000    0.000000
    0.657103    0.000000   -0.753801

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  138.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.2194051"
 Parameter: YPOS -> "-25.6327511"
 Parameter: ZPOS -> "68.8219224"
 Parameter: ZPHI -> "146.790988"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.836678    0.547695    0.000000
   -0.547695   -0.836678    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  146.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.219405 XMAX =   20.219405 XAVE =   20.219405
    YMIN =  -25.632751 YMAX =  -25.632751 YAVE =  -25.632751
    ZMIN =   68.821922 ZMAX =   68.821922 ZAVE =   68.821922
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.2194051"
Evaluating: 20.2194051+3.5
 Parameter: XMAX <- "23.7194051"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.6327511"
Evaluating: -25.6327511+3.5
 Parameter: YMAX <- "-22.1327511"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "68.8219224"
Evaluating: 68.8219224+3.5
 Parameter: ZMAX <- "72.3219224"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.2194051"
Evaluating: 20.2194051-3.5
 Parameter: XMIN <- "16.7194051"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.6327511"
Evaluating: -25.6327511-3.5
 Parameter: YMIN <- "-29.1327511"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "68.8219224"
Evaluating: 68.8219224-3.5
 Parameter: ZMIN <- "65.3219224"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.7194051"
 Parameter: XMIN -> "16.7194051"
 Parameter: YMAX -> "-22.1327511"
 Parameter: YMIN -> "-29.1327511"
 Parameter: ZMAX -> "72.3219224"
 Parameter: ZMIN -> "65.3219224"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "106"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "106" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "106" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "106"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.790170365"
Evaluating: 112.065471*(0.790170365-0.5)
 Parameter: XPOS <- "32.5180786"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.521772814"
Evaluating: 112.065471*(0.521772814-0.5)
 Parameter: YPOS <- "2.43998066"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.162736598"
Evaluating: 142.885239*(0.162736598-0.5)+2.93414115
 Parameter: ZPOS <- "-45.2558207"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-45.2558207" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.5180786"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.5180786-0
 Parameter: XTRAN <- "32.5180786"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.43998066"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.43998066-0
 Parameter: YTRAN <- "2.43998066"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-45.2558207"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -45.2558207-0
 Parameter: ZTRAN <- "-45.2558207"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.5180786"
 Parameter: YTRAN -> "2.43998066"
 Parameter: ZTRAN -> "-45.2558207"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    32.518079    2.439981  -45.255821
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.210318385"
Evaluating: 0.210318385*360.0
 Parameter: XPHI <- "75.7146186"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.565193575"
Evaluating: 0.565193575*360.0
 Parameter: YPHI <- "203.469687"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.24068371"
Evaluating: 0.24068371*360.0
 Parameter: ZPHI <- "86.6461356"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.5180786"
 Parameter: YPOS -> "2.43998066"
 Parameter: ZPOS -> "-45.2558207"
 Parameter: XPHI -> "75.7146186"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.246752    0.969079
    0.000000   -0.969079    0.246752

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   75.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.5180786"
 Parameter: YPOS -> "2.43998066"
 Parameter: ZPOS -> "-45.2558207"
 Parameter: YPHI -> "203.469687"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.917271    0.000000    0.398264
    0.000000    1.000000    0.000000
   -0.398264    0.000000   -0.917271

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  156.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.5180786"
 Parameter: YPOS -> "2.43998066"
 Parameter: ZPOS -> "-45.2558207"
 Parameter: ZPHI -> "86.6461356"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.058503    0.998287    0.000000
   -0.998287    0.058503    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   86.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.518079 XMAX =   32.518079 XAVE =   32.518079
    YMIN =    2.439981 YMAX =    2.439981 YAVE =    2.439981
    ZMIN =  -45.255821 ZMAX =  -45.255821 ZAVE =  -45.255821
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.5180786"
Evaluating: 32.5180786+3.5
 Parameter: XMAX <- "36.0180786"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.43998066"
Evaluating: 2.43998066+3.5
 Parameter: YMAX <- "5.93998066"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-45.2558207"
Evaluating: -45.2558207+3.5
 Parameter: ZMAX <- "-41.7558207"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.5180786"
Evaluating: 32.5180786-3.5
 Parameter: XMIN <- "29.0180786"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.43998066"
Evaluating: 2.43998066-3.5
 Parameter: YMIN <- "-1.06001934"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-45.2558207"
Evaluating: -45.2558207-3.5
 Parameter: ZMIN <- "-48.7558207"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.0180786"
 Parameter: XMIN -> "29.0180786"
 Parameter: YMAX -> "5.93998066"
 Parameter: YMIN -> "-1.06001934"
 Parameter: ZMAX -> "-41.7558207"
 Parameter: ZMIN -> "-48.7558207"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "107"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "107" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "107" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "107"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.655401053"
Evaluating: 112.065471*(0.655401053-0.5)
 Parameter: XPOS <- "17.4150922"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.927772271"
Evaluating: 112.065471*(0.927772271-0.5)
 Parameter: YPOS <- "47.938501"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.364279758"
Evaluating: 142.885239*(0.364279758-0.5)+2.93414115
 Parameter: ZPOS <- "-16.4582781"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.4582781" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.4150922"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.4150922-0
 Parameter: XTRAN <- "17.4150922"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "47.938501"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 47.938501-0
 Parameter: YTRAN <- "47.938501"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.4582781"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.4582781-0
 Parameter: ZTRAN <- "-16.4582781"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.4150922"
 Parameter: YTRAN -> "47.938501"
 Parameter: ZTRAN -> "-16.4582781"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    17.415092   47.938501  -16.458278
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.246973471"
Evaluating: 0.246973471*360.0
 Parameter: XPHI <- "88.9104496"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.705327497E-02"
Evaluating: 3.705327497E-02*360.0
 Parameter: YPHI <- "13.339179"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.23585252"
Evaluating: 0.23585252*360.0
 Parameter: ZPHI <- "84.9069072"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.4150922"
 Parameter: YPOS -> "47.938501"
 Parameter: ZPOS -> "-16.4582781"
 Parameter: XPHI -> "88.9104496"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.019015    0.999819
    0.000000   -0.999819    0.019015

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   88.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.4150922"
 Parameter: YPOS -> "47.938501"
 Parameter: ZPOS -> "-16.4582781"
 Parameter: YPHI -> "13.339179"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.973021    0.000000   -0.230715
    0.000000    1.000000    0.000000
    0.230715    0.000000    0.973021

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   13.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.4150922"
 Parameter: YPOS -> "47.938501"
 Parameter: ZPOS -> "-16.4582781"
 Parameter: ZPHI -> "84.9069072"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.088774    0.996052    0.000000
   -0.996052    0.088774    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   84.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.415092 XMAX =   17.415092 XAVE =   17.415092
    YMIN =   47.938501 YMAX =   47.938501 YAVE =   47.938501
    ZMIN =  -16.458278 ZMAX =  -16.458278 ZAVE =  -16.458278
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.4150922"
Evaluating: 17.4150922+3.5
 Parameter: XMAX <- "20.9150922"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "47.938501"
Evaluating: 47.938501+3.5
 Parameter: YMAX <- "51.438501"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.4582781"
Evaluating: -16.4582781+3.5
 Parameter: ZMAX <- "-12.9582781"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.4150922"
Evaluating: 17.4150922-3.5
 Parameter: XMIN <- "13.9150922"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "47.938501"
Evaluating: 47.938501-3.5
 Parameter: YMIN <- "44.438501"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.4582781"
Evaluating: -16.4582781-3.5
 Parameter: ZMIN <- "-19.9582781"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.9150922"
 Parameter: XMIN -> "13.9150922"
 Parameter: YMAX -> "51.438501"
 Parameter: YMIN -> "44.438501"
 Parameter: ZMAX -> "-12.9582781"
 Parameter: ZMIN -> "-19.9582781"
 SELRPN>     22 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     10 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53164 POS      POT      107      POT     -**** MEMB     POPC     200      C14           3.8930
53164 POS      POT      107      POT     -**** MEMB     POPC     232      P             3.6030
53164 POS      POT      107      POT     -**** MEMB     POPC     232      O14           3.0923
53164 POS      POT      107      POT     -**** MEMB     POPC     232      O11           2.8908
53164 POS      POT      107      POT     -**** MEMB     POPC     232      C1            3.3288
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "107" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "107"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.698455781"
Evaluating: 112.065471*(0.698455781-0.5)
 Parameter: XPOS <- "22.2400406"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.615296789"
Evaluating: 112.065471*(0.615296789-0.5)
 Parameter: YPOS <- "12.920789"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.890507081"
Evaluating: 142.885239*(0.890507081-0.5)+2.93414115
 Parameter: ZPOS <- "58.7318387"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "58.7318387" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "58.7318387" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.415092 XMAX =   17.415092 XAVE =   17.415092
    YMIN =   47.938501 YMAX =   47.938501 YAVE =   47.938501
    ZMIN =  -16.458278 ZMAX =  -16.458278 ZAVE =  -16.458278
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.2400406"
 RDCMND substituted energy or value "?XAVE" to "17.4150922"
Evaluating: 22.2400406-17.4150922
 Parameter: XTRAN <- "4.8249484"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.920789"
 RDCMND substituted energy or value "?YAVE" to "47.938501"
Evaluating: 12.920789-47.938501
 Parameter: YTRAN <- "-35.017712"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "58.7318387"
 RDCMND substituted energy or value "?ZAVE" to "-16.4582781"
Evaluating: 58.7318387--16.4582781
 Parameter: ZTRAN <- "75.1901168"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.8249484"
 Parameter: YTRAN -> "-35.017712"
 Parameter: ZTRAN -> "75.1901168"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     4.824948  -35.017712   75.190117
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.324198434"
Evaluating: 0.324198434*360.0
 Parameter: XPHI <- "116.711436"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.836439041"
Evaluating: 0.836439041*360.0
 Parameter: YPHI <- "301.118055"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.955358914"
Evaluating: 0.955358914*360.0
 Parameter: ZPHI <- "343.929209"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.2400406"
 Parameter: YPOS -> "12.920789"
 Parameter: ZPOS -> "58.7318387"
 Parameter: XPHI -> "116.711436"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.449497    0.893282
    0.000000   -0.893282   -0.449497

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  116.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.2400406"
 Parameter: YPOS -> "12.920789"
 Parameter: ZPOS -> "58.7318387"
 Parameter: YPHI -> "301.118055"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.516803    0.000000    0.856104
    0.000000    1.000000    0.000000
   -0.856104    0.000000    0.516803

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   58.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.2400406"
 Parameter: YPOS -> "12.920789"
 Parameter: ZPOS -> "58.7318387"
 Parameter: ZPHI -> "343.929209"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.960920   -0.276825    0.000000
    0.276825    0.960920    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   16.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.240041 XMAX =   22.240041 XAVE =   22.240041
    YMIN =   12.920789 YMAX =   12.920789 YAVE =   12.920789
    ZMIN =   58.731839 ZMAX =   58.731839 ZAVE =   58.731839
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.2400406"
Evaluating: 22.2400406+3.5
 Parameter: XMAX <- "25.7400406"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.920789"
Evaluating: 12.920789+3.5
 Parameter: YMAX <- "16.420789"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "58.7318387"
Evaluating: 58.7318387+3.5
 Parameter: ZMAX <- "62.2318387"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.2400406"
Evaluating: 22.2400406-3.5
 Parameter: XMIN <- "18.7400406"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.920789"
Evaluating: 12.920789-3.5
 Parameter: YMIN <- "9.420789"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "58.7318387"
Evaluating: 58.7318387-3.5
 Parameter: ZMIN <- "55.2318387"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.7400406"
 Parameter: XMIN -> "18.7400406"
 Parameter: YMAX -> "16.420789"
 Parameter: YMIN -> "9.420789"
 Parameter: ZMAX -> "62.2318387"
 Parameter: ZMIN -> "55.2318387"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "108"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "108" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "108"
Evaluating: 108
 Parameter: J <- "108"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "108" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "108"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.430276265"
Evaluating: 112.065471*(0.430276265-0.5)
 Parameter: XPOS <- "-7.8136232"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.427440908"
Evaluating: 112.065471*(0.427440908-0.5)
 Parameter: YPOS <- "-8.13136882"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.385465844"
Evaluating: 142.885239*(0.385465844-0.5)+2.93414115
 Parameter: ZPOS <- "-13.4310991"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.4310991" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.4310991" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "108"
Evaluating: 108
 Parameter: J <- "108"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "108" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "108"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.214180718"
Evaluating: 112.065471*(0.214180718-0.5)
 Parameter: XPOS <- "-32.0304725"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.921542837"
Evaluating: 112.065471*(0.921542837-0.5)
 Parameter: YPOS <- "47.2403966"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.122817469"
Evaluating: 142.885239*(0.122817469-0.5)+2.93414115
 Parameter: ZPOS <- "-50.9596749"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.9596749" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.0304725"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.0304725-0
 Parameter: XTRAN <- "-32.0304725"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "47.2403966"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 47.2403966-0
 Parameter: YTRAN <- "47.2403966"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.9596749"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.9596749-0
 Parameter: ZTRAN <- "-50.9596749"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.0304725"
 Parameter: YTRAN -> "47.2403966"
 Parameter: ZTRAN -> "-50.9596749"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -32.030473   47.240397  -50.959675
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.674824182"
Evaluating: 0.674824182*360.0
 Parameter: XPHI <- "242.936706"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.62742314"
Evaluating: 0.62742314*360.0
 Parameter: YPHI <- "225.87233"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.65449646"
Evaluating: 0.65449646*360.0
 Parameter: ZPHI <- "235.618726"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.0304725"
 Parameter: YPOS -> "47.2403966"
 Parameter: ZPOS -> "-50.9596749"
 Parameter: XPHI -> "242.936706"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.454975   -0.890504
    0.000000    0.890504   -0.454975

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  117.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.0304725"
 Parameter: YPOS -> "47.2403966"
 Parameter: ZPOS -> "-50.9596749"
 Parameter: YPHI -> "225.87233"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.696260    0.000000    0.717790
    0.000000    1.000000    0.000000
   -0.717790    0.000000   -0.696260

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  134.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.0304725"
 Parameter: YPOS -> "47.2403966"
 Parameter: ZPOS -> "-50.9596749"
 Parameter: ZPHI -> "235.618726"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.564697   -0.825298    0.000000
    0.825298   -0.564697    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  124.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.030473 XMAX =  -32.030473 XAVE =  -32.030473
    YMIN =   47.240397 YMAX =   47.240397 YAVE =   47.240397
    ZMIN =  -50.959675 ZMAX =  -50.959675 ZAVE =  -50.959675
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.0304725"
Evaluating: -32.0304725+3.5
 Parameter: XMAX <- "-28.5304725"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "47.2403966"
Evaluating: 47.2403966+3.5
 Parameter: YMAX <- "50.7403966"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.9596749"
Evaluating: -50.9596749+3.5
 Parameter: ZMAX <- "-47.4596749"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.0304725"
Evaluating: -32.0304725-3.5
 Parameter: XMIN <- "-35.5304725"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "47.2403966"
Evaluating: 47.2403966-3.5
 Parameter: YMIN <- "43.7403966"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.9596749"
Evaluating: -50.9596749-3.5
 Parameter: ZMIN <- "-54.4596749"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.5304725"
 Parameter: XMIN -> "-35.5304725"
 Parameter: YMAX -> "50.7403966"
 Parameter: YMIN -> "43.7403966"
 Parameter: ZMAX -> "-47.4596749"
 Parameter: ZMIN -> "-54.4596749"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "109"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "109" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "109" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "109"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.716444105"
Evaluating: 112.065471*(0.716444105-0.5)
 Parameter: XPOS <- "24.2559106"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.290275153"
Evaluating: 112.065471*(0.290275153-0.5)
 Parameter: YPOS <- "-23.5029138"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.342625555"
Evaluating: 142.885239*(0.342625555-0.5)+2.93414115
 Parameter: ZPOS <- "-19.552344"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.552344" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.2559106"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.2559106-0
 Parameter: XTRAN <- "24.2559106"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.5029138"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -23.5029138-0
 Parameter: YTRAN <- "-23.5029138"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.552344"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.552344-0
 Parameter: ZTRAN <- "-19.552344"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.2559106"
 Parameter: YTRAN -> "-23.5029138"
 Parameter: ZTRAN -> "-19.552344"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    24.255911  -23.502914  -19.552344
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.713854932"
Evaluating: 0.713854932*360.0
 Parameter: XPHI <- "256.987776"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.44355465"
Evaluating: 0.44355465*360.0
 Parameter: YPHI <- "159.679674"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.101804882"
Evaluating: 0.101804882*360.0
 Parameter: ZPHI <- "36.6497575"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.2559106"
 Parameter: YPOS -> "-23.5029138"
 Parameter: ZPOS -> "-19.552344"
 Parameter: XPHI -> "256.987776"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.225159   -0.974322
    0.000000    0.974322   -0.225159

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  103.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.2559106"
 Parameter: YPOS -> "-23.5029138"
 Parameter: ZPOS -> "-19.552344"
 Parameter: YPHI -> "159.679674"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.937766    0.000000   -0.347268
    0.000000    1.000000    0.000000
    0.347268    0.000000   -0.937766

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  159.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.2559106"
 Parameter: YPOS -> "-23.5029138"
 Parameter: ZPOS -> "-19.552344"
 Parameter: ZPHI -> "36.6497575"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.802299    0.596922    0.000000
   -0.596922    0.802299    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   36.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.255911 XMAX =   24.255911 XAVE =   24.255911
    YMIN =  -23.502914 YMAX =  -23.502914 YAVE =  -23.502914
    ZMIN =  -19.552344 ZMAX =  -19.552344 ZAVE =  -19.552344
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.2559106"
Evaluating: 24.2559106+3.5
 Parameter: XMAX <- "27.7559106"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.5029138"
Evaluating: -23.5029138+3.5
 Parameter: YMAX <- "-20.0029138"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.552344"
Evaluating: -19.552344+3.5
 Parameter: ZMAX <- "-16.052344"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.2559106"
Evaluating: 24.2559106-3.5
 Parameter: XMIN <- "20.7559106"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.5029138"
Evaluating: -23.5029138-3.5
 Parameter: YMIN <- "-27.0029138"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.552344"
Evaluating: -19.552344-3.5
 Parameter: ZMIN <- "-23.052344"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.7559106"
 Parameter: XMIN -> "20.7559106"
 Parameter: YMAX -> "-20.0029138"
 Parameter: YMIN -> "-27.0029138"
 Parameter: ZMAX -> "-16.052344"
 Parameter: ZMIN -> "-23.052344"
 SELRPN>     12 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      8 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53166 POS      POT      109      POT     -**** MEMB     POPC     178      O22           3.7062
53166 POS      POT      109      POT     -**** MEMB     POPC     193      P             3.3438
53166 POS      POT      109      POT     -**** MEMB     POPC     193      O13           3.2373
53166 POS      POT      109      POT     -**** MEMB     POPC     193      O14           3.0417
53166 POS      POT      109      POT     -**** MEMB     POPC     193      O12           3.7730
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "109" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "109"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.554290084"
Evaluating: 112.065471*(0.554290084-0.5)
 Parameter: XPOS <- "6.08404383"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.894796523"
Evaluating: 112.065471*(0.894796523-0.5)
 Parameter: YPOS <- "44.2430583"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.787191718"
Evaluating: 142.885239*(0.787191718-0.5)+2.93414115
 Parameter: ZPOS <- "43.9695984"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.9695984" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.9695984" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.255911 XMAX =   24.255911 XAVE =   24.255911
    YMIN =  -23.502914 YMAX =  -23.502914 YAVE =  -23.502914
    ZMIN =  -19.552344 ZMAX =  -19.552344 ZAVE =  -19.552344
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.08404383"
 RDCMND substituted energy or value "?XAVE" to "24.2559106"
Evaluating: 6.08404383-24.2559106
 Parameter: XTRAN <- "-18.1718668"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.2430583"
 RDCMND substituted energy or value "?YAVE" to "-23.5029138"
Evaluating: 44.2430583--23.5029138
 Parameter: YTRAN <- "67.7459721"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.9695984"
 RDCMND substituted energy or value "?ZAVE" to "-19.552344"
Evaluating: 43.9695984--19.552344
 Parameter: ZTRAN <- "63.5219424"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.1718668"
 Parameter: YTRAN -> "67.7459721"
 Parameter: ZTRAN -> "63.5219424"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -18.171867   67.745972   63.521942
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.722182722"
Evaluating: 0.722182722*360.0
 Parameter: XPHI <- "259.98578"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.504181344"
Evaluating: 0.504181344*360.0
 Parameter: YPHI <- "181.505284"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873219453"
Evaluating: 0.873219453*360.0
 Parameter: ZPHI <- "314.359003"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.08404383"
 Parameter: YPOS -> "44.2430583"
 Parameter: ZPOS -> "43.9695984"
 Parameter: XPHI -> "259.98578"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.173893   -0.984765
    0.000000    0.984765   -0.173893

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.08404383"
 Parameter: YPOS -> "44.2430583"
 Parameter: ZPOS -> "43.9695984"
 Parameter: YPHI -> "181.505284"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.999655    0.000000    0.026269
    0.000000    1.000000    0.000000
   -0.026269    0.000000   -0.999655

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  178.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.08404383"
 Parameter: YPOS -> "44.2430583"
 Parameter: ZPOS -> "43.9695984"
 Parameter: ZPHI -> "314.359003"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.699152   -0.714973    0.000000
    0.714973    0.699152    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.084044 XMAX =    6.084044 XAVE =    6.084044
    YMIN =   44.243058 YMAX =   44.243058 YAVE =   44.243058
    ZMIN =   43.969598 ZMAX =   43.969598 ZAVE =   43.969598
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.08404385"
Evaluating: 6.08404385+3.5
 Parameter: XMAX <- "9.58404385"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.2430583"
Evaluating: 44.2430583+3.5
 Parameter: YMAX <- "47.7430583"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.9695984"
Evaluating: 43.9695984+3.5
 Parameter: ZMAX <- "47.4695984"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.08404385"
Evaluating: 6.08404385-3.5
 Parameter: XMIN <- "2.58404385"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.2430583"
Evaluating: 44.2430583-3.5
 Parameter: YMIN <- "40.7430583"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.9695984"
Evaluating: 43.9695984-3.5
 Parameter: ZMIN <- "40.4695984"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.58404385"
 Parameter: XMIN -> "2.58404385"
 Parameter: YMAX -> "47.7430583"
 Parameter: YMIN -> "40.7430583"
 Parameter: ZMAX -> "47.4695984"
 Parameter: ZMIN -> "40.4695984"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "110"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "110" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "110" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "110"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.648791234"
Evaluating: 112.065471*(0.648791234-0.5)
 Parameter: XPOS <- "16.6743597"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.450010483"
Evaluating: 112.065471*(0.450010483-0.5)
 Parameter: YPOS <- "-5.60209877"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.376532299"
Evaluating: 142.885239*(0.376532299-0.5)+2.93414115
 Parameter: ZPOS <- "-14.7075708"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.7075708" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.7075708" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "110" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "110"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.729456076"
Evaluating: 112.065471*(0.729456076-0.5)
 Parameter: XPOS <- "25.7141032"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.170710151"
Evaluating: 112.065471*(0.170710151-0.5)
 Parameter: YPOS <- "-36.902022"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "6.606087404E-02"
Evaluating: 142.885239*(6.606087404E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-59.0693546"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-59.0693546" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.7141032"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.7141032-0
 Parameter: XTRAN <- "25.7141032"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.902022"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -36.902022-0
 Parameter: YTRAN <- "-36.902022"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-59.0693546"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -59.0693546-0
 Parameter: ZTRAN <- "-59.0693546"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.7141032"
 Parameter: YTRAN -> "-36.902022"
 Parameter: ZTRAN -> "-59.0693546"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    25.714103  -36.902022  -59.069355
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.642466547"
Evaluating: 0.642466547*360.0
 Parameter: XPHI <- "231.287957"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.755555958"
Evaluating: 0.755555958*360.0
 Parameter: YPHI <- "272.000145"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.550155663"
Evaluating: 0.550155663*360.0
 Parameter: ZPHI <- "198.056039"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.7141032"
 Parameter: YPOS -> "-36.902022"
 Parameter: ZPOS -> "-59.0693546"
 Parameter: XPHI -> "231.287957"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.625407   -0.780299
    0.000000    0.780299   -0.625407

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.7141032"
 Parameter: YPOS -> "-36.902022"
 Parameter: ZPOS -> "-59.0693546"
 Parameter: YPHI -> "272.000145"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.034902    0.000000    0.999391
    0.000000    1.000000    0.000000
   -0.999391    0.000000    0.034902

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   88.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.7141032"
 Parameter: YPOS -> "-36.902022"
 Parameter: ZPOS -> "-59.0693546"
 Parameter: ZPHI -> "198.056039"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.950754   -0.309947    0.000000
    0.309947   -0.950754    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  161.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.714103 XMAX =   25.714103 XAVE =   25.714103
    YMIN =  -36.902022 YMAX =  -36.902022 YAVE =  -36.902022
    ZMIN =  -59.069355 ZMAX =  -59.069355 ZAVE =  -59.069355
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.7141032"
Evaluating: 25.7141032+3.5
 Parameter: XMAX <- "29.2141032"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.902022"
Evaluating: -36.902022+3.5
 Parameter: YMAX <- "-33.402022"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-59.0693546"
Evaluating: -59.0693546+3.5
 Parameter: ZMAX <- "-55.5693546"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.7141032"
Evaluating: 25.7141032-3.5
 Parameter: XMIN <- "22.2141032"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.902022"
Evaluating: -36.902022-3.5
 Parameter: YMIN <- "-40.402022"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-59.0693546"
Evaluating: -59.0693546-3.5
 Parameter: ZMIN <- "-62.5693546"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.2141032"
 Parameter: XMIN -> "22.2141032"
 Parameter: YMAX -> "-33.402022"
 Parameter: YMIN -> "-40.402022"
 Parameter: ZMAX -> "-55.5693546"
 Parameter: ZMIN -> "-62.5693546"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "111"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "111" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "111" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "111"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.27623373"
Evaluating: 112.065471*(0.27623373-0.5)
 Parameter: XPOS <- "-25.0764724"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.810264303"
Evaluating: 112.065471*(0.810264303-0.5)
 Parameter: YPOS <- "34.7699153"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.106406685"
Evaluating: 142.885239*(0.106406685-0.5)+2.93414115
 Parameter: ZPOS <- "-53.3045337"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.3045337" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.0764724"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.0764724-0
 Parameter: XTRAN <- "-25.0764724"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.7699153"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.7699153-0
 Parameter: YTRAN <- "34.7699153"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.3045337"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.3045337-0
 Parameter: ZTRAN <- "-53.3045337"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.0764724"
 Parameter: YTRAN -> "34.7699153"
 Parameter: ZTRAN -> "-53.3045337"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -25.076472   34.769915  -53.304534
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317950471"
Evaluating: 0.317950471*360.0
 Parameter: XPHI <- "114.46217"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.429538651"
Evaluating: 0.429538651*360.0
 Parameter: YPHI <- "154.633914"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.330660937"
Evaluating: 0.330660937*360.0
 Parameter: ZPHI <- "119.037937"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.0764724"
 Parameter: YPOS -> "34.7699153"
 Parameter: ZPOS -> "-53.3045337"
 Parameter: XPHI -> "114.46217"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.414092    0.910235
    0.000000   -0.910235   -0.414092

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.0764724"
 Parameter: YPOS -> "34.7699153"
 Parameter: ZPOS -> "-53.3045337"
 Parameter: YPHI -> "154.633914"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.903589    0.000000   -0.428400
    0.000000    1.000000    0.000000
    0.428400    0.000000   -0.903589

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  154.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.0764724"
 Parameter: YPOS -> "34.7699153"
 Parameter: ZPOS -> "-53.3045337"
 Parameter: ZPHI -> "119.037937"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.485389    0.874299    0.000000
   -0.874299   -0.485389    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  119.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.076472 XMAX =  -25.076472 XAVE =  -25.076472
    YMIN =   34.769915 YMAX =   34.769915 YAVE =   34.769915
    ZMIN =  -53.304534 ZMAX =  -53.304534 ZAVE =  -53.304534
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.0764724"
Evaluating: -25.0764724+3.5
 Parameter: XMAX <- "-21.5764724"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.7699153"
Evaluating: 34.7699153+3.5
 Parameter: YMAX <- "38.2699153"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.3045337"
Evaluating: -53.3045337+3.5
 Parameter: ZMAX <- "-49.8045337"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.0764724"
Evaluating: -25.0764724-3.5
 Parameter: XMIN <- "-28.5764724"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.7699153"
Evaluating: 34.7699153-3.5
 Parameter: YMIN <- "31.2699153"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.3045337"
Evaluating: -53.3045337-3.5
 Parameter: ZMIN <- "-56.8045337"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.5764724"
 Parameter: XMIN -> "-28.5764724"
 Parameter: YMAX -> "38.2699153"
 Parameter: YMIN -> "31.2699153"
 Parameter: ZMAX -> "-49.8045337"
 Parameter: ZMIN -> "-56.8045337"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "112"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "112" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "112"
Evaluating: 112
 Parameter: J <- "112"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "112" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "112"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.129187832"
Evaluating: 112.065471*(0.129187832-0.5)
 Parameter: XPOS <- "-41.5552403"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.712898814"
Evaluating: 112.065471*(0.712898814-0.5)
 Parameter: YPOS <- "23.8586059"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.405018793"
Evaluating: 142.885239*(0.405018793-0.5)+2.93414115
 Parameter: ZPOS <- "-10.6372713"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.6372713" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.6372713" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "112"
Evaluating: 112
 Parameter: J <- "112"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "112" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "112"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.913417609"
Evaluating: 112.065471*(0.913417609-0.5)
 Parameter: XPOS <- "46.3298391"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.323714277"
Evaluating: 112.065471*(0.323714277-0.5)
 Parameter: YPOS <- "-19.7555426"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "9.091813379E-02"
Evaluating: 142.885239*(9.091813379E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-55.5176191"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.5176191" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.3298391"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.3298391-0
 Parameter: XTRAN <- "46.3298391"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.7555426"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -19.7555426-0
 Parameter: YTRAN <- "-19.7555426"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.5176191"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.5176191-0
 Parameter: ZTRAN <- "-55.5176191"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.3298391"
 Parameter: YTRAN -> "-19.7555426"
 Parameter: ZTRAN -> "-55.5176191"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    46.329839  -19.755543  -55.517619
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.556413038"
Evaluating: 0.556413038*360.0
 Parameter: XPHI <- "200.308694"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.575871619"
Evaluating: 0.575871619*360.0
 Parameter: YPHI <- "207.313783"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.8449583"
Evaluating: 0.8449583*360.0
 Parameter: ZPHI <- "304.184988"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.3298391"
 Parameter: YPOS -> "-19.7555426"
 Parameter: ZPOS -> "-55.5176191"
 Parameter: XPHI -> "200.308694"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.937836   -0.347078
    0.000000    0.347078   -0.937836

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  159.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.3298391"
 Parameter: YPOS -> "-19.7555426"
 Parameter: ZPOS -> "-55.5176191"
 Parameter: YPHI -> "207.313783"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.888507    0.000000    0.458863
    0.000000    1.000000    0.000000
   -0.458863    0.000000   -0.888507

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  152.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.3298391"
 Parameter: YPOS -> "-19.7555426"
 Parameter: ZPOS -> "-55.5176191"
 Parameter: ZPHI -> "304.184988"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.561867   -0.827228    0.000000
    0.827228    0.561867    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   55.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.329839 XMAX =   46.329839 XAVE =   46.329839
    YMIN =  -19.755543 YMAX =  -19.755543 YAVE =  -19.755543
    ZMIN =  -55.517619 ZMAX =  -55.517619 ZAVE =  -55.517619
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.3298391"
Evaluating: 46.3298391+3.5
 Parameter: XMAX <- "49.8298391"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.7555426"
Evaluating: -19.7555426+3.5
 Parameter: YMAX <- "-16.2555426"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.5176191"
Evaluating: -55.5176191+3.5
 Parameter: ZMAX <- "-52.0176191"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.3298391"
Evaluating: 46.3298391-3.5
 Parameter: XMIN <- "42.8298391"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.7555426"
Evaluating: -19.7555426-3.5
 Parameter: YMIN <- "-23.2555426"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.5176191"
Evaluating: -55.5176191-3.5
 Parameter: ZMIN <- "-59.0176191"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.8298391"
 Parameter: XMIN -> "42.8298391"
 Parameter: YMAX -> "-16.2555426"
 Parameter: YMIN -> "-23.2555426"
 Parameter: ZMAX -> "-52.0176191"
 Parameter: ZMIN -> "-59.0176191"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "113"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "113" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "113"
Evaluating: 113
 Parameter: J <- "113"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "113" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "113"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.635292915"
Evaluating: 112.065471*(0.635292915-0.5)
 Parameter: XPOS <- "15.1616642"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.372007425"
Evaluating: 112.065471*(0.372007425-0.5)
 Parameter: YPOS <- "-14.3435482"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.988480617"
Evaluating: 142.885239*(0.988480617-0.5)+2.93414115
 Parameter: ZPOS <- "72.7308109"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "72.7308109" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "72.7308109" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.1616642"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.1616642-0
 Parameter: XTRAN <- "15.1616642"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.3435482"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.3435482-0
 Parameter: YTRAN <- "-14.3435482"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "72.7308109"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 72.7308109-0
 Parameter: ZTRAN <- "72.7308109"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.1616642"
 Parameter: YTRAN -> "-14.3435482"
 Parameter: ZTRAN -> "72.7308109"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    15.161664  -14.343548   72.730811
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.768066414"
Evaluating: 0.768066414*360.0
 Parameter: XPHI <- "276.503909"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137787858"
Evaluating: 0.137787858*360.0
 Parameter: YPHI <- "49.6036289"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.583155763E-02"
Evaluating: 8.583155763E-02*360.0
 Parameter: ZPHI <- "30.8993607"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.1616642"
 Parameter: YPOS -> "-14.3435482"
 Parameter: ZPOS -> "72.7308109"
 Parameter: XPHI -> "276.503909"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.113271   -0.993564
    0.000000    0.993564    0.113271

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   83.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.1616642"
 Parameter: YPOS -> "-14.3435482"
 Parameter: ZPOS -> "72.7308109"
 Parameter: YPHI -> "49.6036289"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.648072    0.000000   -0.761579
    0.000000    1.000000    0.000000
    0.761579    0.000000    0.648072

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   49.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.1616642"
 Parameter: YPOS -> "-14.3435482"
 Parameter: ZPOS -> "72.7308109"
 Parameter: ZPHI -> "30.8993607"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.858071    0.513532    0.000000
   -0.513532    0.858071    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   30.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.161664 XMAX =   15.161664 XAVE =   15.161664
    YMIN =  -14.343548 YMAX =  -14.343548 YAVE =  -14.343548
    ZMIN =   72.730811 ZMAX =   72.730811 ZAVE =   72.730811
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.1616642"
Evaluating: 15.1616642+3.5
 Parameter: XMAX <- "18.6616642"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.3435482"
Evaluating: -14.3435482+3.5
 Parameter: YMAX <- "-10.8435482"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "72.7308109"
Evaluating: 72.7308109+3.5
 Parameter: ZMAX <- "76.2308109"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.1616642"
Evaluating: 15.1616642-3.5
 Parameter: XMIN <- "11.6616642"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.3435482"
Evaluating: -14.3435482-3.5
 Parameter: YMIN <- "-17.8435482"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "72.7308109"
Evaluating: 72.7308109-3.5
 Parameter: ZMIN <- "69.2308109"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.6616642"
 Parameter: XMIN -> "11.6616642"
 Parameter: YMAX -> "-10.8435482"
 Parameter: YMIN -> "-17.8435482"
 Parameter: ZMAX -> "76.2308109"
 Parameter: ZMIN -> "69.2308109"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "114"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "114" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "114"
Evaluating: 114
 Parameter: J <- "114"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "114" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "114"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.511821767"
Evaluating: 112.065471*(0.511821767-0.5)
 Parameter: XPOS <- "1.32481189"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.928831017"
Evaluating: 112.065471*(0.928831017-0.5)
 Parameter: YPOS <- "48.0571499"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.635574266"
Evaluating: 142.885239*(0.635574266-0.5)+2.93414115
 Parameter: ZPOS <- "22.3057025"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.3057025" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.3057025" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.32481189"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.32481189-0
 Parameter: XTRAN <- "1.32481189"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "48.0571499"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 48.0571499-0
 Parameter: YTRAN <- "48.0571499"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.3057025"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.3057025-0
 Parameter: ZTRAN <- "22.3057025"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.32481189"
 Parameter: YTRAN -> "48.0571499"
 Parameter: ZTRAN -> "22.3057025"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     1.324812   48.057150   22.305702
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.230392519"
Evaluating: 0.230392519*360.0
 Parameter: XPHI <- "82.9413068"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.614211636"
Evaluating: 0.614211636*360.0
 Parameter: YPHI <- "221.116189"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.98542638"
Evaluating: 0.98542638*360.0
 Parameter: ZPHI <- "354.753497"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.32481189"
 Parameter: YPOS -> "48.0571499"
 Parameter: ZPOS -> "22.3057025"
 Parameter: XPHI -> "82.9413068"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.122886    0.992421
    0.000000   -0.992421    0.122886

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   82.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.32481189"
 Parameter: YPOS -> "48.0571499"
 Parameter: ZPOS -> "22.3057025"
 Parameter: YPHI -> "221.116189"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.753378    0.000000    0.657588
    0.000000    1.000000    0.000000
   -0.657588    0.000000   -0.753378

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  138.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.32481189"
 Parameter: YPOS -> "48.0571499"
 Parameter: ZPOS -> "22.3057025"
 Parameter: ZPHI -> "354.753497"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.995811   -0.091441    0.000000
    0.091441    0.995811    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    5.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.324812 XMAX =    1.324812 XAVE =    1.324812
    YMIN =   48.057150 YMAX =   48.057150 YAVE =   48.057150
    ZMIN =   22.305702 ZMAX =   22.305702 ZAVE =   22.305702
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.32481189"
Evaluating: 1.32481189+3.5
 Parameter: XMAX <- "4.82481189"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "48.0571499"
Evaluating: 48.0571499+3.5
 Parameter: YMAX <- "51.5571499"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.3057025"
Evaluating: 22.3057025+3.5
 Parameter: ZMAX <- "25.8057025"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.32481189"
Evaluating: 1.32481189-3.5
 Parameter: XMIN <- "-2.17518811"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "48.0571499"
Evaluating: 48.0571499-3.5
 Parameter: YMIN <- "44.5571499"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.3057025"
Evaluating: 22.3057025-3.5
 Parameter: ZMIN <- "18.8057025"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.82481189"
 Parameter: XMIN -> "-2.17518811"
 Parameter: YMAX -> "51.5571499"
 Parameter: YMIN -> "44.5571499"
 Parameter: ZMAX -> "25.8057025"
 Parameter: ZMIN -> "18.8057025"
 SELRPN>     17 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      6 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53171 POS      POT      114      POT     -**** MEMB     POPC     66       N             2.4610
53171 POS      POT      114      POT     -**** MEMB     POPC     66       C12           3.9889
53171 POS      POT      114      POT     -**** MEMB     POPC     66       C13           2.0450
53171 POS      POT      114      POT     -**** MEMB     POPC     66       C14           2.7679
53171 POS      POT      114      POT     -**** MEMB     POPC     66       C15           2.4156
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "114"
Evaluating: 114
 Parameter: J <- "114"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "114" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "114"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.66725433"
Evaluating: 112.065471*(0.66725433-0.5)
 Parameter: XPOS <- "18.7434353"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.720685342"
Evaluating: 112.065471*(0.720685342-0.5)
 Parameter: YPOS <- "24.7312068"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.716039355"
Evaluating: 142.885239*(0.716039355-0.5)+2.93414115
 Parameter: ZPOS <- "33.802976"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.802976" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.802976" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.324812 XMAX =    1.324812 XAVE =    1.324812
    YMIN =   48.057150 YMAX =   48.057150 YAVE =   48.057150
    ZMIN =   22.305702 ZMAX =   22.305702 ZAVE =   22.305702
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.7434353"
 RDCMND substituted energy or value "?XAVE" to "1.32481189"
Evaluating: 18.7434353-1.32481189
 Parameter: XTRAN <- "17.4186234"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.7312068"
 RDCMND substituted energy or value "?YAVE" to "48.0571499"
Evaluating: 24.7312068-48.0571499
 Parameter: YTRAN <- "-23.3259431"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.802976"
 RDCMND substituted energy or value "?ZAVE" to "22.3057025"
Evaluating: 33.802976-22.3057025
 Parameter: ZTRAN <- "11.4972735"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.4186234"
 Parameter: YTRAN -> "-23.3259431"
 Parameter: ZTRAN -> "11.4972735"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    17.418623  -23.325943   11.497274
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.778392756"
Evaluating: 0.778392756*360.0
 Parameter: XPHI <- "280.221392"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.573791412"
Evaluating: 0.573791412*360.0
 Parameter: YPHI <- "206.564908"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.55003071"
Evaluating: 0.55003071*360.0
 Parameter: ZPHI <- "198.011056"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.7434353"
 Parameter: YPOS -> "24.7312068"
 Parameter: ZPOS -> "33.802976"
 Parameter: XPHI -> "280.221392"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.177452   -0.984129
    0.000000    0.984129    0.177452

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   79.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.7434353"
 Parameter: YPOS -> "24.7312068"
 Parameter: ZPOS -> "33.802976"
 Parameter: YPHI -> "206.564908"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.894428    0.000000    0.447211
    0.000000    1.000000    0.000000
   -0.447211    0.000000   -0.894428

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  153.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.7434353"
 Parameter: YPOS -> "24.7312068"
 Parameter: ZPOS -> "33.802976"
 Parameter: ZPHI -> "198.011056"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.950997   -0.309201    0.000000
    0.309201   -0.950997    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  161.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.743435 XMAX =   18.743435 XAVE =   18.743435
    YMIN =   24.731207 YMAX =   24.731207 YAVE =   24.731207
    ZMIN =   33.802976 ZMAX =   33.802976 ZAVE =   33.802976
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.7434353"
Evaluating: 18.7434353+3.5
 Parameter: XMAX <- "22.2434353"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.7312068"
Evaluating: 24.7312068+3.5
 Parameter: YMAX <- "28.2312068"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.802976"
Evaluating: 33.802976+3.5
 Parameter: ZMAX <- "37.302976"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.7434353"
Evaluating: 18.7434353-3.5
 Parameter: XMIN <- "15.2434353"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.7312068"
Evaluating: 24.7312068-3.5
 Parameter: YMIN <- "21.2312068"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.802976"
Evaluating: 33.802976-3.5
 Parameter: ZMIN <- "30.302976"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.2434353"
 Parameter: XMIN -> "15.2434353"
 Parameter: YMAX -> "28.2312068"
 Parameter: YMIN -> "21.2312068"
 Parameter: ZMAX -> "37.302976"
 Parameter: ZMIN -> "30.302976"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "115"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "115" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "115"
Evaluating: 115
 Parameter: J <- "115"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "115" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "115"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.192533946"
Evaluating: 112.065471*(0.192533946-0.5)
 Parameter: XPOS <- "-34.4563282"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.929682103"
Evaluating: 112.065471*(0.929682103-0.5)
 Parameter: YPOS <- "48.1525273"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.834092944"
Evaluating: 142.885239*(0.834092944-0.5)+2.93414115
 Parameter: ZPOS <- "50.6710913"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.6710913" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.6710913" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.4563282"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.4563282-0
 Parameter: XTRAN <- "-34.4563282"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "48.1525273"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 48.1525273-0
 Parameter: YTRAN <- "48.1525273"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.6710913"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 50.6710913-0
 Parameter: ZTRAN <- "50.6710913"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.4563282"
 Parameter: YTRAN -> "48.1525273"
 Parameter: ZTRAN -> "50.6710913"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -34.456328   48.152527   50.671091
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.680285877"
Evaluating: 0.680285877*360.0
 Parameter: XPHI <- "244.902916"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.113954382"
Evaluating: 0.113954382*360.0
 Parameter: YPHI <- "41.0235775"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.816478315"
Evaluating: 0.816478315*360.0
 Parameter: ZPHI <- "293.932193"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.4563282"
 Parameter: YPOS -> "48.1525273"
 Parameter: ZPOS -> "50.6710913"
 Parameter: XPHI -> "244.902916"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.424153   -0.905590
    0.000000    0.905590   -0.424153

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.4563282"
 Parameter: YPOS -> "48.1525273"
 Parameter: ZPOS -> "50.6710913"
 Parameter: YPHI -> "41.0235775"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.754440    0.000000   -0.656370
    0.000000    1.000000    0.000000
    0.656370    0.000000    0.754440

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   41.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.4563282"
 Parameter: YPOS -> "48.1525273"
 Parameter: ZPOS -> "50.6710913"
 Parameter: ZPHI -> "293.932193"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.405655   -0.914026    0.000000
    0.914026    0.405655    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.456328 XMAX =  -34.456328 XAVE =  -34.456328
    YMIN =   48.152527 YMAX =   48.152527 YAVE =   48.152527
    ZMIN =   50.671091 ZMAX =   50.671091 ZAVE =   50.671091
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.4563282"
Evaluating: -34.4563282+3.5
 Parameter: XMAX <- "-30.9563282"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "48.1525273"
Evaluating: 48.1525273+3.5
 Parameter: YMAX <- "51.6525273"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.6710913"
Evaluating: 50.6710913+3.5
 Parameter: ZMAX <- "54.1710913"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.4563282"
Evaluating: -34.4563282-3.5
 Parameter: XMIN <- "-37.9563282"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "48.1525273"
Evaluating: 48.1525273-3.5
 Parameter: YMIN <- "44.6525273"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.6710913"
Evaluating: 50.6710913-3.5
 Parameter: ZMIN <- "47.1710913"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.9563282"
 Parameter: XMIN -> "-37.9563282"
 Parameter: YMAX -> "51.6525273"
 Parameter: YMIN -> "44.6525273"
 Parameter: ZMAX -> "54.1710913"
 Parameter: ZMIN -> "47.1710913"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "116"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "116" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "116"
Evaluating: 116
 Parameter: J <- "116"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "116" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "116"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.415355827"
Evaluating: 112.065471*(0.415355827-0.5)
 Parameter: XPOS <- "-9.48568911"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.180580674"
Evaluating: 112.065471*(0.180580674-0.5)
 Parameter: YPOS <- "-35.7958772"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.86483971"
Evaluating: 142.885239*(0.86483971-0.5)+2.93414115
 Parameter: ZPOS <- "55.0643503"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "55.0643503" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "55.0643503" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.48568911"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.48568911-0
 Parameter: XTRAN <- "-9.48568911"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.7958772"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.7958772-0
 Parameter: YTRAN <- "-35.7958772"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "55.0643503"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 55.0643503-0
 Parameter: ZTRAN <- "55.0643503"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.48568911"
 Parameter: YTRAN -> "-35.7958772"
 Parameter: ZTRAN -> "55.0643503"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -9.485689  -35.795877   55.064350
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318580049"
Evaluating: 0.318580049*360.0
 Parameter: XPHI <- "114.688818"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.305158611"
Evaluating: 0.305158611*360.0
 Parameter: YPHI <- "109.8571"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.108249887"
Evaluating: 0.108249887*360.0
 Parameter: ZPHI <- "38.9699593"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.48568911"
 Parameter: YPOS -> "-35.7958772"
 Parameter: ZPOS -> "55.0643503"
 Parameter: XPHI -> "114.688818"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.417690    0.908590
    0.000000   -0.908590   -0.417690

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.48568911"
 Parameter: YPOS -> "-35.7958772"
 Parameter: ZPOS -> "55.0643503"
 Parameter: YPHI -> "109.8571"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.339675    0.000000   -0.940543
    0.000000    1.000000    0.000000
    0.940543    0.000000   -0.339675

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.48568911"
 Parameter: YPOS -> "-35.7958772"
 Parameter: ZPOS -> "55.0643503"
 Parameter: ZPHI -> "38.9699593"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.777476    0.628913    0.000000
   -0.628913    0.777476    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   38.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.485689 XMAX =   -9.485689 XAVE =   -9.485689
    YMIN =  -35.795877 YMAX =  -35.795877 YAVE =  -35.795877
    ZMIN =   55.064350 ZMAX =   55.064350 ZAVE =   55.064350
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.48568911"
Evaluating: -9.48568911+3.5
 Parameter: XMAX <- "-5.98568911"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.7958772"
Evaluating: -35.7958772+3.5
 Parameter: YMAX <- "-32.2958772"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "55.0643503"
Evaluating: 55.0643503+3.5
 Parameter: ZMAX <- "58.5643503"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.48568911"
Evaluating: -9.48568911-3.5
 Parameter: XMIN <- "-12.9856891"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.7958772"
Evaluating: -35.7958772-3.5
 Parameter: YMIN <- "-39.2958772"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "55.0643503"
Evaluating: 55.0643503-3.5
 Parameter: ZMIN <- "51.5643503"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.98568911"
 Parameter: XMIN -> "-12.9856891"
 Parameter: YMAX -> "-32.2958772"
 Parameter: YMIN -> "-39.2958772"
 Parameter: ZMAX -> "58.5643503"
 Parameter: ZMIN -> "51.5643503"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "117"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "117" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "117" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "117"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.786549076"
Evaluating: 112.065471*(0.786549076-0.5)
 Parameter: XPOS <- "32.1122572"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.386770053"
Evaluating: 112.065471*(0.386770053-0.5)
 Parameter: YPOS <- "-12.6891673"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.667763466"
Evaluating: 142.885239*(0.667763466-0.5)+2.93414115
 Parameter: ZPOS <- "26.9050641"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.9050641" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.9050641" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.1122572"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.1122572-0
 Parameter: XTRAN <- "32.1122572"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.6891673"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.6891673-0
 Parameter: YTRAN <- "-12.6891673"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.9050641"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.9050641-0
 Parameter: ZTRAN <- "26.9050641"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.1122572"
 Parameter: YTRAN -> "-12.6891673"
 Parameter: ZTRAN -> "26.9050641"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    32.112257  -12.689167   26.905064
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.778431648"
Evaluating: 0.778431648*360.0
 Parameter: XPHI <- "280.235393"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.883904694"
Evaluating: 0.883904694*360.0
 Parameter: YPHI <- "318.20569"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.567672686"
Evaluating: 0.567672686*360.0
 Parameter: ZPHI <- "204.362167"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.1122572"
 Parameter: YPOS -> "-12.6891673"
 Parameter: ZPOS -> "26.9050641"
 Parameter: XPHI -> "280.235393"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.177693   -0.984086
    0.000000    0.984086    0.177693

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   79.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.1122572"
 Parameter: YPOS -> "-12.6891673"
 Parameter: ZPOS -> "26.9050641"
 Parameter: YPHI -> "318.20569"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.745542    0.000000    0.666458
    0.000000    1.000000    0.000000
   -0.666458    0.000000    0.745542

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   41.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.1122572"
 Parameter: YPOS -> "-12.6891673"
 Parameter: ZPOS -> "26.9050641"
 Parameter: ZPHI -> "204.362167"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.910956   -0.412503    0.000000
    0.412503   -0.910956    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  155.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.112257 XMAX =   32.112257 XAVE =   32.112257
    YMIN =  -12.689167 YMAX =  -12.689167 YAVE =  -12.689167
    ZMIN =   26.905064 ZMAX =   26.905064 ZAVE =   26.905064
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.1122572"
Evaluating: 32.1122572+3.5
 Parameter: XMAX <- "35.6122572"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.6891673"
Evaluating: -12.6891673+3.5
 Parameter: YMAX <- "-9.1891673"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.9050641"
Evaluating: 26.9050641+3.5
 Parameter: ZMAX <- "30.4050641"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.1122572"
Evaluating: 32.1122572-3.5
 Parameter: XMIN <- "28.6122572"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.6891673"
Evaluating: -12.6891673-3.5
 Parameter: YMIN <- "-16.1891673"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.9050641"
Evaluating: 26.9050641-3.5
 Parameter: ZMIN <- "23.4050641"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.6122572"
 Parameter: XMIN -> "28.6122572"
 Parameter: YMAX -> "-9.1891673"
 Parameter: YMIN -> "-16.1891673"
 Parameter: ZMAX -> "30.4050641"
 Parameter: ZMIN -> "23.4050641"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "118"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "118" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "118" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "118"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.873559655"
Evaluating: 112.065471*(0.873559655-0.5)
 Parameter: XPOS <- "41.8631387"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.88728749"
Evaluating: 112.065471*(0.88728749-0.5)
 Parameter: YPOS <- "43.401555"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.971784366"
Evaluating: 142.885239*(0.971784366-0.5)+2.93414115
 Parameter: ZPOS <- "70.345163"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "70.345163" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "70.345163" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.8631387"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.8631387-0
 Parameter: XTRAN <- "41.8631387"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.401555"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 43.401555-0
 Parameter: YTRAN <- "43.401555"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "70.345163"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 70.345163-0
 Parameter: ZTRAN <- "70.345163"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.8631387"
 Parameter: YTRAN -> "43.401555"
 Parameter: ZTRAN -> "70.345163"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    41.863139   43.401555   70.345163
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.339389017"
Evaluating: 0.339389017*360.0
 Parameter: XPHI <- "122.180046"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.51194026"
Evaluating: 0.51194026*360.0
 Parameter: YPHI <- "184.298494"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.833053404"
Evaluating: 0.833053404*360.0
 Parameter: ZPHI <- "299.899225"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.8631387"
 Parameter: YPOS -> "43.401555"
 Parameter: ZPOS -> "70.345163"
 Parameter: XPHI -> "122.180046"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.532582    0.846379
    0.000000   -0.846379   -0.532582

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  122.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.8631387"
 Parameter: YPOS -> "43.401555"
 Parameter: ZPOS -> "70.345163"
 Parameter: YPHI -> "184.298494"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.997187    0.000000    0.074953
    0.000000    1.000000    0.000000
   -0.074953    0.000000   -0.997187

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  175.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.8631387"
 Parameter: YPOS -> "43.401555"
 Parameter: ZPOS -> "70.345163"
 Parameter: ZPHI -> "299.899225"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.498476   -0.866903    0.000000
    0.866903    0.498476    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.863139 XMAX =   41.863139 XAVE =   41.863139
    YMIN =   43.401555 YMAX =   43.401555 YAVE =   43.401555
    ZMIN =   70.345163 ZMAX =   70.345163 ZAVE =   70.345163
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.8631387"
Evaluating: 41.8631387+3.5
 Parameter: XMAX <- "45.3631387"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.401555"
Evaluating: 43.401555+3.5
 Parameter: YMAX <- "46.901555"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "70.345163"
Evaluating: 70.345163+3.5
 Parameter: ZMAX <- "73.845163"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.8631387"
Evaluating: 41.8631387-3.5
 Parameter: XMIN <- "38.3631387"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.401555"
Evaluating: 43.401555-3.5
 Parameter: YMIN <- "39.901555"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "70.345163"
Evaluating: 70.345163-3.5
 Parameter: ZMIN <- "66.845163"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.3631387"
 Parameter: XMIN -> "38.3631387"
 Parameter: YMAX -> "46.901555"
 Parameter: YMIN -> "39.901555"
 Parameter: ZMAX -> "73.845163"
 Parameter: ZMIN -> "66.845163"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "119"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "119" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "119" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "119"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.706351974"
Evaluating: 112.065471*(0.706351974-0.5)
 Parameter: XPOS <- "23.1249312"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.30126774"
Evaluating: 112.065471*(0.30126774-0.5)
 Parameter: YPOS <- "-22.2710243"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.171536838"
Evaluating: 142.885239*(0.171536838-0.5)+2.93414115
 Parameter: ZPOS <- "-43.9983963"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.9983963" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.1249312"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.1249312-0
 Parameter: XTRAN <- "23.1249312"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.2710243"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.2710243-0
 Parameter: YTRAN <- "-22.2710243"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.9983963"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.9983963-0
 Parameter: ZTRAN <- "-43.9983963"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.1249312"
 Parameter: YTRAN -> "-22.2710243"
 Parameter: ZTRAN -> "-43.9983963"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    23.124931  -22.271024  -43.998396
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.635928078"
Evaluating: 0.635928078*360.0
 Parameter: XPHI <- "228.934108"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926384837"
Evaluating: 0.926384837*360.0
 Parameter: YPHI <- "333.498541"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.814285508E-03"
Evaluating: 7.814285508E-03*360.0
 Parameter: ZPHI <- "2.81314278"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.1249312"
 Parameter: YPOS -> "-22.2710243"
 Parameter: ZPOS -> "-43.9983963"
 Parameter: XPHI -> "228.934108"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.656927   -0.753955
    0.000000    0.753955   -0.656927

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  131.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.1249312"
 Parameter: YPOS -> "-22.2710243"
 Parameter: ZPOS -> "-43.9983963"
 Parameter: YPHI -> "333.498541"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.894923    0.000000    0.446221
    0.000000    1.000000    0.000000
   -0.446221    0.000000    0.894923

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   26.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.1249312"
 Parameter: YPOS -> "-22.2710243"
 Parameter: ZPOS -> "-43.9983963"
 Parameter: ZPHI -> "2.81314278"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.998795    0.049079    0.000000
   -0.049079    0.998795    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    2.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.124931 XMAX =   23.124931 XAVE =   23.124931
    YMIN =  -22.271024 YMAX =  -22.271024 YAVE =  -22.271024
    ZMIN =  -43.998396 ZMAX =  -43.998396 ZAVE =  -43.998396
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.1249312"
Evaluating: 23.1249312+3.5
 Parameter: XMAX <- "26.6249312"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.2710243"
Evaluating: -22.2710243+3.5
 Parameter: YMAX <- "-18.7710243"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.9983963"
Evaluating: -43.9983963+3.5
 Parameter: ZMAX <- "-40.4983963"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.1249312"
Evaluating: 23.1249312-3.5
 Parameter: XMIN <- "19.6249312"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.2710243"
Evaluating: -22.2710243-3.5
 Parameter: YMIN <- "-25.7710243"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.9983963"
Evaluating: -43.9983963-3.5
 Parameter: ZMIN <- "-47.4983963"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.6249312"
 Parameter: XMIN -> "19.6249312"
 Parameter: YMAX -> "-18.7710243"
 Parameter: YMIN -> "-25.7710243"
 Parameter: ZMAX -> "-40.4983963"
 Parameter: ZMIN -> "-47.4983963"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "120"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "120" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "120"
Evaluating: 120
 Parameter: J <- "120"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "120" and "120".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "120"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.7712354"
Evaluating: 112.065471*(0.7712354-0.5)
 Parameter: XPOS <- "30.3961229"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.432807838"
Evaluating: 112.065471*(0.432807838-0.5)
 Parameter: YPOS <- "-7.52992128"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "8.659105211E-02"
Evaluating: 142.885239*(8.659105211E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-56.1358952"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.1358952" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.3961229"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.3961229-0
 Parameter: XTRAN <- "30.3961229"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.52992128"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.52992128-0
 Parameter: YTRAN <- "-7.52992128"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.1358952"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.1358952-0
 Parameter: ZTRAN <- "-56.1358952"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.3961229"
 Parameter: YTRAN -> "-7.52992128"
 Parameter: ZTRAN -> "-56.1358952"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    30.396123   -7.529921  -56.135895
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.705840211"
Evaluating: 0.705840211*360.0
 Parameter: XPHI <- "254.102476"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.46659338"
Evaluating: 0.46659338*360.0
 Parameter: YPHI <- "167.973617"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.497536495"
Evaluating: 0.497536495*360.0
 Parameter: ZPHI <- "179.113138"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.3961229"
 Parameter: YPOS -> "-7.52992128"
 Parameter: ZPOS -> "-56.1358952"
 Parameter: XPHI -> "254.102476"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.273918   -0.961753
    0.000000    0.961753   -0.273918

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  105.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.3961229"
 Parameter: YPOS -> "-7.52992128"
 Parameter: ZPOS -> "-56.1358952"
 Parameter: YPHI -> "167.973617"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.978052    0.000000   -0.208362
    0.000000    1.000000    0.000000
    0.208362    0.000000   -0.978052

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  167.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.3961229"
 Parameter: YPOS -> "-7.52992128"
 Parameter: ZPOS -> "-56.1358952"
 Parameter: ZPHI -> "179.113138"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.999880    0.015478    0.000000
   -0.015478   -0.999880    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  179.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.396123 XMAX =   30.396123 XAVE =   30.396123
    YMIN =   -7.529921 YMAX =   -7.529921 YAVE =   -7.529921
    ZMIN =  -56.135895 ZMAX =  -56.135895 ZAVE =  -56.135895
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.3961229"
Evaluating: 30.3961229+3.5
 Parameter: XMAX <- "33.8961229"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.52992128"
Evaluating: -7.52992128+3.5
 Parameter: YMAX <- "-4.02992128"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.1358952"
Evaluating: -56.1358952+3.5
 Parameter: ZMAX <- "-52.6358952"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.3961229"
Evaluating: 30.3961229-3.5
 Parameter: XMIN <- "26.8961229"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.52992128"
Evaluating: -7.52992128-3.5
 Parameter: YMIN <- "-11.0299213"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.1358952"
Evaluating: -56.1358952-3.5
 Parameter: ZMIN <- "-59.6358952"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.8961229"
 Parameter: XMIN -> "26.8961229"
 Parameter: YMAX -> "-4.02992128"
 Parameter: YMIN -> "-11.0299213"
 Parameter: ZMAX -> "-52.6358952"
 Parameter: ZMIN -> "-59.6358952"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "121"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "121" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "121" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "121"
 Parameter: NPOS -> "120"
Evaluating: 121-120
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.413375657"
Evaluating: 112.065471*(0.413375657-0.5)
 Parameter: XPOS <- "-9.7075978"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.711855714"
Evaluating: 112.065471*(0.711855714-0.5)
 Parameter: YPOS <- "23.7417104"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.552025717"
Evaluating: 142.885239*(0.552025717-0.5)+2.93414115
 Parameter: ZPOS <- "10.3678482"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.3678482" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.3678482" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "121" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "121"
 Parameter: NPOS -> "120"
Evaluating: 121-120
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.378703884"
Evaluating: 112.065471*(0.378703884-0.5)
 Parameter: XPOS <- "-13.5931064"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.776421465"
Evaluating: 112.065471*(0.776421465-0.5)
 Parameter: YPOS <- "30.9773017"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.239083282"
Evaluating: 142.885239*(0.239083282-0.5)+2.93414115
 Parameter: ZPOS <- "-34.3470065"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.3470065" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.5931064"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.5931064-0
 Parameter: XTRAN <- "-13.5931064"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.9773017"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.9773017-0
 Parameter: YTRAN <- "30.9773017"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.3470065"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.3470065-0
 Parameter: ZTRAN <- "-34.3470065"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.5931064"
 Parameter: YTRAN -> "30.9773017"
 Parameter: ZTRAN -> "-34.3470065"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -13.593106   30.977302  -34.347006
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.673550131"
Evaluating: 0.673550131*360.0
 Parameter: XPHI <- "242.478047"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.607807937"
Evaluating: 0.607807937*360.0
 Parameter: YPHI <- "218.810857"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.475637214"
Evaluating: 0.475637214*360.0
 Parameter: ZPHI <- "171.229397"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.5931064"
 Parameter: YPOS -> "30.9773017"
 Parameter: ZPOS -> "-34.3470065"
 Parameter: XPHI -> "242.478047"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.462088   -0.886834
    0.000000    0.886834   -0.462088

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  117.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.5931064"
 Parameter: YPOS -> "30.9773017"
 Parameter: ZPOS -> "-34.3470065"
 Parameter: YPHI -> "218.810857"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.779219    0.000000    0.626751
    0.000000    1.000000    0.000000
   -0.626751    0.000000   -0.779219

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  141.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.5931064"
 Parameter: YPOS -> "30.9773017"
 Parameter: ZPOS -> "-34.3470065"
 Parameter: ZPHI -> "171.229397"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.988307    0.152479    0.000000
   -0.152479   -0.988307    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  171.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.593106 XMAX =  -13.593106 XAVE =  -13.593106
    YMIN =   30.977302 YMAX =   30.977302 YAVE =   30.977302
    ZMIN =  -34.347006 ZMAX =  -34.347006 ZAVE =  -34.347006
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.5931064"
Evaluating: -13.5931064+3.5
 Parameter: XMAX <- "-10.0931064"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.9773017"
Evaluating: 30.9773017+3.5
 Parameter: YMAX <- "34.4773017"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.3470065"
Evaluating: -34.3470065+3.5
 Parameter: ZMAX <- "-30.8470065"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.5931064"
Evaluating: -13.5931064-3.5
 Parameter: XMIN <- "-17.0931064"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.9773017"
Evaluating: 30.9773017-3.5
 Parameter: YMIN <- "27.4773017"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.3470065"
Evaluating: -34.3470065-3.5
 Parameter: ZMIN <- "-37.8470065"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.0931064"
 Parameter: XMIN -> "-17.0931064"
 Parameter: YMAX -> "34.4773017"
 Parameter: YMIN -> "27.4773017"
 Parameter: ZMAX -> "-30.8470065"
 Parameter: ZMIN -> "-37.8470065"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "122"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "122" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "122" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "122"
 Parameter: NPOS -> "120"
Evaluating: 122-120
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.426917859"
Evaluating: 112.065471*(0.426917859-0.5)
 Parameter: XPOS <- "-8.18998455"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.305196417"
Evaluating: 112.065471*(0.305196417-0.5)
 Parameter: YPOS <- "-21.8307553"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.463644814"
Evaluating: 142.885239*(0.463644814-0.5)+2.93414115
 Parameter: ZPOS <- "-2.26047829"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.26047829" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.26047829" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "122" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "122"
 Parameter: NPOS -> "120"
Evaluating: 122-120
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.682886877"
Evaluating: 112.065471*(0.682886877-0.5)
 Parameter: XPOS <- "20.495304"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.561257846E-02"
Evaluating: 112.065471*(7.561257846E-02-0.5)
 Parameter: YPOS <- "-47.5591763"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "9.268720783E-02"
Evaluating: 142.885239*(9.268720783E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-55.2648445"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.2648445" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.495304"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.495304-0
 Parameter: XTRAN <- "20.495304"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.5591763"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.5591763-0
 Parameter: YTRAN <- "-47.5591763"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.2648445"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.2648445-0
 Parameter: ZTRAN <- "-55.2648445"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.495304"
 Parameter: YTRAN -> "-47.5591763"
 Parameter: ZTRAN -> "-55.2648445"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    20.495304  -47.559176  -55.264845
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.674527381"
Evaluating: 0.674527381*360.0
 Parameter: XPHI <- "242.829857"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.327673289"
Evaluating: 0.327673289*360.0
 Parameter: YPHI <- "117.962384"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.337503465"
Evaluating: 0.337503465*360.0
 Parameter: ZPHI <- "121.501247"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.495304"
 Parameter: YPOS -> "-47.5591763"
 Parameter: ZPOS -> "-55.2648445"
 Parameter: XPHI -> "242.829857"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.456634   -0.889654
    0.000000    0.889654   -0.456634

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  117.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.495304"
 Parameter: YPOS -> "-47.5591763"
 Parameter: ZPOS -> "-55.2648445"
 Parameter: YPHI -> "117.962384"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.468892    0.000000   -0.883256
    0.000000    1.000000    0.000000
    0.883256    0.000000   -0.468892

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  117.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.495304"
 Parameter: YPOS -> "-47.5591763"
 Parameter: ZPOS -> "-55.2648445"
 Parameter: ZPHI -> "121.501247"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.522517    0.852629    0.000000
   -0.852629   -0.522517    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  121.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.495304 XMAX =   20.495304 XAVE =   20.495304
    YMIN =  -47.559176 YMAX =  -47.559176 YAVE =  -47.559176
    ZMIN =  -55.264845 ZMAX =  -55.264845 ZAVE =  -55.264845
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.495304"
Evaluating: 20.495304+3.5
 Parameter: XMAX <- "23.995304"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.5591763"
Evaluating: -47.5591763+3.5
 Parameter: YMAX <- "-44.0591763"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.2648445"
Evaluating: -55.2648445+3.5
 Parameter: ZMAX <- "-51.7648445"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.495304"
Evaluating: 20.495304-3.5
 Parameter: XMIN <- "16.995304"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.5591763"
Evaluating: -47.5591763-3.5
 Parameter: YMIN <- "-51.0591763"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.2648445"
Evaluating: -55.2648445-3.5
 Parameter: ZMIN <- "-58.7648445"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.995304"
 Parameter: XMIN -> "16.995304"
 Parameter: YMAX -> "-44.0591763"
 Parameter: YMIN -> "-51.0591763"
 Parameter: ZMAX -> "-51.7648445"
 Parameter: ZMIN -> "-58.7648445"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "123"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "123" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "123"
Evaluating: 123
 Parameter: J <- "123"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "123" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "123"
 Parameter: NPOS -> "120"
Evaluating: 123-120
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.173424201"
Evaluating: 112.065471*(0.173424201-0.5)
 Parameter: XPOS <- "-36.5978707"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.911888382E-02"
Evaluating: 112.065471*(7.911888382E-02-0.5)
 Parameter: YPOS <- "-47.1662405"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.156639911"
Evaluating: 142.885239*(0.156639911-0.5)+2.93414115
 Parameter: ZPOS <- "-46.1269472"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.1269472" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.5978707"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.5978707-0
 Parameter: XTRAN <- "-36.5978707"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.1662405"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.1662405-0
 Parameter: YTRAN <- "-47.1662405"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.1269472"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -46.1269472-0
 Parameter: ZTRAN <- "-46.1269472"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.5978707"
 Parameter: YTRAN -> "-47.1662405"
 Parameter: ZTRAN -> "-46.1269472"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -36.597871  -47.166241  -46.126947
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.154273133"
Evaluating: 0.154273133*360.0
 Parameter: XPHI <- "55.5383279"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.22807769"
Evaluating: 0.22807769*360.0
 Parameter: YPHI <- "82.1079684"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.731674665"
Evaluating: 0.731674665*360.0
 Parameter: ZPHI <- "263.402879"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.5978707"
 Parameter: YPOS -> "-47.1662405"
 Parameter: ZPOS -> "-46.1269472"
 Parameter: XPHI -> "55.5383279"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.565855    0.824505
    0.000000   -0.824505    0.565855

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   55.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.5978707"
 Parameter: YPOS -> "-47.1662405"
 Parameter: ZPOS -> "-46.1269472"
 Parameter: YPHI -> "82.1079684"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.137307    0.000000   -0.990529
    0.000000    1.000000    0.000000
    0.990529    0.000000    0.137307

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   82.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.5978707"
 Parameter: YPOS -> "-47.1662405"
 Parameter: ZPOS -> "-46.1269472"
 Parameter: ZPHI -> "263.402879"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.114887   -0.993379    0.000000
    0.993379   -0.114887    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   96.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.597871 XMAX =  -36.597871 XAVE =  -36.597871
    YMIN =  -47.166241 YMAX =  -47.166241 YAVE =  -47.166241
    ZMIN =  -46.126947 ZMAX =  -46.126947 ZAVE =  -46.126947
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.5978707"
Evaluating: -36.5978707+3.5
 Parameter: XMAX <- "-33.0978707"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.1662405"
Evaluating: -47.1662405+3.5
 Parameter: YMAX <- "-43.6662405"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.1269472"
Evaluating: -46.1269472+3.5
 Parameter: ZMAX <- "-42.6269472"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.5978707"
Evaluating: -36.5978707-3.5
 Parameter: XMIN <- "-40.0978707"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.1662405"
Evaluating: -47.1662405-3.5
 Parameter: YMIN <- "-50.6662405"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.1269472"
Evaluating: -46.1269472-3.5
 Parameter: ZMIN <- "-49.6269472"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.0978707"
 Parameter: XMIN -> "-40.0978707"
 Parameter: YMAX -> "-43.6662405"
 Parameter: YMIN -> "-50.6662405"
 Parameter: ZMAX -> "-42.6269472"
 Parameter: ZMIN -> "-49.6269472"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "124"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "124" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "124" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "124"
 Parameter: NPOS -> "120"
Evaluating: 124-120
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.843161497"
Evaluating: 112.065471*(0.843161497-0.5)
 Parameter: XPOS <- "38.4565548"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.542317698"
Evaluating: 112.065471*(0.542317698-0.5)
 Parameter: YPOS <- "4.74235276"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.472211072"
Evaluating: 142.885239*(0.472211072-0.5)+2.93414115
 Parameter: ZPOS <- "-1.03648647"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.03648647" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.03648647" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "124" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "124"
 Parameter: NPOS -> "120"
Evaluating: 124-120
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.719089455"
Evaluating: 112.065471*(0.719089455-0.5)
 Parameter: XPOS <- "24.552363"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.855023522"
Evaluating: 112.065471*(0.855023522-0.5)
 Parameter: YPOS <- "39.7858782"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.164170896"
Evaluating: 142.885239*(0.164170896-0.5)+2.93414115
 Parameter: ZPOS <- "-45.0508806"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-45.0508806" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.552363"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.552363-0
 Parameter: XTRAN <- "24.552363"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.7858782"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 39.7858782-0
 Parameter: YTRAN <- "39.7858782"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-45.0508806"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -45.0508806-0
 Parameter: ZTRAN <- "-45.0508806"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.552363"
 Parameter: YTRAN -> "39.7858782"
 Parameter: ZTRAN -> "-45.0508806"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    24.552363   39.785878  -45.050881
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.155539529"
Evaluating: 0.155539529*360.0
 Parameter: XPHI <- "55.9942304"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.608005872"
Evaluating: 0.608005872*360.0
 Parameter: YPHI <- "218.882114"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.195754556"
Evaluating: 0.195754556*360.0
 Parameter: ZPHI <- "70.4716402"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.552363"
 Parameter: YPOS -> "39.7858782"
 Parameter: ZPOS -> "-45.0508806"
 Parameter: XPHI -> "55.9942304"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.559276    0.828981
    0.000000   -0.828981    0.559276

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   55.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.552363"
 Parameter: YPOS -> "39.7858782"
 Parameter: ZPOS -> "-45.0508806"
 Parameter: YPHI -> "218.882114"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.778439    0.000000    0.627720
    0.000000    1.000000    0.000000
   -0.627720    0.000000   -0.778439

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  141.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.552363"
 Parameter: YPOS -> "39.7858782"
 Parameter: ZPOS -> "-45.0508806"
 Parameter: ZPHI -> "70.4716402"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.334273    0.942476    0.000000
   -0.942476    0.334273    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   70.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.552363 XMAX =   24.552363 XAVE =   24.552363
    YMIN =   39.785878 YMAX =   39.785878 YAVE =   39.785878
    ZMIN =  -45.050881 ZMAX =  -45.050881 ZAVE =  -45.050881
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.552363"
Evaluating: 24.552363+3.5
 Parameter: XMAX <- "28.052363"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.7858782"
Evaluating: 39.7858782+3.5
 Parameter: YMAX <- "43.2858782"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-45.0508806"
Evaluating: -45.0508806+3.5
 Parameter: ZMAX <- "-41.5508806"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.552363"
Evaluating: 24.552363-3.5
 Parameter: XMIN <- "21.052363"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.7858782"
Evaluating: 39.7858782-3.5
 Parameter: YMIN <- "36.2858782"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-45.0508806"
Evaluating: -45.0508806-3.5
 Parameter: ZMIN <- "-48.5508806"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.052363"
 Parameter: XMIN -> "21.052363"
 Parameter: YMAX -> "43.2858782"
 Parameter: YMIN -> "36.2858782"
 Parameter: ZMAX -> "-41.5508806"
 Parameter: ZMIN -> "-48.5508806"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "125"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "125" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "125" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "125"
 Parameter: NPOS -> "120"
Evaluating: 125-120
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "8.75758492E-02"
Evaluating: 112.065471*(8.75758492E-02-0.5)
 Parameter: XPOS <- "-46.2185067"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.360364904"
Evaluating: 112.065471*(0.360364904-0.5)
 Parameter: YPOS <- "-15.6482728"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.883996056"
Evaluating: 142.885239*(0.883996056-0.5)+2.93414115
 Parameter: ZPOS <- "57.8015094"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.8015094" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.8015094" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.2185067"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -46.2185067-0
 Parameter: XTRAN <- "-46.2185067"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.6482728"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.6482728-0
 Parameter: YTRAN <- "-15.6482728"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.8015094"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.8015094-0
 Parameter: ZTRAN <- "57.8015094"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.2185067"
 Parameter: YTRAN -> "-15.6482728"
 Parameter: ZTRAN -> "57.8015094"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -46.218507  -15.648273   57.801509
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549485511"
Evaluating: 0.549485511*360.0
 Parameter: XPHI <- "197.814784"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.511472824E-02"
Evaluating: 5.511472824E-02*360.0
 Parameter: YPHI <- "19.8413022"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.871287532"
Evaluating: 0.871287532*360.0
 Parameter: ZPHI <- "313.663512"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.2185067"
 Parameter: YPOS -> "-15.6482728"
 Parameter: ZPOS -> "57.8015094"
 Parameter: XPHI -> "197.814784"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.952050   -0.305941
    0.000000    0.305941   -0.952050

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.2185067"
 Parameter: YPOS -> "-15.6482728"
 Parameter: ZPOS -> "57.8015094"
 Parameter: YPHI -> "19.8413022"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.940636    0.000000   -0.339416
    0.000000    1.000000    0.000000
    0.339416    0.000000    0.940636

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   19.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.2185067"
 Parameter: YPOS -> "-15.6482728"
 Parameter: ZPOS -> "57.8015094"
 Parameter: ZPHI -> "313.663512"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.690422   -0.723407    0.000000
    0.723407    0.690422    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   46.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.218507 XMAX =  -46.218507 XAVE =  -46.218507
    YMIN =  -15.648273 YMAX =  -15.648273 YAVE =  -15.648273
    ZMIN =   57.801509 ZMAX =   57.801509 ZAVE =   57.801509
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.2185067"
Evaluating: -46.2185067+3.5
 Parameter: XMAX <- "-42.7185067"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.6482728"
Evaluating: -15.6482728+3.5
 Parameter: YMAX <- "-12.1482728"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.8015094"
Evaluating: 57.8015094+3.5
 Parameter: ZMAX <- "61.3015094"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.2185067"
Evaluating: -46.2185067-3.5
 Parameter: XMIN <- "-49.7185067"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.6482728"
Evaluating: -15.6482728-3.5
 Parameter: YMIN <- "-19.1482728"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.8015094"
Evaluating: 57.8015094-3.5
 Parameter: ZMIN <- "54.3015094"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.7185067"
 Parameter: XMIN -> "-49.7185067"
 Parameter: YMAX -> "-12.1482728"
 Parameter: YMIN -> "-19.1482728"
 Parameter: ZMAX -> "61.3015094"
 Parameter: ZMIN -> "54.3015094"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "126"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "126" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "126"
Evaluating: 126
 Parameter: J <- "126"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "126" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "126"
 Parameter: NPOS -> "120"
Evaluating: 126-120
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.762146401"
Evaluating: 112.065471*(0.762146401-0.5)
 Parameter: XPOS <- "29.3775599"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.917888431E-02"
Evaluating: 112.065471*(5.917888431E-02-0.5)
 Parameter: YPOS <- "-49.400826"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.715927998"
Evaluating: 142.885239*(0.715927998-0.5)+2.93414115
 Parameter: ZPOS <- "33.7870648"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.7870648" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.7870648" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.3775599"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.3775599-0
 Parameter: XTRAN <- "29.3775599"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.400826"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -49.400826-0
 Parameter: YTRAN <- "-49.400826"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.7870648"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.7870648-0
 Parameter: ZTRAN <- "33.7870648"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.3775599"
 Parameter: YTRAN -> "-49.400826"
 Parameter: ZTRAN -> "33.7870648"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    29.377560  -49.400826   33.787065
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.838659327"
Evaluating: 0.838659327*360.0
 Parameter: XPHI <- "301.917358"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.763939906E-03"
Evaluating: 5.763939906E-03*360.0
 Parameter: YPHI <- "2.07501837"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.75073468"
Evaluating: 0.75073468*360.0
 Parameter: ZPHI <- "270.264485"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.3775599"
 Parameter: YPOS -> "-49.400826"
 Parameter: ZPOS -> "33.7870648"
 Parameter: XPHI -> "301.917358"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.528696   -0.848812
    0.000000    0.848812    0.528696

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.3775599"
 Parameter: YPOS -> "-49.400826"
 Parameter: ZPOS -> "33.7870648"
 Parameter: YPHI -> "2.07501837"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.999344    0.000000   -0.036208
    0.000000    1.000000    0.000000
    0.036208    0.000000    0.999344

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.3775599"
 Parameter: YPOS -> "-49.400826"
 Parameter: ZPOS -> "33.7870648"
 Parameter: ZPHI -> "270.264485"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.004616   -0.999989    0.000000
    0.999989    0.004616    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   89.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.377560 XMAX =   29.377560 XAVE =   29.377560
    YMIN =  -49.400826 YMAX =  -49.400826 YAVE =  -49.400826
    ZMIN =   33.787065 ZMAX =   33.787065 ZAVE =   33.787065
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.3775599"
Evaluating: 29.3775599+3.5
 Parameter: XMAX <- "32.8775599"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.400826"
Evaluating: -49.400826+3.5
 Parameter: YMAX <- "-45.900826"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.7870648"
Evaluating: 33.7870648+3.5
 Parameter: ZMAX <- "37.2870648"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.3775599"
Evaluating: 29.3775599-3.5
 Parameter: XMIN <- "25.8775599"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.400826"
Evaluating: -49.400826-3.5
 Parameter: YMIN <- "-52.900826"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.7870648"
Evaluating: 33.7870648-3.5
 Parameter: ZMIN <- "30.2870648"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.8775599"
 Parameter: XMIN -> "25.8775599"
 Parameter: YMAX -> "-45.900826"
 Parameter: YMIN -> "-52.900826"
 Parameter: ZMAX -> "37.2870648"
 Parameter: ZMIN -> "30.2870648"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "127"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "127" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "127"
Evaluating: 127
 Parameter: J <- "127"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "127" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "127"
 Parameter: NPOS -> "120"
Evaluating: 127-120
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.899686405"
Evaluating: 112.065471*(0.899686405-0.5)
 Parameter: XPOS <- "44.7910452"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.945077342"
Evaluating: 112.065471*(0.945077342-0.5)
 Parameter: YPOS <- "49.877802"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.59184806"
Evaluating: 142.885239*(0.59184806-0.5)+2.93414115
 Parameter: ZPOS <- "16.0578732"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.0578732" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.0578732" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.7910452"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.7910452-0
 Parameter: XTRAN <- "44.7910452"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "49.877802"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 49.877802-0
 Parameter: YTRAN <- "49.877802"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.0578732"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.0578732-0
 Parameter: ZTRAN <- "16.0578732"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.7910452"
 Parameter: YTRAN -> "49.877802"
 Parameter: ZTRAN -> "16.0578732"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    44.791045   49.877802   16.057873
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.33836807"
Evaluating: 0.33836807*360.0
 Parameter: XPHI <- "121.812505"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272792503"
Evaluating: 0.272792503*360.0
 Parameter: YPHI <- "98.2053011"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.206673854"
Evaluating: 0.206673854*360.0
 Parameter: ZPHI <- "74.4025874"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.7910452"
 Parameter: YPOS -> "49.877802"
 Parameter: ZPOS -> "16.0578732"
 Parameter: XPHI -> "121.812505"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.527141    0.849778
    0.000000   -0.849778   -0.527141

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.7910452"
 Parameter: YPOS -> "49.877802"
 Parameter: ZPOS -> "16.0578732"
 Parameter: YPHI -> "98.2053011"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.142721    0.000000   -0.989763
    0.000000    1.000000    0.000000
    0.989763    0.000000   -0.142721

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.7910452"
 Parameter: YPOS -> "49.877802"
 Parameter: ZPOS -> "16.0578732"
 Parameter: ZPHI -> "74.4025874"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.268876    0.963175    0.000000
   -0.963175    0.268876    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   74.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.791045 XMAX =   44.791045 XAVE =   44.791045
    YMIN =   49.877802 YMAX =   49.877802 YAVE =   49.877802
    ZMIN =   16.057873 ZMAX =   16.057873 ZAVE =   16.057873
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.7910452"
Evaluating: 44.7910452+3.5
 Parameter: XMAX <- "48.2910452"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "49.877802"
Evaluating: 49.877802+3.5
 Parameter: YMAX <- "53.377802"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.0578732"
Evaluating: 16.0578732+3.5
 Parameter: ZMAX <- "19.5578732"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.7910452"
Evaluating: 44.7910452-3.5
 Parameter: XMIN <- "41.2910452"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "49.877802"
Evaluating: 49.877802-3.5
 Parameter: YMIN <- "46.377802"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.0578732"
Evaluating: 16.0578732-3.5
 Parameter: ZMIN <- "12.5578732"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "48.2910452"
 Parameter: XMIN -> "41.2910452"
 Parameter: YMAX -> "53.377802"
 Parameter: YMIN -> "46.377802"
 Parameter: ZMAX -> "19.5578732"
 Parameter: ZMIN -> "12.5578732"
 SELRPN>     17 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      5 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53184 NEG      CLA      7        CLA     -**** MEMB     POPC     147      N             3.2936
53184 NEG      CLA      7        CLA     -**** MEMB     POPC     147      C12           3.3583
53184 NEG      CLA      7        CLA     -**** MEMB     POPC     147      C14           2.4037
53184 NEG      CLA      7        CLA     -**** MEMB     POPC     147      C11           3.7873
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "127"
Evaluating: 127
 Parameter: J <- "127"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "127" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "127"
 Parameter: NPOS -> "120"
Evaluating: 127-120
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.525298628"
Evaluating: 112.065471*(0.525298628-0.5)
 Parameter: XPOS <- "2.83510266"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.671125611"
Evaluating: 112.065471*(0.671125611-0.5)
 Parameter: YPOS <- "19.1772722"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.152700857"
Evaluating: 142.885239*(0.152700857-0.5)+2.93414115
 Parameter: ZPOS <- "-46.6897799"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.6897799" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.791045 XMAX =   44.791045 XAVE =   44.791045
    YMIN =   49.877802 YMAX =   49.877802 YAVE =   49.877802
    ZMIN =   16.057873 ZMAX =   16.057873 ZAVE =   16.057873
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.83510266"
 RDCMND substituted energy or value "?XAVE" to "44.7910452"
Evaluating: 2.83510266-44.7910452
 Parameter: XTRAN <- "-41.9559425"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.1772722"
 RDCMND substituted energy or value "?YAVE" to "49.877802"
Evaluating: 19.1772722-49.877802
 Parameter: YTRAN <- "-30.7005298"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.6897799"
 RDCMND substituted energy or value "?ZAVE" to "16.0578732"
Evaluating: -46.6897799-16.0578732
 Parameter: ZTRAN <- "-62.7476531"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.9559425"
 Parameter: YTRAN -> "-30.7005298"
 Parameter: ZTRAN -> "-62.7476531"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -41.955942  -30.700530  -62.747653
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.427312702E-02"
Evaluating: 4.427312702E-02*360.0
 Parameter: XPHI <- "15.9383257"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.570282268"
Evaluating: 0.570282268*360.0
 Parameter: YPHI <- "205.301616"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.902806198"
Evaluating: 0.902806198*360.0
 Parameter: ZPHI <- "325.010231"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.83510266"
 Parameter: YPOS -> "19.1772722"
 Parameter: ZPOS -> "-46.6897799"
 Parameter: XPHI -> "15.9383257"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.961558    0.274602
    0.000000   -0.274602    0.961558

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   15.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.83510266"
 Parameter: YPOS -> "19.1772722"
 Parameter: ZPOS -> "-46.6897799"
 Parameter: YPHI -> "205.301616"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.904070    0.000000    0.427383
    0.000000    1.000000    0.000000
   -0.427383    0.000000   -0.904070

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  154.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.83510266"
 Parameter: YPOS -> "19.1772722"
 Parameter: ZPOS -> "-46.6897799"
 Parameter: ZPHI -> "325.010231"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.819254   -0.573430    0.000000
    0.573430    0.819254    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.835103 XMAX =    2.835103 XAVE =    2.835103
    YMIN =   19.177272 YMAX =   19.177272 YAVE =   19.177272
    ZMIN =  -46.689780 ZMAX =  -46.689780 ZAVE =  -46.689780
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.83510263"
Evaluating: 2.83510263+3.5
 Parameter: XMAX <- "6.33510263"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.1772722"
Evaluating: 19.1772722+3.5
 Parameter: YMAX <- "22.6772722"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.6897799"
Evaluating: -46.6897799+3.5
 Parameter: ZMAX <- "-43.1897799"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.83510263"
Evaluating: 2.83510263-3.5
 Parameter: XMIN <- "-0.66489737"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.1772722"
Evaluating: 19.1772722-3.5
 Parameter: YMIN <- "15.6772722"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.6897799"
Evaluating: -46.6897799-3.5
 Parameter: ZMIN <- "-50.1897799"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.33510263"
 Parameter: XMIN -> "-0.66489737"
 Parameter: YMAX -> "22.6772722"
 Parameter: YMIN -> "15.6772722"
 Parameter: ZMAX -> "-43.1897799"
 Parameter: ZMIN -> "-50.1897799"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "128"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "128" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "128"
Evaluating: 128
 Parameter: J <- "128"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "128" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "128"
 Parameter: NPOS -> "120"
Evaluating: 128-120
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.737829998"
Evaluating: 112.065471*(0.737829998-0.5)
 Parameter: XPOS <- "26.6525307"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.817974477"
Evaluating: 112.065471*(0.817974477-0.5)
 Parameter: YPOS <- "35.6339595"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "3.565500512E-02"
Evaluating: 142.885239*(3.565500512E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-63.4139044"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-63.4139044" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.6525307"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.6525307-0
 Parameter: XTRAN <- "26.6525307"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.6339595"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.6339595-0
 Parameter: YTRAN <- "35.6339595"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-63.4139044"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -63.4139044-0
 Parameter: ZTRAN <- "-63.4139044"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.6525307"
 Parameter: YTRAN -> "35.6339595"
 Parameter: ZTRAN -> "-63.4139044"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    26.652531   35.633960  -63.413904
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.195161323"
Evaluating: 0.195161323*360.0
 Parameter: XPHI <- "70.2580763"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.621731998"
Evaluating: 0.621731998*360.0
 Parameter: YPHI <- "223.823519"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.125975388"
Evaluating: 0.125975388*360.0
 Parameter: ZPHI <- "45.3511397"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.6525307"
 Parameter: YPOS -> "35.6339595"
 Parameter: ZPOS -> "-63.4139044"
 Parameter: XPHI -> "70.2580763"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.337784    0.941224
    0.000000   -0.941224    0.337784

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   70.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.6525307"
 Parameter: YPOS -> "35.6339595"
 Parameter: ZPOS -> "-63.4139044"
 Parameter: YPHI -> "223.823519"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.721476    0.000000    0.692439
    0.000000    1.000000    0.000000
   -0.692439    0.000000   -0.721476

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  136.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.6525307"
 Parameter: YPOS -> "35.6339595"
 Parameter: ZPOS -> "-63.4139044"
 Parameter: ZPHI -> "45.3511397"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.702760    0.711427    0.000000
   -0.711427    0.702760    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   45.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.652531 XMAX =   26.652531 XAVE =   26.652531
    YMIN =   35.633960 YMAX =   35.633960 YAVE =   35.633960
    ZMIN =  -63.413904 ZMAX =  -63.413904 ZAVE =  -63.413904
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.6525307"
Evaluating: 26.6525307+3.5
 Parameter: XMAX <- "30.1525307"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.6339595"
Evaluating: 35.6339595+3.5
 Parameter: YMAX <- "39.1339595"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-63.4139044"
Evaluating: -63.4139044+3.5
 Parameter: ZMAX <- "-59.9139044"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.6525307"
Evaluating: 26.6525307-3.5
 Parameter: XMIN <- "23.1525307"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.6339595"
Evaluating: 35.6339595-3.5
 Parameter: YMIN <- "32.1339595"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-63.4139044"
Evaluating: -63.4139044-3.5
 Parameter: ZMIN <- "-66.9139044"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.1525307"
 Parameter: XMIN -> "23.1525307"
 Parameter: YMAX -> "39.1339595"
 Parameter: YMIN -> "32.1339595"
 Parameter: ZMAX -> "-59.9139044"
 Parameter: ZMIN -> "-66.9139044"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "129"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "129" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "129"
Evaluating: 129
 Parameter: J <- "129"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "129" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "129"
 Parameter: NPOS -> "120"
Evaluating: 129-120
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.2203016"
Evaluating: 112.065471*(0.2203016-0.5)
 Parameter: XPOS <- "-31.3445329"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.160742516"
Evaluating: 112.065471*(0.160742516-0.5)
 Parameter: YPOS <- "-38.0190497"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.602592776"
Evaluating: 142.885239*(0.602592776-0.5)+2.93414115
 Parameter: ZPOS <- "17.5931345"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.5931345" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.5931345" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.3445329"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.3445329-0
 Parameter: XTRAN <- "-31.3445329"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.0190497"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.0190497-0
 Parameter: YTRAN <- "-38.0190497"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.5931345"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.5931345-0
 Parameter: ZTRAN <- "17.5931345"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.3445329"
 Parameter: YTRAN -> "-38.0190497"
 Parameter: ZTRAN -> "17.5931345"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -31.344533  -38.019050   17.593135
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336417541"
Evaluating: 0.336417541*360.0
 Parameter: XPHI <- "121.110315"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.254737795"
Evaluating: 0.254737795*360.0
 Parameter: YPHI <- "91.7056062"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.692343134"
Evaluating: 0.692343134*360.0
 Parameter: ZPHI <- "249.243528"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.3445329"
 Parameter: YPOS -> "-38.0190497"
 Parameter: ZPOS -> "17.5931345"
 Parameter: XPHI -> "121.110315"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.516687    0.856174
    0.000000   -0.856174   -0.516687

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.3445329"
 Parameter: YPOS -> "-38.0190497"
 Parameter: ZPOS -> "17.5931345"
 Parameter: YPHI -> "91.7056062"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.029764    0.000000   -0.999557
    0.000000    1.000000    0.000000
    0.999557    0.000000   -0.029764

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   91.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.3445329"
 Parameter: YPOS -> "-38.0190497"
 Parameter: ZPOS -> "17.5931345"
 Parameter: ZPHI -> "249.243528"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.354397   -0.935095    0.000000
    0.935095   -0.354397    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  110.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.344533 XMAX =  -31.344533 XAVE =  -31.344533
    YMIN =  -38.019050 YMAX =  -38.019050 YAVE =  -38.019050
    ZMIN =   17.593135 ZMAX =   17.593135 ZAVE =   17.593135
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.3445329"
Evaluating: -31.3445329+3.5
 Parameter: XMAX <- "-27.8445329"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.0190497"
Evaluating: -38.0190497+3.5
 Parameter: YMAX <- "-34.5190497"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.5931345"
Evaluating: 17.5931345+3.5
 Parameter: ZMAX <- "21.0931345"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.3445329"
Evaluating: -31.3445329-3.5
 Parameter: XMIN <- "-34.8445329"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.0190497"
Evaluating: -38.0190497-3.5
 Parameter: YMIN <- "-41.5190497"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.5931345"
Evaluating: 17.5931345-3.5
 Parameter: ZMIN <- "14.0931345"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.8445329"
 Parameter: XMIN -> "-34.8445329"
 Parameter: YMAX -> "-34.5190497"
 Parameter: YMIN -> "-41.5190497"
 Parameter: ZMAX -> "21.0931345"
 Parameter: ZMIN -> "14.0931345"
 SELRPN>     15 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      8 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53186 NEG      CLA      9        CLA     -**** MEMB     POPC     32       P             3.6713
53186 NEG      CLA      9        CLA     -**** MEMB     POPC     32       O13           3.4907
53186 NEG      CLA      9        CLA     -**** MEMB     POPC     32       O14           2.8740
53186 NEG      CLA      9        CLA     -**** MEMB     POPC     65       C12           3.4205
53186 NEG      CLA      9        CLA     -**** MEMB     POPC     65       C14           3.4495
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "129"
Evaluating: 129
 Parameter: J <- "129"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "129" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "129"
 Parameter: NPOS -> "120"
Evaluating: 129-120
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.511828812"
Evaluating: 112.065471*(0.511828812-0.5)
 Parameter: XPOS <- "1.32560139"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.216920418"
Evaluating: 112.065471*(0.216920418-0.5)
 Parameter: YPOS <- "-31.7234467"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.936226232"
Evaluating: 142.885239*(0.936226232-0.5)+2.93414115
 Parameter: ZPOS <- "65.2644306"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "65.2644306" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "65.2644306" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.344533 XMAX =  -31.344533 XAVE =  -31.344533
    YMIN =  -38.019050 YMAX =  -38.019050 YAVE =  -38.019050
    ZMIN =   17.593135 ZMAX =   17.593135 ZAVE =   17.593135
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.32560139"
 RDCMND substituted energy or value "?XAVE" to "-31.3445329"
Evaluating: 1.32560139--31.3445329
 Parameter: XTRAN <- "32.6701343"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.7234467"
 RDCMND substituted energy or value "?YAVE" to "-38.0190497"
Evaluating: -31.7234467--38.0190497
 Parameter: YTRAN <- "6.295603"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "65.2644306"
 RDCMND substituted energy or value "?ZAVE" to "17.5931345"
Evaluating: 65.2644306-17.5931345
 Parameter: ZTRAN <- "47.6712961"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.6701343"
 Parameter: YTRAN -> "6.295603"
 Parameter: ZTRAN -> "47.6712961"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    32.670134    6.295603   47.671296
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382174729"
Evaluating: 0.382174729*360.0
 Parameter: XPHI <- "137.582902"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.298841195"
Evaluating: 0.298841195*360.0
 Parameter: YPHI <- "107.58283"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.834330779"
Evaluating: 0.834330779*360.0
 Parameter: ZPHI <- "300.35908"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.32560139"
 Parameter: YPOS -> "-31.7234467"
 Parameter: ZPOS -> "65.2644306"
 Parameter: XPHI -> "137.582902"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.738254    0.674523
    0.000000   -0.674523   -0.738254

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.32560139"
 Parameter: YPOS -> "-31.7234467"
 Parameter: ZPOS -> "65.2644306"
 Parameter: YPHI -> "107.58283"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.302084    0.000000   -0.953281
    0.000000    1.000000    0.000000
    0.953281    0.000000   -0.302084

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  107.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.32560139"
 Parameter: YPOS -> "-31.7234467"
 Parameter: ZPOS -> "65.2644306"
 Parameter: ZPHI -> "300.35908"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.505418   -0.862875    0.000000
    0.862875    0.505418    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   59.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.325601 XMAX =    1.325601 XAVE =    1.325601
    YMIN =  -31.723447 YMAX =  -31.723447 YAVE =  -31.723447
    ZMIN =   65.264431 ZMAX =   65.264431 ZAVE =   65.264431
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.32560139"
Evaluating: 1.32560139+3.5
 Parameter: XMAX <- "4.82560139"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.7234467"
Evaluating: -31.7234467+3.5
 Parameter: YMAX <- "-28.2234467"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "65.2644306"
Evaluating: 65.2644306+3.5
 Parameter: ZMAX <- "68.7644306"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.32560139"
Evaluating: 1.32560139-3.5
 Parameter: XMIN <- "-2.17439861"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.7234467"
Evaluating: -31.7234467-3.5
 Parameter: YMIN <- "-35.2234467"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "65.2644306"
Evaluating: 65.2644306-3.5
 Parameter: ZMIN <- "61.7644306"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.82560139"
 Parameter: XMIN -> "-2.17439861"
 Parameter: YMAX -> "-28.2234467"
 Parameter: YMIN -> "-35.2234467"
 Parameter: ZMAX -> "68.7644306"
 Parameter: ZMIN -> "61.7644306"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "130"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "130" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "130" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "130"
 Parameter: NPOS -> "120"
Evaluating: 130-120
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.786522406"
Evaluating: 112.065471*(0.786522406-0.5)
 Parameter: XPOS <- "32.1092684"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.165350972"
Evaluating: 112.065471*(0.165350972-0.5)
 Parameter: YPOS <- "-37.5026009"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.241457283"
Evaluating: 142.885239*(0.241457283-0.5)+2.93414115
 Parameter: ZPOS <- "-34.0077968"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.0077968" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.1092684"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.1092684-0
 Parameter: XTRAN <- "32.1092684"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.5026009"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.5026009-0
 Parameter: YTRAN <- "-37.5026009"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.0077968"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.0077968-0
 Parameter: ZTRAN <- "-34.0077968"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.1092684"
 Parameter: YTRAN -> "-37.5026009"
 Parameter: ZTRAN -> "-34.0077968"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    32.109268  -37.502601  -34.007797
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.83866003"
Evaluating: 0.83866003*360.0
 Parameter: XPHI <- "301.917611"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.777376918"
Evaluating: 0.777376918*360.0
 Parameter: YPHI <- "279.85569"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.464052373"
Evaluating: 0.464052373*360.0
 Parameter: ZPHI <- "167.058854"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.1092684"
 Parameter: YPOS -> "-37.5026009"
 Parameter: ZPOS -> "-34.0077968"
 Parameter: XPHI -> "301.917611"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.528699   -0.848809
    0.000000    0.848809    0.528699

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.1092684"
 Parameter: YPOS -> "-37.5026009"
 Parameter: ZPOS -> "-34.0077968"
 Parameter: YPHI -> "279.85569"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.171167    0.000000    0.985242
    0.000000    1.000000    0.000000
   -0.985242    0.000000    0.171167

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   80.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.1092684"
 Parameter: YPOS -> "-37.5026009"
 Parameter: ZPOS -> "-34.0077968"
 Parameter: ZPHI -> "167.058854"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.974601    0.223950    0.000000
   -0.223950   -0.974601    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  167.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.109268 XMAX =   32.109268 XAVE =   32.109268
    YMIN =  -37.502601 YMAX =  -37.502601 YAVE =  -37.502601
    ZMIN =  -34.007797 ZMAX =  -34.007797 ZAVE =  -34.007797
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.1092684"
Evaluating: 32.1092684+3.5
 Parameter: XMAX <- "35.6092684"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.5026009"
Evaluating: -37.5026009+3.5
 Parameter: YMAX <- "-34.0026009"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.0077968"
Evaluating: -34.0077968+3.5
 Parameter: ZMAX <- "-30.5077968"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.1092684"
Evaluating: 32.1092684-3.5
 Parameter: XMIN <- "28.6092684"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.5026009"
Evaluating: -37.5026009-3.5
 Parameter: YMIN <- "-41.0026009"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.0077968"
Evaluating: -34.0077968-3.5
 Parameter: ZMIN <- "-37.5077968"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.6092684"
 Parameter: XMIN -> "28.6092684"
 Parameter: YMAX -> "-34.0026009"
 Parameter: YMIN -> "-41.0026009"
 Parameter: ZMAX -> "-30.5077968"
 Parameter: ZMIN -> "-37.5077968"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "131"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "131" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "131"
Evaluating: 131
 Parameter: J <- "131"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "131" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "131"
 Parameter: NPOS -> "120"
Evaluating: 131-120
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.491736521"
Evaluating: 112.065471*(0.491736521-0.5)
 Parameter: XPOS <- "-0.926050666"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.607261694"
Evaluating: 112.065471*(0.607261694-0.5)
 Parameter: YPOS <- "12.0203323"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.718043724"
Evaluating: 142.885239*(0.718043724-0.5)+2.93414115
 Parameter: ZPOS <- "34.0893708"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.0893708" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.0893708" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.926050666"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.926050666-0
 Parameter: XTRAN <- "-0.926050666"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.0203323"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.0203323-0
 Parameter: YTRAN <- "12.0203323"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.0893708"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.0893708-0
 Parameter: ZTRAN <- "34.0893708"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.926050666"
 Parameter: YTRAN -> "12.0203323"
 Parameter: ZTRAN -> "34.0893708"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -0.926051   12.020332   34.089371
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.676189462"
Evaluating: 0.676189462*360.0
 Parameter: XPHI <- "243.428206"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.957189687"
Evaluating: 0.957189687*360.0
 Parameter: YPHI <- "344.588287"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.990689651"
Evaluating: 0.990689651*360.0
 Parameter: ZPHI <- "356.648274"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.926050666"
 Parameter: YPOS -> "12.0203323"
 Parameter: ZPOS -> "34.0893708"
 Parameter: XPHI -> "243.428206"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.447319   -0.894375
    0.000000    0.894375   -0.447319

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  116.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.926050666"
 Parameter: YPOS -> "12.0203323"
 Parameter: ZPOS -> "34.0893708"
 Parameter: YPHI -> "344.588287"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.964041    0.000000    0.265753
    0.000000    1.000000    0.000000
   -0.265753    0.000000    0.964041

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   15.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.926050666"
 Parameter: YPOS -> "12.0203323"
 Parameter: ZPOS -> "34.0893708"
 Parameter: ZPHI -> "356.648274"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.998289   -0.058465    0.000000
    0.058465    0.998289    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    3.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.926051 XMAX =   -0.926051 XAVE =   -0.926051
    YMIN =   12.020332 YMAX =   12.020332 YAVE =   12.020332
    ZMIN =   34.089371 ZMAX =   34.089371 ZAVE =   34.089371
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.926050666"
Evaluating: -0.926050666+3.5
 Parameter: XMAX <- "2.57394933"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.0203323"
Evaluating: 12.0203323+3.5
 Parameter: YMAX <- "15.5203323"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.0893708"
Evaluating: 34.0893708+3.5
 Parameter: ZMAX <- "37.5893708"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.926050666"
Evaluating: -0.926050666-3.5
 Parameter: XMIN <- "-4.42605067"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.0203323"
Evaluating: 12.0203323-3.5
 Parameter: YMIN <- "8.5203323"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.0893708"
Evaluating: 34.0893708-3.5
 Parameter: ZMIN <- "30.5893708"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.57394933"
 Parameter: XMIN -> "-4.42605067"
 Parameter: YMAX -> "15.5203323"
 Parameter: YMIN -> "8.5203323"
 Parameter: ZMAX -> "37.5893708"
 Parameter: ZMIN -> "30.5893708"
 SELRPN>     42 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     23 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53188 NEG      CLA      11       CLA     -**** PROF     VAL      164      C             5.0979
53188 NEG      CLA      11       CLA     -**** PROF     VAL      164      O             4.4342
53188 NEG      CLA      11       CLA     -**** PROF     PRO      165      C             4.0608
53188 NEG      CLA      11       CLA     -**** PROF     PRO      165      O             3.8819
53188 NEG      CLA      11       CLA     -**** PROF     VAL      166      N             3.8369
53188 NEG      CLA      11       CLA     -**** PROF     VAL      166      CA            3.2533
53188 NEG      CLA      11       CLA     -**** PROF     VAL      166      CB            3.5514
53188 NEG      CLA      11       CLA     -**** PROF     VAL      166      CG1           2.8128
53188 NEG      CLA      11       CLA     -**** PROF     VAL      166      C             4.4165
53188 NEG      CLA      11       CLA     -**** PROF     VAL      166      O             5.5266
53188 NEG      CLA      11       CLA     -**** PROF     GLY      167      N             4.4823
53188 NEG      CLA      11       CLA     -**** PROF     VAL      206      N             4.2608
53188 NEG      CLA      11       CLA     -**** PROF     VAL      206      CA            3.6796
53188 NEG      CLA      11       CLA     -**** PROF     VAL      206      CB            2.4007
53188 NEG      CLA      11       CLA     -**** PROF     VAL      206      CG1           2.8196
53188 NEG      CLA      11       CLA     -**** PROF     VAL      206      CG2           2.9920
53188 NEG      CLA      11       CLA     -**** PROF     VAL      206      C             4.0280
53188 NEG      CLA      11       CLA     -**** PROF     VAL      206      O             4.0340
53188 NEG      CLA      11       CLA     -**** PROF     ASP      207      N             4.9143
53188 NEG      CLA      11       CLA     -**** PROF     GLN      208      O             3.7971
53188 NEG      CLA      11       CLA     -**** PROF     ALA      233      CA            3.4716
53188 NEG      CLA      11       CLA     -**** PROF     ALA      233      CB            2.2156
53188 NEG      CLA      11       CLA     -**** PROF     ALA      233      C             4.0791
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        23
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "23"
 Comparing "23" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "131"
Evaluating: 131
 Parameter: J <- "131"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "131" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "131"
 Parameter: NPOS -> "120"
Evaluating: 131-120
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.83806037"
Evaluating: 112.065471*(0.83806037-0.5)
 Parameter: XPOS <- "37.8848946"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.451457337"
Evaluating: 112.065471*(0.451457337-0.5)
 Parameter: YPOS <- "-5.43995639"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.275928292"
Evaluating: 142.885239*(0.275928292-0.5)+2.93414115
 Parameter: ZPOS <- "-29.0823984"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.0823984" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.926051 XMAX =   -0.926051 XAVE =   -0.926051
    YMIN =   12.020332 YMAX =   12.020332 YAVE =   12.020332
    ZMIN =   34.089371 ZMAX =   34.089371 ZAVE =   34.089371
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.8848946"
 RDCMND substituted energy or value "?XAVE" to "-0.926050666"
Evaluating: 37.8848946--0.926050666
 Parameter: XTRAN <- "38.8109453"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.43995639"
 RDCMND substituted energy or value "?YAVE" to "12.0203323"
Evaluating: -5.43995639-12.0203323
 Parameter: YTRAN <- "-17.4602887"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.0823984"
 RDCMND substituted energy or value "?ZAVE" to "34.0893708"
Evaluating: -29.0823984-34.0893708
 Parameter: ZTRAN <- "-63.1717692"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.8109453"
 Parameter: YTRAN -> "-17.4602887"
 Parameter: ZTRAN -> "-63.1717692"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    38.810945  -17.460289  -63.171769
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.907080465"
Evaluating: 0.907080465*360.0
 Parameter: XPHI <- "326.548967"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.159039333"
Evaluating: 0.159039333*360.0
 Parameter: YPHI <- "57.2541599"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.975514072"
Evaluating: 0.975514072*360.0
 Parameter: ZPHI <- "351.185066"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.8848946"
 Parameter: YPOS -> "-5.43995639"
 Parameter: ZPOS -> "-29.0823984"
 Parameter: XPHI -> "326.548967"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.834357   -0.551224
    0.000000    0.551224    0.834357

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   33.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.8848946"
 Parameter: YPOS -> "-5.43995639"
 Parameter: ZPOS -> "-29.0823984"
 Parameter: YPHI -> "57.2541599"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.540913    0.000000   -0.841078
    0.000000    1.000000    0.000000
    0.841078    0.000000    0.540913

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   57.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.8848946"
 Parameter: YPOS -> "-5.43995639"
 Parameter: ZPOS -> "-29.0823984"
 Parameter: ZPHI -> "351.185066"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.988188   -0.153243    0.000000
    0.153243    0.988188    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    8.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.884895 XMAX =   37.884895 XAVE =   37.884895
    YMIN =   -5.439956 YMAX =   -5.439956 YAVE =   -5.439956
    ZMIN =  -29.082398 ZMAX =  -29.082398 ZAVE =  -29.082398
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.8848946"
Evaluating: 37.8848946+3.5
 Parameter: XMAX <- "41.3848946"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.43995639"
Evaluating: -5.43995639+3.5
 Parameter: YMAX <- "-1.93995639"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.0823984"
Evaluating: -29.0823984+3.5
 Parameter: ZMAX <- "-25.5823984"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.8848946"
Evaluating: 37.8848946-3.5
 Parameter: XMIN <- "34.3848946"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.43995639"
Evaluating: -5.43995639-3.5
 Parameter: YMIN <- "-8.93995639"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.0823984"
Evaluating: -29.0823984-3.5
 Parameter: ZMIN <- "-32.5823984"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.3848946"
 Parameter: XMIN -> "34.3848946"
 Parameter: YMAX -> "-1.93995639"
 Parameter: YMIN -> "-8.93995639"
 Parameter: ZMAX -> "-25.5823984"
 Parameter: ZMIN -> "-32.5823984"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "132"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "132" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "132" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "132"
 Parameter: NPOS -> "120"
Evaluating: 132-120
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.352710999"
Evaluating: 112.065471*(0.352710999-0.5)
 Parameter: XPOS <- "-16.5060113"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.393109195"
Evaluating: 112.065471*(0.393109195-0.5)
 Parameter: YPOS <- "-11.9787684"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.695287734"
Evaluating: 142.885239*(0.695287734-0.5)+2.93414115
 Parameter: ZPOS <- "30.8378757"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.8378757" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.8378757" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.5060113"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.5060113-0
 Parameter: XTRAN <- "-16.5060113"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.9787684"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.9787684-0
 Parameter: YTRAN <- "-11.9787684"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.8378757"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.8378757-0
 Parameter: ZTRAN <- "30.8378757"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.5060113"
 Parameter: YTRAN -> "-11.9787684"
 Parameter: ZTRAN -> "30.8378757"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -16.506011  -11.978768   30.837876
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.928296613"
Evaluating: 0.928296613*360.0
 Parameter: XPHI <- "334.186781"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.011502022E-02"
Evaluating: 5.011502022E-02*360.0
 Parameter: YPHI <- "18.0414073"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.922656605"
Evaluating: 0.922656605*360.0
 Parameter: ZPHI <- "332.156378"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.5060113"
 Parameter: YPOS -> "-11.9787684"
 Parameter: ZPOS -> "30.8378757"
 Parameter: XPHI -> "334.186781"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.900218   -0.435439
    0.000000    0.435439    0.900218

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   25.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.5060113"
 Parameter: YPOS -> "-11.9787684"
 Parameter: ZPOS -> "30.8378757"
 Parameter: YPHI -> "18.0414073"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.950833    0.000000   -0.309704
    0.000000    1.000000    0.000000
    0.309704    0.000000    0.950833

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   18.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.5060113"
 Parameter: YPOS -> "-11.9787684"
 Parameter: ZPOS -> "30.8378757"
 Parameter: ZPHI -> "332.156378"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.884226   -0.467060    0.000000
    0.467060    0.884226    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   27.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.506011 XMAX =  -16.506011 XAVE =  -16.506011
    YMIN =  -11.978768 YMAX =  -11.978768 YAVE =  -11.978768
    ZMIN =   30.837876 ZMAX =   30.837876 ZAVE =   30.837876
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.5060113"
Evaluating: -16.5060113+3.5
 Parameter: XMAX <- "-13.0060113"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.9787684"
Evaluating: -11.9787684+3.5
 Parameter: YMAX <- "-8.4787684"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.8378757"
Evaluating: 30.8378757+3.5
 Parameter: ZMAX <- "34.3378757"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.5060113"
Evaluating: -16.5060113-3.5
 Parameter: XMIN <- "-20.0060113"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.9787684"
Evaluating: -11.9787684-3.5
 Parameter: YMIN <- "-15.4787684"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.8378757"
Evaluating: 30.8378757-3.5
 Parameter: ZMIN <- "27.3378757"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.0060113"
 Parameter: XMIN -> "-20.0060113"
 Parameter: YMAX -> "-8.4787684"
 Parameter: YMIN -> "-15.4787684"
 Parameter: ZMAX -> "34.3378757"
 Parameter: ZMIN -> "27.3378757"
 SELRPN>     34 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     19 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53189 NEG      CLA      12       CLA     -**** PROF     GLU      140      CA            3.7527
53189 NEG      CLA      12       CLA     -**** PROF     GLU      140      CB            3.0642
53189 NEG      CLA      12       CLA     -**** PROF     GLU      140      C             3.2416
53189 NEG      CLA      12       CLA     -**** PROF     GLU      140      O             3.4585
53189 NEG      CLA      12       CLA     -**** PROF     LYS      141      N             3.3605
53189 NEG      CLA      12       CLA     -**** PROF     LYS      141      CA            3.8851
53189 NEG      CLA      12       CLA     -**** PROF     LYS      141      CB            4.2771
53189 NEG      CLA      12       CLA     -**** PROF     LYS      141      C             3.5310
53189 NEG      CLA      12       CLA     -**** PROF     GLU      142      N             2.4596
53189 NEG      CLA      12       CLA     -**** PROF     GLU      142      CA            3.0206
53189 NEG      CLA      12       CLA     -**** PROF     GLU      142      CB            2.6409
53189 NEG      CLA      12       CLA     -**** PROF     GLU      142      CG            2.4738
53189 NEG      CLA      12       CLA     -**** PROF     GLU      142      CD            1.5149
53189 NEG      CLA      12       CLA     -**** PROF     GLU      142      OE1           0.8473
53189 NEG      CLA      12       CLA     -**** PROF     GLU      142      OE2           2.4037
53189 NEG      CLA      12       CLA     -**** PROF     GLU      142      C             3.7959
53189 NEG      CLA      12       CLA     -**** PROF     ALA      143      N             3.6481
53189 NEG      CLA      12       CLA     -**** PROF     ALA      143      CA            4.8984
53189 NEG      CLA      12       CLA     -**** PROF     ALA      143      CB            5.0301
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        19
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "132" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "132"
 Parameter: NPOS -> "120"
Evaluating: 132-120
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.730602796"
Evaluating: 112.065471*(0.730602796-0.5)
 Parameter: XPOS <- "25.8426109"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.360186016"
Evaluating: 112.065471*(0.360186016-0.5)
 Parameter: YPOS <- "-15.66832"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.462514404"
Evaluating: 142.885239*(0.462514404-0.5)+2.93414115
 Parameter: ZPOS <- "-2.42199719"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.42199719" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.42199719" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "132" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "132"
 Parameter: NPOS -> "120"
Evaluating: 132-120
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.824978271"
Evaluating: 112.065471*(0.824978271-0.5)
 Parameter: XPOS <- "36.418843"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.277754008"
Evaluating: 112.065471*(0.277754008-0.5)
 Parameter: YPOS <- "-24.9061018"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.598394886"
Evaluating: 142.885239*(0.598394886-0.5)+2.93414115
 Parameter: ZPOS <- "16.993318"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.993318" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.993318" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.506011 XMAX =  -16.506011 XAVE =  -16.506011
    YMIN =  -11.978768 YMAX =  -11.978768 YAVE =  -11.978768
    ZMIN =   30.837876 ZMAX =   30.837876 ZAVE =   30.837876
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.418843"
 RDCMND substituted energy or value "?XAVE" to "-16.5060113"
Evaluating: 36.418843--16.5060113
 Parameter: XTRAN <- "52.9248543"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.9061018"
 RDCMND substituted energy or value "?YAVE" to "-11.9787684"
Evaluating: -24.9061018--11.9787684
 Parameter: YTRAN <- "-12.9273334"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.993318"
 RDCMND substituted energy or value "?ZAVE" to "30.8378757"
Evaluating: 16.993318-30.8378757
 Parameter: ZTRAN <- "-13.8445577"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.9248543"
 Parameter: YTRAN -> "-12.9273334"
 Parameter: ZTRAN -> "-13.8445577"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    52.924854  -12.927333  -13.844558
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.71693184"
Evaluating: 0.71693184*360.0
 Parameter: XPHI <- "258.095462"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.842962835"
Evaluating: 0.842962835*360.0
 Parameter: YPHI <- "303.466621"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.143872101"
Evaluating: 0.143872101*360.0
 Parameter: ZPHI <- "51.7939564"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.418843"
 Parameter: YPOS -> "-24.9061018"
 Parameter: ZPOS -> "16.993318"
 Parameter: XPHI -> "258.095462"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.206282   -0.978493
    0.000000    0.978493   -0.206282

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  101.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.418843"
 Parameter: YPOS -> "-24.9061018"
 Parameter: ZPOS -> "16.993318"
 Parameter: YPHI -> "303.466621"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.551451    0.000000    0.834207
    0.000000    1.000000    0.000000
   -0.834207    0.000000    0.551451

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   56.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.418843"
 Parameter: YPOS -> "-24.9061018"
 Parameter: ZPOS -> "16.993318"
 Parameter: ZPHI -> "51.7939564"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.618491    0.785792    0.000000
   -0.785792    0.618491    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   51.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.418843 XMAX =   36.418843 XAVE =   36.418843
    YMIN =  -24.906102 YMAX =  -24.906102 YAVE =  -24.906102
    ZMIN =   16.993318 ZMAX =   16.993318 ZAVE =   16.993318
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.418843"
Evaluating: 36.418843+3.5
 Parameter: XMAX <- "39.918843"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.9061018"
Evaluating: -24.9061018+3.5
 Parameter: YMAX <- "-21.4061018"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.993318"
Evaluating: 16.993318+3.5
 Parameter: ZMAX <- "20.493318"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.418843"
Evaluating: 36.418843-3.5
 Parameter: XMIN <- "32.918843"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.9061018"
Evaluating: -24.9061018-3.5
 Parameter: YMIN <- "-28.4061018"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.993318"
Evaluating: 16.993318-3.5
 Parameter: ZMIN <- "13.493318"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.918843"
 Parameter: XMIN -> "32.918843"
 Parameter: YMAX -> "-21.4061018"
 Parameter: YMIN -> "-28.4061018"
 Parameter: ZMAX -> "20.493318"
 Parameter: ZMIN -> "13.493318"
 SELRPN>     26 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      9 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53189 NEG      CLA      12       CLA     -**** MEMB     POPC     37       N             2.5789
53189 NEG      CLA      12       CLA     -**** MEMB     POPC     37       C13           2.5621
53189 NEG      CLA      12       CLA     -**** MEMB     POPC     37       C14           2.9393
53189 NEG      CLA      12       CLA     -**** MEMB     POPC     37       C15           1.9933
53189 NEG      CLA      12       CLA     -**** MEMB     POPC     74       N             3.9499
53189 NEG      CLA      12       CLA     -**** MEMB     POPC     74       C14           3.5863
53189 NEG      CLA      12       CLA     -**** MEMB     POPC     74       C15           3.0858
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "132" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "132"
 Parameter: NPOS -> "120"
Evaluating: 132-120
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.287526223"
Evaluating: 112.065471*(0.287526223-0.5)
 Parameter: XPOS <- "-23.8109739"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.366440886"
Evaluating: 112.065471*(0.366440886-0.5)
 Parameter: YPOS <- "-14.967365"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.761306534"
Evaluating: 142.885239*(0.761306534-0.5)+2.93414115
 Parameter: ZPOS <- "40.2709877"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.2709877" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.2709877" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.418843 XMAX =   36.418843 XAVE =   36.418843
    YMIN =  -24.906102 YMAX =  -24.906102 YAVE =  -24.906102
    ZMIN =   16.993318 ZMAX =   16.993318 ZAVE =   16.993318
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.8109739"
 RDCMND substituted energy or value "?XAVE" to "36.418843"
Evaluating: -23.8109739-36.418843
 Parameter: XTRAN <- "-60.2298169"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.967365"
 RDCMND substituted energy or value "?YAVE" to "-24.9061018"
Evaluating: -14.967365--24.9061018
 Parameter: YTRAN <- "9.9387368"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.2709877"
 RDCMND substituted energy or value "?ZAVE" to "16.993318"
Evaluating: 40.2709877-16.993318
 Parameter: ZTRAN <- "23.2776697"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-60.2298169"
 Parameter: YTRAN -> "9.9387368"
 Parameter: ZTRAN -> "23.2776697"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -60.229817    9.938737   23.277670
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.597604595"
Evaluating: 0.597604595*360.0
 Parameter: XPHI <- "215.137654"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225388654"
Evaluating: 0.225388654*360.0
 Parameter: YPHI <- "81.1399154"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.175904311"
Evaluating: 0.175904311*360.0
 Parameter: ZPHI <- "63.325552"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.8109739"
 Parameter: YPOS -> "-14.967365"
 Parameter: ZPOS -> "40.2709877"
 Parameter: XPHI -> "215.137654"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.817772   -0.575543
    0.000000    0.575543   -0.817772

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  144.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.8109739"
 Parameter: YPOS -> "-14.967365"
 Parameter: ZPOS -> "40.2709877"
 Parameter: YPHI -> "81.1399154"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.154022    0.000000   -0.988067
    0.000000    1.000000    0.000000
    0.988067    0.000000    0.154022

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.8109739"
 Parameter: YPOS -> "-14.967365"
 Parameter: ZPOS -> "40.2709877"
 Parameter: ZPHI -> "63.325552"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.448921    0.893572    0.000000
   -0.893572    0.448921    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   63.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.810974 XMAX =  -23.810974 XAVE =  -23.810974
    YMIN =  -14.967365 YMAX =  -14.967365 YAVE =  -14.967365
    ZMIN =   40.270988 ZMAX =   40.270988 ZAVE =   40.270988
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.8109739"
Evaluating: -23.8109739+3.5
 Parameter: XMAX <- "-20.3109739"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.967365"
Evaluating: -14.967365+3.5
 Parameter: YMAX <- "-11.467365"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.2709877"
Evaluating: 40.2709877+3.5
 Parameter: ZMAX <- "43.7709877"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.8109739"
Evaluating: -23.8109739-3.5
 Parameter: XMIN <- "-27.3109739"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.967365"
Evaluating: -14.967365-3.5
 Parameter: YMIN <- "-18.467365"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.2709877"
Evaluating: 40.2709877-3.5
 Parameter: ZMIN <- "36.7709877"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.3109739"
 Parameter: XMIN -> "-27.3109739"
 Parameter: YMAX -> "-11.467365"
 Parameter: YMIN -> "-18.467365"
 Parameter: ZMAX -> "43.7709877"
 Parameter: ZMIN -> "36.7709877"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "133"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "133" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "133" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "133"
 Parameter: NPOS -> "120"
Evaluating: 133-120
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.599533836"
Evaluating: 112.065471*(0.599533836-0.5)
 Parameter: XPOS <- "11.1543062"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.776946113"
Evaluating: 112.065471*(0.776946113-0.5)
 Parameter: YPOS <- "31.0360966"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.324464291"
Evaluating: 142.885239*(0.324464291-0.5)+2.93414115
 Parameter: ZPOS <- "-22.1473206"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.1473206" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.1543062"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.1543062-0
 Parameter: XTRAN <- "11.1543062"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.0360966"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.0360966-0
 Parameter: YTRAN <- "31.0360966"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.1473206"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.1473206-0
 Parameter: ZTRAN <- "-22.1473206"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.1543062"
 Parameter: YTRAN -> "31.0360966"
 Parameter: ZTRAN -> "-22.1473206"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    11.154306   31.036097  -22.147321
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.697229278"
Evaluating: 0.697229278*360.0
 Parameter: XPHI <- "251.00254"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.496673622"
Evaluating: 0.496673622*360.0
 Parameter: YPHI <- "178.802504"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.320136417"
Evaluating: 0.320136417*360.0
 Parameter: ZPHI <- "115.24911"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.1543062"
 Parameter: YPOS -> "31.0360966"
 Parameter: ZPOS -> "-22.1473206"
 Parameter: XPHI -> "251.00254"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.325526   -0.945533
    0.000000    0.945533   -0.325526

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  109.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.1543062"
 Parameter: YPOS -> "31.0360966"
 Parameter: ZPOS -> "-22.1473206"
 Parameter: YPHI -> "178.802504"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.999782    0.000000   -0.020899
    0.000000    1.000000    0.000000
    0.020899    0.000000   -0.999782

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  178.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.1543062"
 Parameter: YPOS -> "31.0360966"
 Parameter: ZPOS -> "-22.1473206"
 Parameter: ZPHI -> "115.24911"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.426555    0.904462    0.000000
   -0.904462   -0.426555    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  115.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.154306 XMAX =   11.154306 XAVE =   11.154306
    YMIN =   31.036097 YMAX =   31.036097 YAVE =   31.036097
    ZMIN =  -22.147321 ZMAX =  -22.147321 ZAVE =  -22.147321
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.1543062"
Evaluating: 11.1543062+3.5
 Parameter: XMAX <- "14.6543062"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.0360966"
Evaluating: 31.0360966+3.5
 Parameter: YMAX <- "34.5360966"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.1473206"
Evaluating: -22.1473206+3.5
 Parameter: ZMAX <- "-18.6473206"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.1543062"
Evaluating: 11.1543062-3.5
 Parameter: XMIN <- "7.6543062"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.0360966"
Evaluating: 31.0360966-3.5
 Parameter: YMIN <- "27.5360966"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.1473206"
Evaluating: -22.1473206-3.5
 Parameter: ZMIN <- "-25.6473206"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.6543062"
 Parameter: XMIN -> "7.6543062"
 Parameter: YMAX -> "34.5360966"
 Parameter: YMIN -> "27.5360966"
 Parameter: ZMAX -> "-18.6473206"
 Parameter: ZMIN -> "-25.6473206"
 SELRPN>     13 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      1 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53190 NEG      CLA      13       CLA     -9585 PROF     PRO      76       CD            4.4668
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "133" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "133"
 Parameter: NPOS -> "120"
Evaluating: 133-120
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.329181054E-02"
Evaluating: 112.065471*(4.329181054E-02-0.5)
 Parameter: XPOS <- "-51.1812184"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.415360137"
Evaluating: 112.065471*(0.415360137-0.5)
 Parameter: YPOS <- "-9.48520611"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.320571415"
Evaluating: 142.885239*(0.320571415-0.5)+2.93414115
 Parameter: ZPOS <- "-22.7035551"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.7035551" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.154306 XMAX =   11.154306 XAVE =   11.154306
    YMIN =   31.036097 YMAX =   31.036097 YAVE =   31.036097
    ZMIN =  -22.147321 ZMAX =  -22.147321 ZAVE =  -22.147321
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.1812184"
 RDCMND substituted energy or value "?XAVE" to "11.1543062"
Evaluating: -51.1812184-11.1543062
 Parameter: XTRAN <- "-62.3355246"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.48520611"
 RDCMND substituted energy or value "?YAVE" to "31.0360966"
Evaluating: -9.48520611-31.0360966
 Parameter: YTRAN <- "-40.5213027"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.7035551"
 RDCMND substituted energy or value "?ZAVE" to "-22.1473206"
Evaluating: -22.7035551--22.1473206
 Parameter: ZTRAN <- "-0.5562345"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.3355246"
 Parameter: YTRAN -> "-40.5213027"
 Parameter: ZTRAN -> "-0.5562345"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -62.335525  -40.521303   -0.556234
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.985361987"
Evaluating: 0.985361987*360.0
 Parameter: XPHI <- "354.730315"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.149644532"
Evaluating: 0.149644532*360.0
 Parameter: YPHI <- "53.8720315"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.168283373"
Evaluating: 0.168283373*360.0
 Parameter: ZPHI <- "60.5820143"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.1812184"
 Parameter: YPOS -> "-9.48520611"
 Parameter: ZPOS -> "-22.7035551"
 Parameter: XPHI -> "354.730315"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.995773   -0.091844
    0.000000    0.091844    0.995773

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    5.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.1812184"
 Parameter: YPOS -> "-9.48520611"
 Parameter: ZPOS -> "-22.7035551"
 Parameter: YPHI -> "53.8720315"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.589591    0.000000   -0.807702
    0.000000    1.000000    0.000000
    0.807702    0.000000    0.589591

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   53.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.1812184"
 Parameter: YPOS -> "-9.48520611"
 Parameter: ZPOS -> "-22.7035551"
 Parameter: ZPHI -> "60.5820143"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.491177    0.871060    0.000000
   -0.871060    0.491177    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   60.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.181218 XMAX =  -51.181218 XAVE =  -51.181218
    YMIN =   -9.485206 YMAX =   -9.485206 YAVE =   -9.485206
    ZMIN =  -22.703555 ZMAX =  -22.703555 ZAVE =  -22.703555
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.1812184"
Evaluating: -51.1812184+3.5
 Parameter: XMAX <- "-47.6812184"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.4852061"
Evaluating: -9.4852061+3.5
 Parameter: YMAX <- "-5.9852061"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.7035551"
Evaluating: -22.7035551+3.5
 Parameter: ZMAX <- "-19.2035551"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.1812184"
Evaluating: -51.1812184-3.5
 Parameter: XMIN <- "-54.6812184"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.4852061"
Evaluating: -9.4852061-3.5
 Parameter: YMIN <- "-12.9852061"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.7035551"
Evaluating: -22.7035551-3.5
 Parameter: ZMIN <- "-26.2035551"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-47.6812184"
 Parameter: XMIN -> "-54.6812184"
 Parameter: YMAX -> "-5.9852061"
 Parameter: YMIN -> "-12.9852061"
 Parameter: ZMAX -> "-19.2035551"
 Parameter: ZMIN -> "-26.2035551"
 SELRPN>     18 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      6 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53190 NEG      CLA      13       CLA     -**** MEMB     POPC     249      N             2.4845
53190 NEG      CLA      13       CLA     -**** MEMB     POPC     249      C12           2.8456
53190 NEG      CLA      13       CLA     -**** MEMB     POPC     249      C13           3.8672
53190 NEG      CLA      13       CLA     -**** MEMB     POPC     249      C14           2.9541
53190 NEG      CLA      13       CLA     -**** MEMB     POPC     249      C15           1.5415
53190 NEG      CLA      13       CLA     -**** MEMB     POPC     249      C11           3.2710
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "133" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "133"
 Parameter: NPOS -> "120"
Evaluating: 133-120
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.636893856"
Evaluating: 112.065471*(0.636893856-0.5)
 Parameter: XPOS <- "15.3410744"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.520320637"
Evaluating: 112.065471*(0.520320637-0.5)
 Parameter: YPOS <- "2.27724176"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.34115295"
Evaluating: 142.885239*(0.34115295-0.5)+2.93414115
 Parameter: ZPOS <- "-19.7627576"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.7627576" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.181218 XMAX =  -51.181218 XAVE =  -51.181218
    YMIN =   -9.485206 YMAX =   -9.485206 YAVE =   -9.485206
    ZMIN =  -22.703555 ZMAX =  -22.703555 ZAVE =  -22.703555
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.3410744"
 RDCMND substituted energy or value "?XAVE" to "-51.1812184"
Evaluating: 15.3410744--51.1812184
 Parameter: XTRAN <- "66.5222928"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.27724176"
 RDCMND substituted energy or value "?YAVE" to "-9.4852061"
Evaluating: 2.27724176--9.4852061
 Parameter: YTRAN <- "11.7624479"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.7627576"
 RDCMND substituted energy or value "?ZAVE" to "-22.7035551"
Evaluating: -19.7627576--22.7035551
 Parameter: ZTRAN <- "2.9407975"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "66.5222928"
 Parameter: YTRAN -> "11.7624479"
 Parameter: ZTRAN -> "2.9407975"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    66.522293   11.762448    2.940797
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.519932152"
Evaluating: 0.519932152*360.0
 Parameter: XPHI <- "187.175575"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.773490543E-02"
Evaluating: 5.773490543E-02*360.0
 Parameter: YPHI <- "20.784566"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.172920747"
Evaluating: 0.172920747*360.0
 Parameter: ZPHI <- "62.2514689"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.3410744"
 Parameter: YPOS -> "2.27724176"
 Parameter: ZPOS -> "-19.7627576"
 Parameter: XPHI -> "187.175575"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.992168   -0.124910
    0.000000    0.124910   -0.992168

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  172.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.3410744"
 Parameter: YPOS -> "2.27724176"
 Parameter: ZPOS -> "-19.7627576"
 Parameter: YPHI -> "20.784566"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.934921    0.000000   -0.354855
    0.000000    1.000000    0.000000
    0.354855    0.000000    0.934921

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   20.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.3410744"
 Parameter: YPOS -> "2.27724176"
 Parameter: ZPOS -> "-19.7627576"
 Parameter: ZPHI -> "62.2514689"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.465592    0.885000    0.000000
   -0.885000    0.465592    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.341074 XMAX =   15.341074 XAVE =   15.341074
    YMIN =    2.277242 YMAX =    2.277242 YAVE =    2.277242
    ZMIN =  -19.762758 ZMAX =  -19.762758 ZAVE =  -19.762758
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.3410744"
Evaluating: 15.3410744+3.5
 Parameter: XMAX <- "18.8410744"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.27724174"
Evaluating: 2.27724174+3.5
 Parameter: YMAX <- "5.77724174"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.7627576"
Evaluating: -19.7627576+3.5
 Parameter: ZMAX <- "-16.2627576"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.3410744"
Evaluating: 15.3410744-3.5
 Parameter: XMIN <- "11.8410744"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.27724174"
Evaluating: 2.27724174-3.5
 Parameter: YMIN <- "-1.22275826"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.7627576"
Evaluating: -19.7627576-3.5
 Parameter: ZMIN <- "-23.2627576"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.8410744"
 Parameter: XMIN -> "11.8410744"
 Parameter: YMAX -> "5.77724174"
 Parameter: YMIN -> "-1.22275826"
 Parameter: ZMAX -> "-16.2627576"
 Parameter: ZMIN -> "-23.2627576"
 SELRPN>     29 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     18 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53190 NEG      CLA      13       CLA     -3137 PROB     TRP      222      CD2           4.4258
53190 NEG      CLA      13       CLA     -3138 PROB     TRP      222      CE3           3.3703
53190 NEG      CLA      13       CLA     -3140 PROB     TRP      222      CZ3           3.0779
53190 NEG      CLA      13       CLA     -3177 PROB     PHE      225      CA            4.1007
53190 NEG      CLA      13       CLA     -3179 PROB     PHE      225      CB            2.9450
53190 NEG      CLA      13       CLA     -3182 PROB     PHE      225      CG            2.0820
53190 NEG      CLA      13       CLA     -3183 PROB     PHE      225      CD1           3.1496
53190 NEG      CLA      13       CLA     -3185 PROB     PHE      225      CE1           3.4456
53190 NEG      CLA      13       CLA     -3187 PROB     PHE      225      CZ            2.8672
53190 NEG      CLA      13       CLA     -3189 PROB     PHE      225      CD2           0.7873
53190 NEG      CLA      13       CLA     -3191 PROB     PHE      225      CE2           1.6091
53190 NEG      CLA      13       CLA     -3193 PROB     PHE      225      C             4.0751
53190 NEG      CLA      13       CLA     -3194 PROB     PHE      225      O             4.4698
53190 NEG      CLA      13       CLA     -3195 PROB     ILE      226      N             4.2052
53190 NEG      CLA      13       CLA     -3205 PROB     ILE      226      CG1           4.3197
53190 NEG      CLA      13       CLA     -3208 PROB     ILE      226      CD            5.2215
53190 NEG      CLA      13       CLA     -3246 PROB     TRP      229      CD1           4.7478
53190 NEG      CLA      13       CLA     -3248 PROB     TRP      229      NE1           4.9794
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        18
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "18"
 Comparing "18" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "133" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "133"
 Parameter: NPOS -> "120"
Evaluating: 133-120
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.625293287"
Evaluating: 112.065471*(0.625293287-0.5)
 Parameter: XPOS <- "14.0410512"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.731250647"
Evaluating: 112.065471*(0.731250647-0.5)
 Parameter: YPOS <- "25.9152127"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.879091227"
Evaluating: 142.885239*(0.879091227-0.5)+2.93414115
 Parameter: ZPOS <- "57.1006817"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.1006817" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.1006817" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.341074 XMAX =   15.341074 XAVE =   15.341074
    YMIN =    2.277242 YMAX =    2.277242 YAVE =    2.277242
    ZMIN =  -19.762758 ZMAX =  -19.762758 ZAVE =  -19.762758
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.0410512"
 RDCMND substituted energy or value "?XAVE" to "15.3410744"
Evaluating: 14.0410512-15.3410744
 Parameter: XTRAN <- "-1.3000232"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.9152127"
 RDCMND substituted energy or value "?YAVE" to "2.27724174"
Evaluating: 25.9152127-2.27724174
 Parameter: YTRAN <- "23.637971"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.1006817"
 RDCMND substituted energy or value "?ZAVE" to "-19.7627576"
Evaluating: 57.1006817--19.7627576
 Parameter: ZTRAN <- "76.8634393"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.3000232"
 Parameter: YTRAN -> "23.637971"
 Parameter: ZTRAN -> "76.8634393"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -1.300023   23.637971   76.863439
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549563041"
Evaluating: 0.549563041*360.0
 Parameter: XPHI <- "197.842695"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.508977297"
Evaluating: 0.508977297*360.0
 Parameter: YPHI <- "183.231827"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864731685"
Evaluating: 0.864731685*360.0
 Parameter: ZPHI <- "311.303407"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.0410512"
 Parameter: YPOS -> "25.9152127"
 Parameter: ZPOS -> "57.1006817"
 Parameter: XPHI -> "197.842695"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.951901   -0.306405
    0.000000    0.306405   -0.951901

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.0410512"
 Parameter: YPOS -> "25.9152127"
 Parameter: ZPOS -> "57.1006817"
 Parameter: YPHI -> "183.231827"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.998410    0.000000    0.056376
    0.000000    1.000000    0.000000
   -0.056376    0.000000   -0.998410

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  176.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.0410512"
 Parameter: YPOS -> "25.9152127"
 Parameter: ZPOS -> "57.1006817"
 Parameter: ZPHI -> "311.303407"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.660046   -0.751225    0.000000
    0.751225    0.660046    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   48.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.041051 XMAX =   14.041051 XAVE =   14.041051
    YMIN =   25.915213 YMAX =   25.915213 YAVE =   25.915213
    ZMIN =   57.100682 ZMAX =   57.100682 ZAVE =   57.100682
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.0410512"
Evaluating: 14.0410512+3.5
 Parameter: XMAX <- "17.5410512"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.9152127"
Evaluating: 25.9152127+3.5
 Parameter: YMAX <- "29.4152127"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.1006817"
Evaluating: 57.1006817+3.5
 Parameter: ZMAX <- "60.6006817"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.0410512"
Evaluating: 14.0410512-3.5
 Parameter: XMIN <- "10.5410512"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.9152127"
Evaluating: 25.9152127-3.5
 Parameter: YMIN <- "22.4152127"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.1006817"
Evaluating: 57.1006817-3.5
 Parameter: ZMIN <- "53.6006817"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.5410512"
 Parameter: XMIN -> "10.5410512"
 Parameter: YMAX -> "29.4152127"
 Parameter: YMIN -> "22.4152127"
 Parameter: ZMAX -> "60.6006817"
 Parameter: ZMIN -> "53.6006817"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "134"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "134" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "134" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "134"
 Parameter: NPOS -> "120"
Evaluating: 134-120
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.125671664"
Evaluating: 112.065471*(0.125671664-0.5)
 Parameter: XPOS <- "-41.9492813"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.387368424"
Evaluating: 112.065471*(0.387368424-0.5)
 Parameter: YPOS <- "-12.6221106"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.609039073"
Evaluating: 142.885239*(0.609039073-0.5)+2.93414115
 Parameter: ZPOS <- "18.5142152"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.5142152" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.5142152" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.9492813"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.9492813-0
 Parameter: XTRAN <- "-41.9492813"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.6221106"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.6221106-0
 Parameter: YTRAN <- "-12.6221106"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.5142152"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 18.5142152-0
 Parameter: ZTRAN <- "18.5142152"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.9492813"
 Parameter: YTRAN -> "-12.6221106"
 Parameter: ZTRAN -> "18.5142152"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -41.949281  -12.622111   18.514215
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.809742153"
Evaluating: 0.809742153*360.0
 Parameter: XPHI <- "291.507175"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.153875361"
Evaluating: 0.153875361*360.0
 Parameter: YPHI <- "55.39513"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.341757018"
Evaluating: 0.341757018*360.0
 Parameter: ZPHI <- "123.032526"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.9492813"
 Parameter: YPOS -> "-12.6221106"
 Parameter: ZPOS -> "18.5142152"
 Parameter: XPHI -> "291.507175"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.366618   -0.930372
    0.000000    0.930372    0.366618

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   68.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.9492813"
 Parameter: YPOS -> "-12.6221106"
 Parameter: ZPOS -> "18.5142152"
 Parameter: YPHI -> "55.39513"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.567914    0.000000   -0.823088
    0.000000    1.000000    0.000000
    0.823088    0.000000    0.567914

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   55.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.9492813"
 Parameter: YPOS -> "-12.6221106"
 Parameter: ZPOS -> "18.5142152"
 Parameter: ZPHI -> "123.032526"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.545115    0.838361    0.000000
   -0.838361   -0.545115    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  123.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.949281 XMAX =  -41.949281 XAVE =  -41.949281
    YMIN =  -12.622111 YMAX =  -12.622111 YAVE =  -12.622111
    ZMIN =   18.514215 ZMAX =   18.514215 ZAVE =   18.514215
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.9492813"
Evaluating: -41.9492813+3.5
 Parameter: XMAX <- "-38.4492813"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.6221106"
Evaluating: -12.6221106+3.5
 Parameter: YMAX <- "-9.1221106"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.5142152"
Evaluating: 18.5142152+3.5
 Parameter: ZMAX <- "22.0142152"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.9492813"
Evaluating: -41.9492813-3.5
 Parameter: XMIN <- "-45.4492813"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.6221106"
Evaluating: -12.6221106-3.5
 Parameter: YMIN <- "-16.1221106"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.5142152"
Evaluating: 18.5142152-3.5
 Parameter: ZMIN <- "15.0142152"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.4492813"
 Parameter: XMIN -> "-45.4492813"
 Parameter: YMAX -> "-9.1221106"
 Parameter: YMIN -> "-16.1221106"
 Parameter: ZMAX -> "22.0142152"
 Parameter: ZMIN -> "15.0142152"
 SELRPN>     24 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     12 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53191 NEG      CLA      14       CLA     -**** MEMB     POPC     47       N             2.6271
53191 NEG      CLA      14       CLA     -**** MEMB     POPC     47       C12           1.7243
53191 NEG      CLA      14       CLA     -**** MEMB     POPC     47       C13           2.9508
53191 NEG      CLA      14       CLA     -**** MEMB     POPC     47       C15           2.8855
53191 NEG      CLA      14       CLA     -**** MEMB     POPC     47       C11           0.6311
53191 NEG      CLA      14       CLA     -**** MEMB     POPC     47       P             2.0496
53191 NEG      CLA      14       CLA     -**** MEMB     POPC     47       O13           3.1364
53191 NEG      CLA      14       CLA     -**** MEMB     POPC     47       O14           2.6496
53191 NEG      CLA      14       CLA     -**** MEMB     POPC     47       O12           0.8302
53191 NEG      CLA      14       CLA     -**** MEMB     POPC     47       O11           2.8017
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "134" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "134"
 Parameter: NPOS -> "120"
Evaluating: 134-120
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.198919708"
Evaluating: 112.065471*(0.198919708-0.5)
 Parameter: XPOS <- "-33.7407047"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.438011518"
Evaluating: 112.065471*(0.438011518-0.5)
 Parameter: YPOS <- "-6.94676843"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.888196368"
Evaluating: 142.885239*(0.888196368-0.5)+2.93414115
 Parameter: ZPOS <- "58.401672"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "58.401672" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "58.401672" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.949281 XMAX =  -41.949281 XAVE =  -41.949281
    YMIN =  -12.622111 YMAX =  -12.622111 YAVE =  -12.622111
    ZMIN =   18.514215 ZMAX =   18.514215 ZAVE =   18.514215
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.7407047"
 RDCMND substituted energy or value "?XAVE" to "-41.9492813"
Evaluating: -33.7407047--41.9492813
 Parameter: XTRAN <- "8.2085766"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.94676843"
 RDCMND substituted energy or value "?YAVE" to "-12.6221106"
Evaluating: -6.94676843--12.6221106
 Parameter: YTRAN <- "5.67534217"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "58.401672"
 RDCMND substituted energy or value "?ZAVE" to "18.5142152"
Evaluating: 58.401672-18.5142152
 Parameter: ZTRAN <- "39.8874568"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.2085766"
 Parameter: YTRAN -> "5.67534217"
 Parameter: ZTRAN -> "39.8874568"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     8.208577    5.675342   39.887457
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.589092284"
Evaluating: 0.589092284*360.0
 Parameter: XPHI <- "212.073222"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396661171"
Evaluating: 0.396661171*360.0
 Parameter: YPHI <- "142.798022"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.083612897E-02"
Evaluating: 4.083612897E-02*360.0
 Parameter: ZPHI <- "14.7010064"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.7407047"
 Parameter: YPOS -> "-6.94676843"
 Parameter: ZPOS -> "58.401672"
 Parameter: XPHI -> "212.073222"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.847370   -0.531003
    0.000000    0.531003   -0.847370

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  147.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.7407047"
 Parameter: YPOS -> "-6.94676843"
 Parameter: ZPOS -> "58.401672"
 Parameter: YPHI -> "142.798022"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.796509    0.000000   -0.604627
    0.000000    1.000000    0.000000
    0.604627    0.000000   -0.796509

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.7407047"
 Parameter: YPOS -> "-6.94676843"
 Parameter: ZPOS -> "58.401672"
 Parameter: ZPHI -> "14.7010064"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.967263    0.253775    0.000000
   -0.253775    0.967263    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   14.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.740705 XMAX =  -33.740705 XAVE =  -33.740705
    YMIN =   -6.946768 YMAX =   -6.946768 YAVE =   -6.946768
    ZMIN =   58.401672 ZMAX =   58.401672 ZAVE =   58.401672
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.7407047"
Evaluating: -33.7407047+3.5
 Parameter: XMAX <- "-30.2407047"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.94676843"
Evaluating: -6.94676843+3.5
 Parameter: YMAX <- "-3.44676843"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "58.401672"
Evaluating: 58.401672+3.5
 Parameter: ZMAX <- "61.901672"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.7407047"
Evaluating: -33.7407047-3.5
 Parameter: XMIN <- "-37.2407047"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.94676843"
Evaluating: -6.94676843-3.5
 Parameter: YMIN <- "-10.4467684"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "58.401672"
Evaluating: 58.401672-3.5
 Parameter: ZMIN <- "54.901672"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.2407047"
 Parameter: XMIN -> "-37.2407047"
 Parameter: YMAX -> "-3.44676843"
 Parameter: YMIN -> "-10.4467684"
 Parameter: ZMAX -> "61.901672"
 Parameter: ZMIN -> "54.901672"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "135"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "135" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "135"
Evaluating: 135
 Parameter: J <- "135"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "135" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "135"
 Parameter: NPOS -> "120"
Evaluating: 135-120
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.492749428"
Evaluating: 112.065471*(0.492749428-0.5)
 Parameter: XPOS <- "-0.812538766"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.482691439"
Evaluating: 112.065471*(0.482691439-0.5)
 Parameter: YPOS <- "-1.93969204"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "8.373311215E-02"
Evaluating: 142.885239*(8.373311215E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-56.5442526"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.5442526" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.812538766"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.812538766-0
 Parameter: XTRAN <- "-0.812538766"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.93969204"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.93969204-0
 Parameter: YTRAN <- "-1.93969204"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.5442526"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.5442526-0
 Parameter: ZTRAN <- "-56.5442526"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.812538766"
 Parameter: YTRAN -> "-1.93969204"
 Parameter: ZTRAN -> "-56.5442526"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -0.812539   -1.939692  -56.544253
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.448758279"
Evaluating: 0.448758279*360.0
 Parameter: XPHI <- "161.55298"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.437039836E-02"
Evaluating: 8.437039836E-02*360.0
 Parameter: YPHI <- "30.3733434"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.568040221"
Evaluating: 0.568040221*360.0
 Parameter: ZPHI <- "204.49448"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.812538766"
 Parameter: YPOS -> "-1.93969204"
 Parameter: ZPOS -> "-56.5442526"
 Parameter: XPHI -> "161.55298"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.948617    0.316428
    0.000000   -0.316428   -0.948617

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  161.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.812538766"
 Parameter: YPOS -> "-1.93969204"
 Parameter: ZPOS -> "-56.5442526"
 Parameter: YPHI -> "30.3733434"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.862749    0.000000   -0.505632
    0.000000    1.000000    0.000000
    0.505632    0.000000    0.862749

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   30.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.812538766"
 Parameter: YPOS -> "-1.93969204"
 Parameter: ZPOS -> "-56.5442526"
 Parameter: ZPHI -> "204.49448"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.910001   -0.414606    0.000000
    0.414606   -0.910001    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  155.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.812539 XMAX =   -0.812539 XAVE =   -0.812539
    YMIN =   -1.939692 YMAX =   -1.939692 YAVE =   -1.939692
    ZMIN =  -56.544253 ZMAX =  -56.544253 ZAVE =  -56.544253
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.812538766"
Evaluating: -0.812538766+3.5
 Parameter: XMAX <- "2.68746123"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.93969204"
Evaluating: -1.93969204+3.5
 Parameter: YMAX <- "1.56030796"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.5442526"
Evaluating: -56.5442526+3.5
 Parameter: ZMAX <- "-53.0442526"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.812538766"
Evaluating: -0.812538766-3.5
 Parameter: XMIN <- "-4.31253877"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.93969204"
Evaluating: -1.93969204-3.5
 Parameter: YMIN <- "-5.43969204"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.5442526"
Evaluating: -56.5442526-3.5
 Parameter: ZMIN <- "-60.0442526"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.68746123"
 Parameter: XMIN -> "-4.31253877"
 Parameter: YMAX -> "1.56030796"
 Parameter: YMIN -> "-5.43969204"
 Parameter: ZMAX -> "-53.0442526"
 Parameter: ZMIN -> "-60.0442526"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "136"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "136" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "136" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "136"
 Parameter: NPOS -> "120"
Evaluating: 136-120
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.600592841"
Evaluating: 112.065471*(0.600592841-0.5)
 Parameter: XPOS <- "11.2729841"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.450581275"
Evaluating: 112.065471*(0.450581275-0.5)
 Parameter: YPOS <- "-5.53813269"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.859332607"
Evaluating: 142.885239*(0.859332607-0.5)+2.93414115
 Parameter: ZPOS <- "54.2774666"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.2774666" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.2774666" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.2729841"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.2729841-0
 Parameter: XTRAN <- "11.2729841"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.53813269"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.53813269-0
 Parameter: YTRAN <- "-5.53813269"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.2774666"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 54.2774666-0
 Parameter: ZTRAN <- "54.2774666"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.2729841"
 Parameter: YTRAN -> "-5.53813269"
 Parameter: ZTRAN -> "54.2774666"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    11.272984   -5.538133   54.277467
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.992830289"
Evaluating: 0.992830289*360.0
 Parameter: XPHI <- "357.418904"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.708916015"
Evaluating: 0.708916015*360.0
 Parameter: YPHI <- "255.209765"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.233337206"
Evaluating: 0.233337206*360.0
 Parameter: ZPHI <- "84.0013942"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.2729841"
 Parameter: YPOS -> "-5.53813269"
 Parameter: ZPOS -> "54.2774666"
 Parameter: XPHI -> "357.418904"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998985   -0.045033
    0.000000    0.045033    0.998985

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    2.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.2729841"
 Parameter: YPOS -> "-5.53813269"
 Parameter: ZPOS -> "54.2774666"
 Parameter: YPHI -> "255.209765"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.255281    0.000000    0.966867
    0.000000    1.000000    0.000000
   -0.966867    0.000000   -0.255281

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  104.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.2729841"
 Parameter: YPOS -> "-5.53813269"
 Parameter: ZPOS -> "54.2774666"
 Parameter: ZPHI -> "84.0013942"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.104504    0.994524    0.000000
   -0.994524    0.104504    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   84.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.272984 XMAX =   11.272984 XAVE =   11.272984
    YMIN =   -5.538133 YMAX =   -5.538133 YAVE =   -5.538133
    ZMIN =   54.277467 ZMAX =   54.277467 ZAVE =   54.277467
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.2729841"
Evaluating: 11.2729841+3.5
 Parameter: XMAX <- "14.7729841"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.53813269"
Evaluating: -5.53813269+3.5
 Parameter: YMAX <- "-2.03813269"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.2774666"
Evaluating: 54.2774666+3.5
 Parameter: ZMAX <- "57.7774666"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.2729841"
Evaluating: 11.2729841-3.5
 Parameter: XMIN <- "7.7729841"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.53813269"
Evaluating: -5.53813269-3.5
 Parameter: YMIN <- "-9.03813269"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.2774666"
Evaluating: 54.2774666-3.5
 Parameter: ZMIN <- "50.7774666"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.7729841"
 Parameter: XMIN -> "7.7729841"
 Parameter: YMAX -> "-2.03813269"
 Parameter: YMIN -> "-9.03813269"
 Parameter: ZMAX -> "57.7774666"
 Parameter: ZMIN -> "50.7774666"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "137"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "137" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "137" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "137"
 Parameter: NPOS -> "120"
Evaluating: 137-120
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.856007826"
Evaluating: 112.065471*(0.856007826-0.5)
 Parameter: XPOS <- "39.8961847"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.878177224"
Evaluating: 112.065471*(0.878177224-0.5)
 Parameter: YPOS <- "42.3806087"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.139592725"
Evaluating: 142.885239*(0.139592725-0.5)+2.93414115
 Parameter: ZPOS <- "-48.5627385"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.5627385" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.8961847"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.8961847-0
 Parameter: XTRAN <- "39.8961847"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.3806087"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.3806087-0
 Parameter: YTRAN <- "42.3806087"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.5627385"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.5627385-0
 Parameter: ZTRAN <- "-48.5627385"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.8961847"
 Parameter: YTRAN -> "42.3806087"
 Parameter: ZTRAN -> "-48.5627385"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    39.896185   42.380609  -48.562739
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.872464215"
Evaluating: 0.872464215*360.0
 Parameter: XPHI <- "314.087117"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.46654877"
Evaluating: 0.46654877*360.0
 Parameter: YPHI <- "167.957557"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.425836282"
Evaluating: 0.425836282*360.0
 Parameter: ZPHI <- "153.301062"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.8961847"
 Parameter: YPOS -> "42.3806087"
 Parameter: ZPOS -> "-48.5627385"
 Parameter: XPHI -> "314.087117"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.695751   -0.718283
    0.000000    0.718283    0.695751

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   45.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.8961847"
 Parameter: YPOS -> "42.3806087"
 Parameter: ZPOS -> "-48.5627385"
 Parameter: YPHI -> "167.957557"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.977993    0.000000   -0.208636
    0.000000    1.000000    0.000000
    0.208636    0.000000   -0.977993

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  167.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.8961847"
 Parameter: YPOS -> "42.3806087"
 Parameter: ZPOS -> "-48.5627385"
 Parameter: ZPHI -> "153.301062"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.893380    0.449302    0.000000
   -0.449302   -0.893380    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  153.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.896185 XMAX =   39.896185 XAVE =   39.896185
    YMIN =   42.380609 YMAX =   42.380609 YAVE =   42.380609
    ZMIN =  -48.562739 ZMAX =  -48.562739 ZAVE =  -48.562739
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.8961847"
Evaluating: 39.8961847+3.5
 Parameter: XMAX <- "43.3961847"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.3806087"
Evaluating: 42.3806087+3.5
 Parameter: YMAX <- "45.8806087"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.5627385"
Evaluating: -48.5627385+3.5
 Parameter: ZMAX <- "-45.0627385"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.8961847"
Evaluating: 39.8961847-3.5
 Parameter: XMIN <- "36.3961847"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.3806087"
Evaluating: 42.3806087-3.5
 Parameter: YMIN <- "38.8806087"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.5627385"
Evaluating: -48.5627385-3.5
 Parameter: ZMIN <- "-52.0627385"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.3961847"
 Parameter: XMIN -> "36.3961847"
 Parameter: YMAX -> "45.8806087"
 Parameter: YMIN -> "38.8806087"
 Parameter: ZMAX -> "-45.0627385"
 Parameter: ZMIN -> "-52.0627385"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "138"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "138" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "138" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "138"
 Parameter: NPOS -> "120"
Evaluating: 138-120
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.816463057"
Evaluating: 112.065471*(0.816463057-0.5)
 Parameter: XPOS <- "35.4645815"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.24644115"
Evaluating: 112.065471*(0.24644115-0.5)
 Parameter: YPOS <- "-28.415192"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.699983956"
Evaluating: 142.885239*(0.699983956-0.5)+2.93414115
 Parameter: ZPOS <- "31.5088965"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.5088965" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.5088965" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.4645815"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 35.4645815-0
 Parameter: XTRAN <- "35.4645815"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.415192"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.415192-0
 Parameter: YTRAN <- "-28.415192"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.5088965"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.5088965-0
 Parameter: ZTRAN <- "31.5088965"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.4645815"
 Parameter: YTRAN -> "-28.415192"
 Parameter: ZTRAN -> "31.5088965"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    35.464582  -28.415192   31.508896
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.904999596"
Evaluating: 0.904999596*360.0
 Parameter: XPHI <- "325.799855"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.298956454"
Evaluating: 0.298956454*360.0
 Parameter: YPHI <- "107.624323"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.621461965"
Evaluating: 0.621461965*360.0
 Parameter: ZPHI <- "223.726307"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.4645815"
 Parameter: YPOS -> "-28.415192"
 Parameter: ZPOS -> "31.5088965"
 Parameter: XPHI -> "325.799855"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.827079   -0.562085
    0.000000    0.562085    0.827079

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   34.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.4645815"
 Parameter: YPOS -> "-28.415192"
 Parameter: ZPOS -> "31.5088965"
 Parameter: YPHI -> "107.624323"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.302775    0.000000   -0.953062
    0.000000    1.000000    0.000000
    0.953062    0.000000   -0.302775

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  107.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.4645815"
 Parameter: YPOS -> "-28.415192"
 Parameter: ZPOS -> "31.5088965"
 Parameter: ZPHI -> "223.726307"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.722650   -0.691214    0.000000
    0.691214   -0.722650    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  136.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.464582 XMAX =   35.464582 XAVE =   35.464582
    YMIN =  -28.415192 YMAX =  -28.415192 YAVE =  -28.415192
    ZMIN =   31.508896 ZMAX =   31.508896 ZAVE =   31.508896
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.4645815"
Evaluating: 35.4645815+3.5
 Parameter: XMAX <- "38.9645815"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.415192"
Evaluating: -28.415192+3.5
 Parameter: YMAX <- "-24.915192"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.5088965"
Evaluating: 31.5088965+3.5
 Parameter: ZMAX <- "35.0088965"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.4645815"
Evaluating: 35.4645815-3.5
 Parameter: XMIN <- "31.9645815"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.415192"
Evaluating: -28.415192-3.5
 Parameter: YMIN <- "-31.915192"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.5088965"
Evaluating: 31.5088965-3.5
 Parameter: ZMIN <- "28.0088965"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.9645815"
 Parameter: XMIN -> "31.9645815"
 Parameter: YMAX -> "-24.915192"
 Parameter: YMIN -> "-31.915192"
 Parameter: ZMAX -> "35.0088965"
 Parameter: ZMIN -> "28.0088965"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "139"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "139" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "139"
Evaluating: 139
 Parameter: J <- "139"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "139" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "139"
 Parameter: NPOS -> "120"
Evaluating: 139-120
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.718085267"
Evaluating: 112.065471*(0.718085267-0.5)
 Parameter: XPOS <- "24.4398282"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.477571792"
Evaluating: 112.065471*(0.477571792-0.5)
 Parameter: YPOS <- "-2.51342769"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "2.05427767E-03"
Evaluating: 142.885239*(2.05427767E-03-0.5)+2.93414115
 Parameter: ZPOS <- "-68.2149524"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-68.2149524" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.4398282"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.4398282-0
 Parameter: XTRAN <- "24.4398282"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.51342769"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.51342769-0
 Parameter: YTRAN <- "-2.51342769"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-68.2149524"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -68.2149524-0
 Parameter: ZTRAN <- "-68.2149524"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.4398282"
 Parameter: YTRAN -> "-2.51342769"
 Parameter: ZTRAN -> "-68.2149524"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    24.439828   -2.513428  -68.214952
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926274061"
Evaluating: 0.926274061*360.0
 Parameter: XPHI <- "333.458662"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.799417879"
Evaluating: 0.799417879*360.0
 Parameter: YPHI <- "287.790436"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.256575122"
Evaluating: 0.256575122*360.0
 Parameter: ZPHI <- "92.3670439"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.4398282"
 Parameter: YPOS -> "-2.51342769"
 Parameter: ZPOS -> "-68.2149524"
 Parameter: XPHI -> "333.458662"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.894612   -0.446843
    0.000000    0.446843    0.894612

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   26.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.4398282"
 Parameter: YPOS -> "-2.51342769"
 Parameter: ZPOS -> "-68.2149524"
 Parameter: YPHI -> "287.790436"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.305536    0.000000    0.952180
    0.000000    1.000000    0.000000
   -0.952180    0.000000    0.305536

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   72.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.4398282"
 Parameter: YPOS -> "-2.51342769"
 Parameter: ZPOS -> "-68.2149524"
 Parameter: ZPHI -> "92.3670439"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.041301    0.999147    0.000000
   -0.999147   -0.041301    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   92.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.439828 XMAX =   24.439828 XAVE =   24.439828
    YMIN =   -2.513428 YMAX =   -2.513428 YAVE =   -2.513428
    ZMIN =  -68.214952 ZMAX =  -68.214952 ZAVE =  -68.214952
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.4398282"
Evaluating: 24.4398282+3.5
 Parameter: XMAX <- "27.9398282"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.51342769"
Evaluating: -2.51342769+3.5
 Parameter: YMAX <- "0.98657231"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-68.2149524"
Evaluating: -68.2149524+3.5
 Parameter: ZMAX <- "-64.7149524"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.4398282"
Evaluating: 24.4398282-3.5
 Parameter: XMIN <- "20.9398282"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.51342769"
Evaluating: -2.51342769-3.5
 Parameter: YMIN <- "-6.01342769"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-68.2149524"
Evaluating: -68.2149524-3.5
 Parameter: ZMIN <- "-71.7149524"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.9398282"
 Parameter: XMIN -> "20.9398282"
 Parameter: YMAX -> "0.98657231"
 Parameter: YMIN -> "-6.01342769"
 Parameter: ZMAX -> "-64.7149524"
 Parameter: ZMIN -> "-71.7149524"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "140"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "140" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "140" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "140"
 Parameter: NPOS -> "120"
Evaluating: 140-120
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "1.265219371E-02"
Evaluating: 112.065471*(1.265219371E-02-0.5)
 Parameter: XPOS <- "-54.6148615"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.451548048"
Evaluating: 112.065471*(0.451548048-0.5)
 Parameter: YPOS <- "-5.42979082"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.818214891"
Evaluating: 142.885239*(0.818214891-0.5)+2.93414115
 Parameter: ZPOS <- "48.4023519"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.4023519" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.4023519" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-54.6148615"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -54.6148615-0
 Parameter: XTRAN <- "-54.6148615"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.42979082"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.42979082-0
 Parameter: YTRAN <- "-5.42979082"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.4023519"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.4023519-0
 Parameter: ZTRAN <- "48.4023519"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-54.6148615"
 Parameter: YTRAN -> "-5.42979082"
 Parameter: ZTRAN -> "48.4023519"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -54.614862   -5.429791   48.402352
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.490814734"
Evaluating: 0.490814734*360.0
 Parameter: XPHI <- "176.693304"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.495791748"
Evaluating: 0.495791748*360.0
 Parameter: YPHI <- "178.485029"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.371946958"
Evaluating: 0.371946958*360.0
 Parameter: ZPHI <- "133.900905"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-54.6148615"
 Parameter: YPOS -> "-5.42979082"
 Parameter: ZPOS -> "48.4023519"
 Parameter: XPHI -> "176.693304"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998335    0.057681
    0.000000   -0.057681   -0.998335

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  176.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-54.6148615"
 Parameter: YPOS -> "-5.42979082"
 Parameter: ZPOS -> "48.4023519"
 Parameter: YPHI -> "178.485029"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.999650    0.000000   -0.026438
    0.000000    1.000000    0.000000
    0.026438    0.000000   -0.999650

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  178.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-54.6148615"
 Parameter: YPOS -> "-5.42979082"
 Parameter: ZPOS -> "48.4023519"
 Parameter: ZPHI -> "133.900905"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.693413    0.720540    0.000000
   -0.720540   -0.693413    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  133.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -54.614862 XMAX =  -54.614862 XAVE =  -54.614862
    YMIN =   -5.429791 YMAX =   -5.429791 YAVE =   -5.429791
    ZMIN =   48.402352 ZMAX =   48.402352 ZAVE =   48.402352
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-54.6148615"
Evaluating: -54.6148615+3.5
 Parameter: XMAX <- "-51.1148615"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.42979082"
Evaluating: -5.42979082+3.5
 Parameter: YMAX <- "-1.92979082"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.4023519"
Evaluating: 48.4023519+3.5
 Parameter: ZMAX <- "51.9023519"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-54.6148615"
Evaluating: -54.6148615-3.5
 Parameter: XMIN <- "-58.1148615"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.42979082"
Evaluating: -5.42979082-3.5
 Parameter: YMIN <- "-8.92979082"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.4023519"
Evaluating: 48.4023519-3.5
 Parameter: ZMIN <- "44.9023519"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-51.1148615"
 Parameter: XMIN -> "-58.1148615"
 Parameter: YMAX -> "-1.92979082"
 Parameter: YMIN -> "-8.92979082"
 Parameter: ZMAX -> "51.9023519"
 Parameter: ZMIN -> "44.9023519"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "141"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "141" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "141" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "141"
 Parameter: NPOS -> "120"
Evaluating: 141-120
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.761303016"
Evaluating: 112.065471*(0.761303016-0.5)
 Parameter: XPOS <- "29.2830456"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.156257372"
Evaluating: 112.065471*(0.156257372-0.5)
 Parameter: YPOS <- "-38.5216795"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.949411306"
Evaluating: 142.885239*(0.949411306-0.5)+2.93414115
 Parameter: ZPOS <- "67.148383"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "67.148383" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "67.148383" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.2830456"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.2830456-0
 Parameter: XTRAN <- "29.2830456"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.5216795"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.5216795-0
 Parameter: YTRAN <- "-38.5216795"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "67.148383"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 67.148383-0
 Parameter: ZTRAN <- "67.148383"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.2830456"
 Parameter: YTRAN -> "-38.5216795"
 Parameter: ZTRAN -> "67.148383"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    29.283046  -38.521679   67.148383
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.327499969"
Evaluating: 0.327499969*360.0
 Parameter: XPHI <- "117.899989"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.750944977"
Evaluating: 0.750944977*360.0
 Parameter: YPHI <- "270.340192"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.838251014"
Evaluating: 0.838251014*360.0
 Parameter: ZPHI <- "301.770365"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.2830456"
 Parameter: YPOS -> "-38.5216795"
 Parameter: ZPOS -> "67.148383"
 Parameter: XPHI -> "117.899989"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.467930    0.883766
    0.000000   -0.883766   -0.467930

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  117.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.2830456"
 Parameter: YPOS -> "-38.5216795"
 Parameter: ZPOS -> "67.148383"
 Parameter: YPHI -> "270.340192"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.005937    0.000000    0.999982
    0.000000    1.000000    0.000000
   -0.999982    0.000000    0.005937

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   89.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.2830456"
 Parameter: YPOS -> "-38.5216795"
 Parameter: ZPOS -> "67.148383"
 Parameter: ZPHI -> "301.770365"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.526516   -0.850165    0.000000
    0.850165    0.526516    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   58.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.283046 XMAX =   29.283046 XAVE =   29.283046
    YMIN =  -38.521679 YMAX =  -38.521679 YAVE =  -38.521679
    ZMIN =   67.148383 ZMAX =   67.148383 ZAVE =   67.148383
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.2830456"
Evaluating: 29.2830456+3.5
 Parameter: XMAX <- "32.7830456"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.5216795"
Evaluating: -38.5216795+3.5
 Parameter: YMAX <- "-35.0216795"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "67.148383"
Evaluating: 67.148383+3.5
 Parameter: ZMAX <- "70.648383"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.2830456"
Evaluating: 29.2830456-3.5
 Parameter: XMIN <- "25.7830456"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.5216795"
Evaluating: -38.5216795-3.5
 Parameter: YMIN <- "-42.0216795"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "67.148383"
Evaluating: 67.148383-3.5
 Parameter: ZMIN <- "63.648383"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.7830456"
 Parameter: XMIN -> "25.7830456"
 Parameter: YMAX -> "-35.0216795"
 Parameter: YMIN -> "-42.0216795"
 Parameter: ZMAX -> "70.648383"
 Parameter: ZMIN -> "63.648383"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "142"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "142" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "142"
Evaluating: 142
 Parameter: J <- "142"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "142" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "142"
 Parameter: NPOS -> "120"
Evaluating: 142-120
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.261748411"
Evaluating: 112.065471*(0.261748411-0.5)
 Parameter: XPOS <- "-26.6997765"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.551195112"
Evaluating: 112.065471*(0.551195112-0.5)
 Parameter: YPOS <- "5.73720434"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.120071536"
Evaluating: 142.885239*(0.120071536-0.5)+2.93414115
 Parameter: ZPOS <- "-51.3520282"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.3520282" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.6997765"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -26.6997765-0
 Parameter: XTRAN <- "-26.6997765"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.73720434"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.73720434-0
 Parameter: YTRAN <- "5.73720434"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.3520282"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.3520282-0
 Parameter: ZTRAN <- "-51.3520282"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.6997765"
 Parameter: YTRAN -> "5.73720434"
 Parameter: ZTRAN -> "-51.3520282"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -26.699776    5.737204  -51.352028
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.148637327"
Evaluating: 0.148637327*360.0
 Parameter: XPHI <- "53.5094377"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.166331964"
Evaluating: 0.166331964*360.0
 Parameter: YPHI <- "59.879507"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.445163859"
Evaluating: 0.445163859*360.0
 Parameter: ZPHI <- "160.258989"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.6997765"
 Parameter: YPOS -> "5.73720434"
 Parameter: ZPOS -> "-51.3520282"
 Parameter: XPHI -> "53.5094377"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.594690    0.803955
    0.000000   -0.803955    0.594690

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   53.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.6997765"
 Parameter: YPOS -> "5.73720434"
 Parameter: ZPOS -> "-51.3520282"
 Parameter: YPHI -> "59.879507"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.501820    0.000000   -0.864972
    0.000000    1.000000    0.000000
    0.864972    0.000000    0.501820

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   59.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.6997765"
 Parameter: YPOS -> "5.73720434"
 Parameter: ZPOS -> "-51.3520282"
 Parameter: ZPHI -> "160.258989"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.941229    0.337769    0.000000
   -0.337769   -0.941229    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  160.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.699776 XMAX =  -26.699776 XAVE =  -26.699776
    YMIN =    5.737204 YMAX =    5.737204 YAVE =    5.737204
    ZMIN =  -51.352028 ZMAX =  -51.352028 ZAVE =  -51.352028
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.6997765"
Evaluating: -26.6997765+3.5
 Parameter: XMAX <- "-23.1997765"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.73720434"
Evaluating: 5.73720434+3.5
 Parameter: YMAX <- "9.23720434"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.3520282"
Evaluating: -51.3520282+3.5
 Parameter: ZMAX <- "-47.8520282"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.6997765"
Evaluating: -26.6997765-3.5
 Parameter: XMIN <- "-30.1997765"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.73720434"
Evaluating: 5.73720434-3.5
 Parameter: YMIN <- "2.23720434"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.3520282"
Evaluating: -51.3520282-3.5
 Parameter: ZMIN <- "-54.8520282"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.1997765"
 Parameter: XMIN -> "-30.1997765"
 Parameter: YMAX -> "9.23720434"
 Parameter: YMIN -> "2.23720434"
 Parameter: ZMAX -> "-47.8520282"
 Parameter: ZMIN -> "-54.8520282"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "143"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "143" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "143"
Evaluating: 143
 Parameter: J <- "143"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "143" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "143"
 Parameter: NPOS -> "120"
Evaluating: 143-120
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "9.925015539E-02"
Evaluating: 112.065471*(9.925015539E-02-0.5)
 Parameter: XPOS <- "-44.9102201"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.384733108"
Evaluating: 112.065471*(0.384733108-0.5)
 Parameter: YPOS <- "-12.9174385"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.77067908"
Evaluating: 142.885239*(0.77067908-0.5)+2.93414115
 Parameter: ZPOS <- "41.6101862"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.6101862" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.6101862" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.9102201"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.9102201-0
 Parameter: XTRAN <- "-44.9102201"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.9174385"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.9174385-0
 Parameter: YTRAN <- "-12.9174385"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.6101862"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.6101862-0
 Parameter: ZTRAN <- "41.6101862"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.9102201"
 Parameter: YTRAN -> "-12.9174385"
 Parameter: ZTRAN -> "41.6101862"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -44.910220  -12.917438   41.610186
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.846794459"
Evaluating: 0.846794459*360.0
 Parameter: XPHI <- "304.846005"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.964210582"
Evaluating: 0.964210582*360.0
 Parameter: YPHI <- "347.11581"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.368833153"
Evaluating: 0.368833153*360.0
 Parameter: ZPHI <- "132.779935"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.9102201"
 Parameter: YPOS -> "-12.9174385"
 Parameter: ZPOS -> "41.6101862"
 Parameter: XPHI -> "304.846005"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.571373   -0.820691
    0.000000    0.820691    0.571373

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   55.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.9102201"
 Parameter: YPOS -> "-12.9174385"
 Parameter: ZPOS -> "41.6101862"
 Parameter: YPHI -> "347.11581"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.974823    0.000000    0.222981
    0.000000    1.000000    0.000000
   -0.222981    0.000000    0.974823

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   12.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.9102201"
 Parameter: YPOS -> "-12.9174385"
 Parameter: ZPOS -> "41.6101862"
 Parameter: ZPHI -> "132.779935"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.679184    0.733968    0.000000
   -0.733968   -0.679184    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  132.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.910220 XMAX =  -44.910220 XAVE =  -44.910220
    YMIN =  -12.917438 YMAX =  -12.917438 YAVE =  -12.917438
    ZMIN =   41.610186 ZMAX =   41.610186 ZAVE =   41.610186
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.9102201"
Evaluating: -44.9102201+3.5
 Parameter: XMAX <- "-41.4102201"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.9174385"
Evaluating: -12.9174385+3.5
 Parameter: YMAX <- "-9.4174385"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.6101862"
Evaluating: 41.6101862+3.5
 Parameter: ZMAX <- "45.1101862"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.9102201"
Evaluating: -44.9102201-3.5
 Parameter: XMIN <- "-48.4102201"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.9174385"
Evaluating: -12.9174385-3.5
 Parameter: YMIN <- "-16.4174385"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.6101862"
Evaluating: 41.6101862-3.5
 Parameter: ZMIN <- "38.1101862"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.4102201"
 Parameter: XMIN -> "-48.4102201"
 Parameter: YMAX -> "-9.4174385"
 Parameter: YMIN -> "-16.4174385"
 Parameter: ZMAX -> "45.1101862"
 Parameter: ZMIN -> "38.1101862"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "144"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "144" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "144"
Evaluating: 144
 Parameter: J <- "144"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "144" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "144"
 Parameter: NPOS -> "120"
Evaluating: 144-120
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.60503968"
Evaluating: 112.065471*(0.60503968-0.5)
 Parameter: XPOS <- "11.7713212"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.254958828"
Evaluating: 112.065471*(0.254958828-0.5)
 Parameter: YPOS <- "-27.4606544"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.717442142"
Evaluating: 142.885239*(0.717442142-0.5)+2.93414115
 Parameter: ZPOS <- "34.0034136"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.0034136" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.0034136" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.7713212"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.7713212-0
 Parameter: XTRAN <- "11.7713212"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.4606544"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.4606544-0
 Parameter: YTRAN <- "-27.4606544"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.0034136"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.0034136-0
 Parameter: ZTRAN <- "34.0034136"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.7713212"
 Parameter: YTRAN -> "-27.4606544"
 Parameter: ZTRAN -> "34.0034136"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    11.771321  -27.460654   34.003414
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.631951087"
Evaluating: 0.631951087*360.0
 Parameter: XPHI <- "227.502391"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.629546125"
Evaluating: 0.629546125*360.0
 Parameter: YPHI <- "226.636605"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.390142887"
Evaluating: 0.390142887*360.0
 Parameter: ZPHI <- "140.451439"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.7713212"
 Parameter: YPOS -> "-27.4606544"
 Parameter: ZPOS -> "34.0034136"
 Parameter: XPHI -> "227.502391"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.675559   -0.737306
    0.000000    0.737306   -0.675559

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  132.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.7713212"
 Parameter: YPOS -> "-27.4606544"
 Parameter: ZPOS -> "34.0034136"
 Parameter: YPHI -> "226.636605"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.686623    0.000000    0.727013
    0.000000    1.000000    0.000000
   -0.727013    0.000000   -0.686623

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  133.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.7713212"
 Parameter: YPOS -> "-27.4606544"
 Parameter: ZPOS -> "34.0034136"
 Parameter: ZPHI -> "140.451439"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.771085    0.636732    0.000000
   -0.636732   -0.771085    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  140.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.771321 XMAX =   11.771321 XAVE =   11.771321
    YMIN =  -27.460654 YMAX =  -27.460654 YAVE =  -27.460654
    ZMIN =   34.003414 ZMAX =   34.003414 ZAVE =   34.003414
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.7713212"
Evaluating: 11.7713212+3.5
 Parameter: XMAX <- "15.2713212"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.4606544"
Evaluating: -27.4606544+3.5
 Parameter: YMAX <- "-23.9606544"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.0034136"
Evaluating: 34.0034136+3.5
 Parameter: ZMAX <- "37.5034136"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.7713212"
Evaluating: 11.7713212-3.5
 Parameter: XMIN <- "8.2713212"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.4606544"
Evaluating: -27.4606544-3.5
 Parameter: YMIN <- "-30.9606544"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.0034136"
Evaluating: 34.0034136-3.5
 Parameter: ZMIN <- "30.5034136"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.2713212"
 Parameter: XMIN -> "8.2713212"
 Parameter: YMAX -> "-23.9606544"
 Parameter: YMIN -> "-30.9606544"
 Parameter: ZMAX -> "37.5034136"
 Parameter: ZMIN -> "30.5034136"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "145"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "145" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "145" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "120"
Evaluating: 145-120
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.846466787"
Evaluating: 112.065471*(0.846466787-0.5)
 Parameter: XPOS <- "38.8269637"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.690918723"
Evaluating: 112.065471*(0.690918723-0.5)
 Parameter: YPOS <- "21.3953966"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.341209107"
Evaluating: 142.885239*(0.341209107-0.5)+2.93414115
 Parameter: ZPOS <- "-19.7547335"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.7547335" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.8269637"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.8269637-0
 Parameter: XTRAN <- "38.8269637"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.3953966"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.3953966-0
 Parameter: YTRAN <- "21.3953966"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.7547335"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.7547335-0
 Parameter: ZTRAN <- "-19.7547335"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.8269637"
 Parameter: YTRAN -> "21.3953966"
 Parameter: ZTRAN -> "-19.7547335"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    38.826964   21.395397  -19.754734
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.285169011"
Evaluating: 0.285169011*360.0
 Parameter: XPHI <- "102.660844"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.685914525"
Evaluating: 0.685914525*360.0
 Parameter: YPHI <- "246.929229"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.597518303"
Evaluating: 0.597518303*360.0
 Parameter: ZPHI <- "215.106589"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.8269637"
 Parameter: YPOS -> "21.3953966"
 Parameter: ZPOS -> "-19.7547335"
 Parameter: XPHI -> "102.660844"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.219179    0.975685
    0.000000   -0.975685   -0.219179

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  102.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.8269637"
 Parameter: YPOS -> "21.3953966"
 Parameter: ZPOS -> "-19.7547335"
 Parameter: YPHI -> "246.929229"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.391868    0.000000    0.920022
    0.000000    1.000000    0.000000
   -0.920022    0.000000   -0.391868

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  113.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.8269637"
 Parameter: YPOS -> "21.3953966"
 Parameter: ZPOS -> "-19.7547335"
 Parameter: ZPHI -> "215.106589"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.818084   -0.575099    0.000000
    0.575099   -0.818084    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  144.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.826964 XMAX =   38.826964 XAVE =   38.826964
    YMIN =   21.395397 YMAX =   21.395397 YAVE =   21.395397
    ZMIN =  -19.754734 ZMAX =  -19.754734 ZAVE =  -19.754734
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.8269637"
Evaluating: 38.8269637+3.5
 Parameter: XMAX <- "42.3269637"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.3953966"
Evaluating: 21.3953966+3.5
 Parameter: YMAX <- "24.8953966"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.7547335"
Evaluating: -19.7547335+3.5
 Parameter: ZMAX <- "-16.2547335"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.8269637"
Evaluating: 38.8269637-3.5
 Parameter: XMIN <- "35.3269637"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.3953966"
Evaluating: 21.3953966-3.5
 Parameter: YMIN <- "17.8953966"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.7547335"
Evaluating: -19.7547335-3.5
 Parameter: ZMIN <- "-23.2547335"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.3269637"
 Parameter: XMIN -> "35.3269637"
 Parameter: YMAX -> "24.8953966"
 Parameter: YMIN -> "17.8953966"
 Parameter: ZMAX -> "-16.2547335"
 Parameter: ZMIN -> "-23.2547335"
 SELRPN>     21 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     10 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     219      N             3.7362
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     219      C13           2.8668
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     219      C15           3.5894
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     219      O12           3.7270
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     219      O11           3.9871
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     260      C14           2.8639
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "145" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "120"
Evaluating: 145-120
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "8.93902486E-02"
Evaluating: 112.065471*(8.93902486E-02-0.5)
 Parameter: XPOS <- "-46.0151752"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.663071831E-02"
Evaluating: 112.065471*(5.663071831E-02-0.5)
 Parameter: YPOS <- "-49.6863874"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.366245377"
Evaluating: 142.885239*(0.366245377-0.5)+2.93414115
 Parameter: ZPOS <- "-16.1774201"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.1774201" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.826964 XMAX =   38.826964 XAVE =   38.826964
    YMIN =   21.395397 YMAX =   21.395397 YAVE =   21.395397
    ZMIN =  -19.754734 ZMAX =  -19.754734 ZAVE =  -19.754734
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.0151752"
 RDCMND substituted energy or value "?XAVE" to "38.8269637"
Evaluating: -46.0151752-38.8269637
 Parameter: XTRAN <- "-84.8421389"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.6863874"
 RDCMND substituted energy or value "?YAVE" to "21.3953966"
Evaluating: -49.6863874-21.3953966
 Parameter: YTRAN <- "-71.081784"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.1774201"
 RDCMND substituted energy or value "?ZAVE" to "-19.7547335"
Evaluating: -16.1774201--19.7547335
 Parameter: ZTRAN <- "3.5773134"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-84.8421389"
 Parameter: YTRAN -> "-71.081784"
 Parameter: ZTRAN -> "3.5773134"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -84.842139  -71.081784    3.577313
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.256774747"
Evaluating: 0.256774747*360.0
 Parameter: XPHI <- "92.4389089"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.593827968"
Evaluating: 0.593827968*360.0
 Parameter: YPHI <- "213.778068"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.615777485"
Evaluating: 0.615777485*360.0
 Parameter: ZPHI <- "221.679895"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.0151752"
 Parameter: YPOS -> "-49.6863874"
 Parameter: ZPOS -> "-16.1774201"
 Parameter: XPHI -> "92.4389089"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.042554    0.999094
    0.000000   -0.999094   -0.042554

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   92.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.0151752"
 Parameter: YPOS -> "-49.6863874"
 Parameter: ZPOS -> "-16.1774201"
 Parameter: YPHI -> "213.778068"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.831197    0.000000    0.555977
    0.000000    1.000000    0.000000
   -0.555977    0.000000   -0.831197

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  146.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.0151752"
 Parameter: YPOS -> "-49.6863874"
 Parameter: ZPOS -> "-16.1774201"
 Parameter: ZPHI -> "221.679895"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.746872   -0.664968    0.000000
    0.664968   -0.746872    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  138.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.015175 XMAX =  -46.015175 XAVE =  -46.015175
    YMIN =  -49.686387 YMAX =  -49.686387 YAVE =  -49.686387
    ZMIN =  -16.177420 ZMAX =  -16.177420 ZAVE =  -16.177420
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.0151752"
Evaluating: -46.0151752+3.5
 Parameter: XMAX <- "-42.5151752"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.6863874"
Evaluating: -49.6863874+3.5
 Parameter: YMAX <- "-46.1863874"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.1774201"
Evaluating: -16.1774201+3.5
 Parameter: ZMAX <- "-12.6774201"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.0151752"
Evaluating: -46.0151752-3.5
 Parameter: XMIN <- "-49.5151752"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.6863874"
Evaluating: -49.6863874-3.5
 Parameter: YMIN <- "-53.1863874"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.1774201"
Evaluating: -16.1774201-3.5
 Parameter: ZMIN <- "-19.6774201"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.5151752"
 Parameter: XMIN -> "-49.5151752"
 Parameter: YMAX -> "-46.1863874"
 Parameter: YMIN -> "-53.1863874"
 Parameter: ZMAX -> "-12.6774201"
 Parameter: ZMIN -> "-19.6774201"
 SELRPN>     24 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     13 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     292      C1            3.9941
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     292      C2            2.5024
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     292      O21           1.5535
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     292      C21           2.1479
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     292      O22           3.1609
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     292      C22           2.4673
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     292      C3            2.8472
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     292      O31           3.4892
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     292      C23           3.2414
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     292      C24           3.1187
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "145" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "120"
Evaluating: 145-120
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.615216303"
Evaluating: 112.065471*(0.615216303-0.5)
 Parameter: XPOS <- "12.9117693"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.266638079"
Evaluating: 112.065471*(0.266638079-0.5)
 Parameter: YPOS <- "-26.1518136"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.500630456"
Evaluating: 142.885239*(0.500630456-0.5)+2.93414115
 Parameter: ZPOS <- "3.02422401"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.02422401" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.02422401" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "145" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "120"
Evaluating: 145-120
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.409496791"
Evaluating: 112.065471*(0.409496791-0.5)
 Parameter: XPOS <- "-10.1422847"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.193666338"
Evaluating: 112.065471*(0.193666338-0.5)
 Parameter: YPOS <- "-34.3294261"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.522022102"
Evaluating: 142.885239*(0.522022102-0.5)+2.93414115
 Parameter: ZPOS <- "6.08077446"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.08077446" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.08077446" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "145" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "120"
Evaluating: 145-120
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "6.727574906E-02"
Evaluating: 112.065471*(6.727574906E-02-0.5)
 Parameter: XPOS <- "-48.493447"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.471809975"
Evaluating: 112.065471*(0.471809975-0.5)
 Parameter: YPOS <- "-3.15912843"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.3808689"
Evaluating: 142.885239*(0.3808689-0.5)+2.93414115
 Parameter: ZPOS <- "-14.0879345"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.0879345" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.0879345" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "145" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "120"
Evaluating: 145-120
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.438738792"
Evaluating: 112.065471*(0.438738792-0.5)
 Parameter: XPOS <- "-6.86526613"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.809814913"
Evaluating: 112.065471*(0.809814913-0.5)
 Parameter: YPOS <- "34.7195541"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.632080812"
Evaluating: 142.885239*(0.632080812-0.5)+2.93414115
 Parameter: ZPOS <- "21.8065395"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.8065395" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.8065395" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.015175 XMAX =  -46.015175 XAVE =  -46.015175
    YMIN =  -49.686387 YMAX =  -49.686387 YAVE =  -49.686387
    ZMIN =  -16.177420 ZMAX =  -16.177420 ZAVE =  -16.177420
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.86526613"
 RDCMND substituted energy or value "?XAVE" to "-46.0151752"
Evaluating: -6.86526613--46.0151752
 Parameter: XTRAN <- "39.1499091"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.7195541"
 RDCMND substituted energy or value "?YAVE" to "-49.6863874"
Evaluating: 34.7195541--49.6863874
 Parameter: YTRAN <- "84.4059415"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.8065395"
 RDCMND substituted energy or value "?ZAVE" to "-16.1774201"
Evaluating: 21.8065395--16.1774201
 Parameter: ZTRAN <- "37.9839596"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.1499091"
 Parameter: YTRAN -> "84.4059415"
 Parameter: ZTRAN -> "37.9839596"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    39.149909   84.405941   37.983960
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.354803762"
Evaluating: 0.354803762*360.0
 Parameter: XPHI <- "127.729354"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.901166242"
Evaluating: 0.901166242*360.0
 Parameter: YPHI <- "324.419847"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.498345274"
Evaluating: 0.498345274*360.0
 Parameter: ZPHI <- "179.404299"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.86526613"
 Parameter: YPOS -> "34.7195541"
 Parameter: ZPOS -> "21.8065395"
 Parameter: XPHI -> "127.729354"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.611932    0.790910
    0.000000   -0.790910   -0.611932

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  127.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.86526613"
 Parameter: YPOS -> "34.7195541"
 Parameter: ZPOS -> "21.8065395"
 Parameter: YPHI -> "324.419847"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.813302    0.000000    0.581841
    0.000000    1.000000    0.000000
   -0.581841    0.000000    0.813302

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   35.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.86526613"
 Parameter: YPOS -> "34.7195541"
 Parameter: ZPOS -> "21.8065395"
 Parameter: ZPHI -> "179.404299"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.999946    0.010397    0.000000
   -0.010397   -0.999946    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  179.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.865266 XMAX =   -6.865266 XAVE =   -6.865266
    YMIN =   34.719554 YMAX =   34.719554 YAVE =   34.719554
    ZMIN =   21.806539 ZMAX =   21.806539 ZAVE =   21.806539
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.86526615"
Evaluating: -6.86526615+3.5
 Parameter: XMAX <- "-3.36526615"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.7195541"
Evaluating: 34.7195541+3.5
 Parameter: YMAX <- "38.2195541"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.8065395"
Evaluating: 21.8065395+3.5
 Parameter: ZMAX <- "25.3065395"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.86526615"
Evaluating: -6.86526615-3.5
 Parameter: XMIN <- "-10.3652662"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.7195541"
Evaluating: 34.7195541-3.5
 Parameter: YMIN <- "31.2195541"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.8065395"
Evaluating: 21.8065395-3.5
 Parameter: ZMIN <- "18.3065395"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.36526615"
 Parameter: XMIN -> "-10.3652662"
 Parameter: YMAX -> "38.2195541"
 Parameter: YMIN -> "31.2195541"
 Parameter: ZMAX -> "25.3065395"
 Parameter: ZMIN -> "18.3065395"
 SELRPN>     18 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      5 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     40       N             3.2254
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     40       C12           3.8502
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     40       C13           3.3162
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     40       C14           2.0106
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "6"
Evaluating: 6+1
 Parameter: CNTRAND <- "7"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "7" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "145" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "120"
Evaluating: 145-120
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.545206979"
Evaluating: 112.065471*(0.545206979-0.5)
 Parameter: XPOS <- "5.06614139"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.101184171"
Evaluating: 112.065471*(0.101184171-0.5)
 Parameter: YPOS <- "-44.6934837"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.328475323"
Evaluating: 142.885239*(0.328475323-0.5)+2.93414115
 Parameter: ZPOS <- "-21.5742033"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.5742033" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.865266 XMAX =   -6.865266 XAVE =   -6.865266
    YMIN =   34.719554 YMAX =   34.719554 YAVE =   34.719554
    ZMIN =   21.806539 ZMAX =   21.806539 ZAVE =   21.806539
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.06614139"
 RDCMND substituted energy or value "?XAVE" to "-6.86526615"
Evaluating: 5.06614139--6.86526615
 Parameter: XTRAN <- "11.9314075"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.6934837"
 RDCMND substituted energy or value "?YAVE" to "34.7195541"
Evaluating: -44.6934837-34.7195541
 Parameter: YTRAN <- "-79.4130378"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.5742033"
 RDCMND substituted energy or value "?ZAVE" to "21.8065395"
Evaluating: -21.5742033-21.8065395
 Parameter: ZTRAN <- "-43.3807428"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.9314075"
 Parameter: YTRAN -> "-79.4130378"
 Parameter: ZTRAN -> "-43.3807428"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    11.931408  -79.413038  -43.380743
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.73332746"
Evaluating: 0.73332746*360.0
 Parameter: XPHI <- "263.997886"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.105801534"
Evaluating: 0.105801534*360.0
 Parameter: YPHI <- "38.0885522"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.223881146E-02"
Evaluating: 5.223881146E-02*360.0
 Parameter: ZPHI <- "18.8059721"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.06614139"
 Parameter: YPOS -> "-44.6934837"
 Parameter: ZPOS -> "-21.5742033"
 Parameter: XPHI -> "263.997886"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.104565   -0.994518
    0.000000    0.994518   -0.104565

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   96.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.06614139"
 Parameter: YPOS -> "-44.6934837"
 Parameter: ZPOS -> "-21.5742033"
 Parameter: YPHI -> "38.0885522"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.787058    0.000000   -0.616879
    0.000000    1.000000    0.000000
    0.616879    0.000000    0.787058

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   38.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.06614139"
 Parameter: YPOS -> "-44.6934837"
 Parameter: ZPOS -> "-21.5742033"
 Parameter: ZPHI -> "18.8059721"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.946616    0.322364    0.000000
   -0.322364    0.946616    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   18.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.066141 XMAX =    5.066141 XAVE =    5.066141
    YMIN =  -44.693484 YMAX =  -44.693484 YAVE =  -44.693484
    ZMIN =  -21.574203 ZMAX =  -21.574203 ZAVE =  -21.574203
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.06614136"
Evaluating: 5.06614136+3.5
 Parameter: XMAX <- "8.56614136"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.6934837"
Evaluating: -44.6934837+3.5
 Parameter: YMAX <- "-41.1934837"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.5742033"
Evaluating: -21.5742033+3.5
 Parameter: ZMAX <- "-18.0742033"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.06614136"
Evaluating: 5.06614136-3.5
 Parameter: XMIN <- "1.56614136"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.6934837"
Evaluating: -44.6934837-3.5
 Parameter: YMIN <- "-48.1934837"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.5742033"
Evaluating: -21.5742033-3.5
 Parameter: ZMIN <- "-25.0742033"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.56614136"
 Parameter: XMIN -> "1.56614136"
 Parameter: YMAX -> "-41.1934837"
 Parameter: YMIN -> "-48.1934837"
 Parameter: ZMAX -> "-18.0742033"
 Parameter: ZMIN -> "-25.0742033"
 SELRPN>     15 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     10 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     209      C12           3.9073
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     209      C11           3.2510
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     209      P             2.6729
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     209      O13           2.0487
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     209      O14           3.4379
53202 NEG      CLA      25       CLA     -**** MEMB     POPC     209      O12           2.5964
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "7"
Evaluating: 7+1
 Parameter: CNTRAND <- "8"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "8" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "145" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "120"
Evaluating: 145-120
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.35194937"
Evaluating: 112.065471*(0.35194937-0.5)
 Parameter: XPOS <- "-16.5913636"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "6.982652793E-02"
Evaluating: 112.065471*(6.982652793E-02-0.5)
 Parameter: YPOS <- "-48.2075928"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.80915235"
Evaluating: 142.885239*(0.80915235-0.5)+2.93414115
 Parameter: ZPOS <- "47.1074486"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.1074486" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.1074486" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.066141 XMAX =    5.066141 XAVE =    5.066141
    YMIN =  -44.693484 YMAX =  -44.693484 YAVE =  -44.693484
    ZMIN =  -21.574203 ZMAX =  -21.574203 ZAVE =  -21.574203
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.5913636"
 RDCMND substituted energy or value "?XAVE" to "5.06614136"
Evaluating: -16.5913636-5.06614136
 Parameter: XTRAN <- "-21.657505"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.2075928"
 RDCMND substituted energy or value "?YAVE" to "-44.6934837"
Evaluating: -48.2075928--44.6934837
 Parameter: YTRAN <- "-3.5141091"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.1074486"
 RDCMND substituted energy or value "?ZAVE" to "-21.5742033"
Evaluating: 47.1074486--21.5742033
 Parameter: ZTRAN <- "68.6816519"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.657505"
 Parameter: YTRAN -> "-3.5141091"
 Parameter: ZTRAN -> "68.6816519"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -21.657505   -3.514109   68.681652
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.127621391E-02"
Evaluating: 4.127621391E-02*360.0
 Parameter: XPHI <- "14.859437"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.596118226"
Evaluating: 0.596118226*360.0
 Parameter: YPHI <- "214.602561"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.447454628"
Evaluating: 0.447454628*360.0
 Parameter: ZPHI <- "161.083666"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.5913636"
 Parameter: YPOS -> "-48.2075928"
 Parameter: ZPOS -> "47.1074486"
 Parameter: XPHI -> "14.859437"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.966558    0.256449
    0.000000   -0.256449    0.966558

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   14.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.5913636"
 Parameter: YPOS -> "-48.2075928"
 Parameter: ZPOS -> "47.1074486"
 Parameter: YPHI -> "214.602561"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.823111    0.000000    0.567881
    0.000000    1.000000    0.000000
   -0.567881    0.000000   -0.823111

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  145.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.5913636"
 Parameter: YPOS -> "-48.2075928"
 Parameter: ZPOS -> "47.1074486"
 Parameter: ZPHI -> "161.083666"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.945993    0.324187    0.000000
   -0.324187   -0.945993    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  161.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.591364 XMAX =  -16.591364 XAVE =  -16.591364
    YMIN =  -48.207593 YMAX =  -48.207593 YAVE =  -48.207593
    ZMIN =   47.107449 ZMAX =   47.107449 ZAVE =   47.107449
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.5913636"
Evaluating: -16.5913636+3.5
 Parameter: XMAX <- "-13.0913636"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.2075928"
Evaluating: -48.2075928+3.5
 Parameter: YMAX <- "-44.7075928"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.1074486"
Evaluating: 47.1074486+3.5
 Parameter: ZMAX <- "50.6074486"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.5913636"
Evaluating: -16.5913636-3.5
 Parameter: XMIN <- "-20.0913636"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.2075928"
Evaluating: -48.2075928-3.5
 Parameter: YMIN <- "-51.7075928"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.1074486"
Evaluating: 47.1074486-3.5
 Parameter: ZMIN <- "43.6074486"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.0913636"
 Parameter: XMIN -> "-20.0913636"
 Parameter: YMAX -> "-44.7075928"
 Parameter: YMIN -> "-51.7075928"
 Parameter: ZMAX -> "50.6074486"
 Parameter: ZMIN -> "43.6074486"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "146"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "146" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "146" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "120"
Evaluating: 146-120
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.483197931"
Evaluating: 112.065471*(0.483197931-0.5)
 Parameter: XPOS <- "-1.88293178"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.233778223"
Evaluating: 112.065471*(0.233778223-0.5)
 Parameter: YPOS <- "-29.8342688"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.925956363"
Evaluating: 142.885239*(0.925956363-0.5)+2.93414115
 Parameter: ZPOS <- "63.7970179"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.7970179" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.7970179" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.88293178"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -1.88293178-0
 Parameter: XTRAN <- "-1.88293178"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.8342688"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.8342688-0
 Parameter: YTRAN <- "-29.8342688"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.7970179"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 63.7970179-0
 Parameter: ZTRAN <- "63.7970179"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.88293178"
 Parameter: YTRAN -> "-29.8342688"
 Parameter: ZTRAN -> "63.7970179"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -1.882932  -29.834269   63.797018
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.12988359"
Evaluating: 0.12988359*360.0
 Parameter: XPHI <- "46.7580924"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.975898323"
Evaluating: 0.975898323*360.0
 Parameter: YPHI <- "351.323396"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.298101426"
Evaluating: 0.298101426*360.0
 Parameter: ZPHI <- "107.316513"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.88293178"
 Parameter: YPOS -> "-29.8342688"
 Parameter: ZPOS -> "63.7970179"
 Parameter: XPHI -> "46.7580924"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.685080    0.728468
    0.000000   -0.728468    0.685080

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   46.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.88293178"
 Parameter: YPOS -> "-29.8342688"
 Parameter: ZPOS -> "63.7970179"
 Parameter: YPHI -> "351.323396"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.988556    0.000000    0.150857
    0.000000    1.000000    0.000000
   -0.150857    0.000000    0.988556

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    8.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.88293178"
 Parameter: YPOS -> "-29.8342688"
 Parameter: ZPOS -> "63.7970179"
 Parameter: ZPHI -> "107.316513"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.297650    0.954675    0.000000
   -0.954675   -0.297650    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  107.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.882932 XMAX =   -1.882932 XAVE =   -1.882932
    YMIN =  -29.834269 YMAX =  -29.834269 YAVE =  -29.834269
    ZMIN =   63.797018 ZMAX =   63.797018 ZAVE =   63.797018
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.88293178"
Evaluating: -1.88293178+3.5
 Parameter: XMAX <- "1.61706822"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.8342688"
Evaluating: -29.8342688+3.5
 Parameter: YMAX <- "-26.3342688"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.7970179"
Evaluating: 63.7970179+3.5
 Parameter: ZMAX <- "67.2970179"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.88293178"
Evaluating: -1.88293178-3.5
 Parameter: XMIN <- "-5.38293178"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.8342688"
Evaluating: -29.8342688-3.5
 Parameter: YMIN <- "-33.3342688"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.7970179"
Evaluating: 63.7970179-3.5
 Parameter: ZMIN <- "60.2970179"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.61706822"
 Parameter: XMIN -> "-5.38293178"
 Parameter: YMAX -> "-26.3342688"
 Parameter: YMIN -> "-33.3342688"
 Parameter: ZMAX -> "67.2970179"
 Parameter: ZMIN -> "60.2970179"
 SELRPN>      2 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      2 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53203 NEG      CLA      26       CLA     -**** POS      POT      1        POT           3.2320
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "146" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "120"
Evaluating: 146-120
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.91624145"
Evaluating: 112.065471*(0.91624145-0.5)
 Parameter: XPOS <- "46.6462941"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.647981473"
Evaluating: 112.065471*(0.647981473-0.5)
 Parameter: YPOS <- "16.5836135"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.611179115"
Evaluating: 142.885239*(0.611179115-0.5)+2.93414115
 Parameter: ZPOS <- "18.8199956"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.8199956" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.8199956" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.882932 XMAX =   -1.882932 XAVE =   -1.882932
    YMIN =  -29.834269 YMAX =  -29.834269 YAVE =  -29.834269
    ZMIN =   63.797018 ZMAX =   63.797018 ZAVE =   63.797018
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.6462941"
 RDCMND substituted energy or value "?XAVE" to "-1.88293178"
Evaluating: 46.6462941--1.88293178
 Parameter: XTRAN <- "48.5292259"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.5836135"
 RDCMND substituted energy or value "?YAVE" to "-29.8342688"
Evaluating: 16.5836135--29.8342688
 Parameter: YTRAN <- "46.4178823"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.8199956"
 RDCMND substituted energy or value "?ZAVE" to "63.7970179"
Evaluating: 18.8199956-63.7970179
 Parameter: ZTRAN <- "-44.9770223"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "48.5292259"
 Parameter: YTRAN -> "46.4178823"
 Parameter: ZTRAN -> "-44.9770223"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    48.529226   46.417882  -44.977022
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.841346192"
Evaluating: 0.841346192*360.0
 Parameter: XPHI <- "302.884629"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487182181"
Evaluating: 0.487182181*360.0
 Parameter: YPHI <- "175.385585"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.790716602"
Evaluating: 0.790716602*360.0
 Parameter: ZPHI <- "284.657977"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.6462941"
 Parameter: YPOS -> "16.5836135"
 Parameter: ZPOS -> "18.8199956"
 Parameter: XPHI -> "302.884629"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.542949   -0.839766
    0.000000    0.839766    0.542949

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   57.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.6462941"
 Parameter: YPOS -> "16.5836135"
 Parameter: ZPOS -> "18.8199956"
 Parameter: YPHI -> "175.385585"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.996759    0.000000   -0.080450
    0.000000    1.000000    0.000000
    0.080450    0.000000   -0.996759

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  175.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.6462941"
 Parameter: YPOS -> "16.5836135"
 Parameter: ZPOS -> "18.8199956"
 Parameter: ZPHI -> "284.657977"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.253048   -0.967454    0.000000
    0.967454    0.253048    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   75.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.646294 XMAX =   46.646294 XAVE =   46.646294
    YMIN =   16.583613 YMAX =   16.583613 YAVE =   16.583613
    ZMIN =   18.819996 ZMAX =   18.819996 ZAVE =   18.819996
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.6462941"
Evaluating: 46.6462941+3.5
 Parameter: XMAX <- "50.1462941"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.5836135"
Evaluating: 16.5836135+3.5
 Parameter: YMAX <- "20.0836135"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.8199956"
Evaluating: 18.8199956+3.5
 Parameter: ZMAX <- "22.3199956"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.6462941"
Evaluating: 46.6462941-3.5
 Parameter: XMIN <- "43.1462941"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.5836135"
Evaluating: 16.5836135-3.5
 Parameter: YMIN <- "13.0836135"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.8199956"
Evaluating: 18.8199956-3.5
 Parameter: ZMIN <- "15.3199956"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.1462941"
 Parameter: XMIN -> "43.1462941"
 Parameter: YMAX -> "20.0836135"
 Parameter: YMIN -> "13.0836135"
 Parameter: ZMAX -> "22.3199956"
 Parameter: ZMIN -> "15.3199956"
 SELRPN>     18 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      8 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53203 NEG      CLA      26       CLA     -**** MEMB     POPC     113      C11           3.1410
53203 NEG      CLA      26       CLA     -**** MEMB     POPC     113      P             2.6130
53203 NEG      CLA      26       CLA     -**** MEMB     POPC     113      O13           2.1899
53203 NEG      CLA      26       CLA     -**** MEMB     POPC     113      O14           3.6364
53203 NEG      CLA      26       CLA     -**** MEMB     POPC     113      O12           2.0662
53203 NEG      CLA      26       CLA     -**** MEMB     POPC     113      O11           3.8360
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "146" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "120"
Evaluating: 146-120
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.412478858"
Evaluating: 112.065471*(0.412478858-0.5)
 Parameter: XPOS <- "-9.808098"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.396468494"
Evaluating: 112.065471*(0.396468494-0.5)
 Parameter: YPOS <- "-11.602307"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.948426745"
Evaluating: 142.885239*(0.948426745-0.5)+2.93414115
 Parameter: ZPOS <- "67.0077038"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "67.0077038" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "67.0077038" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.646294 XMAX =   46.646294 XAVE =   46.646294
    YMIN =   16.583613 YMAX =   16.583613 YAVE =   16.583613
    ZMIN =   18.819996 ZMAX =   18.819996 ZAVE =   18.819996
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.808098"
 RDCMND substituted energy or value "?XAVE" to "46.6462941"
Evaluating: -9.808098-46.6462941
 Parameter: XTRAN <- "-56.4543921"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.602307"
 RDCMND substituted energy or value "?YAVE" to "16.5836135"
Evaluating: -11.602307-16.5836135
 Parameter: YTRAN <- "-28.1859205"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "67.0077038"
 RDCMND substituted energy or value "?ZAVE" to "18.8199956"
Evaluating: 67.0077038-18.8199956
 Parameter: ZTRAN <- "48.1877082"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-56.4543921"
 Parameter: YTRAN -> "-28.1859205"
 Parameter: ZTRAN -> "48.1877082"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -56.454392  -28.185921   48.187708
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.513953081"
Evaluating: 0.513953081*360.0
 Parameter: XPHI <- "185.023109"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.860006597"
Evaluating: 0.860006597*360.0
 Parameter: YPHI <- "309.602375"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.306708066"
Evaluating: 0.306708066*360.0
 Parameter: ZPHI <- "110.414904"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.808098"
 Parameter: YPOS -> "-11.602307"
 Parameter: ZPOS -> "67.0077038"
 Parameter: XPHI -> "185.023109"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996159   -0.087558
    0.000000    0.087558   -0.996159

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  174.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.808098"
 Parameter: YPOS -> "-11.602307"
 Parameter: ZPOS -> "67.0077038"
 Parameter: YPHI -> "309.602375"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.637456    0.000000    0.770487
    0.000000    1.000000    0.000000
   -0.770487    0.000000    0.637456

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   50.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.808098"
 Parameter: YPOS -> "-11.602307"
 Parameter: ZPOS -> "67.0077038"
 Parameter: ZPHI -> "110.414904"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.348816    0.937191    0.000000
   -0.937191   -0.348816    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  110.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.808098 XMAX =   -9.808098 XAVE =   -9.808098
    YMIN =  -11.602307 YMAX =  -11.602307 YAVE =  -11.602307
    ZMIN =   67.007704 ZMAX =   67.007704 ZAVE =   67.007704
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.80809798"
Evaluating: -9.80809798+3.5
 Parameter: XMAX <- "-6.30809798"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.602307"
Evaluating: -11.602307+3.5
 Parameter: YMAX <- "-8.102307"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "67.0077038"
Evaluating: 67.0077038+3.5
 Parameter: ZMAX <- "70.5077038"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.80809798"
Evaluating: -9.80809798-3.5
 Parameter: XMIN <- "-13.308098"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.602307"
Evaluating: -11.602307-3.5
 Parameter: YMIN <- "-15.102307"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "67.0077038"
Evaluating: 67.0077038-3.5
 Parameter: ZMIN <- "63.5077038"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.30809798"
 Parameter: XMIN -> "-13.308098"
 Parameter: YMAX -> "-8.102307"
 Parameter: YMIN -> "-15.102307"
 Parameter: ZMAX -> "70.5077038"
 Parameter: ZMIN -> "63.5077038"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "147"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "147" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "147" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "120"
Evaluating: 147-120
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.842008685"
Evaluating: 112.065471*(0.842008685-0.5)
 Parameter: XPOS <- "38.3273644"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.849949293"
Evaluating: 112.065471*(0.849949293-0.5)
 Parameter: YPOS <- "39.2172323"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.217310209"
Evaluating: 142.885239*(0.217310209-0.5)+2.93414115
 Parameter: ZPOS <- "-37.4580572"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.4580572" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.3273644"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.3273644-0
 Parameter: XTRAN <- "38.3273644"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.2172323"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 39.2172323-0
 Parameter: YTRAN <- "39.2172323"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.4580572"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.4580572-0
 Parameter: ZTRAN <- "-37.4580572"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.3273644"
 Parameter: YTRAN -> "39.2172323"
 Parameter: ZTRAN -> "-37.4580572"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    38.327364   39.217232  -37.458057
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.828227266"
Evaluating: 0.828227266*360.0
 Parameter: XPHI <- "298.161816"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.687272704"
Evaluating: 0.687272704*360.0
 Parameter: YPHI <- "247.418173"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.586954953"
Evaluating: 0.586954953*360.0
 Parameter: ZPHI <- "211.303783"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.3273644"
 Parameter: YPOS -> "39.2172323"
 Parameter: ZPOS -> "-37.4580572"
 Parameter: XPHI -> "298.161816"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.471963   -0.881618
    0.000000    0.881618    0.471963

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   61.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.3273644"
 Parameter: YPOS -> "39.2172323"
 Parameter: ZPOS -> "-37.4580572"
 Parameter: YPHI -> "247.418173"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.384002    0.000000    0.923332
    0.000000    1.000000    0.000000
   -0.923332    0.000000   -0.384002

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  112.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.3273644"
 Parameter: YPOS -> "39.2172323"
 Parameter: ZPOS -> "-37.4580572"
 Parameter: ZPHI -> "211.303783"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.854425   -0.519576    0.000000
    0.519576   -0.854425    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  148.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.327364 XMAX =   38.327364 XAVE =   38.327364
    YMIN =   39.217232 YMAX =   39.217232 YAVE =   39.217232
    ZMIN =  -37.458057 ZMAX =  -37.458057 ZAVE =  -37.458057
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.3273644"
Evaluating: 38.3273644+3.5
 Parameter: XMAX <- "41.8273644"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.2172323"
Evaluating: 39.2172323+3.5
 Parameter: YMAX <- "42.7172323"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.4580572"
Evaluating: -37.4580572+3.5
 Parameter: ZMAX <- "-33.9580572"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.3273644"
Evaluating: 38.3273644-3.5
 Parameter: XMIN <- "34.8273644"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.2172323"
Evaluating: 39.2172323-3.5
 Parameter: YMIN <- "35.7172323"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.4580572"
Evaluating: -37.4580572-3.5
 Parameter: ZMIN <- "-40.9580572"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.8273644"
 Parameter: XMIN -> "34.8273644"
 Parameter: YMAX -> "42.7172323"
 Parameter: YMIN -> "35.7172323"
 Parameter: ZMAX -> "-33.9580572"
 Parameter: ZMIN -> "-40.9580572"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "148"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "148" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "148"
Evaluating: 148
 Parameter: J <- "148"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "148" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "148"
 Parameter: NPOS -> "120"
Evaluating: 148-120
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.981838834"
Evaluating: 112.065471*(0.981838834-0.5)
 Parameter: XPOS <- "53.9974959"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.965831051"
Evaluating: 112.065471*(0.965831051-0.5)
 Parameter: YPOS <- "52.2035761"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.793497998"
Evaluating: 142.885239*(0.793497998-0.5)+2.93414115
 Parameter: ZPOS <- "44.8706727"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.8706727" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.8706727" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.9974959"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.9974959-0
 Parameter: XTRAN <- "53.9974959"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "52.2035761"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 52.2035761-0
 Parameter: YTRAN <- "52.2035761"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.8706727"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.8706727-0
 Parameter: ZTRAN <- "44.8706727"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.9974959"
 Parameter: YTRAN -> "52.2035761"
 Parameter: ZTRAN -> "44.8706727"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    53.997496   52.203576   44.870673
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.013642824E-03"
Evaluating: 7.013642824E-03*360.0
 Parameter: XPHI <- "2.52491142"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.17512375E-02"
Evaluating: 7.17512375E-02*360.0
 Parameter: YPHI <- "25.8304455"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.756880091E-02"
Evaluating: 1.756880091E-02*360.0
 Parameter: ZPHI <- "6.32476833"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.9974959"
 Parameter: YPOS -> "52.2035761"
 Parameter: ZPOS -> "44.8706727"
 Parameter: XPHI -> "2.52491142"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999029    0.044054
    0.000000   -0.044054    0.999029

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    2.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.9974959"
 Parameter: YPOS -> "52.2035761"
 Parameter: ZPOS -> "44.8706727"
 Parameter: YPHI -> "25.8304455"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.900087    0.000000   -0.435709
    0.000000    1.000000    0.000000
    0.435709    0.000000    0.900087

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   25.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.9974959"
 Parameter: YPOS -> "52.2035761"
 Parameter: ZPOS -> "44.8706727"
 Parameter: ZPHI -> "6.32476833"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.993913    0.110164    0.000000
   -0.110164    0.993913    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.997496 XMAX =   53.997496 XAVE =   53.997496
    YMIN =   52.203576 YMAX =   52.203576 YAVE =   52.203576
    ZMIN =   44.870673 ZMAX =   44.870673 ZAVE =   44.870673
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.9974959"
Evaluating: 53.9974959+3.5
 Parameter: XMAX <- "57.4974959"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "52.2035761"
Evaluating: 52.2035761+3.5
 Parameter: YMAX <- "55.7035761"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.8706727"
Evaluating: 44.8706727+3.5
 Parameter: ZMAX <- "48.3706727"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.9974959"
Evaluating: 53.9974959-3.5
 Parameter: XMIN <- "50.4974959"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "52.2035761"
Evaluating: 52.2035761-3.5
 Parameter: YMIN <- "48.7035761"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.8706727"
Evaluating: 44.8706727-3.5
 Parameter: ZMIN <- "41.3706727"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.4974959"
 Parameter: XMIN -> "50.4974959"
 Parameter: YMAX -> "55.7035761"
 Parameter: YMIN -> "48.7035761"
 Parameter: ZMAX -> "48.3706727"
 Parameter: ZMIN -> "41.3706727"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "149"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "149" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "149"
Evaluating: 149
 Parameter: J <- "149"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "149" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "149"
 Parameter: NPOS -> "120"
Evaluating: 149-120
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.513206712"
Evaluating: 112.065471*(0.513206712-0.5)
 Parameter: XPOS <- "1.4800164"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.176163465"
Evaluating: 112.065471*(0.176163465-0.5)
 Parameter: YPOS <- "-36.2908938"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.361585571"
Evaluating: 142.885239*(0.361585571-0.5)+2.93414115
 Parameter: ZPOS <- "-16.8432376"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.8432376" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.4800164"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.4800164-0
 Parameter: XTRAN <- "1.4800164"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.2908938"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -36.2908938-0
 Parameter: YTRAN <- "-36.2908938"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.8432376"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.8432376-0
 Parameter: ZTRAN <- "-16.8432376"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.4800164"
 Parameter: YTRAN -> "-36.2908938"
 Parameter: ZTRAN -> "-16.8432376"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     1.480016  -36.290894  -16.843238
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.156412667"
Evaluating: 0.156412667*360.0
 Parameter: XPHI <- "56.3085601"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.806124922"
Evaluating: 0.806124922*360.0
 Parameter: YPHI <- "290.204972"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.889673206"
Evaluating: 0.889673206*360.0
 Parameter: ZPHI <- "320.282354"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.4800164"
 Parameter: YPOS -> "-36.2908938"
 Parameter: ZPOS -> "-16.8432376"
 Parameter: XPHI -> "56.3085601"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.554720    0.832037
    0.000000   -0.832037    0.554720

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   56.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.4800164"
 Parameter: YPOS -> "-36.2908938"
 Parameter: ZPOS -> "-16.8432376"
 Parameter: YPHI -> "290.204972"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.345380    0.000000    0.938463
    0.000000    1.000000    0.000000
   -0.938463    0.000000    0.345380

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   69.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.4800164"
 Parameter: YPOS -> "-36.2908938"
 Parameter: ZPOS -> "-16.8432376"
 Parameter: ZPHI -> "320.282354"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.769203   -0.639005    0.000000
    0.639005    0.769203    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   39.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.480016 XMAX =    1.480016 XAVE =    1.480016
    YMIN =  -36.290894 YMAX =  -36.290894 YAVE =  -36.290894
    ZMIN =  -16.843238 ZMAX =  -16.843238 ZAVE =  -16.843238
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.4800164"
Evaluating: 1.4800164+3.5
 Parameter: XMAX <- "4.9800164"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.2908938"
Evaluating: -36.2908938+3.5
 Parameter: YMAX <- "-32.7908938"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.8432376"
Evaluating: -16.8432376+3.5
 Parameter: ZMAX <- "-13.3432376"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.4800164"
Evaluating: 1.4800164-3.5
 Parameter: XMIN <- "-2.0199836"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.2908938"
Evaluating: -36.2908938-3.5
 Parameter: YMIN <- "-39.7908938"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.8432376"
Evaluating: -16.8432376-3.5
 Parameter: ZMIN <- "-20.3432376"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.9800164"
 Parameter: XMIN -> "-2.0199836"
 Parameter: YMAX -> "-32.7908938"
 Parameter: YMIN -> "-39.7908938"
 Parameter: ZMAX -> "-13.3432376"
 Parameter: ZMIN -> "-20.3432376"
 SELRPN>     19 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      9 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53206 NEG      CLA      29       CLA     -**** MEMB     POPC     174      C1            3.1224
53206 NEG      CLA      29       CLA     -**** MEMB     POPC     174      C2            3.4385
53206 NEG      CLA      29       CLA     -**** MEMB     POPC     174      O22           3.5715
53206 NEG      CLA      29       CLA     -**** MEMB     POPC     186      O13           2.4409
53206 NEG      CLA      29       CLA     -**** MEMB     POPC     197      C15           3.4044
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "149"
Evaluating: 149
 Parameter: J <- "149"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "149" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "149"
 Parameter: NPOS -> "120"
Evaluating: 149-120
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.102148575"
Evaluating: 112.065471*(0.102148575-0.5)
 Parameter: XPOS <- "-44.5854073"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.91738774"
Evaluating: 112.065471*(0.91738774-0.5)
 Parameter: YPOS <- "46.7747537"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.179544463"
Evaluating: 142.885239*(0.179544463-0.5)+2.93414115
 Parameter: ZPOS <- "-42.8542248"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.8542248" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.480016 XMAX =    1.480016 XAVE =    1.480016
    YMIN =  -36.290894 YMAX =  -36.290894 YAVE =  -36.290894
    ZMIN =  -16.843238 ZMAX =  -16.843238 ZAVE =  -16.843238
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.5854073"
 RDCMND substituted energy or value "?XAVE" to "1.4800164"
Evaluating: -44.5854073-1.4800164
 Parameter: XTRAN <- "-46.0654237"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.7747537"
 RDCMND substituted energy or value "?YAVE" to "-36.2908938"
Evaluating: 46.7747537--36.2908938
 Parameter: YTRAN <- "83.0656475"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.8542248"
 RDCMND substituted energy or value "?ZAVE" to "-16.8432376"
Evaluating: -42.8542248--16.8432376
 Parameter: ZTRAN <- "-26.0109872"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.0654237"
 Parameter: YTRAN -> "83.0656475"
 Parameter: ZTRAN -> "-26.0109872"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -46.065424   83.065647  -26.010987
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313597714"
Evaluating: 0.313597714*360.0
 Parameter: XPHI <- "112.895177"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.686635224"
Evaluating: 0.686635224*360.0
 Parameter: YPHI <- "247.188681"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.940898727"
Evaluating: 0.940898727*360.0
 Parameter: ZPHI <- "338.723542"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.5854073"
 Parameter: YPOS -> "46.7747537"
 Parameter: ZPOS -> "-42.8542248"
 Parameter: XPHI -> "112.895177"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.389046    0.921218
    0.000000   -0.921218   -0.389046

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.5854073"
 Parameter: YPOS -> "46.7747537"
 Parameter: ZPOS -> "-42.8542248"
 Parameter: YPHI -> "247.188681"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.387698    0.000000    0.921787
    0.000000    1.000000    0.000000
   -0.921787    0.000000   -0.387698

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  112.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.5854073"
 Parameter: YPOS -> "46.7747537"
 Parameter: ZPOS -> "-42.8542248"
 Parameter: ZPHI -> "338.723542"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.931840   -0.362868    0.000000
    0.362868    0.931840    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   21.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.585407 XMAX =  -44.585407 XAVE =  -44.585407
    YMIN =   46.774754 YMAX =   46.774754 YAVE =   46.774754
    ZMIN =  -42.854225 ZMAX =  -42.854225 ZAVE =  -42.854225
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.5854073"
Evaluating: -44.5854073+3.5
 Parameter: XMAX <- "-41.0854073"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.7747537"
Evaluating: 46.7747537+3.5
 Parameter: YMAX <- "50.2747537"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.8542248"
Evaluating: -42.8542248+3.5
 Parameter: ZMAX <- "-39.3542248"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.5854073"
Evaluating: -44.5854073-3.5
 Parameter: XMIN <- "-48.0854073"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.7747537"
Evaluating: 46.7747537-3.5
 Parameter: YMIN <- "43.2747537"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.8542248"
Evaluating: -42.8542248-3.5
 Parameter: ZMIN <- "-46.3542248"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.0854073"
 Parameter: XMIN -> "-48.0854073"
 Parameter: YMAX -> "50.2747537"
 Parameter: YMIN -> "43.2747537"
 Parameter: ZMAX -> "-39.3542248"
 Parameter: ZMIN -> "-46.3542248"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "150"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "150" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "150"
Evaluating: 150
 Parameter: J <- "150"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "150" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "150"
 Parameter: NPOS -> "120"
Evaluating: 150-120
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.105044405"
Evaluating: 112.065471*(0.105044405-0.5)
 Parameter: XPOS <- "-44.2608848"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.147540041"
Evaluating: 112.065471*(0.147540041-0.5)
 Parameter: YPOS <- "-39.4985913"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.141410873"
Evaluating: 142.885239*(0.141410873-0.5)+2.93414115
 Parameter: ZPOS <- "-48.302952"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.302952" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.2608848"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.2608848-0
 Parameter: XTRAN <- "-44.2608848"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.4985913"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.4985913-0
 Parameter: YTRAN <- "-39.4985913"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.302952"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.302952-0
 Parameter: ZTRAN <- "-48.302952"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.2608848"
 Parameter: YTRAN -> "-39.4985913"
 Parameter: ZTRAN -> "-48.302952"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -44.260885  -39.498591  -48.302952
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.515704029"
Evaluating: 0.515704029*360.0
 Parameter: XPHI <- "185.65345"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.824992245"
Evaluating: 0.824992245*360.0
 Parameter: YPHI <- "296.997208"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.773492842E-02"
Evaluating: 4.773492842E-02*360.0
 Parameter: ZPHI <- "17.1845742"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.2608848"
 Parameter: YPOS -> "-39.4985913"
 Parameter: ZPOS -> "-48.302952"
 Parameter: XPHI -> "185.65345"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.995136   -0.098511
    0.000000    0.098511   -0.995136

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  174.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.2608848"
 Parameter: YPOS -> "-39.4985913"
 Parameter: ZPOS -> "-48.302952"
 Parameter: YPHI -> "296.997208"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.453947    0.000000    0.891029
    0.000000    1.000000    0.000000
   -0.891029    0.000000    0.453947

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   63.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.2608848"
 Parameter: YPOS -> "-39.4985913"
 Parameter: ZPOS -> "-48.302952"
 Parameter: ZPHI -> "17.1845742"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.955358    0.295451    0.000000
   -0.295451    0.955358    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.260885 XMAX =  -44.260885 XAVE =  -44.260885
    YMIN =  -39.498591 YMAX =  -39.498591 YAVE =  -39.498591
    ZMIN =  -48.302952 ZMAX =  -48.302952 ZAVE =  -48.302952
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.2608848"
Evaluating: -44.2608848+3.5
 Parameter: XMAX <- "-40.7608848"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.4985913"
Evaluating: -39.4985913+3.5
 Parameter: YMAX <- "-35.9985913"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.302952"
Evaluating: -48.302952+3.5
 Parameter: ZMAX <- "-44.802952"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.2608848"
Evaluating: -44.2608848-3.5
 Parameter: XMIN <- "-47.7608848"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.4985913"
Evaluating: -39.4985913-3.5
 Parameter: YMIN <- "-42.9985913"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.302952"
Evaluating: -48.302952-3.5
 Parameter: ZMIN <- "-51.802952"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.7608848"
 Parameter: XMIN -> "-47.7608848"
 Parameter: YMAX -> "-35.9985913"
 Parameter: YMIN -> "-42.9985913"
 Parameter: ZMAX -> "-44.802952"
 Parameter: ZMIN -> "-51.802952"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "151"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "151" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "151"
Evaluating: 151
 Parameter: J <- "151"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "151" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "151"
 Parameter: NPOS -> "120"
Evaluating: 151-120
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.14303824"
Evaluating: 112.065471*(0.14303824-0.5)
 Parameter: XPOS <- "-40.0030878"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.994013504"
Evaluating: 112.065471*(0.994013504-0.5)
 Parameter: YPOS <- "55.361856"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.28539489"
Evaluating: 142.885239*(0.28539489-0.5)+2.93414115
 Parameter: ZPOS <- "-27.7297613"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.7297613" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.0030878"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -40.0030878-0
 Parameter: XTRAN <- "-40.0030878"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "55.361856"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 55.361856-0
 Parameter: YTRAN <- "55.361856"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.7297613"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.7297613-0
 Parameter: ZTRAN <- "-27.7297613"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.0030878"
 Parameter: YTRAN -> "55.361856"
 Parameter: ZTRAN -> "-27.7297613"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -40.003088   55.361856  -27.729761
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.183536111"
Evaluating: 0.183536111*360.0
 Parameter: XPHI <- "66.073"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499418806"
Evaluating: 0.499418806*360.0
 Parameter: YPHI <- "179.79077"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919027188"
Evaluating: 0.919027188*360.0
 Parameter: ZPHI <- "330.849788"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.0030878"
 Parameter: YPOS -> "55.361856"
 Parameter: ZPOS -> "-27.7297613"
 Parameter: XPHI -> "66.073"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.405572    0.914063
    0.000000   -0.914063    0.405572

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   66.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.0030878"
 Parameter: YPOS -> "55.361856"
 Parameter: ZPOS -> "-27.7297613"
 Parameter: YPHI -> "179.79077"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.999993    0.000000   -0.003652
    0.000000    1.000000    0.000000
    0.003652    0.000000   -0.999993

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  179.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.0030878"
 Parameter: YPOS -> "55.361856"
 Parameter: ZPOS -> "-27.7297613"
 Parameter: ZPHI -> "330.849788"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.873346   -0.487101    0.000000
    0.487101    0.873346    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.003088 XMAX =  -40.003088 XAVE =  -40.003088
    YMIN =   55.361856 YMAX =   55.361856 YAVE =   55.361856
    ZMIN =  -27.729761 ZMAX =  -27.729761 ZAVE =  -27.729761
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.0030878"
Evaluating: -40.0030878+3.5
 Parameter: XMAX <- "-36.5030878"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "55.361856"
Evaluating: 55.361856+3.5
 Parameter: YMAX <- "58.861856"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.7297613"
Evaluating: -27.7297613+3.5
 Parameter: ZMAX <- "-24.2297613"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.0030878"
Evaluating: -40.0030878-3.5
 Parameter: XMIN <- "-43.5030878"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "55.361856"
Evaluating: 55.361856-3.5
 Parameter: YMIN <- "51.861856"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.7297613"
Evaluating: -27.7297613-3.5
 Parameter: ZMIN <- "-31.2297613"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.5030878"
 Parameter: XMIN -> "-43.5030878"
 Parameter: YMAX -> "58.861856"
 Parameter: YMIN -> "51.861856"
 Parameter: ZMAX -> "-24.2297613"
 Parameter: ZMIN -> "-31.2297613"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "152"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "152" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "152"
Evaluating: 152
 Parameter: J <- "152"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "152" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "152"
 Parameter: NPOS -> "120"
Evaluating: 152-120
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.662654809"
Evaluating: 112.065471*(0.662654809-0.5)
 Parameter: XPOS <- "18.2279878"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "2.355081092E-02"
Evaluating: 112.065471*(2.355081092E-02-0.5)
 Parameter: YPOS <- "-53.3935028"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.305744975"
Evaluating: 142.885239*(0.305744975-0.5)+2.93414115
 Parameter: ZPOS <- "-24.8220345"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.8220345" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.2279878"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.2279878-0
 Parameter: XTRAN <- "18.2279878"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-53.3935028"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -53.3935028-0
 Parameter: YTRAN <- "-53.3935028"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.8220345"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.8220345-0
 Parameter: ZTRAN <- "-24.8220345"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.2279878"
 Parameter: YTRAN -> "-53.3935028"
 Parameter: ZTRAN -> "-24.8220345"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    18.227988  -53.393503  -24.822035
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.946466597"
Evaluating: 0.946466597*360.0
 Parameter: XPHI <- "340.727975"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382374039"
Evaluating: 0.382374039*360.0
 Parameter: YPHI <- "137.654654"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179517604"
Evaluating: 0.179517604*360.0
 Parameter: ZPHI <- "64.6263374"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.2279878"
 Parameter: YPOS -> "-53.3935028"
 Parameter: ZPOS -> "-24.8220345"
 Parameter: XPHI -> "340.727975"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.943962   -0.330054
    0.000000    0.330054    0.943962

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   19.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.2279878"
 Parameter: YPOS -> "-53.3935028"
 Parameter: ZPOS -> "-24.8220345"
 Parameter: YPHI -> "137.654654"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.739098    0.000000   -0.673598
    0.000000    1.000000    0.000000
    0.673598    0.000000   -0.739098

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  137.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.2279878"
 Parameter: YPOS -> "-53.3935028"
 Parameter: ZPOS -> "-24.8220345"
 Parameter: ZPHI -> "64.6263374"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.428520    0.903532    0.000000
   -0.903532    0.428520    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   64.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.227988 XMAX =   18.227988 XAVE =   18.227988
    YMIN =  -53.393503 YMAX =  -53.393503 YAVE =  -53.393503
    ZMIN =  -24.822035 ZMAX =  -24.822035 ZAVE =  -24.822035
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.2279878"
Evaluating: 18.2279878+3.5
 Parameter: XMAX <- "21.7279878"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-53.3935028"
Evaluating: -53.3935028+3.5
 Parameter: YMAX <- "-49.8935028"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.8220345"
Evaluating: -24.8220345+3.5
 Parameter: ZMAX <- "-21.3220345"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.2279878"
Evaluating: 18.2279878-3.5
 Parameter: XMIN <- "14.7279878"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-53.3935028"
Evaluating: -53.3935028-3.5
 Parameter: YMIN <- "-56.8935028"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.8220345"
Evaluating: -24.8220345-3.5
 Parameter: ZMIN <- "-28.3220345"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.7279878"
 Parameter: XMIN -> "14.7279878"
 Parameter: YMAX -> "-49.8935028"
 Parameter: YMIN -> "-56.8935028"
 Parameter: ZMAX -> "-21.3220345"
 Parameter: ZMIN -> "-28.3220345"
 SELRPN>      2 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "153"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "153" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "153" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "120"
Evaluating: 153-120
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.311468539"
Evaluating: 112.065471*(0.311468539-0.5)
 Parameter: XPOS <- "-21.127867"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "2.442839224E-02"
Evaluating: 112.065471*(2.442839224E-02-0.5)
 Parameter: YPOS <- "-53.2951562"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.415489128"
Evaluating: 142.885239*(0.415489128-0.5)+2.93414115
 Parameter: ZPOS <- "-9.14121499"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.14121499" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.14121499" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "153" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "120"
Evaluating: 153-120
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "3.687763514E-02"
Evaluating: 112.065471*(3.687763514E-02-0.5)
 Parameter: XPOS <- "-51.9000259"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.470628506"
Evaluating: 112.065471*(0.470628506-0.5)
 Parameter: YPOS <- "-3.29153031"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.829769151"
Evaluating: 142.885239*(0.829769151-0.5)+2.93414115
 Parameter: ZPOS <- "50.0532851"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.0532851" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.0532851" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.9000259"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -51.9000259-0
 Parameter: XTRAN <- "-51.9000259"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.29153031"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.29153031-0
 Parameter: YTRAN <- "-3.29153031"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.0532851"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 50.0532851-0
 Parameter: ZTRAN <- "50.0532851"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.9000259"
 Parameter: YTRAN -> "-3.29153031"
 Parameter: ZTRAN -> "50.0532851"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -51.900026   -3.291530   50.053285
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.431755902"
Evaluating: 0.431755902*360.0
 Parameter: XPHI <- "155.432125"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.103323647"
Evaluating: 0.103323647*360.0
 Parameter: YPHI <- "37.1965129"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.109033537"
Evaluating: 0.109033537*360.0
 Parameter: ZPHI <- "39.2520733"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.9000259"
 Parameter: YPOS -> "-3.29153031"
 Parameter: ZPOS -> "50.0532851"
 Parameter: XPHI -> "155.432125"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.909469    0.415771
    0.000000   -0.415771   -0.909469

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  155.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.9000259"
 Parameter: YPOS -> "-3.29153031"
 Parameter: ZPOS -> "50.0532851"
 Parameter: YPHI -> "37.1965129"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.796567    0.000000   -0.604551
    0.000000    1.000000    0.000000
    0.604551    0.000000    0.796567

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   37.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.9000259"
 Parameter: YPOS -> "-3.29153031"
 Parameter: ZPOS -> "50.0532851"
 Parameter: ZPHI -> "39.2520733"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.774370    0.632733    0.000000
   -0.632733    0.774370    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   39.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.900026 XMAX =  -51.900026 XAVE =  -51.900026
    YMIN =   -3.291530 YMAX =   -3.291530 YAVE =   -3.291530
    ZMIN =   50.053285 ZMAX =   50.053285 ZAVE =   50.053285
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.9000259"
Evaluating: -51.9000259+3.5
 Parameter: XMAX <- "-48.4000259"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.29153031"
Evaluating: -3.29153031+3.5
 Parameter: YMAX <- "0.20846969"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.0532851"
Evaluating: 50.0532851+3.5
 Parameter: ZMAX <- "53.5532851"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.9000259"
Evaluating: -51.9000259-3.5
 Parameter: XMIN <- "-55.4000259"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.29153031"
Evaluating: -3.29153031-3.5
 Parameter: YMIN <- "-6.79153031"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.0532851"
Evaluating: 50.0532851-3.5
 Parameter: ZMIN <- "46.5532851"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-48.4000259"
 Parameter: XMIN -> "-55.4000259"
 Parameter: YMAX -> "0.20846969"
 Parameter: YMIN -> "-6.79153031"
 Parameter: ZMAX -> "53.5532851"
 Parameter: ZMIN -> "46.5532851"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      1 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53210 NEG      CLA      33       CLA     -**** NEG      CLA      20       CLA           3.8299
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "153" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "120"
Evaluating: 153-120
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.814672116"
Evaluating: 112.065471*(0.814672116-0.5)
 Parameter: XPOS <- "35.2638789"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.71682144"
Evaluating: 112.065471*(0.71682144-0.5)
 Parameter: YPOS <- "24.2981968"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.545278986"
Evaluating: 142.885239*(0.545278986-0.5)+2.93414115
 Parameter: ZPOS <- "9.40383989"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.40383989" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.40383989" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "153" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "120"
Evaluating: 153-120
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.259065827"
Evaluating: 112.065471*(0.259065827-0.5)
 Parameter: XPOS <- "-27.0004016"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.373012265"
Evaluating: 112.065471*(0.373012265-0.5)
 Parameter: YPOS <- "-14.2309403"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.28868508"
Evaluating: 142.885239*(0.28868508-0.5)+2.93414115
 Parameter: ZPOS <- "-27.2596417"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.2596417" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.900026 XMAX =  -51.900026 XAVE =  -51.900026
    YMIN =   -3.291530 YMAX =   -3.291530 YAVE =   -3.291530
    ZMIN =   50.053285 ZMAX =   50.053285 ZAVE =   50.053285
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.0004016"
 RDCMND substituted energy or value "?XAVE" to "-51.9000259"
Evaluating: -27.0004016--51.9000259
 Parameter: XTRAN <- "24.8996243"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.2309403"
 RDCMND substituted energy or value "?YAVE" to "-3.29153031"
Evaluating: -14.2309403--3.29153031
 Parameter: YTRAN <- "-10.93941"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.2596417"
 RDCMND substituted energy or value "?ZAVE" to "50.0532851"
Evaluating: -27.2596417-50.0532851
 Parameter: ZTRAN <- "-77.3129268"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.8996243"
 Parameter: YTRAN -> "-10.93941"
 Parameter: ZTRAN -> "-77.3129268"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    24.899624  -10.939410  -77.312927
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.479113032"
Evaluating: 0.479113032*360.0
 Parameter: XPHI <- "172.480692"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.446589762"
Evaluating: 0.446589762*360.0
 Parameter: YPHI <- "160.772314"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.463637254"
Evaluating: 0.463637254*360.0
 Parameter: ZPHI <- "166.909411"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.0004016"
 Parameter: YPOS -> "-14.2309403"
 Parameter: ZPOS -> "-27.2596417"
 Parameter: XPHI -> "172.480692"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.991401    0.130860
    0.000000   -0.130860   -0.991401

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  172.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.0004016"
 Parameter: YPOS -> "-14.2309403"
 Parameter: ZPOS -> "-27.2596417"
 Parameter: YPHI -> "160.772314"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.944217    0.000000   -0.329323
    0.000000    1.000000    0.000000
    0.329323    0.000000   -0.944217

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  160.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.0004016"
 Parameter: YPOS -> "-14.2309403"
 Parameter: ZPOS -> "-27.2596417"
 Parameter: ZPHI -> "166.909411"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.974013    0.226491    0.000000
   -0.226491   -0.974013    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  166.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.000402 XMAX =  -27.000402 XAVE =  -27.000402
    YMIN =  -14.230940 YMAX =  -14.230940 YAVE =  -14.230940
    ZMIN =  -27.259642 ZMAX =  -27.259642 ZAVE =  -27.259642
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.0004016"
Evaluating: -27.0004016+3.5
 Parameter: XMAX <- "-23.5004016"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.2309403"
Evaluating: -14.2309403+3.5
 Parameter: YMAX <- "-10.7309403"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.2596417"
Evaluating: -27.2596417+3.5
 Parameter: ZMAX <- "-23.7596417"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.0004016"
Evaluating: -27.0004016-3.5
 Parameter: XMIN <- "-30.5004016"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.2309403"
Evaluating: -14.2309403-3.5
 Parameter: YMIN <- "-17.7309403"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.2596417"
Evaluating: -27.2596417-3.5
 Parameter: ZMIN <- "-30.7596417"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.5004016"
 Parameter: XMIN -> "-30.5004016"
 Parameter: YMAX -> "-10.7309403"
 Parameter: YMIN -> "-17.7309403"
 Parameter: ZMAX -> "-23.7596417"
 Parameter: ZMIN -> "-30.7596417"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "154"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "154" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "154"
Evaluating: 154
 Parameter: J <- "154"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "154" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "154"
 Parameter: NPOS -> "120"
Evaluating: 154-120
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.24012772"
Evaluating: 112.065471*(0.24012772-0.5)
 Parameter: XPOS <- "-29.1227095"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.461926717"
Evaluating: 112.065471*(0.461926717-0.5)
 Parameter: YPOS <- "-4.26670039"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.829328826"
Evaluating: 142.885239*(0.829328826-0.5)+2.93414115
 Parameter: ZPOS <- "49.9903692"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.9903692" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.9903692" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.1227095"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.1227095-0
 Parameter: XTRAN <- "-29.1227095"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.26670039"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.26670039-0
 Parameter: YTRAN <- "-4.26670039"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.9903692"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.9903692-0
 Parameter: ZTRAN <- "49.9903692"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.1227095"
 Parameter: YTRAN -> "-4.26670039"
 Parameter: ZTRAN -> "49.9903692"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -29.122709   -4.266700   49.990369
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.984220175"
Evaluating: 0.984220175*360.0
 Parameter: XPHI <- "354.319263"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.547405174"
Evaluating: 0.547405174*360.0
 Parameter: YPHI <- "197.065863"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.83666995"
Evaluating: 0.83666995*360.0
 Parameter: ZPHI <- "301.201182"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.1227095"
 Parameter: YPOS -> "-4.26670039"
 Parameter: ZPOS -> "49.9903692"
 Parameter: XPHI -> "354.319263"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.995089   -0.098985
    0.000000    0.098985    0.995089

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    5.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.1227095"
 Parameter: YPOS -> "-4.26670039"
 Parameter: ZPOS -> "49.9903692"
 Parameter: YPHI -> "197.065863"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.955968    0.000000    0.293471
    0.000000    1.000000    0.000000
   -0.293471    0.000000   -0.955968

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  162.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.1227095"
 Parameter: YPOS -> "-4.26670039"
 Parameter: ZPOS -> "49.9903692"
 Parameter: ZPHI -> "301.201182"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.518045   -0.855354    0.000000
    0.855354    0.518045    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   58.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.122709 XMAX =  -29.122709 XAVE =  -29.122709
    YMIN =   -4.266700 YMAX =   -4.266700 YAVE =   -4.266700
    ZMIN =   49.990369 ZMAX =   49.990369 ZAVE =   49.990369
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.1227095"
Evaluating: -29.1227095+3.5
 Parameter: XMAX <- "-25.6227095"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.26670039"
Evaluating: -4.26670039+3.5
 Parameter: YMAX <- "-0.76670039"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.9903692"
Evaluating: 49.9903692+3.5
 Parameter: ZMAX <- "53.4903692"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.1227095"
Evaluating: -29.1227095-3.5
 Parameter: XMIN <- "-32.6227095"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.26670039"
Evaluating: -4.26670039-3.5
 Parameter: YMIN <- "-7.76670039"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.9903692"
Evaluating: 49.9903692-3.5
 Parameter: ZMIN <- "46.4903692"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.6227095"
 Parameter: XMIN -> "-32.6227095"
 Parameter: YMAX -> "-0.76670039"
 Parameter: YMIN -> "-7.76670039"
 Parameter: ZMAX -> "53.4903692"
 Parameter: ZMIN -> "46.4903692"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "155"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "155" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "155"
Evaluating: 155
 Parameter: J <- "155"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "155" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "155"
 Parameter: NPOS -> "120"
Evaluating: 155-120
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.828174956"
Evaluating: 112.065471*(0.828174956-0.5)
 Parameter: XPOS <- "36.777081"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.511369692"
Evaluating: 112.065471*(0.511369692-0.5)
 Parameter: YPOS <- "1.27414989"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.727252123"
Evaluating: 142.885239*(0.727252123-0.5)+2.93414115
 Parameter: ZPOS <- "35.4051151"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.4051151" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.4051151" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.777081"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.777081-0
 Parameter: XTRAN <- "36.777081"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.27414989"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.27414989-0
 Parameter: YTRAN <- "1.27414989"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.4051151"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.4051151-0
 Parameter: ZTRAN <- "35.4051151"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.777081"
 Parameter: YTRAN -> "1.27414989"
 Parameter: ZTRAN -> "35.4051151"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    36.777081    1.274150   35.405115
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.597756112E-02"
Evaluating: 3.597756112E-02*360.0
 Parameter: XPHI <- "12.951922"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499466616"
Evaluating: 0.499466616*360.0
 Parameter: YPHI <- "179.807982"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.203531948"
Evaluating: 0.203531948*360.0
 Parameter: ZPHI <- "73.2715013"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.777081"
 Parameter: YPOS -> "1.27414989"
 Parameter: ZPOS -> "35.4051151"
 Parameter: XPHI -> "12.951922"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.974558    0.224133
    0.000000   -0.224133    0.974558

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   12.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.777081"
 Parameter: YPOS -> "1.27414989"
 Parameter: ZPOS -> "35.4051151"
 Parameter: YPHI -> "179.807982"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.999994    0.000000   -0.003351
    0.000000    1.000000    0.000000
    0.003351    0.000000   -0.999994

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  179.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.777081"
 Parameter: YPOS -> "1.27414989"
 Parameter: ZPOS -> "35.4051151"
 Parameter: ZPHI -> "73.2715013"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.287837    0.957679    0.000000
   -0.957679    0.287837    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   73.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.777081 XMAX =   36.777081 XAVE =   36.777081
    YMIN =    1.274150 YMAX =    1.274150 YAVE =    1.274150
    ZMIN =   35.405115 ZMAX =   35.405115 ZAVE =   35.405115
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.777081"
Evaluating: 36.777081+3.5
 Parameter: XMAX <- "40.277081"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.27414989"
Evaluating: 1.27414989+3.5
 Parameter: YMAX <- "4.77414989"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.4051151"
Evaluating: 35.4051151+3.5
 Parameter: ZMAX <- "38.9051151"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.777081"
Evaluating: 36.777081-3.5
 Parameter: XMIN <- "33.277081"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.27414989"
Evaluating: 1.27414989-3.5
 Parameter: YMIN <- "-2.22585011"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.4051151"
Evaluating: 35.4051151-3.5
 Parameter: ZMIN <- "31.9051151"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.277081"
 Parameter: XMIN -> "33.277081"
 Parameter: YMAX -> "4.77414989"
 Parameter: YMIN -> "-2.22585011"
 Parameter: ZMAX -> "38.9051151"
 Parameter: ZMIN -> "31.9051151"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "156"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "156" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "156"
Evaluating: 156
 Parameter: J <- "156"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "156" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "156"
 Parameter: NPOS -> "120"
Evaluating: 156-120
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.14914504"
Evaluating: 112.065471*(0.14914504-0.5)
 Parameter: XPOS <- "-39.3187263"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.681533402"
Evaluating: 112.065471*(0.681533402-0.5)
 Parameter: YPOS <- "20.3436262"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.678083314"
Evaluating: 142.885239*(0.678083314-0.5)+2.93414115
 Parameter: ZPOS <- "28.379618"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.379618" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.379618" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.3187263"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.3187263-0
 Parameter: XTRAN <- "-39.3187263"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.3436262"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.3436262-0
 Parameter: YTRAN <- "20.3436262"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.379618"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.379618-0
 Parameter: ZTRAN <- "28.379618"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.3187263"
 Parameter: YTRAN -> "20.3436262"
 Parameter: ZTRAN -> "28.379618"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -39.318726   20.343626   28.379618
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.869928484"
Evaluating: 0.869928484*360.0
 Parameter: XPHI <- "313.174254"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.284370112"
Evaluating: 0.284370112*360.0
 Parameter: YPHI <- "102.37324"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.484869476E-02"
Evaluating: 1.484869476E-02*360.0
 Parameter: ZPHI <- "5.34553011"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.3187263"
 Parameter: YPOS -> "20.3436262"
 Parameter: ZPOS -> "28.379618"
 Parameter: XPHI -> "313.174254"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.684219   -0.729276
    0.000000    0.729276    0.684219

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   46.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.3187263"
 Parameter: YPOS -> "20.3436262"
 Parameter: ZPOS -> "28.379618"
 Parameter: YPHI -> "102.37324"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.214279    0.000000   -0.976772
    0.000000    1.000000    0.000000
    0.976772    0.000000   -0.214279

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  102.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.3187263"
 Parameter: YPOS -> "20.3436262"
 Parameter: ZPOS -> "28.379618"
 Parameter: ZPHI -> "5.34553011"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.995651    0.093162    0.000000
   -0.093162    0.995651    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    5.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.318726 XMAX =  -39.318726 XAVE =  -39.318726
    YMIN =   20.343626 YMAX =   20.343626 YAVE =   20.343626
    ZMIN =   28.379618 ZMAX =   28.379618 ZAVE =   28.379618
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.3187263"
Evaluating: -39.3187263+3.5
 Parameter: XMAX <- "-35.8187263"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.3436262"
Evaluating: 20.3436262+3.5
 Parameter: YMAX <- "23.8436262"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.379618"
Evaluating: 28.379618+3.5
 Parameter: ZMAX <- "31.879618"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.3187263"
Evaluating: -39.3187263-3.5
 Parameter: XMIN <- "-42.8187263"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.3436262"
Evaluating: 20.3436262-3.5
 Parameter: YMIN <- "16.8436262"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.379618"
Evaluating: 28.379618-3.5
 Parameter: ZMIN <- "24.879618"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.8187263"
 Parameter: XMIN -> "-42.8187263"
 Parameter: YMAX -> "23.8436262"
 Parameter: YMIN -> "16.8436262"
 Parameter: ZMAX -> "31.879618"
 Parameter: ZMIN -> "24.879618"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "157"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "157" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "157"
Evaluating: 157
 Parameter: J <- "157"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "157" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "157"
 Parameter: NPOS -> "120"
Evaluating: 157-120
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.819250826"
Evaluating: 112.065471*(0.819250826-0.5)
 Parameter: XPOS <- "35.7769942"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.5618222E-02"
Evaluating: 112.065471*(4.5618222E-02-0.5)
 Parameter: YPOS <- "-50.920508"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.674927323"
Evaluating: 142.885239*(0.674927323-0.5)+2.93414115
 Parameter: ZPOS <- "27.9286735"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.9286735" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.9286735" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.7769942"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 35.7769942-0
 Parameter: XTRAN <- "35.7769942"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.920508"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -50.920508-0
 Parameter: YTRAN <- "-50.920508"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.9286735"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.9286735-0
 Parameter: ZTRAN <- "27.9286735"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.7769942"
 Parameter: YTRAN -> "-50.920508"
 Parameter: ZTRAN -> "27.9286735"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    35.776994  -50.920508   27.928673
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.62596938"
Evaluating: 0.62596938*360.0
 Parameter: XPHI <- "225.348977"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.345066524"
Evaluating: 0.345066524*360.0
 Parameter: YPHI <- "124.223949"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.43420879"
Evaluating: 0.43420879*360.0
 Parameter: ZPHI <- "156.315164"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.7769942"
 Parameter: YPOS -> "-50.920508"
 Parameter: ZPOS -> "27.9286735"
 Parameter: XPHI -> "225.348977"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.702787   -0.711400
    0.000000    0.711400   -0.702787

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  134.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.7769942"
 Parameter: YPOS -> "-50.920508"
 Parameter: ZPOS -> "27.9286735"
 Parameter: YPHI -> "124.223949"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.562429    0.000000   -0.826846
    0.000000    1.000000    0.000000
    0.826846    0.000000   -0.562429

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  124.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.7769942"
 Parameter: YPOS -> "-50.920508"
 Parameter: ZPOS -> "27.9286735"
 Parameter: ZPHI -> "156.315164"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.915769    0.401705    0.000000
   -0.401705   -0.915769    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  156.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.776994 XMAX =   35.776994 XAVE =   35.776994
    YMIN =  -50.920508 YMAX =  -50.920508 YAVE =  -50.920508
    ZMIN =   27.928673 ZMAX =   27.928673 ZAVE =   27.928673
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.7769942"
Evaluating: 35.7769942+3.5
 Parameter: XMAX <- "39.2769942"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.920508"
Evaluating: -50.920508+3.5
 Parameter: YMAX <- "-47.420508"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.9286735"
Evaluating: 27.9286735+3.5
 Parameter: ZMAX <- "31.4286735"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.7769942"
Evaluating: 35.7769942-3.5
 Parameter: XMIN <- "32.2769942"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.920508"
Evaluating: -50.920508-3.5
 Parameter: YMIN <- "-54.420508"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.9286735"
Evaluating: 27.9286735-3.5
 Parameter: ZMIN <- "24.4286735"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.2769942"
 Parameter: XMIN -> "32.2769942"
 Parameter: YMAX -> "-47.420508"
 Parameter: YMIN -> "-54.420508"
 Parameter: ZMAX -> "31.4286735"
 Parameter: ZMIN -> "24.4286735"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "158"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "158" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "158"
Evaluating: 158
 Parameter: J <- "158"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "158" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "158"
 Parameter: NPOS -> "120"
Evaluating: 158-120
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.908752597"
Evaluating: 112.065471*(0.908752597-0.5)
 Parameter: XPOS <- "45.8070523"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.201875852"
Evaluating: 112.065471*(0.201875852-0.5)
 Parameter: YPOS <- "-33.4094231"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.587345706"
Evaluating: 142.885239*(0.587345706-0.5)+2.93414115
 Parameter: ZPOS <- "15.4145532"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.4145532" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.4145532" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.8070523"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.8070523-0
 Parameter: XTRAN <- "45.8070523"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.4094231"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.4094231-0
 Parameter: YTRAN <- "-33.4094231"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.4145532"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.4145532-0
 Parameter: ZTRAN <- "15.4145532"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.8070523"
 Parameter: YTRAN -> "-33.4094231"
 Parameter: ZTRAN -> "15.4145532"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    45.807052  -33.409423   15.414553
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.160719462"
Evaluating: 0.160719462*360.0
 Parameter: XPHI <- "57.8590063"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.650507414"
Evaluating: 0.650507414*360.0
 Parameter: YPHI <- "234.182669"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.565290051E-02"
Evaluating: 8.565290051E-02*360.0
 Parameter: ZPHI <- "30.8350442"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.8070523"
 Parameter: YPOS -> "-33.4094231"
 Parameter: ZPOS -> "15.4145532"
 Parameter: XPHI -> "57.8590063"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.532005    0.846742
    0.000000   -0.846742    0.532005

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   57.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.8070523"
 Parameter: YPOS -> "-33.4094231"
 Parameter: ZPOS -> "15.4145532"
 Parameter: YPHI -> "234.182669"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.585203    0.000000    0.810887
    0.000000    1.000000    0.000000
   -0.810887    0.000000   -0.585203

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  125.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.8070523"
 Parameter: YPOS -> "-33.4094231"
 Parameter: ZPOS -> "15.4145532"
 Parameter: ZPHI -> "30.8350442"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.858647    0.512568    0.000000
   -0.512568    0.858647    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   30.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.807052 XMAX =   45.807052 XAVE =   45.807052
    YMIN =  -33.409423 YMAX =  -33.409423 YAVE =  -33.409423
    ZMIN =   15.414553 ZMAX =   15.414553 ZAVE =   15.414553
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.8070523"
Evaluating: 45.8070523+3.5
 Parameter: XMAX <- "49.3070523"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.4094231"
Evaluating: -33.4094231+3.5
 Parameter: YMAX <- "-29.9094231"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.4145532"
Evaluating: 15.4145532+3.5
 Parameter: ZMAX <- "18.9145532"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.8070523"
Evaluating: 45.8070523-3.5
 Parameter: XMIN <- "42.3070523"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.4094231"
Evaluating: -33.4094231-3.5
 Parameter: YMIN <- "-36.9094231"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.4145532"
Evaluating: 15.4145532-3.5
 Parameter: ZMIN <- "11.9145532"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.3070523"
 Parameter: XMIN -> "42.3070523"
 Parameter: YMAX -> "-29.9094231"
 Parameter: YMIN -> "-36.9094231"
 Parameter: ZMAX -> "18.9145532"
 Parameter: ZMIN -> "11.9145532"
 SELRPN>     26 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     14 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53215 NEG      CLA      38       CLA     -**** MEMB     POPC     89       P             2.9798
53215 NEG      CLA      38       CLA     -**** MEMB     POPC     89       O13           3.6790
53215 NEG      CLA      38       CLA     -**** MEMB     POPC     89       O14           2.8474
53215 NEG      CLA      38       CLA     -**** MEMB     POPC     89       O11           2.1755
53215 NEG      CLA      38       CLA     -**** MEMB     POPC     89       C1            2.6918
53215 NEG      CLA      38       CLA     -**** MEMB     POPC     89       C2            2.6113
53215 NEG      CLA      38       CLA     -**** MEMB     POPC     89       O21           1.7038
53215 NEG      CLA      38       CLA     -**** MEMB     POPC     89       C21           2.5930
53215 NEG      CLA      38       CLA     -**** MEMB     POPC     89       O22           3.5686
53215 NEG      CLA      38       CLA     -**** MEMB     POPC     89       C22           2.7469
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "158"
Evaluating: 158
 Parameter: J <- "158"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "158" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "158"
 Parameter: NPOS -> "120"
Evaluating: 158-120
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.537358999"
Evaluating: 112.065471*(0.537358999-0.5)
 Parameter: XPOS <- "4.18665382"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.914060113"
Evaluating: 112.065471*(0.914060113-0.5)
 Parameter: YPOS <- "46.4018416"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.282454942"
Evaluating: 142.885239*(0.282454942-0.5)+2.93414115
 Parameter: ZPOS <- "-28.1498365"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.1498365" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.807052 XMAX =   45.807052 XAVE =   45.807052
    YMIN =  -33.409423 YMAX =  -33.409423 YAVE =  -33.409423
    ZMIN =   15.414553 ZMAX =   15.414553 ZAVE =   15.414553
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.18665382"
 RDCMND substituted energy or value "?XAVE" to "45.8070523"
Evaluating: 4.18665382-45.8070523
 Parameter: XTRAN <- "-41.6203985"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.4018416"
 RDCMND substituted energy or value "?YAVE" to "-33.4094231"
Evaluating: 46.4018416--33.4094231
 Parameter: YTRAN <- "79.8112647"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.1498365"
 RDCMND substituted energy or value "?ZAVE" to "15.4145532"
Evaluating: -28.1498365-15.4145532
 Parameter: ZTRAN <- "-43.5643897"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.6203985"
 Parameter: YTRAN -> "79.8112647"
 Parameter: ZTRAN -> "-43.5643897"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -41.620399   79.811265  -43.564390
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.85898543"
Evaluating: 0.85898543*360.0
 Parameter: XPHI <- "309.234755"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.208675716E-03"
Evaluating: 5.208675716E-03*360.0
 Parameter: YPHI <- "1.87512326"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.527131949E-02"
Evaluating: 6.527131949E-02*360.0
 Parameter: ZPHI <- "23.497675"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.18665382"
 Parameter: YPOS -> "46.4018416"
 Parameter: ZPOS -> "-28.1498365"
 Parameter: XPHI -> "309.234755"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.632499   -0.774561
    0.000000    0.774561    0.632499

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   50.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.18665382"
 Parameter: YPOS -> "46.4018416"
 Parameter: ZPOS -> "-28.1498365"
 Parameter: YPHI -> "1.87512326"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.999465    0.000000   -0.032721
    0.000000    1.000000    0.000000
    0.032721    0.000000    0.999465

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    1.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.18665382"
 Parameter: YPOS -> "46.4018416"
 Parameter: ZPOS -> "-28.1498365"
 Parameter: ZPHI -> "23.497675"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.917076    0.398712    0.000000
   -0.398712    0.917076    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   23.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.186654 XMAX =    4.186654 XAVE =    4.186654
    YMIN =   46.401842 YMAX =   46.401842 YAVE =   46.401842
    ZMIN =  -28.149837 ZMAX =  -28.149837 ZAVE =  -28.149837
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.1866538"
Evaluating: 4.1866538+3.5
 Parameter: XMAX <- "7.6866538"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.4018416"
Evaluating: 46.4018416+3.5
 Parameter: YMAX <- "49.9018416"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.1498365"
Evaluating: -28.1498365+3.5
 Parameter: ZMAX <- "-24.6498365"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.1866538"
Evaluating: 4.1866538-3.5
 Parameter: XMIN <- "0.6866538"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.4018416"
Evaluating: 46.4018416-3.5
 Parameter: YMIN <- "42.9018416"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.1498365"
Evaluating: -28.1498365-3.5
 Parameter: ZMIN <- "-31.6498365"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.6866538"
 Parameter: XMIN -> "0.6866538"
 Parameter: YMAX -> "49.9018416"
 Parameter: YMIN -> "42.9018416"
 Parameter: ZMAX -> "-24.6498365"
 Parameter: ZMIN -> "-31.6498365"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "159"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "159" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "159"
Evaluating: 159
 Parameter: J <- "159"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "159" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "159"
 Parameter: NPOS -> "120"
Evaluating: 159-120
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "9.576296018E-02"
Evaluating: 112.065471*(9.576296018E-02-0.5)
 Parameter: XPOS <- "-45.3010143"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.543241438"
Evaluating: 112.065471*(0.543241438-0.5)
 Parameter: YPOS <- "4.84587212"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.882698137"
Evaluating: 142.885239*(0.882698137-0.5)+2.93414115
 Parameter: ZPOS <- "57.6160559"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.6160559" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.6160559" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.3010143"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -45.3010143-0
 Parameter: XTRAN <- "-45.3010143"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.84587212"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 4.84587212-0
 Parameter: YTRAN <- "4.84587212"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.6160559"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.6160559-0
 Parameter: ZTRAN <- "57.6160559"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.3010143"
 Parameter: YTRAN -> "4.84587212"
 Parameter: ZTRAN -> "57.6160559"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -45.301014    4.845872   57.616056
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.263584889"
Evaluating: 0.263584889*360.0
 Parameter: XPHI <- "94.89056"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.785463123"
Evaluating: 0.785463123*360.0
 Parameter: YPHI <- "282.766724"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.936229945"
Evaluating: 0.936229945*360.0
 Parameter: ZPHI <- "337.04278"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.3010143"
 Parameter: YPOS -> "4.84587212"
 Parameter: ZPOS -> "57.6160559"
 Parameter: XPHI -> "94.89056"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.085253    0.996359
    0.000000   -0.996359   -0.085253

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   94.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.3010143"
 Parameter: YPOS -> "4.84587212"
 Parameter: ZPOS -> "57.6160559"
 Parameter: YPHI -> "282.766724"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.220982    0.000000    0.975278
    0.000000    1.000000    0.000000
   -0.975278    0.000000    0.220982

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   77.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.3010143"
 Parameter: YPOS -> "4.84587212"
 Parameter: ZPOS -> "57.6160559"
 Parameter: ZPHI -> "337.04278"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.920796   -0.390044    0.000000
    0.390044    0.920796    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   22.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.301014 XMAX =  -45.301014 XAVE =  -45.301014
    YMIN =    4.845872 YMAX =    4.845872 YAVE =    4.845872
    ZMIN =   57.616056 ZMAX =   57.616056 ZAVE =   57.616056
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.3010143"
Evaluating: -45.3010143+3.5
 Parameter: XMAX <- "-41.8010143"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.84587212"
Evaluating: 4.84587212+3.5
 Parameter: YMAX <- "8.34587212"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.6160559"
Evaluating: 57.6160559+3.5
 Parameter: ZMAX <- "61.1160559"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.3010143"
Evaluating: -45.3010143-3.5
 Parameter: XMIN <- "-48.8010143"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.84587212"
Evaluating: 4.84587212-3.5
 Parameter: YMIN <- "1.34587212"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.6160559"
Evaluating: 57.6160559-3.5
 Parameter: ZMIN <- "54.1160559"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.8010143"
 Parameter: XMIN -> "-48.8010143"
 Parameter: YMAX -> "8.34587212"
 Parameter: YMIN -> "1.34587212"
 Parameter: ZMAX -> "61.1160559"
 Parameter: ZMIN -> "54.1160559"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "160"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "160" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "160"
Evaluating: 160
 Parameter: J <- "160"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "160" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "160"
 Parameter: NPOS -> "120"
Evaluating: 160-120
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.638580623"
Evaluating: 112.065471*(0.638580623-0.5)
 Parameter: XPOS <- "15.5301028"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.596295165"
Evaluating: 112.065471*(0.596295165-0.5)
 Parameter: YPOS <- "10.791363"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.876290496"
Evaluating: 142.885239*(0.876290496-0.5)+2.93414115
 Parameter: ZPOS <- "56.7004986"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.7004986" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.7004986" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.5301028"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.5301028-0
 Parameter: XTRAN <- "15.5301028"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.791363"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.791363-0
 Parameter: YTRAN <- "10.791363"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.7004986"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 56.7004986-0
 Parameter: ZTRAN <- "56.7004986"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.5301028"
 Parameter: YTRAN -> "10.791363"
 Parameter: ZTRAN -> "56.7004986"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    15.530103   10.791363   56.700499
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.49978871"
Evaluating: 0.49978871*360.0
 Parameter: XPHI <- "179.923936"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.86933941E-02"
Evaluating: 4.86933941E-02*360.0
 Parameter: YPHI <- "17.5296219"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335177872"
Evaluating: 0.335177872*360.0
 Parameter: ZPHI <- "120.664034"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.5301028"
 Parameter: YPOS -> "10.791363"
 Parameter: ZPOS -> "56.7004986"
 Parameter: XPHI -> "179.923936"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999999    0.001328
    0.000000   -0.001328   -0.999999

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  179.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.5301028"
 Parameter: YPOS -> "10.791363"
 Parameter: ZPOS -> "56.7004986"
 Parameter: YPHI -> "17.5296219"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.953561    0.000000   -0.301199
    0.000000    1.000000    0.000000
    0.301199    0.000000    0.953561

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   17.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.5301028"
 Parameter: YPOS -> "10.791363"
 Parameter: ZPOS -> "56.7004986"
 Parameter: ZPHI -> "120.664034"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.510003    0.860173    0.000000
   -0.860173   -0.510003    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.530103 XMAX =   15.530103 XAVE =   15.530103
    YMIN =   10.791363 YMAX =   10.791363 YAVE =   10.791363
    ZMIN =   56.700499 ZMAX =   56.700499 ZAVE =   56.700499
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.5301028"
Evaluating: 15.5301028+3.5
 Parameter: XMAX <- "19.0301028"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.791363"
Evaluating: 10.791363+3.5
 Parameter: YMAX <- "14.291363"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.7004986"
Evaluating: 56.7004986+3.5
 Parameter: ZMAX <- "60.2004986"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.5301028"
Evaluating: 15.5301028-3.5
 Parameter: XMIN <- "12.0301028"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.791363"
Evaluating: 10.791363-3.5
 Parameter: YMIN <- "7.291363"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.7004986"
Evaluating: 56.7004986-3.5
 Parameter: ZMIN <- "53.2004986"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.0301028"
 Parameter: XMIN -> "12.0301028"
 Parameter: YMAX -> "14.291363"
 Parameter: YMIN -> "7.291363"
 Parameter: ZMAX -> "60.2004986"
 Parameter: ZMIN -> "53.2004986"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "161"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "161" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "161"
Evaluating: 161
 Parameter: J <- "161"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "161" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "161"
 Parameter: NPOS -> "120"
Evaluating: 161-120
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "3.99748216E-02"
Evaluating: 112.065471*(3.99748216E-02-0.5)
 Parameter: XPOS <- "-51.5529383"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.374673297E-02"
Evaluating: 112.065471*(5.374673297E-02-0.5)
 Parameter: YPOS <- "-50.0095826"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.619396596"
Evaluating: 142.885239*(0.619396596-0.5)+2.93414115
 Parameter: ZPOS <- "19.9941523"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.9941523" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.9941523" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.5529383"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -51.5529383-0
 Parameter: XTRAN <- "-51.5529383"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.0095826"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -50.0095826-0
 Parameter: YTRAN <- "-50.0095826"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.9941523"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.9941523-0
 Parameter: ZTRAN <- "19.9941523"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.5529383"
 Parameter: YTRAN -> "-50.0095826"
 Parameter: ZTRAN -> "19.9941523"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -51.552938  -50.009583   19.994152
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.446208351"
Evaluating: 0.446208351*360.0
 Parameter: XPHI <- "160.635006"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.888006866"
Evaluating: 0.888006866*360.0
 Parameter: YPHI <- "319.682472"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.541576219"
Evaluating: 0.541576219*360.0
 Parameter: ZPHI <- "194.967439"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.5529383"
 Parameter: YPOS -> "-50.0095826"
 Parameter: ZPOS -> "19.9941523"
 Parameter: XPHI -> "160.635006"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.943425    0.331585
    0.000000   -0.331585   -0.943425

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  160.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.5529383"
 Parameter: YPOS -> "-50.0095826"
 Parameter: ZPOS -> "19.9941523"
 Parameter: YPHI -> "319.682472"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.762470    0.000000    0.647023
    0.000000    1.000000    0.000000
   -0.647023    0.000000    0.762470

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   40.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.5529383"
 Parameter: YPOS -> "-50.0095826"
 Parameter: ZPOS -> "19.9941523"
 Parameter: ZPHI -> "194.967439"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.966073   -0.258270    0.000000
    0.258270   -0.966073    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  165.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.552938 XMAX =  -51.552938 XAVE =  -51.552938
    YMIN =  -50.009583 YMAX =  -50.009583 YAVE =  -50.009583
    ZMIN =   19.994152 ZMAX =   19.994152 ZAVE =   19.994152
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.5529383"
Evaluating: -51.5529383+3.5
 Parameter: XMAX <- "-48.0529383"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.0095826"
Evaluating: -50.0095826+3.5
 Parameter: YMAX <- "-46.5095826"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.9941523"
Evaluating: 19.9941523+3.5
 Parameter: ZMAX <- "23.4941523"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.5529383"
Evaluating: -51.5529383-3.5
 Parameter: XMIN <- "-55.0529383"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.0095826"
Evaluating: -50.0095826-3.5
 Parameter: YMIN <- "-53.5095826"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.9941523"
Evaluating: 19.9941523-3.5
 Parameter: ZMIN <- "16.4941523"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-48.0529383"
 Parameter: XMIN -> "-55.0529383"
 Parameter: YMAX -> "-46.5095826"
 Parameter: YMIN -> "-53.5095826"
 Parameter: ZMAX -> "23.4941523"
 Parameter: ZMIN -> "16.4941523"
 SELRPN>     34 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     16 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     138      N             1.8475
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     138      C12           2.1484
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     138      C13           2.5737
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     138      C14           1.3178
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     138      C15           3.2867
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     138      C11           2.0187
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     138      P             3.7663
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     138      O12           2.5951
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     138      O11           3.3134
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     138      C1            2.9700
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     148      C1            3.7102
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     148      C2            3.8749
53218 NEG      CLA      41       CLA     -**** MEMB     POPC     148      C3            3.8714
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        13
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "161"
Evaluating: 161
 Parameter: J <- "161"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "161" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "161"
 Parameter: NPOS -> "120"
Evaluating: 161-120
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.119867273"
Evaluating: 112.065471*(0.119867273-0.5)
 Parameter: XPOS <- "-42.5997531"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.904792472"
Evaluating: 112.065471*(0.904792472-0.5)
 Parameter: YPOS <- "45.363259"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.136068135"
Evaluating: 142.885239*(0.136068135-0.5)+2.93414115
 Parameter: ZPOS <- "-49.0663504"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.0663504" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.552938 XMAX =  -51.552938 XAVE =  -51.552938
    YMIN =  -50.009583 YMAX =  -50.009583 YAVE =  -50.009583
    ZMIN =   19.994152 ZMAX =   19.994152 ZAVE =   19.994152
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.5997531"
 RDCMND substituted energy or value "?XAVE" to "-51.5529383"
Evaluating: -42.5997531--51.5529383
 Parameter: XTRAN <- "8.9531852"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.363259"
 RDCMND substituted energy or value "?YAVE" to "-50.0095826"
Evaluating: 45.363259--50.0095826
 Parameter: YTRAN <- "95.3728416"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.0663504"
 RDCMND substituted energy or value "?ZAVE" to "19.9941523"
Evaluating: -49.0663504-19.9941523
 Parameter: ZTRAN <- "-69.0605027"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.9531852"
 Parameter: YTRAN -> "95.3728416"
 Parameter: ZTRAN -> "-69.0605027"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     8.953185   95.372842  -69.060503
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.368835759"
Evaluating: 0.368835759*360.0
 Parameter: XPHI <- "132.780873"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.622692266"
Evaluating: 0.622692266*360.0
 Parameter: YPHI <- "224.169216"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.405336549"
Evaluating: 0.405336549*360.0
 Parameter: ZPHI <- "145.921158"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.5997531"
 Parameter: YPOS -> "45.363259"
 Parameter: ZPOS -> "-49.0663504"
 Parameter: XPHI -> "132.780873"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.679196    0.733957
    0.000000   -0.733957   -0.679196

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.5997531"
 Parameter: YPOS -> "45.363259"
 Parameter: ZPOS -> "-49.0663504"
 Parameter: YPHI -> "224.169216"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.717285    0.000000    0.696780
    0.000000    1.000000    0.000000
   -0.696780    0.000000   -0.717285

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  135.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.5997531"
 Parameter: YPOS -> "45.363259"
 Parameter: ZPOS -> "-49.0663504"
 Parameter: ZPHI -> "145.921158"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.828267    0.560333    0.000000
   -0.560333   -0.828267    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  145.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.599753 XMAX =  -42.599753 XAVE =  -42.599753
    YMIN =   45.363259 YMAX =   45.363259 YAVE =   45.363259
    ZMIN =  -49.066350 ZMAX =  -49.066350 ZAVE =  -49.066350
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.5997531"
Evaluating: -42.5997531+3.5
 Parameter: XMAX <- "-39.0997531"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.363259"
Evaluating: 45.363259+3.5
 Parameter: YMAX <- "48.863259"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.0663504"
Evaluating: -49.0663504+3.5
 Parameter: ZMAX <- "-45.5663504"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.5997531"
Evaluating: -42.5997531-3.5
 Parameter: XMIN <- "-46.0997531"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.363259"
Evaluating: 45.363259-3.5
 Parameter: YMIN <- "41.863259"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.0663504"
Evaluating: -49.0663504-3.5
 Parameter: ZMIN <- "-52.5663504"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.0997531"
 Parameter: XMIN -> "-46.0997531"
 Parameter: YMAX -> "48.863259"
 Parameter: YMIN -> "41.863259"
 Parameter: ZMAX -> "-45.5663504"
 Parameter: ZMIN -> "-52.5663504"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "162"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "162" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "162"
Evaluating: 162
 Parameter: J <- "162"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "162" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "162"
 Parameter: NPOS -> "120"
Evaluating: 162-120
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.802284767"
Evaluating: 112.065471*(0.802284767-0.5)
 Parameter: XPOS <- "33.8756848"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.276882286"
Evaluating: 112.065471*(0.276882286-0.5)
 Parameter: YPOS <- "-25.0037917"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.383324134"
Evaluating: 142.885239*(0.383324134-0.5)+2.93414115
 Parameter: ZPOS <- "-13.7371178"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.7371178" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.7371178" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "162"
Evaluating: 162
 Parameter: J <- "162"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "162" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "162"
 Parameter: NPOS -> "120"
Evaluating: 162-120
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.895040382"
Evaluating: 112.065471*(0.895040382-0.5)
 Parameter: XPOS <- "44.2703865"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.448744209"
Evaluating: 112.065471*(0.448744209-0.5)
 Parameter: YPOS <- "-5.74400436"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.897952671"
Evaluating: 142.885239*(0.897952671-0.5)+2.93414115
 Parameter: ZPOS <- "59.7957037"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "59.7957037" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "59.7957037" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.2703865"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.2703865-0
 Parameter: XTRAN <- "44.2703865"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.74400436"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.74400436-0
 Parameter: YTRAN <- "-5.74400436"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "59.7957037"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 59.7957037-0
 Parameter: ZTRAN <- "59.7957037"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.2703865"
 Parameter: YTRAN -> "-5.74400436"
 Parameter: ZTRAN -> "59.7957037"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    44.270387   -5.744004   59.795704
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.923779421"
Evaluating: 0.923779421*360.0
 Parameter: XPHI <- "332.560592"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.792317614"
Evaluating: 0.792317614*360.0
 Parameter: YPHI <- "285.234341"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.817257579"
Evaluating: 0.817257579*360.0
 Parameter: ZPHI <- "294.212728"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.2703865"
 Parameter: YPOS -> "-5.74400436"
 Parameter: ZPOS -> "59.7957037"
 Parameter: XPHI -> "332.560592"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.887499   -0.460810
    0.000000    0.460810    0.887499

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   27.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.2703865"
 Parameter: YPOS -> "-5.74400436"
 Parameter: ZPOS -> "59.7957037"
 Parameter: YPHI -> "285.234341"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.262768    0.000000    0.964859
    0.000000    1.000000    0.000000
   -0.964859    0.000000    0.262768

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   74.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.2703865"
 Parameter: YPOS -> "-5.74400436"
 Parameter: ZPOS -> "59.7957037"
 Parameter: ZPHI -> "294.212728"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.410126   -0.912029    0.000000
    0.912029    0.410126    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   65.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.270387 XMAX =   44.270387 XAVE =   44.270387
    YMIN =   -5.744004 YMAX =   -5.744004 YAVE =   -5.744004
    ZMIN =   59.795704 ZMAX =   59.795704 ZAVE =   59.795704
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.2703865"
Evaluating: 44.2703865+3.5
 Parameter: XMAX <- "47.7703865"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.74400436"
Evaluating: -5.74400436+3.5
 Parameter: YMAX <- "-2.24400436"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "59.7957037"
Evaluating: 59.7957037+3.5
 Parameter: ZMAX <- "63.2957037"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.2703865"
Evaluating: 44.2703865-3.5
 Parameter: XMIN <- "40.7703865"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.74400436"
Evaluating: -5.74400436-3.5
 Parameter: YMIN <- "-9.24400436"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "59.7957037"
Evaluating: 59.7957037-3.5
 Parameter: ZMIN <- "56.2957037"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.7703865"
 Parameter: XMIN -> "40.7703865"
 Parameter: YMAX -> "-2.24400436"
 Parameter: YMIN -> "-9.24400436"
 Parameter: ZMAX -> "63.2957037"
 Parameter: ZMIN -> "56.2957037"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "163"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "163" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "163"
Evaluating: 163
 Parameter: J <- "163"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "163" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "163"
 Parameter: NPOS -> "120"
Evaluating: 163-120
 Parameter: J <- "43"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.824089581"
Evaluating: 112.065471*(0.824089581-0.5)
 Parameter: XPOS <- "36.3192515"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.35091041E-02"
Evaluating: 112.065471*(4.35091041E-02-0.5)
 Parameter: YPOS <- "-51.1568673"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.367534551"
Evaluating: 142.885239*(0.367534551-0.5)+2.93414115
 Parameter: ZPOS <- "-15.9932162"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.9932162" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.3192515"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.3192515-0
 Parameter: XTRAN <- "36.3192515"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-51.1568673"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -51.1568673-0
 Parameter: YTRAN <- "-51.1568673"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.9932162"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.9932162-0
 Parameter: ZTRAN <- "-15.9932162"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.3192515"
 Parameter: YTRAN -> "-51.1568673"
 Parameter: ZTRAN -> "-15.9932162"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    36.319252  -51.156867  -15.993216
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.185304135"
Evaluating: 0.185304135*360.0
 Parameter: XPHI <- "66.7094886"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.449123052E-02"
Evaluating: 2.449123052E-02*360.0
 Parameter: YPHI <- "8.81684299"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126984308"
Evaluating: 0.126984308*360.0
 Parameter: ZPHI <- "45.7143509"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.3192515"
 Parameter: YPOS -> "-51.1568673"
 Parameter: ZPOS -> "-15.9932162"
 Parameter: XPHI -> "66.7094886"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.395393    0.918512
    0.000000   -0.918512    0.395393

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   66.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.3192515"
 Parameter: YPOS -> "-51.1568673"
 Parameter: ZPOS -> "-15.9932162"
 Parameter: YPHI -> "8.81684299"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.988183    0.000000   -0.153276
    0.000000    1.000000    0.000000
    0.153276    0.000000    0.988183

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    8.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.3192515"
 Parameter: YPOS -> "-51.1568673"
 Parameter: ZPOS -> "-15.9932162"
 Parameter: ZPHI -> "45.7143509"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.698236    0.715868    0.000000
   -0.715868    0.698236    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   45.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.319252 XMAX =   36.319252 XAVE =   36.319252
    YMIN =  -51.156867 YMAX =  -51.156867 YAVE =  -51.156867
    ZMIN =  -15.993216 ZMAX =  -15.993216 ZAVE =  -15.993216
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.3192515"
Evaluating: 36.3192515+3.5
 Parameter: XMAX <- "39.8192515"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-51.1568673"
Evaluating: -51.1568673+3.5
 Parameter: YMAX <- "-47.6568673"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.9932162"
Evaluating: -15.9932162+3.5
 Parameter: ZMAX <- "-12.4932162"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.3192515"
Evaluating: 36.3192515-3.5
 Parameter: XMIN <- "32.8192515"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-51.1568673"
Evaluating: -51.1568673-3.5
 Parameter: YMIN <- "-54.6568673"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.9932162"
Evaluating: -15.9932162-3.5
 Parameter: ZMIN <- "-19.4932162"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.8192515"
 Parameter: XMIN -> "32.8192515"
 Parameter: YMAX -> "-47.6568673"
 Parameter: YMIN -> "-54.6568673"
 Parameter: ZMAX -> "-12.4932162"
 Parameter: ZMIN -> "-19.4932162"
 SELRPN>     30 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     18 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     263      C1            3.3556
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     263      C3            3.4090
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     263      O31           2.5399
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     263      C31           3.3953
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     263      C32           3.2695
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     285      P             3.2422
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     285      O13           3.8125
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     285      O14           2.1816
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     285      O11           3.4862
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     285      O31           3.2056
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     285      C31           3.5385
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     285      C32           2.6455
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     285      C33           3.6902
53220 NEG      CLA      43       CLA     -**** MEMB     POPC     285      C34           3.6867
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        14
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "163"
Evaluating: 163
 Parameter: J <- "163"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "163" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "163"
 Parameter: NPOS -> "120"
Evaluating: 163-120
 Parameter: J <- "43"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.384464473"
Evaluating: 112.065471*(0.384464473-0.5)
 Parameter: XPOS <- "-12.9475433"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.13786386"
Evaluating: 112.065471*(0.13786386-0.5)
 Parameter: YPOS <- "-40.5829571"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.966207103"
Evaluating: 142.885239*(0.966207103-0.5)+2.93414115
 Parameter: ZPOS <- "69.5482545"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.5482545" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.5482545" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.319252 XMAX =   36.319252 XAVE =   36.319252
    YMIN =  -51.156867 YMAX =  -51.156867 YAVE =  -51.156867
    ZMIN =  -15.993216 ZMAX =  -15.993216 ZAVE =  -15.993216
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.9475433"
 RDCMND substituted energy or value "?XAVE" to "36.3192515"
Evaluating: -12.9475433-36.3192515
 Parameter: XTRAN <- "-49.2667948"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.5829571"
 RDCMND substituted energy or value "?YAVE" to "-51.1568673"
Evaluating: -40.5829571--51.1568673
 Parameter: YTRAN <- "10.5739102"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.5482545"
 RDCMND substituted energy or value "?ZAVE" to "-15.9932162"
Evaluating: 69.5482545--15.9932162
 Parameter: ZTRAN <- "85.5414707"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.2667948"
 Parameter: YTRAN -> "10.5739102"
 Parameter: ZTRAN -> "85.5414707"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -49.266795   10.573910   85.541471
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481545339"
Evaluating: 0.481545339*360.0
 Parameter: XPHI <- "173.356322"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.194610539"
Evaluating: 0.194610539*360.0
 Parameter: YPHI <- "70.059794"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.807113371"
Evaluating: 0.807113371*360.0
 Parameter: ZPHI <- "290.560814"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.9475433"
 Parameter: YPOS -> "-40.5829571"
 Parameter: ZPOS -> "69.5482545"
 Parameter: XPHI -> "173.356322"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.993285    0.115694
    0.000000   -0.115694   -0.993285

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  173.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.9475433"
 Parameter: YPOS -> "-40.5829571"
 Parameter: ZPOS -> "69.5482545"
 Parameter: YPHI -> "70.059794"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.341039    0.000000   -0.940049
    0.000000    1.000000    0.000000
    0.940049    0.000000    0.341039

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   70.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.9475433"
 Parameter: YPOS -> "-40.5829571"
 Parameter: ZPOS -> "69.5482545"
 Parameter: ZPHI -> "290.560814"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.351201   -0.936300    0.000000
    0.936300    0.351201    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   69.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.947543 XMAX =  -12.947543 XAVE =  -12.947543
    YMIN =  -40.582957 YMAX =  -40.582957 YAVE =  -40.582957
    ZMIN =   69.548254 ZMAX =   69.548254 ZAVE =   69.548254
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.9475433"
Evaluating: -12.9475433+3.5
 Parameter: XMAX <- "-9.4475433"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.5829571"
Evaluating: -40.5829571+3.5
 Parameter: YMAX <- "-37.0829571"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.5482545"
Evaluating: 69.5482545+3.5
 Parameter: ZMAX <- "73.0482545"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.9475433"
Evaluating: -12.9475433-3.5
 Parameter: XMIN <- "-16.4475433"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.5829571"
Evaluating: -40.5829571-3.5
 Parameter: YMIN <- "-44.0829571"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.5482545"
Evaluating: 69.5482545-3.5
 Parameter: ZMIN <- "66.0482545"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.4475433"
 Parameter: XMIN -> "-16.4475433"
 Parameter: YMAX -> "-37.0829571"
 Parameter: YMIN -> "-44.0829571"
 Parameter: ZMAX -> "73.0482545"
 Parameter: ZMIN -> "66.0482545"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "164"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "164" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "164"
Evaluating: 164
 Parameter: J <- "164"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "164" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "164"
 Parameter: NPOS -> "120"
Evaluating: 164-120
 Parameter: J <- "44"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.389388404"
Evaluating: 112.065471*(0.389388404-0.5)
 Parameter: XPOS <- "-12.3957406"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.952343347"
Evaluating: 112.065471*(0.952343347-0.5)
 Parameter: YPOS <- "50.6920702"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.255345776"
Evaluating: 142.885239*(0.255345776-0.5)+2.93414115
 Parameter: ZPOS <- "-32.0233361"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.0233361" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.3957406"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.3957406-0
 Parameter: XTRAN <- "-12.3957406"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.6920702"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 50.6920702-0
 Parameter: YTRAN <- "50.6920702"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.0233361"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.0233361-0
 Parameter: ZTRAN <- "-32.0233361"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.3957406"
 Parameter: YTRAN -> "50.6920702"
 Parameter: ZTRAN -> "-32.0233361"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -12.395741   50.692070  -32.023336
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.933628085"
Evaluating: 0.933628085*360.0
 Parameter: XPHI <- "336.106111"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.825523329E-02"
Evaluating: 7.825523329E-02*360.0
 Parameter: YPHI <- "28.171884"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.80939751"
Evaluating: 0.80939751*360.0
 Parameter: ZPHI <- "291.383104"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.3957406"
 Parameter: YPOS -> "50.6920702"
 Parameter: ZPOS -> "-32.0233361"
 Parameter: XPHI -> "336.106111"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.914297   -0.405044
    0.000000    0.405044    0.914297

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.3957406"
 Parameter: YPOS -> "50.6920702"
 Parameter: ZPOS -> "-32.0233361"
 Parameter: YPHI -> "28.171884"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.881535    0.000000   -0.472118
    0.000000    1.000000    0.000000
    0.472118    0.000000    0.881535

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   28.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.3957406"
 Parameter: YPOS -> "50.6920702"
 Parameter: ZPOS -> "-32.0233361"
 Parameter: ZPHI -> "291.383104"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.364602   -0.931163    0.000000
    0.931163    0.364602    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.395741 XMAX =  -12.395741 XAVE =  -12.395741
    YMIN =   50.692070 YMAX =   50.692070 YAVE =   50.692070
    ZMIN =  -32.023336 ZMAX =  -32.023336 ZAVE =  -32.023336
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.3957406"
Evaluating: -12.3957406+3.5
 Parameter: XMAX <- "-8.8957406"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.6920702"
Evaluating: 50.6920702+3.5
 Parameter: YMAX <- "54.1920702"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.0233361"
Evaluating: -32.0233361+3.5
 Parameter: ZMAX <- "-28.5233361"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.3957406"
Evaluating: -12.3957406-3.5
 Parameter: XMIN <- "-15.8957406"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.6920702"
Evaluating: 50.6920702-3.5
 Parameter: YMIN <- "47.1920702"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.0233361"
Evaluating: -32.0233361-3.5
 Parameter: ZMIN <- "-35.5233361"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.8957406"
 Parameter: XMIN -> "-15.8957406"
 Parameter: YMAX -> "54.1920702"
 Parameter: YMIN -> "47.1920702"
 Parameter: ZMAX -> "-28.5233361"
 Parameter: ZMIN -> "-35.5233361"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "165"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "165" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "165"
Evaluating: 165
 Parameter: J <- "165"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "165" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "165"
 Parameter: NPOS -> "120"
Evaluating: 165-120
 Parameter: J <- "45"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.79983003"
Evaluating: 112.065471*(0.79983003-0.5)
 Parameter: XPOS <- "33.6005935"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.837986448"
Evaluating: 112.065471*(0.837986448-0.5)
 Parameter: YPOS <- "37.8766105"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.959396846"
Evaluating: 142.885239*(0.959396846-0.5)+2.93414115
 Parameter: ZPOS <- "68.5751693"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "68.5751693" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "68.5751693" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.6005935"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.6005935-0
 Parameter: XTRAN <- "33.6005935"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.8766105"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.8766105-0
 Parameter: YTRAN <- "37.8766105"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "68.5751693"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 68.5751693-0
 Parameter: ZTRAN <- "68.5751693"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.6005935"
 Parameter: YTRAN -> "37.8766105"
 Parameter: ZTRAN -> "68.5751693"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    33.600594   37.876610   68.575169
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.622421791"
Evaluating: 0.622421791*360.0
 Parameter: XPHI <- "224.071845"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.323334653E-02"
Evaluating: 9.323334653E-02*360.0
 Parameter: YPHI <- "33.5640048"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.811956846"
Evaluating: 0.811956846*360.0
 Parameter: ZPHI <- "292.304465"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.6005935"
 Parameter: YPOS -> "37.8766105"
 Parameter: ZPOS -> "68.5751693"
 Parameter: XPHI -> "224.071845"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.718468   -0.695560
    0.000000    0.695560   -0.718468

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  135.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.6005935"
 Parameter: YPOS -> "37.8766105"
 Parameter: ZPOS -> "68.5751693"
 Parameter: YPHI -> "33.5640048"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.833269    0.000000   -0.552868
    0.000000    1.000000    0.000000
    0.552868    0.000000    0.833269

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   33.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.6005935"
 Parameter: YPOS -> "37.8766105"
 Parameter: ZPOS -> "68.5751693"
 Parameter: ZPHI -> "292.304465"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.379528   -0.925180    0.000000
    0.925180    0.379528    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   67.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.600594 XMAX =   33.600594 XAVE =   33.600594
    YMIN =   37.876610 YMAX =   37.876610 YAVE =   37.876610
    ZMIN =   68.575169 ZMAX =   68.575169 ZAVE =   68.575169
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.6005935"
Evaluating: 33.6005935+3.5
 Parameter: XMAX <- "37.1005935"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.8766105"
Evaluating: 37.8766105+3.5
 Parameter: YMAX <- "41.3766105"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "68.5751693"
Evaluating: 68.5751693+3.5
 Parameter: ZMAX <- "72.0751693"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.6005935"
Evaluating: 33.6005935-3.5
 Parameter: XMIN <- "30.1005935"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.8766105"
Evaluating: 37.8766105-3.5
 Parameter: YMIN <- "34.3766105"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "68.5751693"
Evaluating: 68.5751693-3.5
 Parameter: ZMIN <- "65.0751693"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.1005935"
 Parameter: XMIN -> "30.1005935"
 Parameter: YMAX -> "41.3766105"
 Parameter: YMIN -> "34.3766105"
 Parameter: ZMAX -> "72.0751693"
 Parameter: ZMIN -> "65.0751693"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "166"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "166" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "166"
Evaluating: 166
 Parameter: J <- "166"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "166" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "166"
 Parameter: NPOS -> "120"
Evaluating: 166-120
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.95924698"
Evaluating: 112.065471*(0.95924698-0.5)
 Parameter: XPOS <- "51.4657291"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.415323676"
Evaluating: 112.065471*(0.415323676-0.5)
 Parameter: YPOS <- "-9.48929213"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.811783696"
Evaluating: 142.885239*(0.811783696-0.5)+2.93414115
 Parameter: ZPOS <- "47.4834291"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.4834291" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.4834291" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.4657291"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.4657291-0
 Parameter: XTRAN <- "51.4657291"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.48929213"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.48929213-0
 Parameter: YTRAN <- "-9.48929213"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.4834291"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.4834291-0
 Parameter: ZTRAN <- "47.4834291"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.4657291"
 Parameter: YTRAN -> "-9.48929213"
 Parameter: ZTRAN -> "47.4834291"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    51.465729   -9.489292   47.483429
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678463713"
Evaluating: 0.678463713*360.0
 Parameter: XPHI <- "244.246937"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.749273745E-02"
Evaluating: 9.749273745E-02*360.0
 Parameter: YPHI <- "35.0973855"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.630016431E-02"
Evaluating: 2.630016431E-02*360.0
 Parameter: ZPHI <- "9.46805915"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.4657291"
 Parameter: YPOS -> "-9.48929213"
 Parameter: ZPOS -> "47.4834291"
 Parameter: XPHI -> "244.246937"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.434493   -0.900675
    0.000000    0.900675   -0.434493

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.4657291"
 Parameter: YPOS -> "-9.48929213"
 Parameter: ZPOS -> "47.4834291"
 Parameter: YPHI -> "35.0973855"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.818176    0.000000   -0.574968
    0.000000    1.000000    0.000000
    0.574968    0.000000    0.818176

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   35.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.4657291"
 Parameter: YPOS -> "-9.48929213"
 Parameter: ZPOS -> "47.4834291"
 Parameter: ZPHI -> "9.46805915"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.986377    0.164498    0.000000
   -0.164498    0.986377    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    9.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.465729 XMAX =   51.465729 XAVE =   51.465729
    YMIN =   -9.489292 YMAX =   -9.489292 YAVE =   -9.489292
    ZMIN =   47.483429 ZMAX =   47.483429 ZAVE =   47.483429
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.4657291"
Evaluating: 51.4657291+3.5
 Parameter: XMAX <- "54.9657291"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.48929213"
Evaluating: -9.48929213+3.5
 Parameter: YMAX <- "-5.98929213"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.4834291"
Evaluating: 47.4834291+3.5
 Parameter: ZMAX <- "50.9834291"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.4657291"
Evaluating: 51.4657291-3.5
 Parameter: XMIN <- "47.9657291"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.48929213"
Evaluating: -9.48929213-3.5
 Parameter: YMIN <- "-12.9892921"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.4834291"
Evaluating: 47.4834291-3.5
 Parameter: ZMIN <- "43.9834291"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.9657291"
 Parameter: XMIN -> "47.9657291"
 Parameter: YMAX -> "-5.98929213"
 Parameter: YMIN -> "-12.9892921"
 Parameter: ZMAX -> "50.9834291"
 Parameter: ZMIN -> "43.9834291"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "167"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "167" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "167"
Evaluating: 167
 Parameter: J <- "167"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "167" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "167"
 Parameter: NPOS -> "120"
Evaluating: 167-120
 Parameter: J <- "47"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.925880155"
Evaluating: 112.065471*(0.925880155-0.5)
 Parameter: XPOS <- "47.7264602"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.482705878"
Evaluating: 112.065471*(0.482705878-0.5)
 Parameter: YPOS <- "-1.93807393"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.373904742"
Evaluating: 142.885239*(0.373904742-0.5)+2.93414115
 Parameter: ZPOS <- "-15.0830099"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.0830099" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.7264602"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 47.7264602-0
 Parameter: XTRAN <- "47.7264602"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.93807393"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.93807393-0
 Parameter: YTRAN <- "-1.93807393"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.0830099"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.0830099-0
 Parameter: ZTRAN <- "-15.0830099"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.7264602"
 Parameter: YTRAN -> "-1.93807393"
 Parameter: ZTRAN -> "-15.0830099"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    47.726460   -1.938074  -15.083010
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.390900847"
Evaluating: 0.390900847*360.0
 Parameter: XPHI <- "140.724305"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.520771792"
Evaluating: 0.520771792*360.0
 Parameter: YPHI <- "187.477845"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.138866047"
Evaluating: 0.138866047*360.0
 Parameter: ZPHI <- "49.9917769"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.7264602"
 Parameter: YPOS -> "-1.93807393"
 Parameter: ZPOS -> "-15.0830099"
 Parameter: XPHI -> "140.724305"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.774109    0.633053
    0.000000   -0.633053   -0.774109

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  140.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.7264602"
 Parameter: YPOS -> "-1.93807393"
 Parameter: ZPOS -> "-15.0830099"
 Parameter: YPHI -> "187.477845"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.991495    0.000000    0.130143
    0.000000    1.000000    0.000000
   -0.130143    0.000000   -0.991495

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  172.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.7264602"
 Parameter: YPOS -> "-1.93807393"
 Parameter: ZPOS -> "-15.0830099"
 Parameter: ZPHI -> "49.9917769"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.642898    0.765952    0.000000
   -0.765952    0.642898    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.726460 XMAX =   47.726460 XAVE =   47.726460
    YMIN =   -1.938074 YMAX =   -1.938074 YAVE =   -1.938074
    ZMIN =  -15.083010 ZMAX =  -15.083010 ZAVE =  -15.083010
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.7264602"
Evaluating: 47.7264602+3.5
 Parameter: XMAX <- "51.2264602"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.93807393"
Evaluating: -1.93807393+3.5
 Parameter: YMAX <- "1.56192607"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.0830099"
Evaluating: -15.0830099+3.5
 Parameter: ZMAX <- "-11.5830099"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.7264602"
Evaluating: 47.7264602-3.5
 Parameter: XMIN <- "44.2264602"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.93807393"
Evaluating: -1.93807393-3.5
 Parameter: YMIN <- "-5.43807393"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.0830099"
Evaluating: -15.0830099-3.5
 Parameter: ZMIN <- "-18.5830099"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.2264602"
 Parameter: XMIN -> "44.2264602"
 Parameter: YMAX -> "1.56192607"
 Parameter: YMIN -> "-5.43807393"
 Parameter: ZMAX -> "-11.5830099"
 Parameter: ZMIN -> "-18.5830099"
 SELRPN>     37 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     18 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      O11           2.5949
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      C1            2.5492
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      C2            2.4254
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      O21           1.9201
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      C21           3.0024
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      C22           3.5386
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      C3            2.7982
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      O31           2.2673
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      C31           3.1758
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      C32           3.3033
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     238      C23           2.8864
53224 NEG      CLA      47       CLA     -**** MEMB     POPC     273      O31           3.8815
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "167"
Evaluating: 167
 Parameter: J <- "167"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "167" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "167"
 Parameter: NPOS -> "120"
Evaluating: 167-120
 Parameter: J <- "47"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.521492156"
Evaluating: 112.065471*(0.521492156-0.5)
 Parameter: XPOS <- "2.40852858"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.605781857"
Evaluating: 112.065471*(0.605781857-0.5)
 Parameter: YPOS <- "11.8544936"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.894750233"
Evaluating: 142.885239*(0.894750233-0.5)+2.93414115
 Parameter: ZPOS <- "59.3381225"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "59.3381225" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "59.3381225" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.726460 XMAX =   47.726460 XAVE =   47.726460
    YMIN =   -1.938074 YMAX =   -1.938074 YAVE =   -1.938074
    ZMIN =  -15.083010 ZMAX =  -15.083010 ZAVE =  -15.083010
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.40852858"
 RDCMND substituted energy or value "?XAVE" to "47.7264602"
Evaluating: 2.40852858-47.7264602
 Parameter: XTRAN <- "-45.3179316"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.8544936"
 RDCMND substituted energy or value "?YAVE" to "-1.93807393"
Evaluating: 11.8544936--1.93807393
 Parameter: YTRAN <- "13.7925675"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "59.3381225"
 RDCMND substituted energy or value "?ZAVE" to "-15.0830099"
Evaluating: 59.3381225--15.0830099
 Parameter: ZTRAN <- "74.4211324"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.3179316"
 Parameter: YTRAN -> "13.7925675"
 Parameter: ZTRAN -> "74.4211324"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -45.317932   13.792568   74.421132
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.100902418"
Evaluating: 0.100902418*360.0
 Parameter: XPHI <- "36.3248705"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.838793576"
Evaluating: 0.838793576*360.0
 Parameter: YPHI <- "301.965687"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.980542932"
Evaluating: 0.980542932*360.0
 Parameter: ZPHI <- "352.995456"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.40852858"
 Parameter: YPOS -> "11.8544936"
 Parameter: ZPOS -> "59.3381225"
 Parameter: XPHI -> "36.3248705"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.805671    0.592363
    0.000000   -0.592363    0.805671

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   36.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.40852858"
 Parameter: YPOS -> "11.8544936"
 Parameter: ZPOS -> "59.3381225"
 Parameter: YPHI -> "301.965687"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.529411    0.000000    0.848365
    0.000000    1.000000    0.000000
   -0.848365    0.000000    0.529411

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   58.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.40852858"
 Parameter: YPOS -> "11.8544936"
 Parameter: ZPOS -> "59.3381225"
 Parameter: ZPHI -> "352.995456"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.992536   -0.121948    0.000000
    0.121948    0.992536    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    7.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.408529 XMAX =    2.408529 XAVE =    2.408529
    YMIN =   11.854494 YMAX =   11.854494 YAVE =   11.854494
    ZMIN =   59.338122 ZMAX =   59.338122 ZAVE =   59.338122
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.40852861"
Evaluating: 2.40852861+3.5
 Parameter: XMAX <- "5.90852861"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.8544936"
Evaluating: 11.8544936+3.5
 Parameter: YMAX <- "15.3544936"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "59.3381225"
Evaluating: 59.3381225+3.5
 Parameter: ZMAX <- "62.8381225"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.40852861"
Evaluating: 2.40852861-3.5
 Parameter: XMIN <- "-1.09147139"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.8544936"
Evaluating: 11.8544936-3.5
 Parameter: YMIN <- "8.3544936"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "59.3381225"
Evaluating: 59.3381225-3.5
 Parameter: ZMIN <- "55.8381225"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.90852861"
 Parameter: XMIN -> "-1.09147139"
 Parameter: YMAX -> "15.3544936"
 Parameter: YMIN -> "8.3544936"
 Parameter: ZMAX -> "62.8381225"
 Parameter: ZMIN -> "55.8381225"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "168"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "168" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "168"
Evaluating: 168
 Parameter: J <- "168"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "168" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "168"
 Parameter: NPOS -> "120"
Evaluating: 168-120
 Parameter: J <- "48"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.304733428"
Evaluating: 112.065471*(0.304733428-0.5)
 Parameter: XPOS <- "-21.8826404"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.359378844"
Evaluating: 112.065471*(0.359378844-0.5)
 Parameter: YPOS <- "-15.7587761"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.540321982"
Evaluating: 142.885239*(0.540321982-0.5)+2.93414115
 Parameter: ZPOS <- "8.69555719"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.69555719" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.69555719" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "168"
Evaluating: 168
 Parameter: J <- "168"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "168" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "168"
 Parameter: NPOS -> "120"
Evaluating: 168-120
 Parameter: J <- "48"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "1.644872476E-02"
Evaluating: 112.065471*(1.644872476E-02-0.5)
 Parameter: XPOS <- "-54.1894014"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.879990356"
Evaluating: 112.065471*(0.879990356-0.5)
 Parameter: YPOS <- "42.5837982"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.708124618"
Evaluating: 142.885239*(0.708124618-0.5)+2.93414115
 Parameter: ZPOS <- "32.6720769"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.6720769" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.6720769" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-54.1894014"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -54.1894014-0
 Parameter: XTRAN <- "-54.1894014"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.5837982"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.5837982-0
 Parameter: YTRAN <- "42.5837982"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.6720769"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.6720769-0
 Parameter: ZTRAN <- "32.6720769"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-54.1894014"
 Parameter: YTRAN -> "42.5837982"
 Parameter: ZTRAN -> "32.6720769"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -54.189401   42.583798   32.672077
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.845367807"
Evaluating: 0.845367807*360.0
 Parameter: XPHI <- "304.332411"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.96312102"
Evaluating: 0.96312102*360.0
 Parameter: YPHI <- "346.723567"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.594081368"
Evaluating: 0.594081368*360.0
 Parameter: ZPHI <- "213.869292"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-54.1894014"
 Parameter: YPOS -> "42.5837982"
 Parameter: ZPOS -> "32.6720769"
 Parameter: XPHI -> "304.332411"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.563993   -0.825779
    0.000000    0.825779    0.563993

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   55.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-54.1894014"
 Parameter: YPOS -> "42.5837982"
 Parameter: ZPOS -> "32.6720769"
 Parameter: YPHI -> "346.723567"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.973273    0.000000    0.229649
    0.000000    1.000000    0.000000
   -0.229649    0.000000    0.973273

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   13.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-54.1894014"
 Parameter: YPOS -> "42.5837982"
 Parameter: ZPOS -> "32.6720769"
 Parameter: ZPHI -> "213.869292"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.830311   -0.557300    0.000000
    0.557300   -0.830311    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  146.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -54.189401 XMAX =  -54.189401 XAVE =  -54.189401
    YMIN =   42.583798 YMAX =   42.583798 YAVE =   42.583798
    ZMIN =   32.672077 ZMAX =   32.672077 ZAVE =   32.672077
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-54.1894014"
Evaluating: -54.1894014+3.5
 Parameter: XMAX <- "-50.6894014"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.5837982"
Evaluating: 42.5837982+3.5
 Parameter: YMAX <- "46.0837982"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.6720769"
Evaluating: 32.6720769+3.5
 Parameter: ZMAX <- "36.1720769"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-54.1894014"
Evaluating: -54.1894014-3.5
 Parameter: XMIN <- "-57.6894014"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.5837982"
Evaluating: 42.5837982-3.5
 Parameter: YMIN <- "39.0837982"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.6720769"
Evaluating: 32.6720769-3.5
 Parameter: ZMIN <- "29.1720769"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-50.6894014"
 Parameter: XMIN -> "-57.6894014"
 Parameter: YMAX -> "46.0837982"
 Parameter: YMIN -> "39.0837982"
 Parameter: ZMAX -> "36.1720769"
 Parameter: ZMIN -> "29.1720769"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "169"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "169" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "169"
Evaluating: 169
 Parameter: J <- "169"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "169" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "169"
 Parameter: NPOS -> "120"
Evaluating: 169-120
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.414355132"
Evaluating: 112.065471*(0.414355132-0.5)
 Parameter: XPOS <- "-9.59783247"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.202620949"
Evaluating: 112.065471*(0.202620949-0.5)
 Parameter: YPOS <- "-33.3259234"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.955844524"
Evaluating: 142.885239*(0.955844524-0.5)+2.93414115
 Parameter: ZPOS <- "68.0675949"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "68.0675949" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "68.0675949" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.59783247"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.59783247-0
 Parameter: XTRAN <- "-9.59783247"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.3259234"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.3259234-0
 Parameter: YTRAN <- "-33.3259234"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "68.0675949"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 68.0675949-0
 Parameter: ZTRAN <- "68.0675949"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.59783247"
 Parameter: YTRAN -> "-33.3259234"
 Parameter: ZTRAN -> "68.0675949"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -9.597832  -33.325923   68.067595
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.44364248"
Evaluating: 0.44364248*360.0
 Parameter: XPHI <- "159.711293"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.903589405"
Evaluating: 0.903589405*360.0
 Parameter: YPHI <- "325.292186"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919746367"
Evaluating: 0.919746367*360.0
 Parameter: ZPHI <- "331.108692"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.59783247"
 Parameter: YPOS -> "-33.3259234"
 Parameter: ZPOS -> "68.0675949"
 Parameter: XPHI -> "159.711293"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.937957    0.346751
    0.000000   -0.346751   -0.937957

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  159.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.59783247"
 Parameter: YPOS -> "-33.3259234"
 Parameter: ZPOS -> "68.0675949"
 Parameter: YPHI -> "325.292186"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.822066    0.000000    0.569392
    0.000000    1.000000    0.000000
   -0.569392    0.000000    0.822066

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   34.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.59783247"
 Parameter: YPOS -> "-33.3259234"
 Parameter: ZPOS -> "68.0675949"
 Parameter: ZPHI -> "331.108692"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.875538   -0.483150    0.000000
    0.483150    0.875538    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.597832 XMAX =   -9.597832 XAVE =   -9.597832
    YMIN =  -33.325923 YMAX =  -33.325923 YAVE =  -33.325923
    ZMIN =   68.067595 ZMAX =   68.067595 ZAVE =   68.067595
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.59783247"
Evaluating: -9.59783247+3.5
 Parameter: XMAX <- "-6.09783247"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.3259234"
Evaluating: -33.3259234+3.5
 Parameter: YMAX <- "-29.8259234"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "68.0675949"
Evaluating: 68.0675949+3.5
 Parameter: ZMAX <- "71.5675949"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.59783247"
Evaluating: -9.59783247-3.5
 Parameter: XMIN <- "-13.0978325"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.3259234"
Evaluating: -33.3259234-3.5
 Parameter: YMIN <- "-36.8259234"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "68.0675949"
Evaluating: 68.0675949-3.5
 Parameter: ZMIN <- "64.5675949"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.09783247"
 Parameter: XMIN -> "-13.0978325"
 Parameter: YMAX -> "-29.8259234"
 Parameter: YMIN -> "-36.8259234"
 Parameter: ZMAX -> "71.5675949"
 Parameter: ZMIN -> "64.5675949"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "170"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "170" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "170"
Evaluating: 170
 Parameter: J <- "170"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "170" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "170"
 Parameter: NPOS -> "120"
Evaluating: 170-120
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.785923535"
Evaluating: 112.065471*(0.785923535-0.5)
 Parameter: XPOS <- "32.0421556"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.571308806"
Evaluating: 112.065471*(0.571308806-0.5)
 Parameter: YPOS <- "7.99125493"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.177557894"
Evaluating: 142.885239*(0.177557894-0.5)+2.93414115
 Parameter: ZPOS <- "-43.1380762"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.1380762" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.0421556"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.0421556-0
 Parameter: XTRAN <- "32.0421556"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.99125493"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.99125493-0
 Parameter: YTRAN <- "7.99125493"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.1380762"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.1380762-0
 Parameter: ZTRAN <- "-43.1380762"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.0421556"
 Parameter: YTRAN -> "7.99125493"
 Parameter: ZTRAN -> "-43.1380762"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    32.042156    7.991255  -43.138076
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.546351266"
Evaluating: 0.546351266*360.0
 Parameter: XPHI <- "196.686456"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.994657736"
Evaluating: 0.994657736*360.0
 Parameter: YPHI <- "358.076785"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.250433333"
Evaluating: 0.250433333*360.0
 Parameter: ZPHI <- "90.1559999"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.0421556"
 Parameter: YPOS -> "7.99125493"
 Parameter: ZPOS -> "-43.1380762"
 Parameter: XPHI -> "196.686456"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.957890   -0.287134
    0.000000    0.287134   -0.957890

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  163.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.0421556"
 Parameter: YPOS -> "7.99125493"
 Parameter: ZPOS -> "-43.1380762"
 Parameter: YPHI -> "358.076785"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.999437    0.000000    0.033560
    0.000000    1.000000    0.000000
   -0.033560    0.000000    0.999437

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    1.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.0421556"
 Parameter: YPOS -> "7.99125493"
 Parameter: ZPOS -> "-43.1380762"
 Parameter: ZPHI -> "90.1559999"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.002723    0.999996    0.000000
   -0.999996   -0.002723    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   90.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.042156 XMAX =   32.042156 XAVE =   32.042156
    YMIN =    7.991255 YMAX =    7.991255 YAVE =    7.991255
    ZMIN =  -43.138076 ZMAX =  -43.138076 ZAVE =  -43.138076
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.0421556"
Evaluating: 32.0421556+3.5
 Parameter: XMAX <- "35.5421556"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.99125493"
Evaluating: 7.99125493+3.5
 Parameter: YMAX <- "11.4912549"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.1380762"
Evaluating: -43.1380762+3.5
 Parameter: ZMAX <- "-39.6380762"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.0421556"
Evaluating: 32.0421556-3.5
 Parameter: XMIN <- "28.5421556"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.99125493"
Evaluating: 7.99125493-3.5
 Parameter: YMIN <- "4.49125493"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.1380762"
Evaluating: -43.1380762-3.5
 Parameter: ZMIN <- "-46.6380762"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.5421556"
 Parameter: XMIN -> "28.5421556"
 Parameter: YMAX -> "11.4912549"
 Parameter: YMIN -> "4.49125493"
 Parameter: ZMAX -> "-39.6380762"
 Parameter: ZMIN -> "-46.6380762"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "171"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "171" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "171"
Evaluating: 171
 Parameter: J <- "171"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "171" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "171"
 Parameter: NPOS -> "120"
Evaluating: 171-120
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.366445093E-02"
Evaluating: 112.065471*(7.366445093E-02-0.5)
 Parameter: XPOS <- "-47.7774941"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.264661561"
Evaluating: 112.065471*(0.264661561-0.5)
 Parameter: YPOS <- "-26.373313"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.87290989"
Evaluating: 142.885239*(0.87290989-0.5)+2.93414115
 Parameter: ZPOS <- "56.2174599"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.2174599" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.2174599" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.7774941"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.7774941-0
 Parameter: XTRAN <- "-47.7774941"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.373313"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.373313-0
 Parameter: YTRAN <- "-26.373313"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.2174599"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 56.2174599-0
 Parameter: ZTRAN <- "56.2174599"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.7774941"
 Parameter: YTRAN -> "-26.373313"
 Parameter: ZTRAN -> "56.2174599"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -47.777494  -26.373313   56.217460
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.476994553"
Evaluating: 0.476994553*360.0
 Parameter: XPHI <- "171.718039"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.11341284"
Evaluating: 0.11341284*360.0
 Parameter: YPHI <- "40.8286224"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.662409266"
Evaluating: 0.662409266*360.0
 Parameter: ZPHI <- "238.467336"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.7774941"
 Parameter: YPOS -> "-26.373313"
 Parameter: ZPOS -> "56.2174599"
 Parameter: XPHI -> "171.718039"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.989571    0.144045
    0.000000   -0.144045   -0.989571

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  171.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.7774941"
 Parameter: YPOS -> "-26.373313"
 Parameter: ZPOS -> "56.2174599"
 Parameter: YPHI -> "40.8286224"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.756669    0.000000   -0.653799
    0.000000    1.000000    0.000000
    0.653799    0.000000    0.756669

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   40.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.7774941"
 Parameter: YPOS -> "-26.373313"
 Parameter: ZPOS -> "56.2174599"
 Parameter: ZPHI -> "238.467336"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.522985   -0.852342    0.000000
    0.852342   -0.522985    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  121.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.777494 XMAX =  -47.777494 XAVE =  -47.777494
    YMIN =  -26.373313 YMAX =  -26.373313 YAVE =  -26.373313
    ZMIN =   56.217460 ZMAX =   56.217460 ZAVE =   56.217460
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.7774941"
Evaluating: -47.7774941+3.5
 Parameter: XMAX <- "-44.2774941"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.373313"
Evaluating: -26.373313+3.5
 Parameter: YMAX <- "-22.873313"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.2174599"
Evaluating: 56.2174599+3.5
 Parameter: ZMAX <- "59.7174599"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.7774941"
Evaluating: -47.7774941-3.5
 Parameter: XMIN <- "-51.2774941"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.373313"
Evaluating: -26.373313-3.5
 Parameter: YMIN <- "-29.873313"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.2174599"
Evaluating: 56.2174599-3.5
 Parameter: ZMIN <- "52.7174599"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.2774941"
 Parameter: XMIN -> "-51.2774941"
 Parameter: YMAX -> "-22.873313"
 Parameter: YMIN -> "-29.873313"
 Parameter: ZMAX -> "59.7174599"
 Parameter: ZMIN -> "52.7174599"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "172"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "172" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "172"
Evaluating: 172
 Parameter: J <- "172"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "172" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "172"
 Parameter: NPOS -> "120"
Evaluating: 172-120
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.144093884"
Evaluating: 112.065471*(0.144093884-0.5)
 Parameter: XPOS <- "-39.8847865"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.257551146"
Evaluating: 112.065471*(0.257551146-0.5)
 Parameter: YPOS <- "-27.170145"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.371295526"
Evaluating: 142.885239*(0.371295526-0.5)+2.93414115
 Parameter: ZPOS <- "-15.4558284"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.4558284" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.8847865"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.8847865-0
 Parameter: XTRAN <- "-39.8847865"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.170145"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.170145-0
 Parameter: YTRAN <- "-27.170145"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.4558284"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.4558284-0
 Parameter: ZTRAN <- "-15.4558284"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.8847865"
 Parameter: YTRAN -> "-27.170145"
 Parameter: ZTRAN -> "-15.4558284"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -39.884786  -27.170145  -15.455828
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.321625059"
Evaluating: 0.321625059*360.0
 Parameter: XPHI <- "115.785021"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.891586278"
Evaluating: 0.891586278*360.0
 Parameter: YPHI <- "320.97106"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.844915062"
Evaluating: 0.844915062*360.0
 Parameter: ZPHI <- "304.169422"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.8847865"
 Parameter: YPOS -> "-27.170145"
 Parameter: ZPOS -> "-15.4558284"
 Parameter: XPHI -> "115.785021"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.434996    0.900433
    0.000000   -0.900433   -0.434996

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.8847865"
 Parameter: YPOS -> "-27.170145"
 Parameter: ZPOS -> "-15.4558284"
 Parameter: YPHI -> "320.97106"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.776828    0.000000    0.629713
    0.000000    1.000000    0.000000
   -0.629713    0.000000    0.776828

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.8847865"
 Parameter: YPOS -> "-27.170145"
 Parameter: ZPOS -> "-15.4558284"
 Parameter: ZPHI -> "304.169422"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.561642   -0.827380    0.000000
    0.827380    0.561642    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   55.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.884786 XMAX =  -39.884786 XAVE =  -39.884786
    YMIN =  -27.170145 YMAX =  -27.170145 YAVE =  -27.170145
    ZMIN =  -15.455828 ZMAX =  -15.455828 ZAVE =  -15.455828
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.8847865"
Evaluating: -39.8847865+3.5
 Parameter: XMAX <- "-36.3847865"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.170145"
Evaluating: -27.170145+3.5
 Parameter: YMAX <- "-23.670145"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.4558284"
Evaluating: -15.4558284+3.5
 Parameter: ZMAX <- "-11.9558284"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.8847865"
Evaluating: -39.8847865-3.5
 Parameter: XMIN <- "-43.3847865"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.170145"
Evaluating: -27.170145-3.5
 Parameter: YMIN <- "-30.670145"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.4558284"
Evaluating: -15.4558284-3.5
 Parameter: ZMIN <- "-18.9558284"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.3847865"
 Parameter: XMIN -> "-43.3847865"
 Parameter: YMAX -> "-23.670145"
 Parameter: YMIN -> "-30.670145"
 Parameter: ZMAX -> "-11.9558284"
 Parameter: ZMIN -> "-18.9558284"
 SELRPN>     25 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     13 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53229 NEG      CLA      52       CLA     -**** MEMB     POPC     234      C3            3.4485
53229 NEG      CLA      52       CLA     -**** MEMB     POPC     234      C31           3.5674
53229 NEG      CLA      52       CLA     -**** MEMB     POPC     234      O32           2.6551
53229 NEG      CLA      52       CLA     -**** MEMB     POPC     250      O11           3.5749
53229 NEG      CLA      52       CLA     -**** MEMB     POPC     250      C1            3.1276
53229 NEG      CLA      52       CLA     -**** MEMB     POPC     250      C2            3.5037
53229 NEG      CLA      52       CLA     -**** MEMB     POPC     250      C3            2.8405
53229 NEG      CLA      52       CLA     -**** MEMB     POPC     250      O31           3.1648
53229 NEG      CLA      52       CLA     -**** MEMB     POPC     250      C31           3.7166
53229 NEG      CLA      52       CLA     -**** MEMB     POPC     250      O32           3.8008
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "172"
Evaluating: 172
 Parameter: J <- "172"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "172" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "172"
 Parameter: NPOS -> "120"
Evaluating: 172-120
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.481344493"
Evaluating: 112.065471*(0.481344493-0.5)
 Parameter: XPOS <- "-2.09063818"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.4458038"
Evaluating: 112.065471*(0.4458038-0.5)
 Parameter: YPOS <- "-6.07352268"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.102643347"
Evaluating: 142.885239*(0.102643347-0.5)+2.93414115
 Parameter: ZPOS <- "-53.8422592"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.8422592" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.884786 XMAX =  -39.884786 XAVE =  -39.884786
    YMIN =  -27.170145 YMAX =  -27.170145 YAVE =  -27.170145
    ZMIN =  -15.455828 ZMAX =  -15.455828 ZAVE =  -15.455828
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.09063818"
 RDCMND substituted energy or value "?XAVE" to "-39.8847865"
Evaluating: -2.09063818--39.8847865
 Parameter: XTRAN <- "37.7941483"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.07352268"
 RDCMND substituted energy or value "?YAVE" to "-27.170145"
Evaluating: -6.07352268--27.170145
 Parameter: YTRAN <- "21.0966223"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.8422592"
 RDCMND substituted energy or value "?ZAVE" to "-15.4558284"
Evaluating: -53.8422592--15.4558284
 Parameter: ZTRAN <- "-38.3864308"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.7941483"
 Parameter: YTRAN -> "21.0966223"
 Parameter: ZTRAN -> "-38.3864308"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    37.794148   21.096622  -38.386431
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.160724834"
Evaluating: 0.160724834*360.0
 Parameter: XPHI <- "57.8609402"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.281199569"
Evaluating: 0.281199569*360.0
 Parameter: YPHI <- "101.231845"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.274941004"
Evaluating: 0.274941004*360.0
 Parameter: ZPHI <- "98.9787614"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.09063818"
 Parameter: YPOS -> "-6.07352268"
 Parameter: ZPOS -> "-53.8422592"
 Parameter: XPHI -> "57.8609402"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.531976    0.846759
    0.000000   -0.846759    0.531976

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   57.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.09063818"
 Parameter: YPOS -> "-6.07352268"
 Parameter: ZPOS -> "-53.8422592"
 Parameter: YPHI -> "101.231845"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.194780    0.000000   -0.980847
    0.000000    1.000000    0.000000
    0.980847    0.000000   -0.194780

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  101.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.09063818"
 Parameter: YPOS -> "-6.07352268"
 Parameter: ZPOS -> "-53.8422592"
 Parameter: ZPHI -> "98.9787614"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.156068    0.987746    0.000000
   -0.987746   -0.156068    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   98.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.090638 XMAX =   -2.090638 XAVE =   -2.090638
    YMIN =   -6.073523 YMAX =   -6.073523 YAVE =   -6.073523
    ZMIN =  -53.842259 ZMAX =  -53.842259 ZAVE =  -53.842259
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.09063819"
Evaluating: -2.09063819+3.5
 Parameter: XMAX <- "1.40936181"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.07352267"
Evaluating: -6.07352267+3.5
 Parameter: YMAX <- "-2.57352267"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.8422592"
Evaluating: -53.8422592+3.5
 Parameter: ZMAX <- "-50.3422592"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.09063819"
Evaluating: -2.09063819-3.5
 Parameter: XMIN <- "-5.59063819"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.07352267"
Evaluating: -6.07352267-3.5
 Parameter: YMIN <- "-9.57352267"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.8422592"
Evaluating: -53.8422592-3.5
 Parameter: ZMIN <- "-57.3422592"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.40936181"
 Parameter: XMIN -> "-5.59063819"
 Parameter: YMAX -> "-2.57352267"
 Parameter: YMIN -> "-9.57352267"
 Parameter: ZMAX -> "-50.3422592"
 Parameter: ZMIN -> "-57.3422592"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "173"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "173" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "173"
Evaluating: 173
 Parameter: J <- "173"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "173" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "173"
 Parameter: NPOS -> "120"
Evaluating: 173-120
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.345371679"
Evaluating: 112.065471*(0.345371679-0.5)
 Parameter: XPOS <- "-17.3284956"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.181686391"
Evaluating: 112.065471*(0.181686391-0.5)
 Parameter: YPOS <- "-35.6719645"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.486553483"
Evaluating: 142.885239*(0.486553483-0.5)+2.93414115
 Parameter: ZPOS <- "1.01283235"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.01283235" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.01283235" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "173"
Evaluating: 173
 Parameter: J <- "173"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "173" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "173"
 Parameter: NPOS -> "120"
Evaluating: 173-120
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.906135243"
Evaluating: 112.065471*(0.906135243-0.5)
 Parameter: XPOS <- "45.5137373"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.106745202E-02"
Evaluating: 112.065471*(4.106745202E-02-0.5)
 Parameter: YPOS <- "-51.4304921"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.728767887"
Evaluating: 142.885239*(0.728767887-0.5)+2.93414115
 Parameter: ZPOS <- "35.6216954"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.6216954" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.6216954" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.5137373"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.5137373-0
 Parameter: XTRAN <- "45.5137373"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-51.4304921"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -51.4304921-0
 Parameter: YTRAN <- "-51.4304921"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.6216954"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.6216954-0
 Parameter: ZTRAN <- "35.6216954"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.5137373"
 Parameter: YTRAN -> "-51.4304921"
 Parameter: ZTRAN -> "35.6216954"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    45.513737  -51.430492   35.621695
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.473645477"
Evaluating: 0.473645477*360.0
 Parameter: XPHI <- "170.512372"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926174681"
Evaluating: 0.926174681*360.0
 Parameter: YPHI <- "333.422885"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.330040933"
Evaluating: 0.330040933*360.0
 Parameter: ZPHI <- "118.814736"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.5137373"
 Parameter: YPOS -> "-51.4304921"
 Parameter: ZPOS -> "35.6216954"
 Parameter: XPHI -> "170.512372"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.986321    0.164835
    0.000000   -0.164835   -0.986321

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  170.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.5137373"
 Parameter: YPOS -> "-51.4304921"
 Parameter: ZPOS -> "35.6216954"
 Parameter: YPHI -> "333.422885"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.894333    0.000000    0.447402
    0.000000    1.000000    0.000000
   -0.447402    0.000000    0.894333

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   26.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.5137373"
 Parameter: YPOS -> "-51.4304921"
 Parameter: ZPOS -> "35.6216954"
 Parameter: ZPHI -> "118.814736"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.481979    0.876183    0.000000
   -0.876183   -0.481979    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  118.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.513737 XMAX =   45.513737 XAVE =   45.513737
    YMIN =  -51.430492 YMAX =  -51.430492 YAVE =  -51.430492
    ZMIN =   35.621695 ZMAX =   35.621695 ZAVE =   35.621695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.5137373"
Evaluating: 45.5137373+3.5
 Parameter: XMAX <- "49.0137373"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-51.4304921"
Evaluating: -51.4304921+3.5
 Parameter: YMAX <- "-47.9304921"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.6216954"
Evaluating: 35.6216954+3.5
 Parameter: ZMAX <- "39.1216954"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.5137373"
Evaluating: 45.5137373-3.5
 Parameter: XMIN <- "42.0137373"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-51.4304921"
Evaluating: -51.4304921-3.5
 Parameter: YMIN <- "-54.9304921"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.6216954"
Evaluating: 35.6216954-3.5
 Parameter: ZMIN <- "32.1216954"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.0137373"
 Parameter: XMIN -> "42.0137373"
 Parameter: YMAX -> "-47.9304921"
 Parameter: YMIN -> "-54.9304921"
 Parameter: ZMAX -> "39.1216954"
 Parameter: ZMIN -> "32.1216954"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "174"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "174" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "174"
Evaluating: 174
 Parameter: J <- "174"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "174" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "174"
 Parameter: NPOS -> "120"
Evaluating: 174-120
 Parameter: J <- "54"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.360784391"
Evaluating: 112.065471*(0.360784391-0.5)
 Parameter: XPOS <- "-15.6012628"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "2.783137952E-03"
Evaluating: 112.065471*(2.783137952E-03-0.5)
 Parameter: YPOS <- "-55.7208418"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.617719736"
Evaluating: 142.885239*(0.617719736-0.5)+2.93414115
 Parameter: ZPOS <- "19.7545538"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.7545538" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.7545538" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-15.6012628"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -15.6012628-0
 Parameter: XTRAN <- "-15.6012628"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-55.7208418"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -55.7208418-0
 Parameter: YTRAN <- "-55.7208418"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.7545538"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.7545538-0
 Parameter: ZTRAN <- "19.7545538"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.6012628"
 Parameter: YTRAN -> "-55.7208418"
 Parameter: ZTRAN -> "19.7545538"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -15.601263  -55.720842   19.754554
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.640085293"
Evaluating: 0.640085293*360.0
 Parameter: XPHI <- "230.430705"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.811782167"
Evaluating: 0.811782167*360.0
 Parameter: YPHI <- "292.24158"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.70826196"
Evaluating: 0.70826196*360.0
 Parameter: ZPHI <- "254.974306"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-15.6012628"
 Parameter: YPOS -> "-55.7208418"
 Parameter: ZPOS -> "19.7545538"
 Parameter: XPHI -> "230.430705"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.637011   -0.770855
    0.000000    0.770855   -0.637011

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-15.6012628"
 Parameter: YPOS -> "-55.7208418"
 Parameter: ZPOS -> "19.7545538"
 Parameter: YPHI -> "292.24158"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.378513    0.000000    0.925596
    0.000000    1.000000    0.000000
   -0.925596    0.000000    0.378513

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   67.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-15.6012628"
 Parameter: YPOS -> "-55.7208418"
 Parameter: ZPOS -> "19.7545538"
 Parameter: ZPHI -> "254.974306"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.259252   -0.965810    0.000000
    0.965810   -0.259252    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  105.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.601263 XMAX =  -15.601263 XAVE =  -15.601263
    YMIN =  -55.720842 YMAX =  -55.720842 YAVE =  -55.720842
    ZMIN =   19.754554 ZMAX =   19.754554 ZAVE =   19.754554
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-15.6012628"
Evaluating: -15.6012628+3.5
 Parameter: XMAX <- "-12.1012628"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-55.7208418"
Evaluating: -55.7208418+3.5
 Parameter: YMAX <- "-52.2208418"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.7545538"
Evaluating: 19.7545538+3.5
 Parameter: ZMAX <- "23.2545538"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-15.6012628"
Evaluating: -15.6012628-3.5
 Parameter: XMIN <- "-19.1012628"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-55.7208418"
Evaluating: -55.7208418-3.5
 Parameter: YMIN <- "-59.2208418"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.7545538"
Evaluating: 19.7545538-3.5
 Parameter: ZMIN <- "16.2545538"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.1012628"
 Parameter: XMIN -> "-19.1012628"
 Parameter: YMAX -> "-52.2208418"
 Parameter: YMIN -> "-59.2208418"
 Parameter: ZMAX -> "23.2545538"
 Parameter: ZMIN -> "16.2545538"
 SELRPN>     11 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      5 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53231 NEG      CLA      54       CLA     -**** MEMB     POPC     103      N             3.8592
53231 NEG      CLA      54       CLA     -**** MEMB     POPC     103      C12           2.9113
53231 NEG      CLA      54       CLA     -**** MEMB     POPC     103      C11           3.3229
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "174"
Evaluating: 174
 Parameter: J <- "174"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "174" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "174"
 Parameter: NPOS -> "120"
Evaluating: 174-120
 Parameter: J <- "54"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.45029455"
Evaluating: 112.065471*(0.45029455-0.5)
 Parameter: XPOS <- "-5.57026467"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.104320833"
Evaluating: 112.065471*(0.104320833-0.5)
 Parameter: YPOS <- "-44.3419722"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.401403817"
Evaluating: 142.885239*(0.401403817-0.5)+2.93414115
 Parameter: ZPOS <- "-11.153798"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.153798" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.153798" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "174"
Evaluating: 174
 Parameter: J <- "174"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "174" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "174"
 Parameter: NPOS -> "120"
Evaluating: 174-120
 Parameter: J <- "54"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.711501072"
Evaluating: 112.065471*(0.711501072-0.5)
 Parameter: XPOS <- "23.7019673"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.369454046"
Evaluating: 112.065471*(0.369454046-0.5)
 Parameter: YPOS <- "-14.6296938"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.212940912"
Evaluating: 142.885239*(0.212940912-0.5)+2.93414115
 Parameter: ZPOS <- "-38.0823652"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.0823652" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.601263 XMAX =  -15.601263 XAVE =  -15.601263
    YMIN =  -55.720842 YMAX =  -55.720842 YAVE =  -55.720842
    ZMIN =   19.754554 ZMAX =   19.754554 ZAVE =   19.754554
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.7019673"
 RDCMND substituted energy or value "?XAVE" to "-15.6012628"
Evaluating: 23.7019673--15.6012628
 Parameter: XTRAN <- "39.3032301"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.6296938"
 RDCMND substituted energy or value "?YAVE" to "-55.7208418"
Evaluating: -14.6296938--55.7208418
 Parameter: YTRAN <- "41.091148"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.0823652"
 RDCMND substituted energy or value "?ZAVE" to "19.7545538"
Evaluating: -38.0823652-19.7545538
 Parameter: ZTRAN <- "-57.836919"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.3032301"
 Parameter: YTRAN -> "41.091148"
 Parameter: ZTRAN -> "-57.836919"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    39.303230   41.091148  -57.836919
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.675355115"
Evaluating: 0.675355115*360.0
 Parameter: XPHI <- "243.127841"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.13158851"
Evaluating: 0.13158851*360.0
 Parameter: YPHI <- "47.3718636"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.533683663"
Evaluating: 0.533683663*360.0
 Parameter: ZPHI <- "192.126119"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.7019673"
 Parameter: YPOS -> "-14.6296938"
 Parameter: ZPOS -> "-38.0823652"
 Parameter: XPHI -> "243.127841"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.452001   -0.892017
    0.000000    0.892017   -0.452001

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  116.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.7019673"
 Parameter: YPOS -> "-14.6296938"
 Parameter: ZPOS -> "-38.0823652"
 Parameter: YPHI -> "47.3718636"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.677237    0.000000   -0.735765
    0.000000    1.000000    0.000000
    0.735765    0.000000    0.677237

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   47.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.7019673"
 Parameter: YPOS -> "-14.6296938"
 Parameter: ZPOS -> "-38.0823652"
 Parameter: ZPHI -> "192.126119"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.977688   -0.210064    0.000000
    0.210064   -0.977688    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  167.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.701967 XMAX =   23.701967 XAVE =   23.701967
    YMIN =  -14.629694 YMAX =  -14.629694 YAVE =  -14.629694
    ZMIN =  -38.082365 ZMAX =  -38.082365 ZAVE =  -38.082365
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.7019673"
Evaluating: 23.7019673+3.5
 Parameter: XMAX <- "27.2019673"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.6296938"
Evaluating: -14.6296938+3.5
 Parameter: YMAX <- "-11.1296938"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.0823652"
Evaluating: -38.0823652+3.5
 Parameter: ZMAX <- "-34.5823652"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.7019673"
Evaluating: 23.7019673-3.5
 Parameter: XMIN <- "20.2019673"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.6296938"
Evaluating: -14.6296938-3.5
 Parameter: YMIN <- "-18.1296938"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.0823652"
Evaluating: -38.0823652-3.5
 Parameter: ZMIN <- "-41.5823652"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.2019673"
 Parameter: XMIN -> "20.2019673"
 Parameter: YMAX -> "-11.1296938"
 Parameter: YMIN -> "-18.1296938"
 Parameter: ZMAX -> "-34.5823652"
 Parameter: ZMIN -> "-41.5823652"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "175"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "175" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "175"
Evaluating: 175
 Parameter: J <- "175"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "175" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "175"
 Parameter: NPOS -> "120"
Evaluating: 175-120
 Parameter: J <- "55"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.655671489"
Evaluating: 112.065471*(0.655671489-0.5)
 Parameter: XPOS <- "17.4453987"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.777888548"
Evaluating: 112.065471*(0.777888548-0.5)
 Parameter: YPOS <- "31.141711"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.721147446"
Evaluating: 142.885239*(0.721147446-0.5)+2.93414115
 Parameter: ZPOS <- "34.5328468"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.5328468" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.5328468" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.4453987"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.4453987-0
 Parameter: XTRAN <- "17.4453987"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.141711"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.141711-0
 Parameter: YTRAN <- "31.141711"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.5328468"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.5328468-0
 Parameter: ZTRAN <- "34.5328468"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.4453987"
 Parameter: YTRAN -> "31.141711"
 Parameter: ZTRAN -> "34.5328468"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    17.445399   31.141711   34.532847
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720040094"
Evaluating: 0.720040094*360.0
 Parameter: XPHI <- "259.214434"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.767195776"
Evaluating: 0.767195776*360.0
 Parameter: YPHI <- "276.190479"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.940873232"
Evaluating: 0.940873232*360.0
 Parameter: ZPHI <- "338.714364"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.4453987"
 Parameter: YPOS -> "31.141711"
 Parameter: ZPOS -> "34.5328468"
 Parameter: XPHI -> "259.214434"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.187134   -0.982334
    0.000000    0.982334   -0.187134

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.4453987"
 Parameter: YPOS -> "31.141711"
 Parameter: ZPOS -> "34.5328468"
 Parameter: YPHI -> "276.190479"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.107834    0.000000    0.994169
    0.000000    1.000000    0.000000
   -0.994169    0.000000    0.107834

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   83.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.4453987"
 Parameter: YPOS -> "31.141711"
 Parameter: ZPOS -> "34.5328468"
 Parameter: ZPHI -> "338.714364"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.931782   -0.363018    0.000000
    0.363018    0.931782    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   21.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.445399 XMAX =   17.445399 XAVE =   17.445399
    YMIN =   31.141711 YMAX =   31.141711 YAVE =   31.141711
    ZMIN =   34.532847 ZMAX =   34.532847 ZAVE =   34.532847
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.4453987"
Evaluating: 17.4453987+3.5
 Parameter: XMAX <- "20.9453987"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.141711"
Evaluating: 31.141711+3.5
 Parameter: YMAX <- "34.641711"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.5328468"
Evaluating: 34.5328468+3.5
 Parameter: ZMAX <- "38.0328468"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.4453987"
Evaluating: 17.4453987-3.5
 Parameter: XMIN <- "13.9453987"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.141711"
Evaluating: 31.141711-3.5
 Parameter: YMIN <- "27.641711"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.5328468"
Evaluating: 34.5328468-3.5
 Parameter: ZMIN <- "31.0328468"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.9453987"
 Parameter: XMIN -> "13.9453987"
 Parameter: YMAX -> "34.641711"
 Parameter: YMIN -> "27.641711"
 Parameter: ZMAX -> "38.0328468"
 Parameter: ZMIN -> "31.0328468"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "176"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "176" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "176"
Evaluating: 176
 Parameter: J <- "176"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "176" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "176"
 Parameter: NPOS -> "120"
Evaluating: 176-120
 Parameter: J <- "56"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.313917997E-02"
Evaluating: 112.065471*(5.313917997E-02-0.5)
 Parameter: XPOS <- "-50.0776683"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "1.031751798E-02"
Evaluating: 112.065471*(1.031751798E-02-0.5)
 Parameter: YPOS <- "-54.876498"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "3.593655737E-02"
Evaluating: 142.885239*(3.593655737E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-63.3736748"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-63.3736748" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.0776683"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -50.0776683-0
 Parameter: XTRAN <- "-50.0776683"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-54.876498"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -54.876498-0
 Parameter: YTRAN <- "-54.876498"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-63.3736748"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -63.3736748-0
 Parameter: ZTRAN <- "-63.3736748"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.0776683"
 Parameter: YTRAN -> "-54.876498"
 Parameter: ZTRAN -> "-63.3736748"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -50.077668  -54.876498  -63.373675
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.395920764"
Evaluating: 0.395920764*360.0
 Parameter: XPHI <- "142.531475"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.822630554"
Evaluating: 0.822630554*360.0
 Parameter: YPHI <- "296.146999"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.408623747"
Evaluating: 0.408623747*360.0
 Parameter: ZPHI <- "147.104549"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.0776683"
 Parameter: YPOS -> "-54.876498"
 Parameter: ZPOS -> "-63.3736748"
 Parameter: XPHI -> "142.531475"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.793688    0.608326
    0.000000   -0.608326   -0.793688

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  142.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.0776683"
 Parameter: YPOS -> "-54.876498"
 Parameter: ZPOS -> "-63.3736748"
 Parameter: YPHI -> "296.146999"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.440676    0.000000    0.897666
    0.000000    1.000000    0.000000
   -0.897666    0.000000    0.440676

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   63.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.0776683"
 Parameter: YPOS -> "-54.876498"
 Parameter: ZPOS -> "-63.3736748"
 Parameter: ZPHI -> "147.104549"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.839663    0.543108    0.000000
   -0.543108   -0.839663    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  147.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.077668 XMAX =  -50.077668 XAVE =  -50.077668
    YMIN =  -54.876498 YMAX =  -54.876498 YAVE =  -54.876498
    ZMIN =  -63.373675 ZMAX =  -63.373675 ZAVE =  -63.373675
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.0776683"
Evaluating: -50.0776683+3.5
 Parameter: XMAX <- "-46.5776683"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-54.876498"
Evaluating: -54.876498+3.5
 Parameter: YMAX <- "-51.376498"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-63.3736748"
Evaluating: -63.3736748+3.5
 Parameter: ZMAX <- "-59.8736748"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.0776683"
Evaluating: -50.0776683-3.5
 Parameter: XMIN <- "-53.5776683"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-54.876498"
Evaluating: -54.876498-3.5
 Parameter: YMIN <- "-58.376498"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-63.3736748"
Evaluating: -63.3736748-3.5
 Parameter: ZMIN <- "-66.8736748"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.5776683"
 Parameter: XMIN -> "-53.5776683"
 Parameter: YMAX -> "-51.376498"
 Parameter: YMIN -> "-58.376498"
 Parameter: ZMAX -> "-59.8736748"
 Parameter: ZMIN -> "-66.8736748"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "177"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "177" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "177"
Evaluating: 177
 Parameter: J <- "177"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "177" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "177"
 Parameter: NPOS -> "120"
Evaluating: 177-120
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.300827319"
Evaluating: 112.065471*(0.300827319-0.5)
 Parameter: XPOS <- "-22.3203803"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.519852182"
Evaluating: 112.065471*(0.519852182-0.5)
 Parameter: YPOS <- "2.22474413"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.537213092"
Evaluating: 142.885239*(0.537213092-0.5)+2.93414115
 Parameter: ZPOS <- "8.25134269"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.25134269" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.25134269" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "177"
Evaluating: 177
 Parameter: J <- "177"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "177" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "177"
 Parameter: NPOS -> "120"
Evaluating: 177-120
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.596020886"
Evaluating: 112.065471*(0.596020886-0.5)
 Parameter: XPOS <- "10.7606258"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.975240807"
Evaluating: 112.065471*(0.975240807-0.5)
 Parameter: YPOS <- "53.2580849"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.735353641"
Evaluating: 142.885239*(0.735353641-0.5)+2.93414115
 Parameter: ZPOS <- "36.5627024"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.5627024" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.5627024" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.7606258"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.7606258-0
 Parameter: XTRAN <- "10.7606258"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "53.2580849"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 53.2580849-0
 Parameter: YTRAN <- "53.2580849"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.5627024"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.5627024-0
 Parameter: ZTRAN <- "36.5627024"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.7606258"
 Parameter: YTRAN -> "53.2580849"
 Parameter: ZTRAN -> "36.5627024"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    10.760626   53.258085   36.562702
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382559124"
Evaluating: 0.382559124*360.0
 Parameter: XPHI <- "137.721285"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.304952923"
Evaluating: 0.304952923*360.0
 Parameter: YPHI <- "109.783052"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.635162933"
Evaluating: 0.635162933*360.0
 Parameter: ZPHI <- "228.658656"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.7606258"
 Parameter: YPOS -> "53.2580849"
 Parameter: ZPOS -> "36.5627024"
 Parameter: XPHI -> "137.721285"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.739881    0.672738
    0.000000   -0.672738   -0.739881

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.7606258"
 Parameter: YPOS -> "53.2580849"
 Parameter: ZPOS -> "36.5627024"
 Parameter: YPHI -> "109.783052"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.338460    0.000000   -0.940981
    0.000000    1.000000    0.000000
    0.940981    0.000000   -0.338460

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.7606258"
 Parameter: YPOS -> "53.2580849"
 Parameter: ZPOS -> "36.5627024"
 Parameter: ZPHI -> "228.658656"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.660544   -0.750788    0.000000
    0.750788   -0.660544    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  131.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.760626 XMAX =   10.760626 XAVE =   10.760626
    YMIN =   53.258085 YMAX =   53.258085 YAVE =   53.258085
    ZMIN =   36.562702 ZMAX =   36.562702 ZAVE =   36.562702
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.7606258"
Evaluating: 10.7606258+3.5
 Parameter: XMAX <- "14.2606258"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "53.2580849"
Evaluating: 53.2580849+3.5
 Parameter: YMAX <- "56.7580849"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.5627024"
Evaluating: 36.5627024+3.5
 Parameter: ZMAX <- "40.0627024"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.7606258"
Evaluating: 10.7606258-3.5
 Parameter: XMIN <- "7.2606258"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "53.2580849"
Evaluating: 53.2580849-3.5
 Parameter: YMIN <- "49.7580849"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.5627024"
Evaluating: 36.5627024-3.5
 Parameter: ZMIN <- "33.0627024"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.2606258"
 Parameter: XMIN -> "7.2606258"
 Parameter: YMAX -> "56.7580849"
 Parameter: YMIN -> "49.7580849"
 Parameter: ZMAX -> "40.0627024"
 Parameter: ZMIN -> "33.0627024"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "178"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "178" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "178"
Evaluating: 178
 Parameter: J <- "178"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "178" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "178"
 Parameter: NPOS -> "120"
Evaluating: 178-120
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.114540869"
Evaluating: 112.065471*(0.114540869-0.5)
 Parameter: XPOS <- "-43.1966591"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.990064823"
Evaluating: 112.065471*(0.990064823-0.5)
 Parameter: YPOS <- "54.9193452"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "4.899444447E-02"
Evaluating: 142.885239*(4.899444447E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-61.5078954"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-61.5078954" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.1966591"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.1966591-0
 Parameter: XTRAN <- "-43.1966591"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "54.9193452"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 54.9193452-0
 Parameter: YTRAN <- "54.9193452"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-61.5078954"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -61.5078954-0
 Parameter: ZTRAN <- "-61.5078954"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.1966591"
 Parameter: YTRAN -> "54.9193452"
 Parameter: ZTRAN -> "-61.5078954"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -43.196659   54.919345  -61.507895
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.555938374"
Evaluating: 0.555938374*360.0
 Parameter: XPHI <- "200.137815"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.147382388"
Evaluating: 0.147382388*360.0
 Parameter: YPHI <- "53.0576597"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.876622726"
Evaluating: 0.876622726*360.0
 Parameter: ZPHI <- "315.584181"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.1966591"
 Parameter: YPOS -> "54.9193452"
 Parameter: ZPOS -> "-61.5078954"
 Parameter: XPHI -> "200.137815"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.938867   -0.344279
    0.000000    0.344279   -0.938867

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  159.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.1966591"
 Parameter: YPOS -> "54.9193452"
 Parameter: ZPOS -> "-61.5078954"
 Parameter: YPHI -> "53.0576597"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.601011    0.000000   -0.799241
    0.000000    1.000000    0.000000
    0.799241    0.000000    0.601011

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   53.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.1966591"
 Parameter: YPOS -> "54.9193452"
 Parameter: ZPOS -> "-61.5078954"
 Parameter: ZPHI -> "315.584181"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.714279   -0.699861    0.000000
    0.699861    0.714279    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   44.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.196659 XMAX =  -43.196659 XAVE =  -43.196659
    YMIN =   54.919345 YMAX =   54.919345 YAVE =   54.919345
    ZMIN =  -61.507895 ZMAX =  -61.507895 ZAVE =  -61.507895
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.1966591"
Evaluating: -43.1966591+3.5
 Parameter: XMAX <- "-39.6966591"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "54.9193452"
Evaluating: 54.9193452+3.5
 Parameter: YMAX <- "58.4193452"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-61.5078954"
Evaluating: -61.5078954+3.5
 Parameter: ZMAX <- "-58.0078954"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.1966591"
Evaluating: -43.1966591-3.5
 Parameter: XMIN <- "-46.6966591"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "54.9193452"
Evaluating: 54.9193452-3.5
 Parameter: YMIN <- "51.4193452"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-61.5078954"
Evaluating: -61.5078954-3.5
 Parameter: ZMIN <- "-65.0078954"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.6966591"
 Parameter: XMIN -> "-46.6966591"
 Parameter: YMAX -> "58.4193452"
 Parameter: YMIN -> "51.4193452"
 Parameter: ZMAX -> "-58.0078954"
 Parameter: ZMIN -> "-65.0078954"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "179"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "179" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "179"
Evaluating: 179
 Parameter: J <- "179"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "179" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "179"
 Parameter: NPOS -> "120"
Evaluating: 179-120
 Parameter: J <- "59"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.116546743"
Evaluating: 112.065471*(0.116546743-0.5)
 Parameter: XPOS <- "-42.9718699"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.800247954"
Evaluating: 112.065471*(0.800247954-0.5)
 Parameter: YPOS <- "33.6474284"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.923796735"
Evaluating: 142.885239*(0.923796735-0.5)+2.93414115
 Parameter: ZPOS <- "63.4884389"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.4884389" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.4884389" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.9718699"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.9718699-0
 Parameter: XTRAN <- "-42.9718699"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.6474284"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.6474284-0
 Parameter: YTRAN <- "33.6474284"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.4884389"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 63.4884389-0
 Parameter: ZTRAN <- "63.4884389"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.9718699"
 Parameter: YTRAN -> "33.6474284"
 Parameter: ZTRAN -> "63.4884389"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -42.971870   33.647428   63.488439
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.113907252"
Evaluating: 0.113907252*360.0
 Parameter: XPHI <- "41.0066107"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.710046272"
Evaluating: 0.710046272*360.0
 Parameter: YPHI <- "255.616658"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.622603181"
Evaluating: 0.622603181*360.0
 Parameter: ZPHI <- "224.137145"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.9718699"
 Parameter: YPOS -> "33.6474284"
 Parameter: ZPOS -> "63.4884389"
 Parameter: XPHI -> "41.0066107"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.754634    0.656146
    0.000000   -0.656146    0.754634

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   41.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.9718699"
 Parameter: YPOS -> "33.6474284"
 Parameter: ZPOS -> "63.4884389"
 Parameter: YPHI -> "255.616658"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.248408    0.000000    0.968655
    0.000000    1.000000    0.000000
   -0.968655    0.000000   -0.248408

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  104.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.9718699"
 Parameter: YPOS -> "33.6474284"
 Parameter: ZPOS -> "63.4884389"
 Parameter: ZPHI -> "224.137145"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.717675   -0.696378    0.000000
    0.696378   -0.717675    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  135.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.971870 XMAX =  -42.971870 XAVE =  -42.971870
    YMIN =   33.647428 YMAX =   33.647428 YAVE =   33.647428
    ZMIN =   63.488439 ZMAX =   63.488439 ZAVE =   63.488439
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.9718699"
Evaluating: -42.9718699+3.5
 Parameter: XMAX <- "-39.4718699"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.6474284"
Evaluating: 33.6474284+3.5
 Parameter: YMAX <- "37.1474284"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.4884389"
Evaluating: 63.4884389+3.5
 Parameter: ZMAX <- "66.9884389"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.9718699"
Evaluating: -42.9718699-3.5
 Parameter: XMIN <- "-46.4718699"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.6474284"
Evaluating: 33.6474284-3.5
 Parameter: YMIN <- "30.1474284"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.4884389"
Evaluating: 63.4884389-3.5
 Parameter: ZMIN <- "59.9884389"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.4718699"
 Parameter: XMIN -> "-46.4718699"
 Parameter: YMAX -> "37.1474284"
 Parameter: YMIN -> "30.1474284"
 Parameter: ZMAX -> "66.9884389"
 Parameter: ZMIN -> "59.9884389"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "180"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "180" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "180"
Evaluating: 180
 Parameter: J <- "180"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "180" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "180"
 Parameter: NPOS -> "120"
Evaluating: 180-120
 Parameter: J <- "60"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.884956823"
Evaluating: 112.065471*(0.884956823-0.5)
 Parameter: XPOS <- "43.1403677"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.632152052"
Evaluating: 112.065471*(0.632152052-0.5)
 Parameter: YPOS <- "14.809682"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.199980229"
Evaluating: 142.885239*(0.199980229-0.5)+2.93414115
 Parameter: ZPOS <- "-39.9342555"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.9342555" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.1403677"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 43.1403677-0
 Parameter: XTRAN <- "43.1403677"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.809682"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.809682-0
 Parameter: YTRAN <- "14.809682"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.9342555"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.9342555-0
 Parameter: ZTRAN <- "-39.9342555"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.1403677"
 Parameter: YTRAN -> "14.809682"
 Parameter: ZTRAN -> "-39.9342555"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    43.140368   14.809682  -39.934255
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.25753748"
Evaluating: 0.25753748*360.0
 Parameter: XPHI <- "92.7134928"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.53320131E-03"
Evaluating: 2.53320131E-03*360.0
 Parameter: YPHI <- "0.911952472"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.513396128"
Evaluating: 0.513396128*360.0
 Parameter: ZPHI <- "184.822606"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.1403677"
 Parameter: YPOS -> "14.809682"
 Parameter: ZPOS -> "-39.9342555"
 Parameter: XPHI -> "92.7134928"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.047342    0.998879
    0.000000   -0.998879   -0.047342

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   92.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.1403677"
 Parameter: YPOS -> "14.809682"
 Parameter: ZPOS -> "-39.9342555"
 Parameter: YPHI -> "0.911952472"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.999873    0.000000   -0.015916
    0.000000    1.000000    0.000000
    0.015916    0.000000    0.999873

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    0.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.1403677"
 Parameter: YPOS -> "14.809682"
 Parameter: ZPOS -> "-39.9342555"
 Parameter: ZPHI -> "184.822606"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.996460   -0.084071    0.000000
    0.084071   -0.996460    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  175.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.140368 XMAX =   43.140368 XAVE =   43.140368
    YMIN =   14.809682 YMAX =   14.809682 YAVE =   14.809682
    ZMIN =  -39.934255 ZMAX =  -39.934255 ZAVE =  -39.934255
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.1403677"
Evaluating: 43.1403677+3.5
 Parameter: XMAX <- "46.6403677"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.809682"
Evaluating: 14.809682+3.5
 Parameter: YMAX <- "18.309682"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.9342555"
Evaluating: -39.9342555+3.5
 Parameter: ZMAX <- "-36.4342555"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.1403677"
Evaluating: 43.1403677-3.5
 Parameter: XMIN <- "39.6403677"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.809682"
Evaluating: 14.809682-3.5
 Parameter: YMIN <- "11.309682"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.9342555"
Evaluating: -39.9342555-3.5
 Parameter: ZMIN <- "-43.4342555"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.6403677"
 Parameter: XMIN -> "39.6403677"
 Parameter: YMAX -> "18.309682"
 Parameter: YMIN -> "11.309682"
 Parameter: ZMAX -> "-36.4342555"
 Parameter: ZMIN -> "-43.4342555"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "181"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "181" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "181"
Evaluating: 181
 Parameter: J <- "181"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "181" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "181"
 Parameter: NPOS -> "120"
Evaluating: 181-120
 Parameter: J <- "61"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.346766535"
Evaluating: 112.065471*(0.346766535-0.5)
 Parameter: XPOS <- "-17.1721804"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.42027955"
Evaluating: 112.065471*(0.42027955-0.5)
 Parameter: YPOS <- "-8.93390978"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.8839927"
Evaluating: 142.885239*(0.8839927-0.5)+2.93414115
 Parameter: ZPOS <- "57.8010299"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.8010299" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.8010299" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.1721804"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.1721804-0
 Parameter: XTRAN <- "-17.1721804"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.93390978"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.93390978-0
 Parameter: YTRAN <- "-8.93390978"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.8010299"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.8010299-0
 Parameter: ZTRAN <- "57.8010299"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.1721804"
 Parameter: YTRAN -> "-8.93390978"
 Parameter: ZTRAN -> "57.8010299"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -17.172180   -8.933910   57.801030
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.501603789"
Evaluating: 0.501603789*360.0
 Parameter: XPHI <- "180.577364"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.127945766"
Evaluating: 0.127945766*360.0
 Parameter: YPHI <- "46.0604758"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.809378476"
Evaluating: 0.809378476*360.0
 Parameter: ZPHI <- "291.376251"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.1721804"
 Parameter: YPOS -> "-8.93390978"
 Parameter: ZPOS -> "57.8010299"
 Parameter: XPHI -> "180.577364"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999949   -0.010077
    0.000000    0.010077   -0.999949

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  179.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.1721804"
 Parameter: YPOS -> "-8.93390978"
 Parameter: ZPOS -> "57.8010299"
 Parameter: YPHI -> "46.0604758"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.693899    0.000000   -0.720073
    0.000000    1.000000    0.000000
    0.720073    0.000000    0.693899

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   46.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.1721804"
 Parameter: YPOS -> "-8.93390978"
 Parameter: ZPOS -> "57.8010299"
 Parameter: ZPHI -> "291.376251"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.364491   -0.931207    0.000000
    0.931207    0.364491    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.172180 XMAX =  -17.172180 XAVE =  -17.172180
    YMIN =   -8.933910 YMAX =   -8.933910 YAVE =   -8.933910
    ZMIN =   57.801030 ZMAX =   57.801030 ZAVE =   57.801030
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.1721804"
Evaluating: -17.1721804+3.5
 Parameter: XMAX <- "-13.6721804"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.93390978"
Evaluating: -8.93390978+3.5
 Parameter: YMAX <- "-5.43390978"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.8010299"
Evaluating: 57.8010299+3.5
 Parameter: ZMAX <- "61.3010299"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.1721804"
Evaluating: -17.1721804-3.5
 Parameter: XMIN <- "-20.6721804"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.93390978"
Evaluating: -8.93390978-3.5
 Parameter: YMIN <- "-12.4339098"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.8010299"
Evaluating: 57.8010299-3.5
 Parameter: ZMIN <- "54.3010299"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.6721804"
 Parameter: XMIN -> "-20.6721804"
 Parameter: YMAX -> "-5.43390978"
 Parameter: YMIN -> "-12.4339098"
 Parameter: ZMAX -> "61.3010299"
 Parameter: ZMIN -> "54.3010299"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "182"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "182" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "182"
Evaluating: 182
 Parameter: J <- "182"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "182" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "182"
 Parameter: NPOS -> "120"
Evaluating: 182-120
 Parameter: J <- "62"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.950049983"
Evaluating: 112.065471*(0.950049983-0.5)
 Parameter: XPOS <- "50.4350633"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.119837784"
Evaluating: 112.065471*(0.119837784-0.5)
 Parameter: YPOS <- "-42.6030578"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.471310849"
Evaluating: 142.885239*(0.471310849-0.5)+2.93414115
 Parameter: ZPOS <- "-1.16511505"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.16511505" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.16511505" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "182"
Evaluating: 182
 Parameter: J <- "182"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "182" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "182"
 Parameter: NPOS -> "120"
Evaluating: 182-120
 Parameter: J <- "62"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.597272168"
Evaluating: 112.065471*(0.597272168-0.5)
 Parameter: XPOS <- "10.9008513"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.166067028"
Evaluating: 112.065471*(0.166067028-0.5)
 Parameter: YPOS <- "-37.4223558"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.145235571"
Evaluating: 142.885239*(0.145235571-0.5)+2.93414115
 Parameter: ZPOS <- "-47.7564591"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.7564591" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.9008513"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.9008513-0
 Parameter: XTRAN <- "10.9008513"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.4223558"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.4223558-0
 Parameter: YTRAN <- "-37.4223558"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.7564591"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -47.7564591-0
 Parameter: ZTRAN <- "-47.7564591"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.9008513"
 Parameter: YTRAN -> "-37.4223558"
 Parameter: ZTRAN -> "-47.7564591"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    10.900851  -37.422356  -47.756459
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.316065353"
Evaluating: 0.316065353*360.0
 Parameter: XPHI <- "113.783527"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126103682"
Evaluating: 0.126103682*360.0
 Parameter: YPHI <- "45.3973255"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.813909693"
Evaluating: 0.813909693*360.0
 Parameter: ZPHI <- "293.007489"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.9008513"
 Parameter: YPOS -> "-37.4223558"
 Parameter: ZPOS -> "-47.7564591"
 Parameter: XPHI -> "113.783527"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.403282    0.915076
    0.000000   -0.915076   -0.403282

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.9008513"
 Parameter: YPOS -> "-37.4223558"
 Parameter: ZPOS -> "-47.7564591"
 Parameter: YPHI -> "45.3973255"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.702186    0.000000   -0.711993
    0.000000    1.000000    0.000000
    0.711993    0.000000    0.702186

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   45.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.9008513"
 Parameter: YPOS -> "-37.4223558"
 Parameter: ZPOS -> "-47.7564591"
 Parameter: ZPHI -> "293.007489"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.390851   -0.920454    0.000000
    0.920454    0.390851    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.900851 XMAX =   10.900851 XAVE =   10.900851
    YMIN =  -37.422356 YMAX =  -37.422356 YAVE =  -37.422356
    ZMIN =  -47.756459 ZMAX =  -47.756459 ZAVE =  -47.756459
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.9008513"
Evaluating: 10.9008513+3.5
 Parameter: XMAX <- "14.4008513"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.4223558"
Evaluating: -37.4223558+3.5
 Parameter: YMAX <- "-33.9223558"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.7564591"
Evaluating: -47.7564591+3.5
 Parameter: ZMAX <- "-44.2564591"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.9008513"
Evaluating: 10.9008513-3.5
 Parameter: XMIN <- "7.4008513"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.4223558"
Evaluating: -37.4223558-3.5
 Parameter: YMIN <- "-40.9223558"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.7564591"
Evaluating: -47.7564591-3.5
 Parameter: ZMIN <- "-51.2564591"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.4008513"
 Parameter: XMIN -> "7.4008513"
 Parameter: YMAX -> "-33.9223558"
 Parameter: YMIN -> "-40.9223558"
 Parameter: ZMAX -> "-44.2564591"
 Parameter: ZMIN -> "-51.2564591"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "183"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "183" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "183"
Evaluating: 183
 Parameter: J <- "183"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "183" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "183"
 Parameter: NPOS -> "120"
Evaluating: 183-120
 Parameter: J <- "63"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "8.17333629E-02"
Evaluating: 112.065471*(8.17333629E-02-0.5)
 Parameter: XPOS <- "-46.8732477"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.539961481"
Evaluating: 112.065471*(0.539961481-0.5)
 Parameter: YPOS <- "4.47830219"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.296451234"
Evaluating: 142.885239*(0.296451234-0.5)+2.93414115
 Parameter: ZPOS <- "-26.1499729"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.1499729" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.8732477"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -46.8732477-0
 Parameter: XTRAN <- "-46.8732477"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.47830219"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 4.47830219-0
 Parameter: YTRAN <- "4.47830219"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.1499729"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.1499729-0
 Parameter: ZTRAN <- "-26.1499729"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.8732477"
 Parameter: YTRAN -> "4.47830219"
 Parameter: ZTRAN -> "-26.1499729"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -46.873248    4.478302  -26.149973
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313186575"
Evaluating: 0.313186575*360.0
 Parameter: XPHI <- "112.747167"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.241019911"
Evaluating: 0.241019911*360.0
 Parameter: YPHI <- "86.767168"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.918293412"
Evaluating: 0.918293412*360.0
 Parameter: ZPHI <- "330.585628"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.8732477"
 Parameter: YPOS -> "4.47830219"
 Parameter: ZPOS -> "-26.1499729"
 Parameter: XPHI -> "112.747167"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.386665    0.922220
    0.000000   -0.922220   -0.386665

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.8732477"
 Parameter: YPOS -> "4.47830219"
 Parameter: ZPOS -> "-26.1499729"
 Parameter: YPHI -> "86.767168"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.056394    0.000000   -0.998409
    0.000000    1.000000    0.000000
    0.998409    0.000000    0.056394

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   86.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.8732477"
 Parameter: YPOS -> "4.47830219"
 Parameter: ZPOS -> "-26.1499729"
 Parameter: ZPHI -> "330.585628"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.871091   -0.491122    0.000000
    0.491122    0.871091    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.873248 XMAX =  -46.873248 XAVE =  -46.873248
    YMIN =    4.478302 YMAX =    4.478302 YAVE =    4.478302
    ZMIN =  -26.149973 ZMAX =  -26.149973 ZAVE =  -26.149973
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.8732477"
Evaluating: -46.8732477+3.5
 Parameter: XMAX <- "-43.3732477"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.47830219"
Evaluating: 4.47830219+3.5
 Parameter: YMAX <- "7.97830219"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.1499729"
Evaluating: -26.1499729+3.5
 Parameter: ZMAX <- "-22.6499729"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.8732477"
Evaluating: -46.8732477-3.5
 Parameter: XMIN <- "-50.3732477"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.47830219"
Evaluating: 4.47830219-3.5
 Parameter: YMIN <- "0.97830219"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.1499729"
Evaluating: -26.1499729-3.5
 Parameter: ZMIN <- "-29.6499729"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.3732477"
 Parameter: XMIN -> "-50.3732477"
 Parameter: YMAX -> "7.97830219"
 Parameter: YMIN -> "0.97830219"
 Parameter: ZMAX -> "-22.6499729"
 Parameter: ZMIN -> "-29.6499729"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "184"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "184" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "184"
Evaluating: 184
 Parameter: J <- "184"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "184" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "184"
 Parameter: NPOS -> "120"
Evaluating: 184-120
 Parameter: J <- "64"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.640577538"
Evaluating: 112.065471*(0.640577538-0.5)
 Parameter: XPOS <- "15.753888"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.954934438"
Evaluating: 112.065471*(0.954934438-0.5)
 Parameter: YPOS <- "50.9824421"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.437109454"
Evaluating: 142.885239*(0.437109454-0.5)+2.93414115
 Parameter: ZPOS <- "-6.05198955"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.05198955" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.05198955" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "184"
Evaluating: 184
 Parameter: J <- "184"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "184" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "184"
 Parameter: NPOS -> "120"
Evaluating: 184-120
 Parameter: J <- "64"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.223280998"
Evaluating: 112.065471*(0.223280998-0.5)
 Parameter: XPOS <- "-31.0106453"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.382746704"
Evaluating: 112.065471*(0.382746704-0.5)
 Parameter: YPOS <- "-13.1400458"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.958169782"
Evaluating: 142.885239*(0.958169782-0.5)+2.93414115
 Parameter: ZPOS <- "68.39984"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "68.39984" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "68.39984" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.0106453"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.0106453-0
 Parameter: XTRAN <- "-31.0106453"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.1400458"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.1400458-0
 Parameter: YTRAN <- "-13.1400458"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "68.39984"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 68.39984-0
 Parameter: ZTRAN <- "68.39984"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.0106453"
 Parameter: YTRAN -> "-13.1400458"
 Parameter: ZTRAN -> "68.39984"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -31.010645  -13.140046   68.399840
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.540820035"
Evaluating: 0.540820035*360.0
 Parameter: XPHI <- "194.695213"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.229145292"
Evaluating: 0.229145292*360.0
 Parameter: YPHI <- "82.4923051"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.551543421"
Evaluating: 0.551543421*360.0
 Parameter: ZPHI <- "198.555632"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.0106453"
 Parameter: YPOS -> "-13.1400458"
 Parameter: ZPOS -> "68.39984"
 Parameter: XPHI -> "194.695213"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.967289   -0.253677
    0.000000    0.253677   -0.967289

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  165.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.0106453"
 Parameter: YPOS -> "-13.1400458"
 Parameter: ZPOS -> "68.39984"
 Parameter: YPHI -> "82.4923051"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.130659    0.000000   -0.991427
    0.000000    1.000000    0.000000
    0.991427    0.000000    0.130659

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   82.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.0106453"
 Parameter: YPOS -> "-13.1400458"
 Parameter: ZPOS -> "68.39984"
 Parameter: ZPHI -> "198.555632"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.948015   -0.318225    0.000000
    0.318225   -0.948015    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  161.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.010645 XMAX =  -31.010645 XAVE =  -31.010645
    YMIN =  -13.140046 YMAX =  -13.140046 YAVE =  -13.140046
    ZMIN =   68.399840 ZMAX =   68.399840 ZAVE =   68.399840
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.0106453"
Evaluating: -31.0106453+3.5
 Parameter: XMAX <- "-27.5106453"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.1400458"
Evaluating: -13.1400458+3.5
 Parameter: YMAX <- "-9.6400458"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "68.39984"
Evaluating: 68.39984+3.5
 Parameter: ZMAX <- "71.89984"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.0106453"
Evaluating: -31.0106453-3.5
 Parameter: XMIN <- "-34.5106453"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.1400458"
Evaluating: -13.1400458-3.5
 Parameter: YMIN <- "-16.6400458"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "68.39984"
Evaluating: 68.39984-3.5
 Parameter: ZMIN <- "64.89984"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.5106453"
 Parameter: XMIN -> "-34.5106453"
 Parameter: YMAX -> "-9.6400458"
 Parameter: YMIN -> "-16.6400458"
 Parameter: ZMAX -> "71.89984"
 Parameter: ZMIN -> "64.89984"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "185"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "185" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "185"
Evaluating: 185
 Parameter: J <- "185"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "185" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "185"
 Parameter: NPOS -> "120"
Evaluating: 185-120
 Parameter: J <- "65"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.572003776E-02"
Evaluating: 112.065471*(5.572003776E-02-0.5)
 Parameter: XPOS <- "-49.7884432"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.138084001"
Evaluating: 112.065471*(0.138084001-0.5)
 Parameter: YPOS <- "-40.5582869"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.668031664"
Evaluating: 142.885239*(0.668031664-0.5)+2.93414115
 Parameter: ZPOS <- "26.9433856"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.9433856" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.9433856" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-49.7884432"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -49.7884432-0
 Parameter: XTRAN <- "-49.7884432"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.5582869"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.5582869-0
 Parameter: YTRAN <- "-40.5582869"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.9433856"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.9433856-0
 Parameter: ZTRAN <- "26.9433856"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.7884432"
 Parameter: YTRAN -> "-40.5582869"
 Parameter: ZTRAN -> "26.9433856"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -49.788443  -40.558287   26.943386
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.954996938E-02"
Evaluating: 3.954996938E-02*360.0
 Parameter: XPHI <- "14.237989"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318627798"
Evaluating: 0.318627798*360.0
 Parameter: YPHI <- "114.706007"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.962749564E-02"
Evaluating: 1.962749564E-02*360.0
 Parameter: ZPHI <- "7.06589843"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-49.7884432"
 Parameter: YPOS -> "-40.5582869"
 Parameter: ZPOS -> "26.9433856"
 Parameter: XPHI -> "14.237989"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.969282    0.245950
    0.000000   -0.245950    0.969282

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   14.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-49.7884432"
 Parameter: YPOS -> "-40.5582869"
 Parameter: ZPOS -> "26.9433856"
 Parameter: YPHI -> "114.706007"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.417962    0.000000   -0.908464
    0.000000    1.000000    0.000000
    0.908464    0.000000   -0.417962

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  114.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-49.7884432"
 Parameter: YPOS -> "-40.5582869"
 Parameter: ZPOS -> "26.9433856"
 Parameter: ZPHI -> "7.06589843"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.992405    0.123011    0.000000
   -0.123011    0.992405    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    7.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.788443 XMAX =  -49.788443 XAVE =  -49.788443
    YMIN =  -40.558287 YMAX =  -40.558287 YAVE =  -40.558287
    ZMIN =   26.943386 ZMAX =   26.943386 ZAVE =   26.943386
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-49.7884432"
Evaluating: -49.7884432+3.5
 Parameter: XMAX <- "-46.2884432"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.5582869"
Evaluating: -40.5582869+3.5
 Parameter: YMAX <- "-37.0582869"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.9433856"
Evaluating: 26.9433856+3.5
 Parameter: ZMAX <- "30.4433856"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-49.7884432"
Evaluating: -49.7884432-3.5
 Parameter: XMIN <- "-53.2884432"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.5582869"
Evaluating: -40.5582869-3.5
 Parameter: YMIN <- "-44.0582869"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.9433856"
Evaluating: 26.9433856-3.5
 Parameter: ZMIN <- "23.4433856"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.2884432"
 Parameter: XMIN -> "-53.2884432"
 Parameter: YMAX -> "-37.0582869"
 Parameter: YMIN -> "-44.0582869"
 Parameter: ZMAX -> "30.4433856"
 Parameter: ZMIN -> "23.4433856"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "186"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "186" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "186"
Evaluating: 186
 Parameter: J <- "186"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "186" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "186"
 Parameter: NPOS -> "120"
Evaluating: 186-120
 Parameter: J <- "66"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.858202817"
Evaluating: 112.065471*(0.858202817-0.5)
 Parameter: XPOS <- "40.1421674"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.718215318"
Evaluating: 112.065471*(0.718215318-0.5)
 Parameter: YPOS <- "24.4544024"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.10037232"
Evaluating: 142.885239*(0.10037232-0.5)+2.93414115
 Parameter: ZPOS <- "-54.1667554"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.1667554" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.1421674"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.1421674-0
 Parameter: XTRAN <- "40.1421674"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.4544024"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.4544024-0
 Parameter: YTRAN <- "24.4544024"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.1667554"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.1667554-0
 Parameter: ZTRAN <- "-54.1667554"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.1421674"
 Parameter: YTRAN -> "24.4544024"
 Parameter: ZTRAN -> "-54.1667554"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    40.142167   24.454402  -54.166755
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.124654251"
Evaluating: 0.124654251*360.0
 Parameter: XPHI <- "44.8755304"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.175529575"
Evaluating: 0.175529575*360.0
 Parameter: YPHI <- "63.190647"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.807788751E-02"
Evaluating: 4.807788751E-02*360.0
 Parameter: ZPHI <- "17.3080395"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.1421674"
 Parameter: YPOS -> "24.4544024"
 Parameter: ZPOS -> "-54.1667554"
 Parameter: XPHI -> "44.8755304"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.708641    0.705569
    0.000000   -0.705569    0.708641

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   44.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.1421674"
 Parameter: YPOS -> "24.4544024"
 Parameter: ZPOS -> "-54.1667554"
 Parameter: YPHI -> "63.190647"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.451023    0.000000   -0.892512
    0.000000    1.000000    0.000000
    0.892512    0.000000    0.451023

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   63.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.1421674"
 Parameter: YPOS -> "24.4544024"
 Parameter: ZPOS -> "-54.1667554"
 Parameter: ZPHI -> "17.3080395"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.954719    0.297509    0.000000
   -0.297509    0.954719    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.142167 XMAX =   40.142167 XAVE =   40.142167
    YMIN =   24.454402 YMAX =   24.454402 YAVE =   24.454402
    ZMIN =  -54.166755 ZMAX =  -54.166755 ZAVE =  -54.166755
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.1421674"
Evaluating: 40.1421674+3.5
 Parameter: XMAX <- "43.6421674"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.4544024"
Evaluating: 24.4544024+3.5
 Parameter: YMAX <- "27.9544024"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.1667554"
Evaluating: -54.1667554+3.5
 Parameter: ZMAX <- "-50.6667554"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.1421674"
Evaluating: 40.1421674-3.5
 Parameter: XMIN <- "36.6421674"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.4544024"
Evaluating: 24.4544024-3.5
 Parameter: YMIN <- "20.9544024"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.1667554"
Evaluating: -54.1667554-3.5
 Parameter: ZMIN <- "-57.6667554"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.6421674"
 Parameter: XMIN -> "36.6421674"
 Parameter: YMAX -> "27.9544024"
 Parameter: YMIN -> "20.9544024"
 Parameter: ZMAX -> "-50.6667554"
 Parameter: ZMIN -> "-57.6667554"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "187"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "187" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "187"
Evaluating: 187
 Parameter: J <- "187"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "187" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "187"
 Parameter: NPOS -> "120"
Evaluating: 187-120
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.25176815"
Evaluating: 112.065471*(0.25176815-0.5)
 Parameter: XPOS <- "-27.8182192"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.470689015"
Evaluating: 112.065471*(0.470689015-0.5)
 Parameter: YPOS <- "-3.28474934"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.643084834"
Evaluating: 142.885239*(0.643084834-0.5)+2.93414115
 Parameter: ZPOS <- "23.3788519"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.3788519" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.3788519" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.8182192"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.8182192-0
 Parameter: XTRAN <- "-27.8182192"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.28474934"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.28474934-0
 Parameter: YTRAN <- "-3.28474934"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.3788519"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.3788519-0
 Parameter: ZTRAN <- "23.3788519"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.8182192"
 Parameter: YTRAN -> "-3.28474934"
 Parameter: ZTRAN -> "23.3788519"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -27.818219   -3.284749   23.378852
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.555955939E-02"
Evaluating: 9.555955939E-02*360.0
 Parameter: XPHI <- "34.4014414"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.990346344"
Evaluating: 0.990346344*360.0
 Parameter: YPHI <- "356.524684"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.755982212"
Evaluating: 0.755982212*360.0
 Parameter: ZPHI <- "272.153596"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.8182192"
 Parameter: YPOS -> "-3.28474934"
 Parameter: ZPOS -> "23.3788519"
 Parameter: XPHI -> "34.4014414"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.825099    0.564988
    0.000000   -0.564988    0.825099

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   34.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.8182192"
 Parameter: YPOS -> "-3.28474934"
 Parameter: ZPOS -> "23.3788519"
 Parameter: YPHI -> "356.524684"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.998161    0.000000    0.060619
    0.000000    1.000000    0.000000
   -0.060619    0.000000    0.998161

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    3.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.8182192"
 Parameter: YPOS -> "-3.28474934"
 Parameter: ZPOS -> "23.3788519"
 Parameter: ZPHI -> "272.153596"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.037578   -0.999294    0.000000
    0.999294    0.037578    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   87.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.818219 XMAX =  -27.818219 XAVE =  -27.818219
    YMIN =   -3.284749 YMAX =   -3.284749 YAVE =   -3.284749
    ZMIN =   23.378852 ZMAX =   23.378852 ZAVE =   23.378852
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.8182192"
Evaluating: -27.8182192+3.5
 Parameter: XMAX <- "-24.3182192"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.28474934"
Evaluating: -3.28474934+3.5
 Parameter: YMAX <- "0.21525066"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.3788519"
Evaluating: 23.3788519+3.5
 Parameter: ZMAX <- "26.8788519"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.8182192"
Evaluating: -27.8182192-3.5
 Parameter: XMIN <- "-31.3182192"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.28474934"
Evaluating: -3.28474934-3.5
 Parameter: YMIN <- "-6.78474934"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.3788519"
Evaluating: 23.3788519-3.5
 Parameter: ZMIN <- "19.8788519"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.3182192"
 Parameter: XMIN -> "-31.3182192"
 Parameter: YMAX -> "0.21525066"
 Parameter: YMIN -> "-6.78474934"
 Parameter: ZMAX -> "26.8788519"
 Parameter: ZMIN -> "19.8788519"
 SELRPN>      4 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      4 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53244 NEG      CLA      67       CLA     -**** MEMB     POPC     6        P             3.7627
53244 NEG      CLA      67       CLA     -**** MEMB     POPC     6        O13           3.0453
53244 NEG      CLA      67       CLA     -**** MEMB     POPC     6        O14           3.6368
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "187"
Evaluating: 187
 Parameter: J <- "187"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "187" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "187"
 Parameter: NPOS -> "120"
Evaluating: 187-120
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.467151091"
Evaluating: 112.065471*(0.467151091-0.5)
 Parameter: XPOS <- "-3.68122846"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.232586272"
Evaluating: 112.065471*(0.232586272-0.5)
 Parameter: YPOS <- "-29.9678454"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.3666985"
Evaluating: 142.885239*(0.3666985-0.5)+2.93414115
 Parameter: ZPOS <- "-16.1126755"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.1126755" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.818219 XMAX =  -27.818219 XAVE =  -27.818219
    YMIN =   -3.284749 YMAX =   -3.284749 YAVE =   -3.284749
    ZMIN =   23.378852 ZMAX =   23.378852 ZAVE =   23.378852
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.68122846"
 RDCMND substituted energy or value "?XAVE" to "-27.8182192"
Evaluating: -3.68122846--27.8182192
 Parameter: XTRAN <- "24.1369907"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.9678454"
 RDCMND substituted energy or value "?YAVE" to "-3.28474934"
Evaluating: -29.9678454--3.28474934
 Parameter: YTRAN <- "-26.6830961"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.1126755"
 RDCMND substituted energy or value "?ZAVE" to "23.3788519"
Evaluating: -16.1126755-23.3788519
 Parameter: ZTRAN <- "-39.4915274"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.1369907"
 Parameter: YTRAN -> "-26.6830961"
 Parameter: ZTRAN -> "-39.4915274"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    24.136991  -26.683096  -39.491527
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.181558612"
Evaluating: 0.181558612*360.0
 Parameter: XPHI <- "65.3611003"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.988561374"
Evaluating: 0.988561374*360.0
 Parameter: YPHI <- "355.882095"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.24669769"
Evaluating: 0.24669769*360.0
 Parameter: ZPHI <- "88.8111684"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.68122846"
 Parameter: YPOS -> "-29.9678454"
 Parameter: ZPOS -> "-16.1126755"
 Parameter: XPHI -> "65.3611003"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.416898    0.908953
    0.000000   -0.908953    0.416898

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   65.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.68122846"
 Parameter: YPOS -> "-29.9678454"
 Parameter: ZPOS -> "-16.1126755"
 Parameter: YPHI -> "355.882095"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.997418    0.000000    0.071809
    0.000000    1.000000    0.000000
   -0.071809    0.000000    0.997418

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.68122846"
 Parameter: YPOS -> "-29.9678454"
 Parameter: ZPOS -> "-16.1126755"
 Parameter: ZPHI -> "88.8111684"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.020748    0.999785    0.000000
   -0.999785    0.020748    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   88.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.681228 XMAX =   -3.681228 XAVE =   -3.681228
    YMIN =  -29.967845 YMAX =  -29.967845 YAVE =  -29.967845
    ZMIN =  -16.112675 ZMAX =  -16.112675 ZAVE =  -16.112675
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.68122848"
Evaluating: -3.68122848+3.5
 Parameter: XMAX <- "-0.18122848"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.9678454"
Evaluating: -29.9678454+3.5
 Parameter: YMAX <- "-26.4678454"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.1126755"
Evaluating: -16.1126755+3.5
 Parameter: ZMAX <- "-12.6126755"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.68122848"
Evaluating: -3.68122848-3.5
 Parameter: XMIN <- "-7.18122848"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.9678454"
Evaluating: -29.9678454-3.5
 Parameter: YMIN <- "-33.4678454"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.1126755"
Evaluating: -16.1126755-3.5
 Parameter: ZMIN <- "-19.6126755"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.18122848"
 Parameter: XMIN -> "-7.18122848"
 Parameter: YMAX -> "-26.4678454"
 Parameter: YMIN -> "-33.4678454"
 Parameter: ZMAX -> "-12.6126755"
 Parameter: ZMIN -> "-19.6126755"
 SELRPN>     21 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      8 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53244 NEG      CLA      67       CLA     -**** MEMB     POPC     174      N             2.8811
53244 NEG      CLA      67       CLA     -**** MEMB     POPC     174      C12           3.4318
53244 NEG      CLA      67       CLA     -**** MEMB     POPC     174      C13           3.4482
53244 NEG      CLA      67       CLA     -**** MEMB     POPC     174      C15           1.5400
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "187"
Evaluating: 187
 Parameter: J <- "187"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "187" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "187"
 Parameter: NPOS -> "120"
Evaluating: 187-120
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.30239389"
Evaluating: 112.065471*(0.30239389-0.5)
 Parameter: XPOS <- "-22.1448218"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.579590538"
Evaluating: 112.065471*(0.579590538-0.5)
 Parameter: YPOS <- "8.91935113"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "2.442955229E-02"
Evaluating: 142.885239*(2.442955229E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-65.0178559"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-65.0178559" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.681228 XMAX =   -3.681228 XAVE =   -3.681228
    YMIN =  -29.967845 YMAX =  -29.967845 YAVE =  -29.967845
    ZMIN =  -16.112675 ZMAX =  -16.112675 ZAVE =  -16.112675
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.1448218"
 RDCMND substituted energy or value "?XAVE" to "-3.68122848"
Evaluating: -22.1448218--3.68122848
 Parameter: XTRAN <- "-18.4635933"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.91935113"
 RDCMND substituted energy or value "?YAVE" to "-29.9678454"
Evaluating: 8.91935113--29.9678454
 Parameter: YTRAN <- "38.8871965"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-65.0178559"
 RDCMND substituted energy or value "?ZAVE" to "-16.1126755"
Evaluating: -65.0178559--16.1126755
 Parameter: ZTRAN <- "-48.9051804"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.4635933"
 Parameter: YTRAN -> "38.8871965"
 Parameter: ZTRAN -> "-48.9051804"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -18.463593   38.887197  -48.905180
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.796592849"
Evaluating: 0.796592849*360.0
 Parameter: XPHI <- "286.773426"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.403981787"
Evaluating: 0.403981787*360.0
 Parameter: YPHI <- "145.433443"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.39565335"
Evaluating: 0.39565335*360.0
 Parameter: ZPHI <- "142.435206"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.1448218"
 Parameter: YPOS -> "8.91935113"
 Parameter: ZPOS -> "-65.0178559"
 Parameter: XPHI -> "286.773426"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.288588   -0.957453
    0.000000    0.957453    0.288588

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   73.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.1448218"
 Parameter: YPOS -> "8.91935113"
 Parameter: ZPOS -> "-65.0178559"
 Parameter: YPHI -> "145.433443"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.823468    0.000000   -0.567363
    0.000000    1.000000    0.000000
    0.567363    0.000000   -0.823468

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  145.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.1448218"
 Parameter: YPOS -> "8.91935113"
 Parameter: ZPOS -> "-65.0178559"
 Parameter: ZPHI -> "142.435206"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.792664    0.609658    0.000000
   -0.609658   -0.792664    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.144822 XMAX =  -22.144822 XAVE =  -22.144822
    YMIN =    8.919351 YMAX =    8.919351 YAVE =    8.919351
    ZMIN =  -65.017856 ZMAX =  -65.017856 ZAVE =  -65.017856
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.1448218"
Evaluating: -22.1448218+3.5
 Parameter: XMAX <- "-18.6448218"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.91935118"
Evaluating: 8.91935118+3.5
 Parameter: YMAX <- "12.4193512"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-65.0178559"
Evaluating: -65.0178559+3.5
 Parameter: ZMAX <- "-61.5178559"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.1448218"
Evaluating: -22.1448218-3.5
 Parameter: XMIN <- "-25.6448218"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.91935118"
Evaluating: 8.91935118-3.5
 Parameter: YMIN <- "5.41935118"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-65.0178559"
Evaluating: -65.0178559-3.5
 Parameter: ZMIN <- "-68.5178559"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.6448218"
 Parameter: XMIN -> "-25.6448218"
 Parameter: YMAX -> "12.4193512"
 Parameter: YMIN -> "5.41935118"
 Parameter: ZMAX -> "-61.5178559"
 Parameter: ZMIN -> "-68.5178559"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "188"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "188" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "188"
Evaluating: 188
 Parameter: J <- "188"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "188" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "188"
 Parameter: NPOS -> "120"
Evaluating: 188-120
 Parameter: J <- "68"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.641377035"
Evaluating: 112.065471*(0.641377035-0.5)
 Parameter: XPOS <- "15.843484"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.650578473E-02"
Evaluating: 112.065471*(5.650578473E-02-0.5)
 Parameter: YPOS <- "-49.7003881"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.419016369"
Evaluating: 142.885239*(0.419016369-0.5)+2.93414115
 Parameter: ZPOS <- "-8.63722432"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.63722432" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.63722432" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "188"
Evaluating: 188
 Parameter: J <- "188"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "188" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "188"
 Parameter: NPOS -> "120"
Evaluating: 188-120
 Parameter: J <- "68"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.577712226"
Evaluating: 112.065471*(0.577712226-0.5)
 Parameter: XPOS <- "8.70885721"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.194431645"
Evaluating: 112.065471*(0.194431645-0.5)
 Parameter: YPOS <- "-34.2436616"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.747402533"
Evaluating: 142.885239*(0.747402533-0.5)+2.93414115
 Parameter: ZPOS <- "38.2843112"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.2843112" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.2843112" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.70885721"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.70885721-0
 Parameter: XTRAN <- "8.70885721"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.2436616"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.2436616-0
 Parameter: YTRAN <- "-34.2436616"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.2843112"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.2843112-0
 Parameter: ZTRAN <- "38.2843112"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.70885721"
 Parameter: YTRAN -> "-34.2436616"
 Parameter: ZTRAN -> "38.2843112"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     8.708857  -34.243662   38.284311
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.651757063"
Evaluating: 0.651757063*360.0
 Parameter: XPHI <- "234.632543"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.490789132"
Evaluating: 0.490789132*360.0
 Parameter: YPHI <- "176.684088"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.401909953"
Evaluating: 0.401909953*360.0
 Parameter: ZPHI <- "144.687583"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.70885721"
 Parameter: YPOS -> "-34.2436616"
 Parameter: ZPOS -> "38.2843112"
 Parameter: XPHI -> "234.632543"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.578818   -0.815457
    0.000000    0.815457   -0.578818

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  125.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.70885721"
 Parameter: YPOS -> "-34.2436616"
 Parameter: ZPOS -> "38.2843112"
 Parameter: YPHI -> "176.684088"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.998326    0.000000   -0.057841
    0.000000    1.000000    0.000000
    0.057841    0.000000   -0.998326

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  176.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.70885721"
 Parameter: YPOS -> "-34.2436616"
 Parameter: ZPOS -> "38.2843112"
 Parameter: ZPHI -> "144.687583"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.816012    0.578034    0.000000
   -0.578034   -0.816012    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  144.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.708857 XMAX =    8.708857 XAVE =    8.708857
    YMIN =  -34.243662 YMAX =  -34.243662 YAVE =  -34.243662
    ZMIN =   38.284311 ZMAX =   38.284311 ZAVE =   38.284311
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.70885721"
Evaluating: 8.70885721+3.5
 Parameter: XMAX <- "12.2088572"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.2436616"
Evaluating: -34.2436616+3.5
 Parameter: YMAX <- "-30.7436616"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.2843112"
Evaluating: 38.2843112+3.5
 Parameter: ZMAX <- "41.7843112"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.70885721"
Evaluating: 8.70885721-3.5
 Parameter: XMIN <- "5.20885721"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.2436616"
Evaluating: -34.2436616-3.5
 Parameter: YMIN <- "-37.7436616"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.2843112"
Evaluating: 38.2843112-3.5
 Parameter: ZMIN <- "34.7843112"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.2088572"
 Parameter: XMIN -> "5.20885721"
 Parameter: YMAX -> "-30.7436616"
 Parameter: YMIN -> "-37.7436616"
 Parameter: ZMAX -> "41.7843112"
 Parameter: ZMIN -> "34.7843112"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "189"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "189" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "189"
Evaluating: 189
 Parameter: J <- "189"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "189" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "189"
 Parameter: NPOS -> "120"
Evaluating: 189-120
 Parameter: J <- "69"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.425551474"
Evaluating: 112.065471*(0.425551474-0.5)
 Parameter: XPOS <- "-8.34310913"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.294481185"
Evaluating: 112.065471*(0.294481185-0.5)
 Parameter: YPOS <- "-23.0315628"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.213475425"
Evaluating: 142.885239*(0.213475425-0.5)+2.93414115
 Parameter: ZPOS <- "-38.0059912"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.0059912" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.34310913"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.34310913-0
 Parameter: XTRAN <- "-8.34310913"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.0315628"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -23.0315628-0
 Parameter: YTRAN <- "-23.0315628"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.0059912"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.0059912-0
 Parameter: ZTRAN <- "-38.0059912"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.34310913"
 Parameter: YTRAN -> "-23.0315628"
 Parameter: ZTRAN -> "-38.0059912"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -8.343109  -23.031563  -38.005991
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.299354318"
Evaluating: 0.299354318*360.0
 Parameter: XPHI <- "107.767554"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.798725847"
Evaluating: 0.798725847*360.0
 Parameter: YPHI <- "287.541305"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.928815281"
Evaluating: 0.928815281*360.0
 Parameter: ZPHI <- "334.373501"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.34310913"
 Parameter: YPOS -> "-23.0315628"
 Parameter: ZPOS -> "-38.0059912"
 Parameter: XPHI -> "107.767554"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.305156    0.952302
    0.000000   -0.952302   -0.305156

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  107.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.34310913"
 Parameter: YPOS -> "-23.0315628"
 Parameter: ZPOS -> "-38.0059912"
 Parameter: YPHI -> "287.541305"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.301393    0.000000    0.953500
    0.000000    1.000000    0.000000
   -0.953500    0.000000    0.301393

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   72.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.34310913"
 Parameter: YPOS -> "-23.0315628"
 Parameter: ZPOS -> "-38.0059912"
 Parameter: ZPHI -> "334.373501"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.901633   -0.432503    0.000000
    0.432503    0.901633    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   25.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.343109 XMAX =   -8.343109 XAVE =   -8.343109
    YMIN =  -23.031563 YMAX =  -23.031563 YAVE =  -23.031563
    ZMIN =  -38.005991 ZMAX =  -38.005991 ZAVE =  -38.005991
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.34310913"
Evaluating: -8.34310913+3.5
 Parameter: XMAX <- "-4.84310913"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.0315628"
Evaluating: -23.0315628+3.5
 Parameter: YMAX <- "-19.5315628"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.0059912"
Evaluating: -38.0059912+3.5
 Parameter: ZMAX <- "-34.5059912"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.34310913"
Evaluating: -8.34310913-3.5
 Parameter: XMIN <- "-11.8431091"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.0315628"
Evaluating: -23.0315628-3.5
 Parameter: YMIN <- "-26.5315628"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.0059912"
Evaluating: -38.0059912-3.5
 Parameter: ZMIN <- "-41.5059912"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.84310913"
 Parameter: XMIN -> "-11.8431091"
 Parameter: YMAX -> "-19.5315628"
 Parameter: YMIN -> "-26.5315628"
 Parameter: ZMAX -> "-34.5059912"
 Parameter: ZMIN -> "-41.5059912"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "190"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "190" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "190"
Evaluating: 190
 Parameter: J <- "190"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "190" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "190"
 Parameter: NPOS -> "120"
Evaluating: 190-120
 Parameter: J <- "70"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.464989429"
Evaluating: 112.065471*(0.464989429-0.5)
 Parameter: XPOS <- "-3.92347613"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.935912178"
Evaluating: 112.065471*(0.935912178-0.5)
 Parameter: YPOS <- "48.8507035"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.337569627"
Evaluating: 142.885239*(0.337569627-0.5)+2.93414115
 Parameter: ZPOS <- "-20.2747615"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.2747615" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.92347613"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.92347613-0
 Parameter: XTRAN <- "-3.92347613"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "48.8507035"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 48.8507035-0
 Parameter: YTRAN <- "48.8507035"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.2747615"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.2747615-0
 Parameter: ZTRAN <- "-20.2747615"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.92347613"
 Parameter: YTRAN -> "48.8507035"
 Parameter: ZTRAN -> "-20.2747615"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -3.923476   48.850704  -20.274762
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.803729646"
Evaluating: 0.803729646*360.0
 Parameter: XPHI <- "289.342673"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.171973066"
Evaluating: 0.171973066*360.0
 Parameter: YPHI <- "61.9103038"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.154556803"
Evaluating: 0.154556803*360.0
 Parameter: ZPHI <- "55.6404491"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.92347613"
 Parameter: YPOS -> "48.8507035"
 Parameter: ZPOS -> "-20.2747615"
 Parameter: XPHI -> "289.342673"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.331217   -0.943555
    0.000000    0.943555    0.331217

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   70.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.92347613"
 Parameter: YPOS -> "48.8507035"
 Parameter: ZPOS -> "-20.2747615"
 Parameter: YPHI -> "61.9103038"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.470853    0.000000   -0.882212
    0.000000    1.000000    0.000000
    0.882212    0.000000    0.470853

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   61.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.92347613"
 Parameter: YPOS -> "48.8507035"
 Parameter: ZPOS -> "-20.2747615"
 Parameter: ZPHI -> "55.6404491"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.564384    0.825512    0.000000
   -0.825512    0.564384    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   55.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.923476 XMAX =   -3.923476 XAVE =   -3.923476
    YMIN =   48.850704 YMAX =   48.850704 YAVE =   48.850704
    ZMIN =  -20.274762 ZMAX =  -20.274762 ZAVE =  -20.274762
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.92347613"
Evaluating: -3.92347613+3.5
 Parameter: XMAX <- "-0.42347613"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "48.8507035"
Evaluating: 48.8507035+3.5
 Parameter: YMAX <- "52.3507035"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.2747615"
Evaluating: -20.2747615+3.5
 Parameter: ZMAX <- "-16.7747615"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.92347613"
Evaluating: -3.92347613-3.5
 Parameter: XMIN <- "-7.42347613"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "48.8507035"
Evaluating: 48.8507035-3.5
 Parameter: YMIN <- "45.3507035"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.2747615"
Evaluating: -20.2747615-3.5
 Parameter: ZMIN <- "-23.7747615"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.42347613"
 Parameter: XMIN -> "-7.42347613"
 Parameter: YMAX -> "52.3507035"
 Parameter: YMIN -> "45.3507035"
 Parameter: ZMAX -> "-16.7747615"
 Parameter: ZMIN -> "-23.7747615"
 SELRPN>     26 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     15 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53247 NEG      CLA      70       CLA     -**** MEMB     POPC     196      O11           3.4697
53247 NEG      CLA      70       CLA     -**** MEMB     POPC     196      C1            3.6019
53247 NEG      CLA      70       CLA     -**** MEMB     POPC     196      C2            3.8469
53247 NEG      CLA      70       CLA     -**** MEMB     POPC     215      C11           3.1287
53247 NEG      CLA      70       CLA     -**** MEMB     POPC     215      P             2.6184
53247 NEG      CLA      70       CLA     -**** MEMB     POPC     215      O13           3.6220
53247 NEG      CLA      70       CLA     -**** MEMB     POPC     215      O14           2.3819
53247 NEG      CLA      70       CLA     -**** MEMB     POPC     215      O12           1.9299
53247 NEG      CLA      70       CLA     -**** MEMB     POPC     215      O11           3.7219
53247 NEG      CLA      70       CLA     -**** MEMB     POPC     233      C14           3.4283
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "190"
Evaluating: 190
 Parameter: J <- "190"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "190" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "190"
 Parameter: NPOS -> "120"
Evaluating: 190-120
 Parameter: J <- "70"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.724445138"
Evaluating: 112.065471*(0.724445138-0.5)
 Parameter: XPOS <- "25.1525501"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "6.299394485E-02"
Evaluating: 112.065471*(6.299394485E-02-0.5)
 Parameter: YPOS <- "-48.9732894"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.976806149"
Evaluating: 142.885239*(0.976806149-0.5)+2.93414115
 Parameter: ZPOS <- "71.0627017"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "71.0627017" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "71.0627017" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.923476 XMAX =   -3.923476 XAVE =   -3.923476
    YMIN =   48.850704 YMAX =   48.850704 YAVE =   48.850704
    ZMIN =  -20.274762 ZMAX =  -20.274762 ZAVE =  -20.274762
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.1525501"
 RDCMND substituted energy or value "?XAVE" to "-3.92347613"
Evaluating: 25.1525501--3.92347613
 Parameter: XTRAN <- "29.0760262"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.9732894"
 RDCMND substituted energy or value "?YAVE" to "48.8507035"
Evaluating: -48.9732894-48.8507035
 Parameter: YTRAN <- "-97.8239929"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "71.0627017"
 RDCMND substituted energy or value "?ZAVE" to "-20.2747615"
Evaluating: 71.0627017--20.2747615
 Parameter: ZTRAN <- "91.3374632"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.0760262"
 Parameter: YTRAN -> "-97.8239929"
 Parameter: ZTRAN -> "91.3374632"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    29.076026  -97.823993   91.337463
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.180389748"
Evaluating: 0.180389748*360.0
 Parameter: XPHI <- "64.9403093"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.913881463"
Evaluating: 0.913881463*360.0
 Parameter: YPHI <- "328.997327"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.544325755E-02"
Evaluating: 2.544325755E-02*360.0
 Parameter: ZPHI <- "9.15957272"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.1525501"
 Parameter: YPOS -> "-48.9732894"
 Parameter: ZPOS -> "71.0627017"
 Parameter: XPHI -> "64.9403093"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.423562    0.905867
    0.000000   -0.905867    0.423562

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.1525501"
 Parameter: YPOS -> "-48.9732894"
 Parameter: ZPOS -> "71.0627017"
 Parameter: YPHI -> "328.997327"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.857143    0.000000    0.515078
    0.000000    1.000000    0.000000
   -0.515078    0.000000    0.857143

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   31.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.1525501"
 Parameter: YPOS -> "-48.9732894"
 Parameter: ZPOS -> "71.0627017"
 Parameter: ZPHI -> "9.15957272"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.987249    0.159185    0.000000
   -0.159185    0.987249    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    9.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.152550 XMAX =   25.152550 XAVE =   25.152550
    YMIN =  -48.973289 YMAX =  -48.973289 YAVE =  -48.973289
    ZMIN =   71.062702 ZMAX =   71.062702 ZAVE =   71.062702
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.1525501"
Evaluating: 25.1525501+3.5
 Parameter: XMAX <- "28.6525501"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.9732894"
Evaluating: -48.9732894+3.5
 Parameter: YMAX <- "-45.4732894"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "71.0627017"
Evaluating: 71.0627017+3.5
 Parameter: ZMAX <- "74.5627017"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.1525501"
Evaluating: 25.1525501-3.5
 Parameter: XMIN <- "21.6525501"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.9732894"
Evaluating: -48.9732894-3.5
 Parameter: YMIN <- "-52.4732894"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "71.0627017"
Evaluating: 71.0627017-3.5
 Parameter: ZMIN <- "67.5627017"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.6525501"
 Parameter: XMIN -> "21.6525501"
 Parameter: YMAX -> "-45.4732894"
 Parameter: YMIN -> "-52.4732894"
 Parameter: ZMAX -> "74.5627017"
 Parameter: ZMIN -> "67.5627017"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "191"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "191" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "191"
Evaluating: 191
 Parameter: J <- "191"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "191" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "191"
 Parameter: NPOS -> "120"
Evaluating: 191-120
 Parameter: J <- "71"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "3.133484655E-02"
Evaluating: 112.065471*(3.133484655E-02-0.5)
 Parameter: XPOS <- "-52.5211812"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.752227869"
Evaluating: 112.065471*(0.752227869-0.5)
 Parameter: YPOS <- "28.2660349"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.586672916"
Evaluating: 142.885239*(0.586672916-0.5)+2.93414115
 Parameter: ZPOS <- "15.3184215"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.3184215" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.3184215" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-52.5211812"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -52.5211812-0
 Parameter: XTRAN <- "-52.5211812"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.2660349"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.2660349-0
 Parameter: YTRAN <- "28.2660349"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.3184215"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.3184215-0
 Parameter: ZTRAN <- "15.3184215"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.5211812"
 Parameter: YTRAN -> "28.2660349"
 Parameter: ZTRAN -> "15.3184215"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -52.521181   28.266035   15.318421
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.226778107"
Evaluating: 0.226778107*360.0
 Parameter: XPHI <- "81.6401185"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.300045131"
Evaluating: 0.300045131*360.0
 Parameter: YPHI <- "108.016247"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.299520346"
Evaluating: 0.299520346*360.0
 Parameter: ZPHI <- "107.827325"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-52.5211812"
 Parameter: YPOS -> "28.2660349"
 Parameter: ZPOS -> "15.3184215"
 Parameter: XPHI -> "81.6401185"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.145390    0.989374
    0.000000   -0.989374    0.145390

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   81.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-52.5211812"
 Parameter: YPOS -> "28.2660349"
 Parameter: ZPOS -> "15.3184215"
 Parameter: YPHI -> "108.016247"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.309287    0.000000   -0.950969
    0.000000    1.000000    0.000000
    0.950969    0.000000   -0.309287

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  108.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-52.5211812"
 Parameter: YPOS -> "28.2660349"
 Parameter: ZPOS -> "15.3184215"
 Parameter: ZPHI -> "107.827325"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.306149    0.951983    0.000000
   -0.951983   -0.306149    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  107.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -52.521181 XMAX =  -52.521181 XAVE =  -52.521181
    YMIN =   28.266035 YMAX =   28.266035 YAVE =   28.266035
    ZMIN =   15.318421 ZMAX =   15.318421 ZAVE =   15.318421
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-52.5211812"
Evaluating: -52.5211812+3.5
 Parameter: XMAX <- "-49.0211812"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.2660349"
Evaluating: 28.2660349+3.5
 Parameter: YMAX <- "31.7660349"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.3184215"
Evaluating: 15.3184215+3.5
 Parameter: ZMAX <- "18.8184215"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-52.5211812"
Evaluating: -52.5211812-3.5
 Parameter: XMIN <- "-56.0211812"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.2660349"
Evaluating: 28.2660349-3.5
 Parameter: YMIN <- "24.7660349"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.3184215"
Evaluating: 15.3184215-3.5
 Parameter: ZMIN <- "11.8184215"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-49.0211812"
 Parameter: XMIN -> "-56.0211812"
 Parameter: YMAX -> "31.7660349"
 Parameter: YMIN -> "24.7660349"
 Parameter: ZMAX -> "18.8184215"
 Parameter: ZMIN -> "11.8184215"
 SELRPN>     21 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     11 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53248 NEG      CLA      71       CLA     -**** MEMB     POPC     129      O11           3.9679
53248 NEG      CLA      71       CLA     -**** MEMB     POPC     129      C1            3.4912
53248 NEG      CLA      71       CLA     -**** MEMB     POPC     129      C2            2.2594
53248 NEG      CLA      71       CLA     -**** MEMB     POPC     129      O21           2.6957
53248 NEG      CLA      71       CLA     -**** MEMB     POPC     129      C3            0.9084
53248 NEG      CLA      71       CLA     -**** MEMB     POPC     129      O31           0.6602
53248 NEG      CLA      71       CLA     -**** MEMB     POPC     129      C31           1.8410
53248 NEG      CLA      71       CLA     -**** MEMB     POPC     129      O32           2.5224
53248 NEG      CLA      71       CLA     -**** MEMB     POPC     129      C32           2.9693
53248 NEG      CLA      71       CLA     -**** MEMB     POPC     129      C33           3.4656
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "191"
Evaluating: 191
 Parameter: J <- "191"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "191" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "191"
 Parameter: NPOS -> "120"
Evaluating: 191-120
 Parameter: J <- "71"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.444016607"
Evaluating: 112.065471*(0.444016607-0.5)
 Parameter: XPOS <- "-6.2738053"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.667328223"
Evaluating: 112.065471*(0.667328223-0.5)
 Parameter: YPOS <- "18.7517161"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.199536468"
Evaluating: 142.885239*(0.199536468-0.5)+2.93414115
 Parameter: ZPOS <- "-39.9976624"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.9976624" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -52.521181 XMAX =  -52.521181 XAVE =  -52.521181
    YMIN =   28.266035 YMAX =   28.266035 YAVE =   28.266035
    ZMIN =   15.318421 ZMAX =   15.318421 ZAVE =   15.318421
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.2738053"
 RDCMND substituted energy or value "?XAVE" to "-52.5211812"
Evaluating: -6.2738053--52.5211812
 Parameter: XTRAN <- "46.2473759"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.7517161"
 RDCMND substituted energy or value "?YAVE" to "28.2660349"
Evaluating: 18.7517161-28.2660349
 Parameter: YTRAN <- "-9.5143188"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.9976624"
 RDCMND substituted energy or value "?ZAVE" to "15.3184215"
Evaluating: -39.9976624-15.3184215
 Parameter: ZTRAN <- "-55.3160839"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.2473759"
 Parameter: YTRAN -> "-9.5143188"
 Parameter: ZTRAN -> "-55.3160839"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    46.247376   -9.514319  -55.316084
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.690381396E-02"
Evaluating: 5.690381396E-02*360.0
 Parameter: XPHI <- "20.485373"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.597014129"
Evaluating: 0.597014129*360.0
 Parameter: YPHI <- "214.925086"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.284667839"
Evaluating: 0.284667839*360.0
 Parameter: ZPHI <- "102.480422"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.2738053"
 Parameter: YPOS -> "18.7517161"
 Parameter: ZPOS -> "-39.9976624"
 Parameter: XPHI -> "20.485373"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.936762    0.349968
    0.000000   -0.349968    0.936762

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   20.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.2738053"
 Parameter: YPOS -> "18.7517161"
 Parameter: ZPOS -> "-39.9976624"
 Parameter: YPHI -> "214.925086"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.819901    0.000000    0.572505
    0.000000    1.000000    0.000000
   -0.572505    0.000000   -0.819901

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  145.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.2738053"
 Parameter: YPOS -> "18.7517161"
 Parameter: ZPOS -> "-39.9976624"
 Parameter: ZPHI -> "102.480422"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.216106    0.976370    0.000000
   -0.976370   -0.216106    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  102.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.273805 XMAX =   -6.273805 XAVE =   -6.273805
    YMIN =   18.751716 YMAX =   18.751716 YAVE =   18.751716
    ZMIN =  -39.997662 ZMAX =  -39.997662 ZAVE =  -39.997662
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.2738053"
Evaluating: -6.2738053+3.5
 Parameter: XMAX <- "-2.7738053"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.7517161"
Evaluating: 18.7517161+3.5
 Parameter: YMAX <- "22.2517161"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.9976624"
Evaluating: -39.9976624+3.5
 Parameter: ZMAX <- "-36.4976624"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.2738053"
Evaluating: -6.2738053-3.5
 Parameter: XMIN <- "-9.7738053"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.7517161"
Evaluating: 18.7517161-3.5
 Parameter: YMIN <- "15.2517161"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.9976624"
Evaluating: -39.9976624-3.5
 Parameter: ZMIN <- "-43.4976624"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.7738053"
 Parameter: XMIN -> "-9.7738053"
 Parameter: YMAX -> "22.2517161"
 Parameter: YMIN -> "15.2517161"
 Parameter: ZMAX -> "-36.4976624"
 Parameter: ZMIN -> "-43.4976624"
 SELRPN>      2 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      1 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53248 NEG      CLA      71       CLA     -9497 PROF     ARG      70       NH1           4.9610
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "191"
Evaluating: 191
 Parameter: J <- "191"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "191" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "191"
 Parameter: NPOS -> "120"
Evaluating: 191-120
 Parameter: J <- "71"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.484377558E-03"
Evaluating: 112.065471*(5.484377558E-03-0.5)
 Parameter: XPOS <- "-55.4181261"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.148302177"
Evaluating: 112.065471*(0.148302177-0.5)
 Parameter: YPOS <- "-39.4131822"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.340939526"
Evaluating: 142.885239*(0.340939526-0.5)+2.93414115
 Parameter: ZPOS <- "-19.7932527"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.7932527" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.273805 XMAX =   -6.273805 XAVE =   -6.273805
    YMIN =   18.751716 YMAX =   18.751716 YAVE =   18.751716
    ZMIN =  -39.997662 ZMAX =  -39.997662 ZAVE =  -39.997662
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-55.4181261"
 RDCMND substituted energy or value "?XAVE" to "-6.2738053"
Evaluating: -55.4181261--6.2738053
 Parameter: XTRAN <- "-49.1443208"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.4131822"
 RDCMND substituted energy or value "?YAVE" to "18.7517161"
Evaluating: -39.4131822-18.7517161
 Parameter: YTRAN <- "-58.1648983"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.7932527"
 RDCMND substituted energy or value "?ZAVE" to "-39.9976624"
Evaluating: -19.7932527--39.9976624
 Parameter: ZTRAN <- "20.2044097"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.1443208"
 Parameter: YTRAN -> "-58.1648983"
 Parameter: ZTRAN -> "20.2044097"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -49.144321  -58.164898   20.204410
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.63552994"
Evaluating: 0.63552994*360.0
 Parameter: XPHI <- "228.790778"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.712130557"
Evaluating: 0.712130557*360.0
 Parameter: YPHI <- "256.367001"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.468472717"
Evaluating: 0.468472717*360.0
 Parameter: ZPHI <- "168.650178"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-55.4181261"
 Parameter: YPOS -> "-39.4131822"
 Parameter: ZPOS -> "-19.7932527"
 Parameter: XPHI -> "228.790778"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.658811   -0.752309
    0.000000    0.752309   -0.658811

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  131.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-55.4181261"
 Parameter: YPOS -> "-39.4131822"
 Parameter: ZPOS -> "-19.7932527"
 Parameter: YPHI -> "256.367001"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.235702    0.000000    0.971825
    0.000000    1.000000    0.000000
   -0.971825    0.000000   -0.235702

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  103.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-55.4181261"
 Parameter: YPOS -> "-39.4131822"
 Parameter: ZPOS -> "-19.7932527"
 Parameter: ZPHI -> "168.650178"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.980444    0.196799    0.000000
   -0.196799   -0.980444    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  168.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -55.418126 XMAX =  -55.418126 XAVE =  -55.418126
    YMIN =  -39.413182 YMAX =  -39.413182 YAVE =  -39.413182
    ZMIN =  -19.793253 ZMAX =  -19.793253 ZAVE =  -19.793253
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-55.4181261"
Evaluating: -55.4181261+3.5
 Parameter: XMAX <- "-51.9181261"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.4131822"
Evaluating: -39.4131822+3.5
 Parameter: YMAX <- "-35.9131822"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.7932527"
Evaluating: -19.7932527+3.5
 Parameter: ZMAX <- "-16.2932527"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-55.4181261"
Evaluating: -55.4181261-3.5
 Parameter: XMIN <- "-58.9181261"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.4131822"
Evaluating: -39.4131822-3.5
 Parameter: YMIN <- "-42.9131822"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.7932527"
Evaluating: -19.7932527-3.5
 Parameter: ZMIN <- "-23.2932527"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-51.9181261"
 Parameter: XMIN -> "-58.9181261"
 Parameter: YMAX -> "-35.9131822"
 Parameter: YMIN -> "-42.9131822"
 Parameter: ZMAX -> "-16.2932527"
 Parameter: ZMIN -> "-23.2932527"
 SELRPN>      2 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      1 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "192"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "192" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "192"
Evaluating: 192
 Parameter: J <- "192"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "192" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "192"
 Parameter: NPOS -> "120"
Evaluating: 192-120
 Parameter: J <- "72"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.462897064"
Evaluating: 112.065471*(0.462897064-0.5)
 Parameter: XPOS <- "-4.157958"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.301094001"
Evaluating: 112.065471*(0.301094001-0.5)
 Parameter: YPOS <- "-22.2904945"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "6.934990475E-02"
Evaluating: 142.885239*(6.934990475E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-58.5994006"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-58.5994006" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.157958"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.157958-0
 Parameter: XTRAN <- "-4.157958"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.2904945"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.2904945-0
 Parameter: YTRAN <- "-22.2904945"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-58.5994006"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -58.5994006-0
 Parameter: ZTRAN <- "-58.5994006"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.157958"
 Parameter: YTRAN -> "-22.2904945"
 Parameter: ZTRAN -> "-58.5994006"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -4.157958  -22.290495  -58.599401
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.960495675E-02"
Evaluating: 8.960495675E-02*360.0
 Parameter: XPHI <- "32.2577844"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.415079826"
Evaluating: 0.415079826*360.0
 Parameter: YPHI <- "149.428737"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.801051914"
Evaluating: 0.801051914*360.0
 Parameter: ZPHI <- "288.378689"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.157958"
 Parameter: YPOS -> "-22.2904945"
 Parameter: ZPOS -> "-58.5994006"
 Parameter: XPHI -> "32.2577844"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.845655    0.533729
    0.000000   -0.533729    0.845655

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   32.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.157958"
 Parameter: YPOS -> "-22.2904945"
 Parameter: ZPOS -> "-58.5994006"
 Parameter: YPHI -> "149.428737"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.860997    0.000000   -0.508610
    0.000000    1.000000    0.000000
    0.508610    0.000000   -0.860997

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  149.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.157958"
 Parameter: YPOS -> "-22.2904945"
 Parameter: ZPOS -> "-58.5994006"
 Parameter: ZPHI -> "288.378689"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.315296   -0.948993    0.000000
    0.948993    0.315296    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   71.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.157958 XMAX =   -4.157958 XAVE =   -4.157958
    YMIN =  -22.290495 YMAX =  -22.290495 YAVE =  -22.290495
    ZMIN =  -58.599401 ZMAX =  -58.599401 ZAVE =  -58.599401
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.157958"
Evaluating: -4.157958+3.5
 Parameter: XMAX <- "-0.657958"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.2904945"
Evaluating: -22.2904945+3.5
 Parameter: YMAX <- "-18.7904945"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-58.5994006"
Evaluating: -58.5994006+3.5
 Parameter: ZMAX <- "-55.0994006"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.157958"
Evaluating: -4.157958-3.5
 Parameter: XMIN <- "-7.657958"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.2904945"
Evaluating: -22.2904945-3.5
 Parameter: YMIN <- "-25.7904945"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-58.5994006"
Evaluating: -58.5994006-3.5
 Parameter: ZMIN <- "-62.0994006"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.657958"
 Parameter: XMIN -> "-7.657958"
 Parameter: YMAX -> "-18.7904945"
 Parameter: YMIN -> "-25.7904945"
 Parameter: ZMAX -> "-55.0994006"
 Parameter: ZMIN -> "-62.0994006"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "193"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "193" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "193"
Evaluating: 193
 Parameter: J <- "193"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "193" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "193"
 Parameter: NPOS -> "120"
Evaluating: 193-120
 Parameter: J <- "73"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.673299603"
Evaluating: 112.065471*(0.673299603-0.5)
 Parameter: XPOS <- "19.4209016"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.185957391"
Evaluating: 112.065471*(0.185957391-0.5)
 Parameter: YPOS <- "-35.1933329"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.685075447"
Evaluating: 142.885239*(0.685075447-0.5)+2.93414115
 Parameter: ZPOS <- "29.3786906"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.3786906" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.3786906" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.4209016"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 19.4209016-0
 Parameter: XTRAN <- "19.4209016"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.1933329"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.1933329-0
 Parameter: YTRAN <- "-35.1933329"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.3786906"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.3786906-0
 Parameter: ZTRAN <- "29.3786906"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.4209016"
 Parameter: YTRAN -> "-35.1933329"
 Parameter: ZTRAN -> "29.3786906"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    19.420902  -35.193333   29.378691
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.259892443"
Evaluating: 0.259892443*360.0
 Parameter: XPHI <- "93.5612795"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.517888783"
Evaluating: 0.517888783*360.0
 Parameter: YPHI <- "186.439962"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.284122109"
Evaluating: 0.284122109*360.0
 Parameter: ZPHI <- "102.283959"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.4209016"
 Parameter: YPOS -> "-35.1933329"
 Parameter: ZPOS -> "29.3786906"
 Parameter: XPHI -> "93.5612795"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.062116    0.998069
    0.000000   -0.998069   -0.062116

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   93.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.4209016"
 Parameter: YPOS -> "-35.1933329"
 Parameter: ZPOS -> "29.3786906"
 Parameter: YPHI -> "186.439962"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.993690    0.000000    0.112162
    0.000000    1.000000    0.000000
   -0.112162    0.000000   -0.993690

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  173.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.4209016"
 Parameter: YPOS -> "-35.1933329"
 Parameter: ZPOS -> "29.3786906"
 Parameter: ZPHI -> "102.283959"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.212757    0.977105    0.000000
   -0.977105   -0.212757    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  102.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.420902 XMAX =   19.420902 XAVE =   19.420902
    YMIN =  -35.193333 YMAX =  -35.193333 YAVE =  -35.193333
    ZMIN =   29.378691 ZMAX =   29.378691 ZAVE =   29.378691
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.4209016"
Evaluating: 19.4209016+3.5
 Parameter: XMAX <- "22.9209016"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.1933329"
Evaluating: -35.1933329+3.5
 Parameter: YMAX <- "-31.6933329"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.3786906"
Evaluating: 29.3786906+3.5
 Parameter: ZMAX <- "32.8786906"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.4209016"
Evaluating: 19.4209016-3.5
 Parameter: XMIN <- "15.9209016"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.1933329"
Evaluating: -35.1933329-3.5
 Parameter: YMIN <- "-38.6933329"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.3786906"
Evaluating: 29.3786906-3.5
 Parameter: ZMIN <- "25.8786906"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.9209016"
 Parameter: XMIN -> "15.9209016"
 Parameter: YMAX -> "-31.6933329"
 Parameter: YMIN -> "-38.6933329"
 Parameter: ZMAX -> "32.8786906"
 Parameter: ZMIN -> "25.8786906"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "194"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "194" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "194"
Evaluating: 194
 Parameter: J <- "194"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "194" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "194"
 Parameter: NPOS -> "120"
Evaluating: 194-120
 Parameter: J <- "74"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.303818909"
Evaluating: 112.065471*(0.303818909-0.5)
 Parameter: XPOS <- "-21.9851264"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.225057031"
Evaluating: 112.065471*(0.225057031-0.5)
 Parameter: YPOS <- "-30.8116133"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "7.836341473E-02"
Evaluating: 142.885239*(7.836341473E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-57.3115031"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.3115031" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.9851264"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -21.9851264-0
 Parameter: XTRAN <- "-21.9851264"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.8116133"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.8116133-0
 Parameter: YTRAN <- "-30.8116133"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.3115031"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -57.3115031-0
 Parameter: ZTRAN <- "-57.3115031"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.9851264"
 Parameter: YTRAN -> "-30.8116133"
 Parameter: ZTRAN -> "-57.3115031"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -21.985126  -30.811613  -57.311503
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.321377399"
Evaluating: 0.321377399*360.0
 Parameter: XPHI <- "115.695864"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.758184069"
Evaluating: 0.758184069*360.0
 Parameter: YPHI <- "272.946265"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.745354907"
Evaluating: 0.745354907*360.0
 Parameter: ZPHI <- "268.327767"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.9851264"
 Parameter: YPOS -> "-30.8116133"
 Parameter: ZPOS -> "-57.3115031"
 Parameter: XPHI -> "115.695864"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.433594    0.901108
    0.000000   -0.901108   -0.433594

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.9851264"
 Parameter: YPOS -> "-30.8116133"
 Parameter: ZPOS -> "-57.3115031"
 Parameter: YPHI -> "272.946265"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.051399    0.000000    0.998678
    0.000000    1.000000    0.000000
   -0.998678    0.000000    0.051399

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   87.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.9851264"
 Parameter: YPOS -> "-30.8116133"
 Parameter: ZPOS -> "-57.3115031"
 Parameter: ZPHI -> "268.327767"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.029182   -0.999574    0.000000
    0.999574   -0.029182    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   91.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.985126 XMAX =  -21.985126 XAVE =  -21.985126
    YMIN =  -30.811613 YMAX =  -30.811613 YAVE =  -30.811613
    ZMIN =  -57.311503 ZMAX =  -57.311503 ZAVE =  -57.311503
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.9851264"
Evaluating: -21.9851264+3.5
 Parameter: XMAX <- "-18.4851264"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.8116133"
Evaluating: -30.8116133+3.5
 Parameter: YMAX <- "-27.3116133"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.3115031"
Evaluating: -57.3115031+3.5
 Parameter: ZMAX <- "-53.8115031"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.9851264"
Evaluating: -21.9851264-3.5
 Parameter: XMIN <- "-25.4851264"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.8116133"
Evaluating: -30.8116133-3.5
 Parameter: YMIN <- "-34.3116133"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.3115031"
Evaluating: -57.3115031-3.5
 Parameter: ZMIN <- "-60.8115031"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.4851264"
 Parameter: XMIN -> "-25.4851264"
 Parameter: YMAX -> "-27.3116133"
 Parameter: YMIN -> "-34.3116133"
 Parameter: ZMAX -> "-53.8115031"
 Parameter: ZMIN -> "-60.8115031"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "195"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "195" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "195"
Evaluating: 195
 Parameter: J <- "195"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "195" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "195"
 Parameter: NPOS -> "120"
Evaluating: 195-120
 Parameter: J <- "75"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.872469915"
Evaluating: 112.065471*(0.872469915-0.5)
 Parameter: XPOS <- "41.7410165"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.394232624"
Evaluating: 112.065471*(0.394232624-0.5)
 Parameter: YPOS <- "-11.8528708"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.744868133"
Evaluating: 142.885239*(0.744868133-0.5)+2.93414115
 Parameter: ZPOS <- "37.9221829"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.9221829" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.9221829" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.7410165"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.7410165-0
 Parameter: XTRAN <- "41.7410165"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.8528708"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.8528708-0
 Parameter: YTRAN <- "-11.8528708"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.9221829"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.9221829-0
 Parameter: ZTRAN <- "37.9221829"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.7410165"
 Parameter: YTRAN -> "-11.8528708"
 Parameter: ZTRAN -> "37.9221829"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    41.741017  -11.852871   37.922183
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.870583226"
Evaluating: 0.870583226*360.0
 Parameter: XPHI <- "313.409961"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.273572991"
Evaluating: 0.273572991*360.0
 Parameter: YPHI <- "98.4862768"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.702253267"
Evaluating: 0.702253267*360.0
 Parameter: ZPHI <- "252.811176"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.7410165"
 Parameter: YPOS -> "-11.8528708"
 Parameter: ZPOS -> "37.9221829"
 Parameter: XPHI -> "313.409961"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.687214   -0.726455
    0.000000    0.726455    0.687214

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   46.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.7410165"
 Parameter: YPOS -> "-11.8528708"
 Parameter: ZPOS -> "37.9221829"
 Parameter: YPHI -> "98.4862768"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.147573    0.000000   -0.989051
    0.000000    1.000000    0.000000
    0.989051    0.000000   -0.147573

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.7410165"
 Parameter: YPOS -> "-11.8528708"
 Parameter: ZPOS -> "37.9221829"
 Parameter: ZPHI -> "252.811176"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.295522   -0.955336    0.000000
    0.955336   -0.295522    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  107.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.741017 XMAX =   41.741017 XAVE =   41.741017
    YMIN =  -11.852871 YMAX =  -11.852871 YAVE =  -11.852871
    ZMIN =   37.922183 ZMAX =   37.922183 ZAVE =   37.922183
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.7410165"
Evaluating: 41.7410165+3.5
 Parameter: XMAX <- "45.2410165"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.8528708"
Evaluating: -11.8528708+3.5
 Parameter: YMAX <- "-8.3528708"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.9221829"
Evaluating: 37.9221829+3.5
 Parameter: ZMAX <- "41.4221829"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.7410165"
Evaluating: 41.7410165-3.5
 Parameter: XMIN <- "38.2410165"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.8528708"
Evaluating: -11.8528708-3.5
 Parameter: YMIN <- "-15.3528708"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.9221829"
Evaluating: 37.9221829-3.5
 Parameter: ZMIN <- "34.4221829"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.2410165"
 Parameter: XMIN -> "38.2410165"
 Parameter: YMAX -> "-8.3528708"
 Parameter: YMIN -> "-15.3528708"
 Parameter: ZMAX -> "41.4221829"
 Parameter: ZMIN -> "34.4221829"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "196"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "196" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "196"
Evaluating: 196
 Parameter: J <- "196"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "196" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "196"
 Parameter: NPOS -> "120"
Evaluating: 196-120
 Parameter: J <- "76"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.77133053"
Evaluating: 112.065471*(0.77133053-0.5)
 Parameter: XPOS <- "30.4067836"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.634720862"
Evaluating: 112.065471*(0.634720862-0.5)
 Parameter: YPOS <- "15.0975569"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.352297879"
Evaluating: 142.885239*(0.352297879-0.5)+2.93414115
 Parameter: ZPOS <- "-18.1703117"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.1703117" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.4067836"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.4067836-0
 Parameter: XTRAN <- "30.4067836"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.0975569"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.0975569-0
 Parameter: YTRAN <- "15.0975569"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.1703117"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.1703117-0
 Parameter: ZTRAN <- "-18.1703117"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.4067836"
 Parameter: YTRAN -> "15.0975569"
 Parameter: ZTRAN -> "-18.1703117"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    30.406784   15.097557  -18.170312
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.31601771"
Evaluating: 0.31601771*360.0
 Parameter: XPHI <- "113.766376"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.830890019"
Evaluating: 0.830890019*360.0
 Parameter: YPHI <- "299.120407"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.650109423"
Evaluating: 0.650109423*360.0
 Parameter: ZPHI <- "234.039392"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.4067836"
 Parameter: YPOS -> "15.0975569"
 Parameter: ZPOS -> "-18.1703117"
 Parameter: XPHI -> "113.766376"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.403008    0.915196
    0.000000   -0.915196   -0.403008

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.4067836"
 Parameter: YPOS -> "15.0975569"
 Parameter: ZPOS -> "-18.1703117"
 Parameter: YPHI -> "299.120407"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.486647    0.000000    0.873599
    0.000000    1.000000    0.000000
   -0.873599    0.000000    0.486647

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   60.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.4067836"
 Parameter: YPOS -> "15.0975569"
 Parameter: ZPOS -> "-18.1703117"
 Parameter: ZPHI -> "234.039392"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.587229   -0.809421    0.000000
    0.809421   -0.587229    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  125.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.406784 XMAX =   30.406784 XAVE =   30.406784
    YMIN =   15.097557 YMAX =   15.097557 YAVE =   15.097557
    ZMIN =  -18.170312 ZMAX =  -18.170312 ZAVE =  -18.170312
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.4067836"
Evaluating: 30.4067836+3.5
 Parameter: XMAX <- "33.9067836"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.0975569"
Evaluating: 15.0975569+3.5
 Parameter: YMAX <- "18.5975569"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.1703117"
Evaluating: -18.1703117+3.5
 Parameter: ZMAX <- "-14.6703117"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.4067836"
Evaluating: 30.4067836-3.5
 Parameter: XMIN <- "26.9067836"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.0975569"
Evaluating: 15.0975569-3.5
 Parameter: YMIN <- "11.5975569"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.1703117"
Evaluating: -18.1703117-3.5
 Parameter: ZMIN <- "-21.6703117"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.9067836"
 Parameter: XMIN -> "26.9067836"
 Parameter: YMAX -> "18.5975569"
 Parameter: YMIN -> "11.5975569"
 Parameter: ZMAX -> "-14.6703117"
 Parameter: ZMIN -> "-21.6703117"
 SELRPN>     33 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     17 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     183      C2            3.4609
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     183      O21           3.8564
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     183      C21           3.6771
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     183      O22           3.4894
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      N             3.1536
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      C12           2.7682
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      C13           3.5870
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      C15           2.9145
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      C11           1.6658
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      P             2.2083
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      O13           2.8811
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      O14           3.3590
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      O12           0.7553
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      O11           2.7210
53253 NEG      CLA      76       CLA     -**** MEMB     POPC     187      C1            2.8568
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        15
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "15"
 Comparing "15" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "196"
Evaluating: 196
 Parameter: J <- "196"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "196" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "196"
 Parameter: NPOS -> "120"
Evaluating: 196-120
 Parameter: J <- "76"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.733115859"
Evaluating: 112.065471*(0.733115859-0.5)
 Parameter: XPOS <- "26.1242385"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "1.152933458E-02"
Evaluating: 112.065471*(1.152933458E-02-0.5)
 Parameter: YPOS <- "-54.7406952"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "7.441703873E-02"
Evaluating: 142.885239*(7.441703873E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-57.875382"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.875382" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.406784 XMAX =   30.406784 XAVE =   30.406784
    YMIN =   15.097557 YMAX =   15.097557 YAVE =   15.097557
    ZMIN =  -18.170312 ZMAX =  -18.170312 ZAVE =  -18.170312
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.1242385"
 RDCMND substituted energy or value "?XAVE" to "30.4067836"
Evaluating: 26.1242385-30.4067836
 Parameter: XTRAN <- "-4.2825451"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-54.7406952"
 RDCMND substituted energy or value "?YAVE" to "15.0975569"
Evaluating: -54.7406952-15.0975569
 Parameter: YTRAN <- "-69.8382521"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.875382"
 RDCMND substituted energy or value "?ZAVE" to "-18.1703117"
Evaluating: -57.875382--18.1703117
 Parameter: ZTRAN <- "-39.7050703"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.2825451"
 Parameter: YTRAN -> "-69.8382521"
 Parameter: ZTRAN -> "-39.7050703"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -4.282545  -69.838252  -39.705070
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.989153435"
Evaluating: 0.989153435*360.0
 Parameter: XPHI <- "356.095237"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.711780923"
Evaluating: 0.711780923*360.0
 Parameter: YPHI <- "256.241132"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.172034306E-02"
Evaluating: 4.172034306E-02*360.0
 Parameter: ZPHI <- "15.0193235"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.1242385"
 Parameter: YPOS -> "-54.7406952"
 Parameter: ZPOS -> "-57.875382"
 Parameter: XPHI -> "356.095237"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997679   -0.068098
    0.000000    0.068098    0.997679

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    3.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.1242385"
 Parameter: YPOS -> "-54.7406952"
 Parameter: ZPOS -> "-57.875382"
 Parameter: YPHI -> "256.241132"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.237836    0.000000    0.971305
    0.000000    1.000000    0.000000
   -0.971305    0.000000   -0.237836

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  103.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.1242385"
 Parameter: YPOS -> "-54.7406952"
 Parameter: ZPOS -> "-57.875382"
 Parameter: ZPHI -> "15.0193235"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.965838    0.259145    0.000000
   -0.259145    0.965838    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   15.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.124238 XMAX =   26.124238 XAVE =   26.124238
    YMIN =  -54.740695 YMAX =  -54.740695 YAVE =  -54.740695
    ZMIN =  -57.875382 ZMAX =  -57.875382 ZAVE =  -57.875382
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.1242385"
Evaluating: 26.1242385+3.5
 Parameter: XMAX <- "29.6242385"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-54.7406952"
Evaluating: -54.7406952+3.5
 Parameter: YMAX <- "-51.2406952"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.875382"
Evaluating: -57.875382+3.5
 Parameter: ZMAX <- "-54.375382"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.1242385"
Evaluating: 26.1242385-3.5
 Parameter: XMIN <- "22.6242385"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-54.7406952"
Evaluating: -54.7406952-3.5
 Parameter: YMIN <- "-58.2406952"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.875382"
Evaluating: -57.875382-3.5
 Parameter: ZMIN <- "-61.375382"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.6242385"
 Parameter: XMIN -> "22.6242385"
 Parameter: YMAX -> "-51.2406952"
 Parameter: YMIN -> "-58.2406952"
 Parameter: ZMAX -> "-54.375382"
 Parameter: ZMIN -> "-61.375382"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "197"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "197" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "197"
Evaluating: 197
 Parameter: J <- "197"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "197" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "197"
 Parameter: NPOS -> "120"
Evaluating: 197-120
 Parameter: J <- "77"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "9.949120113E-02"
Evaluating: 112.065471*(9.949120113E-02-0.5)
 Parameter: XPOS <- "-44.8832072"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.85657684"
Evaluating: 112.065471*(0.85657684-0.5)
 Parameter: YPOS <- "39.9599515"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "2.729013779E-02"
Evaluating: 142.885239*(2.729013779E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-64.6091205"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-64.6091205" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.8832072"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.8832072-0
 Parameter: XTRAN <- "-44.8832072"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.9599515"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 39.9599515-0
 Parameter: YTRAN <- "39.9599515"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-64.6091205"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -64.6091205-0
 Parameter: ZTRAN <- "-64.6091205"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.8832072"
 Parameter: YTRAN -> "39.9599515"
 Parameter: ZTRAN -> "-64.6091205"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -44.883207   39.959952  -64.609121
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.425176115"
Evaluating: 0.425176115*360.0
 Parameter: XPHI <- "153.063401"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.764020504"
Evaluating: 0.764020504*360.0
 Parameter: YPHI <- "275.047381"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.129251917"
Evaluating: 0.129251917*360.0
 Parameter: ZPHI <- "46.5306901"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.8832072"
 Parameter: YPOS -> "39.9599515"
 Parameter: ZPOS -> "-64.6091205"
 Parameter: XPHI -> "153.063401"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.891508    0.453004
    0.000000   -0.453004   -0.891508

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  153.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.8832072"
 Parameter: YPOS -> "39.9599515"
 Parameter: ZPOS -> "-64.6091205"
 Parameter: YPHI -> "275.047381"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.087980    0.000000    0.996122
    0.000000    1.000000    0.000000
   -0.996122    0.000000    0.087980

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   84.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.8832072"
 Parameter: YPOS -> "39.9599515"
 Parameter: ZPOS -> "-64.6091205"
 Parameter: ZPHI -> "46.5306901"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.687966    0.725743    0.000000
   -0.725743    0.687966    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   46.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.883207 XMAX =  -44.883207 XAVE =  -44.883207
    YMIN =   39.959952 YMAX =   39.959952 YAVE =   39.959952
    ZMIN =  -64.609121 ZMAX =  -64.609121 ZAVE =  -64.609121
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.8832072"
Evaluating: -44.8832072+3.5
 Parameter: XMAX <- "-41.3832072"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.9599515"
Evaluating: 39.9599515+3.5
 Parameter: YMAX <- "43.4599515"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-64.6091205"
Evaluating: -64.6091205+3.5
 Parameter: ZMAX <- "-61.1091205"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.8832072"
Evaluating: -44.8832072-3.5
 Parameter: XMIN <- "-48.3832072"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.9599515"
Evaluating: 39.9599515-3.5
 Parameter: YMIN <- "36.4599515"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-64.6091205"
Evaluating: -64.6091205-3.5
 Parameter: ZMIN <- "-68.1091205"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.3832072"
 Parameter: XMIN -> "-48.3832072"
 Parameter: YMAX -> "43.4599515"
 Parameter: YMIN -> "36.4599515"
 Parameter: ZMAX -> "-61.1091205"
 Parameter: ZMIN -> "-68.1091205"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "198"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "198" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "198"
Evaluating: 198
 Parameter: J <- "198"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "198" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "198"
 Parameter: NPOS -> "120"
Evaluating: 198-120
 Parameter: J <- "78"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.666532033"
Evaluating: 112.065471*(0.666532033-0.5)
 Parameter: XPOS <- "18.6624907"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.993252595"
Evaluating: 112.065471*(0.993252595-0.5)
 Parameter: YPOS <- "55.2765844"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.411918816"
Evaluating: 142.885239*(0.411918816-0.5)+2.93414115
 Parameter: ZPOS <- "-9.65135988"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.65135988" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.65135988" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "198"
Evaluating: 198
 Parameter: J <- "198"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "198" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "198"
 Parameter: NPOS -> "120"
Evaluating: 198-120
 Parameter: J <- "78"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.397399613"
Evaluating: 112.065471*(0.397399613-0.5)
 Parameter: XPOS <- "-11.4979607"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.679231214"
Evaluating: 112.065471*(0.679231214-0.5)
 Parameter: YPOS <- "20.0856304"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "6.639687847E-02"
Evaluating: 142.885239*(6.639687847E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-59.0213445"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-59.0213445" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.4979607"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.4979607-0
 Parameter: XTRAN <- "-11.4979607"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.0856304"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.0856304-0
 Parameter: YTRAN <- "20.0856304"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-59.0213445"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -59.0213445-0
 Parameter: ZTRAN <- "-59.0213445"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.4979607"
 Parameter: YTRAN -> "20.0856304"
 Parameter: ZTRAN -> "-59.0213445"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -11.497961   20.085630  -59.021344
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.570870744"
Evaluating: 0.570870744*360.0
 Parameter: XPHI <- "205.513468"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.284597782"
Evaluating: 0.284597782*360.0
 Parameter: YPHI <- "102.455202"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.626831632"
Evaluating: 0.626831632*360.0
 Parameter: ZPHI <- "225.659388"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.4979607"
 Parameter: YPOS -> "20.0856304"
 Parameter: ZPOS -> "-59.0213445"
 Parameter: XPHI -> "205.513468"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.902484   -0.430723
    0.000000    0.430723   -0.902484

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  154.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.4979607"
 Parameter: YPOS -> "20.0856304"
 Parameter: ZPOS -> "-59.0213445"
 Parameter: YPHI -> "102.455202"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.215676    0.000000   -0.976465
    0.000000    1.000000    0.000000
    0.976465    0.000000   -0.215676

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  102.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.4979607"
 Parameter: YPOS -> "20.0856304"
 Parameter: ZPOS -> "-59.0213445"
 Parameter: ZPHI -> "225.659388"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.698922   -0.715198    0.000000
    0.715198   -0.698922    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  134.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.497961 XMAX =  -11.497961 XAVE =  -11.497961
    YMIN =   20.085630 YMAX =   20.085630 YAVE =   20.085630
    ZMIN =  -59.021344 ZMAX =  -59.021344 ZAVE =  -59.021344
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.4979607"
Evaluating: -11.4979607+3.5
 Parameter: XMAX <- "-7.9979607"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.0856304"
Evaluating: 20.0856304+3.5
 Parameter: YMAX <- "23.5856304"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-59.0213445"
Evaluating: -59.0213445+3.5
 Parameter: ZMAX <- "-55.5213445"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.4979607"
Evaluating: -11.4979607-3.5
 Parameter: XMIN <- "-14.9979607"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.0856304"
Evaluating: 20.0856304-3.5
 Parameter: YMIN <- "16.5856304"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-59.0213445"
Evaluating: -59.0213445-3.5
 Parameter: ZMIN <- "-62.5213445"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.9979607"
 Parameter: XMIN -> "-14.9979607"
 Parameter: YMAX -> "23.5856304"
 Parameter: YMIN -> "16.5856304"
 Parameter: ZMAX -> "-55.5213445"
 Parameter: ZMIN -> "-62.5213445"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "199"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "199" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "199"
Evaluating: 199
 Parameter: J <- "199"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "199" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "199"
 Parameter: NPOS -> "120"
Evaluating: 199-120
 Parameter: J <- "79"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.919848066"
Evaluating: 112.065471*(0.919848066-0.5)
 Parameter: XPOS <- "47.0504713"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.184568585"
Evaluating: 112.065471*(0.184568585-0.5)
 Parameter: YPOS <- "-35.3489701"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.485715218"
Evaluating: 142.885239*(0.485715218-0.5)+2.93414115
 Parameter: ZPOS <- "0.89305666"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.89305666" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.89305666" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "199"
Evaluating: 199
 Parameter: J <- "199"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "199" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "199"
 Parameter: NPOS -> "120"
Evaluating: 199-120
 Parameter: J <- "79"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.981056228"
Evaluating: 112.065471*(0.981056228-0.5)
 Parameter: XPOS <- "53.9097928"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.789488646"
Evaluating: 112.065471*(0.789488646-0.5)
 Parameter: YPOS <- "32.4416815"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.825438347"
Evaluating: 142.885239*(0.825438347-0.5)+2.93414115
 Parameter: ZPOS <- "49.4344771"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.4344771" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.4344771" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.9097928"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.9097928-0
 Parameter: XTRAN <- "53.9097928"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.4416815"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.4416815-0
 Parameter: YTRAN <- "32.4416815"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.4344771"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.4344771-0
 Parameter: ZTRAN <- "49.4344771"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.9097928"
 Parameter: YTRAN -> "32.4416815"
 Parameter: ZTRAN -> "49.4344771"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    53.909793   32.441682   49.434477
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.863566991"
Evaluating: 0.863566991*360.0
 Parameter: XPHI <- "310.884117"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.84400782"
Evaluating: 0.84400782*360.0
 Parameter: YPHI <- "303.842815"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.96782235"
Evaluating: 0.96782235*360.0
 Parameter: ZPHI <- "348.416046"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.9097928"
 Parameter: YPOS -> "32.4416815"
 Parameter: ZPOS -> "49.4344771"
 Parameter: XPHI -> "310.884117"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.654531   -0.756035
    0.000000    0.756035    0.654531

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   49.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.9097928"
 Parameter: YPOS -> "32.4416815"
 Parameter: ZPOS -> "49.4344771"
 Parameter: YPHI -> "303.842815"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.556916    0.000000    0.830569
    0.000000    1.000000    0.000000
   -0.830569    0.000000    0.556916

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   56.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.9097928"
 Parameter: YPOS -> "32.4416815"
 Parameter: ZPOS -> "49.4344771"
 Parameter: ZPHI -> "348.416046"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.979632   -0.200804    0.000000
    0.200804    0.979632    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   11.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.909793 XMAX =   53.909793 XAVE =   53.909793
    YMIN =   32.441682 YMAX =   32.441682 YAVE =   32.441682
    ZMIN =   49.434477 ZMAX =   49.434477 ZAVE =   49.434477
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.9097928"
Evaluating: 53.9097928+3.5
 Parameter: XMAX <- "57.4097928"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.4416815"
Evaluating: 32.4416815+3.5
 Parameter: YMAX <- "35.9416815"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.4344771"
Evaluating: 49.4344771+3.5
 Parameter: ZMAX <- "52.9344771"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.9097928"
Evaluating: 53.9097928-3.5
 Parameter: XMIN <- "50.4097928"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.4416815"
Evaluating: 32.4416815-3.5
 Parameter: YMIN <- "28.9416815"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.4344771"
Evaluating: 49.4344771-3.5
 Parameter: ZMIN <- "45.9344771"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.4097928"
 Parameter: XMIN -> "50.4097928"
 Parameter: YMAX -> "35.9416815"
 Parameter: YMIN -> "28.9416815"
 Parameter: ZMAX -> "52.9344771"
 Parameter: ZMIN -> "45.9344771"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "200"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "200" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "200"
Evaluating: 200
 Parameter: J <- "200"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "200" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "200"
 Parameter: NPOS -> "120"
Evaluating: 200-120
 Parameter: J <- "80"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.634176148"
Evaluating: 112.065471*(0.634176148-0.5)
 Parameter: XPOS <- "15.0365132"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.707542454"
Evaluating: 112.065471*(0.707542454-0.5)
 Parameter: YPOS <- "23.2583429"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.279897135"
Evaluating: 142.885239*(0.279897135-0.5)+2.93414115
 Parameter: ZPOS <- "-28.5153093"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.5153093" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.0365132"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.0365132-0
 Parameter: XTRAN <- "15.0365132"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.2583429"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.2583429-0
 Parameter: YTRAN <- "23.2583429"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.5153093"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.5153093-0
 Parameter: ZTRAN <- "-28.5153093"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.0365132"
 Parameter: YTRAN -> "23.2583429"
 Parameter: ZTRAN -> "-28.5153093"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    15.036513   23.258343  -28.515309
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.483435676"
Evaluating: 0.483435676*360.0
 Parameter: XPHI <- "174.036843"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.270319856"
Evaluating: 0.270319856*360.0
 Parameter: YPHI <- "97.3151482"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.603097837"
Evaluating: 0.603097837*360.0
 Parameter: ZPHI <- "217.115221"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.0365132"
 Parameter: YPOS -> "23.2583429"
 Parameter: ZPOS -> "-28.5153093"
 Parameter: XPHI -> "174.036843"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.994589    0.103889
    0.000000   -0.103889   -0.994589

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  174.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.0365132"
 Parameter: YPOS -> "23.2583429"
 Parameter: ZPOS -> "-28.5153093"
 Parameter: YPHI -> "97.3151482"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.127327    0.000000   -0.991861
    0.000000    1.000000    0.000000
    0.991861    0.000000   -0.127327

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   97.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.0365132"
 Parameter: YPOS -> "23.2583429"
 Parameter: ZPOS -> "-28.5153093"
 Parameter: ZPHI -> "217.115221"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.797424   -0.603420    0.000000
    0.603420   -0.797424    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  142.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.036513 XMAX =   15.036513 XAVE =   15.036513
    YMIN =   23.258343 YMAX =   23.258343 YAVE =   23.258343
    ZMIN =  -28.515309 ZMAX =  -28.515309 ZAVE =  -28.515309
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.0365132"
Evaluating: 15.0365132+3.5
 Parameter: XMAX <- "18.5365132"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.2583429"
Evaluating: 23.2583429+3.5
 Parameter: YMAX <- "26.7583429"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.5153093"
Evaluating: -28.5153093+3.5
 Parameter: ZMAX <- "-25.0153093"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.0365132"
Evaluating: 15.0365132-3.5
 Parameter: XMIN <- "11.5365132"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.2583429"
Evaluating: 23.2583429-3.5
 Parameter: YMIN <- "19.7583429"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.5153093"
Evaluating: -28.5153093-3.5
 Parameter: ZMIN <- "-32.0153093"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.5365132"
 Parameter: XMIN -> "11.5365132"
 Parameter: YMAX -> "26.7583429"
 Parameter: YMIN -> "19.7583429"
 Parameter: ZMAX -> "-25.0153093"
 Parameter: ZMIN -> "-32.0153093"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "201"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "201" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "201"
Evaluating: 201
 Parameter: J <- "201"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "201" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "201"
 Parameter: NPOS -> "120"
Evaluating: 201-120
 Parameter: J <- "81"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.859397201"
Evaluating: 112.065471*(0.859397201-0.5)
 Parameter: XPOS <- "40.2760166"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "2.375023927E-02"
Evaluating: 112.065471*(2.375023927E-02-0.5)
 Parameter: YPOS <- "-53.3711537"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.173107542"
Evaluating: 142.885239*(0.173107542-0.5)+2.93414115
 Parameter: ZPOS <- "-43.7739658"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.7739658" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.2760166"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.2760166-0
 Parameter: XTRAN <- "40.2760166"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-53.3711537"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -53.3711537-0
 Parameter: YTRAN <- "-53.3711537"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.7739658"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.7739658-0
 Parameter: ZTRAN <- "-43.7739658"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.2760166"
 Parameter: YTRAN -> "-53.3711537"
 Parameter: ZTRAN -> "-43.7739658"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    40.276017  -53.371154  -43.773966
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.394622945"
Evaluating: 0.394622945*360.0
 Parameter: XPHI <- "142.06426"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.490738206"
Evaluating: 0.490738206*360.0
 Parameter: YPHI <- "176.665754"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.364001918"
Evaluating: 0.364001918*360.0
 Parameter: ZPHI <- "131.04069"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.2760166"
 Parameter: YPOS -> "-53.3711537"
 Parameter: ZPOS -> "-43.7739658"
 Parameter: XPHI -> "142.06426"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.788701    0.614777
    0.000000   -0.614777   -0.788701

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  142.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.2760166"
 Parameter: YPOS -> "-53.3711537"
 Parameter: ZPOS -> "-43.7739658"
 Parameter: YPHI -> "176.665754"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.998307    0.000000   -0.058161
    0.000000    1.000000    0.000000
    0.058161    0.000000   -0.998307

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  176.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.2760166"
 Parameter: YPOS -> "-53.3711537"
 Parameter: ZPOS -> "-43.7739658"
 Parameter: ZPHI -> "131.04069"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.656595    0.754243    0.000000
   -0.754243   -0.656595    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  131.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.276017 XMAX =   40.276017 XAVE =   40.276017
    YMIN =  -53.371154 YMAX =  -53.371154 YAVE =  -53.371154
    ZMIN =  -43.773966 ZMAX =  -43.773966 ZAVE =  -43.773966
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.2760166"
Evaluating: 40.2760166+3.5
 Parameter: XMAX <- "43.7760166"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-53.3711537"
Evaluating: -53.3711537+3.5
 Parameter: YMAX <- "-49.8711537"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.7739658"
Evaluating: -43.7739658+3.5
 Parameter: ZMAX <- "-40.2739658"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.2760166"
Evaluating: 40.2760166-3.5
 Parameter: XMIN <- "36.7760166"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-53.3711537"
Evaluating: -53.3711537-3.5
 Parameter: YMIN <- "-56.8711537"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.7739658"
Evaluating: -43.7739658-3.5
 Parameter: ZMIN <- "-47.2739658"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.7760166"
 Parameter: XMIN -> "36.7760166"
 Parameter: YMAX -> "-49.8711537"
 Parameter: YMIN -> "-56.8711537"
 Parameter: ZMAX -> "-40.2739658"
 Parameter: ZMIN -> "-47.2739658"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "202"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "202" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "202"
Evaluating: 202
 Parameter: J <- "202"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "202" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "202"
 Parameter: NPOS -> "120"
Evaluating: 202-120
 Parameter: J <- "82"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.965569105"
Evaluating: 112.065471*(0.965569105-0.5)
 Parameter: XPOS <- "52.174221"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.116590212E-02"
Evaluating: 112.065471*(5.116590212E-02-0.5)
 Parameter: YPOS <- "-50.2988046"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.656495589"
Evaluating: 142.885239*(0.656495589-0.5)+2.93414115
 Parameter: ZPOS <- "25.2950508"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.2950508" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.2950508" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "52.174221"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 52.174221-0
 Parameter: XTRAN <- "52.174221"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.2988046"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -50.2988046-0
 Parameter: YTRAN <- "-50.2988046"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.2950508"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.2950508-0
 Parameter: ZTRAN <- "25.2950508"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.174221"
 Parameter: YTRAN -> "-50.2988046"
 Parameter: ZTRAN -> "25.2950508"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    52.174221  -50.298805   25.295051
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.231022903"
Evaluating: 0.231022903*360.0
 Parameter: XPHI <- "83.1682451"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.153673485"
Evaluating: 0.153673485*360.0
 Parameter: YPHI <- "55.3224546"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.205077141E-02"
Evaluating: 2.205077141E-02*360.0
 Parameter: ZPHI <- "7.93827771"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "52.174221"
 Parameter: YPOS -> "-50.2988046"
 Parameter: ZPOS -> "25.2950508"
 Parameter: XPHI -> "83.1682451"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.118954    0.992900
    0.000000   -0.992900    0.118954

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   83.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "52.174221"
 Parameter: YPOS -> "-50.2988046"
 Parameter: ZPOS -> "25.2950508"
 Parameter: YPHI -> "55.3224546"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.568957    0.000000   -0.822367
    0.000000    1.000000    0.000000
    0.822367    0.000000    0.568957

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   55.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "52.174221"
 Parameter: YPOS -> "-50.2988046"
 Parameter: ZPOS -> "25.2950508"
 Parameter: ZPHI -> "7.93827771"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.990417    0.138106    0.000000
   -0.138106    0.990417    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    7.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   52.174221 XMAX =   52.174221 XAVE =   52.174221
    YMIN =  -50.298805 YMAX =  -50.298805 YAVE =  -50.298805
    ZMIN =   25.295051 ZMAX =   25.295051 ZAVE =   25.295051
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "52.174221"
Evaluating: 52.174221+3.5
 Parameter: XMAX <- "55.674221"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.2988046"
Evaluating: -50.2988046+3.5
 Parameter: YMAX <- "-46.7988046"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.2950508"
Evaluating: 25.2950508+3.5
 Parameter: ZMAX <- "28.7950508"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "52.174221"
Evaluating: 52.174221-3.5
 Parameter: XMIN <- "48.674221"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.2988046"
Evaluating: -50.2988046-3.5
 Parameter: YMIN <- "-53.7988046"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.2950508"
Evaluating: 25.2950508-3.5
 Parameter: ZMIN <- "21.7950508"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.674221"
 Parameter: XMIN -> "48.674221"
 Parameter: YMAX -> "-46.7988046"
 Parameter: YMIN -> "-53.7988046"
 Parameter: ZMAX -> "28.7950508"
 Parameter: ZMIN -> "21.7950508"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "203"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "203" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "203"
Evaluating: 203
 Parameter: J <- "203"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "203" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "203"
 Parameter: NPOS -> "120"
Evaluating: 203-120
 Parameter: J <- "83"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.806724007"
Evaluating: 112.065471*(0.806724007-0.5)
 Parameter: XPOS <- "34.3731703"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.786499271"
Evaluating: 112.065471*(0.786499271-0.5)
 Parameter: YPOS <- "32.1066757"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.267268706"
Evaluating: 142.885239*(0.267268706-0.5)+2.93414115
 Parameter: ZPOS <- "-30.3197254"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.3197254" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.3731703"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.3731703-0
 Parameter: XTRAN <- "34.3731703"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.1066757"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.1066757-0
 Parameter: YTRAN <- "32.1066757"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.3197254"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.3197254-0
 Parameter: ZTRAN <- "-30.3197254"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.3731703"
 Parameter: YTRAN -> "32.1066757"
 Parameter: ZTRAN -> "-30.3197254"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    34.373170   32.106676  -30.319725
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.94387369"
Evaluating: 0.94387369*360.0
 Parameter: XPHI <- "339.794528"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.649487572"
Evaluating: 0.649487572*360.0
 Parameter: YPHI <- "233.815526"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671111374"
Evaluating: 0.671111374*360.0
 Parameter: ZPHI <- "241.600095"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.3731703"
 Parameter: YPOS -> "32.1066757"
 Parameter: ZPOS -> "-30.3197254"
 Parameter: XPHI -> "339.794528"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.938460   -0.345388
    0.000000    0.345388    0.938460

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   20.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.3731703"
 Parameter: YPOS -> "32.1066757"
 Parameter: ZPOS -> "-30.3197254"
 Parameter: YPHI -> "233.815526"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.590387    0.000000    0.807120
    0.000000    1.000000    0.000000
   -0.807120    0.000000   -0.590387

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  126.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.3731703"
 Parameter: YPOS -> "32.1066757"
 Parameter: ZPOS -> "-30.3197254"
 Parameter: ZPHI -> "241.600095"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.475623   -0.879649    0.000000
    0.879649   -0.475623    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  118.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.373170 XMAX =   34.373170 XAVE =   34.373170
    YMIN =   32.106676 YMAX =   32.106676 YAVE =   32.106676
    ZMIN =  -30.319725 ZMAX =  -30.319725 ZAVE =  -30.319725
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.3731703"
Evaluating: 34.3731703+3.5
 Parameter: XMAX <- "37.8731703"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.1066757"
Evaluating: 32.1066757+3.5
 Parameter: YMAX <- "35.6066757"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.3197254"
Evaluating: -30.3197254+3.5
 Parameter: ZMAX <- "-26.8197254"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.3731703"
Evaluating: 34.3731703-3.5
 Parameter: XMIN <- "30.8731703"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.1066757"
Evaluating: 32.1066757-3.5
 Parameter: YMIN <- "28.6066757"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.3197254"
Evaluating: -30.3197254-3.5
 Parameter: ZMIN <- "-33.8197254"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.8731703"
 Parameter: XMIN -> "30.8731703"
 Parameter: YMAX -> "35.6066757"
 Parameter: YMIN -> "28.6066757"
 Parameter: ZMAX -> "-26.8197254"
 Parameter: ZMIN -> "-33.8197254"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "204"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "204" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "204"
Evaluating: 204
 Parameter: J <- "204"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "204" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "204"
 Parameter: NPOS -> "120"
Evaluating: 204-120
 Parameter: J <- "84"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.865896189"
Evaluating: 112.065471*(0.865896189-0.5)
 Parameter: XPOS <- "41.0043288"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "9.798432029E-02"
Evaluating: 112.065471*(9.798432029E-02-0.5)
 Parameter: YPOS <- "-45.0520765"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.535203341"
Evaluating: 142.885239*(0.535203341-0.5)+2.93414115
 Parameter: ZPOS <- "7.96417894"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.96417894" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.96417894" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "204"
Evaluating: 204
 Parameter: J <- "204"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "204" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "204"
 Parameter: NPOS -> "120"
Evaluating: 204-120
 Parameter: J <- "84"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.290616402"
Evaluating: 112.065471*(0.290616402-0.5)
 Parameter: XPOS <- "-23.4646715"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.645388773"
Evaluating: 112.065471*(0.645388773-0.5)
 Parameter: YPOS <- "16.2930613"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.755112481"
Evaluating: 142.885239*(0.755112481-0.5)+2.93414115
 Parameter: ZPOS <- "39.385949"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.385949" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.385949" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.4646715"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.4646715-0
 Parameter: XTRAN <- "-23.4646715"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.2930613"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.2930613-0
 Parameter: YTRAN <- "16.2930613"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.385949"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.385949-0
 Parameter: ZTRAN <- "39.385949"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.4646715"
 Parameter: YTRAN -> "16.2930613"
 Parameter: ZTRAN -> "39.385949"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -23.464672   16.293061   39.385949
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.410181199"
Evaluating: 0.410181199*360.0
 Parameter: XPHI <- "147.665232"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.417924295"
Evaluating: 0.417924295*360.0
 Parameter: YPHI <- "150.452746"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.649077727"
Evaluating: 0.649077727*360.0
 Parameter: ZPHI <- "233.667982"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.4646715"
 Parameter: YPOS -> "16.2930613"
 Parameter: ZPOS -> "39.385949"
 Parameter: XPHI -> "147.665232"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.844937    0.534865
    0.000000   -0.534865   -0.844937

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  147.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.4646715"
 Parameter: YPOS -> "16.2930613"
 Parameter: ZPOS -> "39.385949"
 Parameter: YPHI -> "150.452746"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.869949    0.000000   -0.493141
    0.000000    1.000000    0.000000
    0.493141    0.000000   -0.869949

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  150.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.4646715"
 Parameter: YPOS -> "16.2930613"
 Parameter: ZPOS -> "39.385949"
 Parameter: ZPHI -> "233.667982"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.592463   -0.805597    0.000000
    0.805597   -0.592463    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  126.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.464672 XMAX =  -23.464672 XAVE =  -23.464672
    YMIN =   16.293061 YMAX =   16.293061 YAVE =   16.293061
    ZMIN =   39.385949 ZMAX =   39.385949 ZAVE =   39.385949
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.4646715"
Evaluating: -23.4646715+3.5
 Parameter: XMAX <- "-19.9646715"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.2930613"
Evaluating: 16.2930613+3.5
 Parameter: YMAX <- "19.7930613"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.385949"
Evaluating: 39.385949+3.5
 Parameter: ZMAX <- "42.885949"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.4646715"
Evaluating: -23.4646715-3.5
 Parameter: XMIN <- "-26.9646715"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.2930613"
Evaluating: 16.2930613-3.5
 Parameter: YMIN <- "12.7930613"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.385949"
Evaluating: 39.385949-3.5
 Parameter: ZMIN <- "35.885949"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.9646715"
 Parameter: XMIN -> "-26.9646715"
 Parameter: YMAX -> "19.7930613"
 Parameter: YMIN -> "12.7930613"
 Parameter: ZMAX -> "42.885949"
 Parameter: ZMIN -> "35.885949"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "205"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "205" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "205"
Evaluating: 205
 Parameter: J <- "205"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "205" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "205"
 Parameter: NPOS -> "120"
Evaluating: 205-120
 Parameter: J <- "85"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.566051737"
Evaluating: 112.065471*(0.566051737-0.5)
 Parameter: XPOS <- "7.40211902"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.729908096"
Evaluating: 112.065471*(0.729908096-0.5)
 Parameter: YPOS <- "25.7647591"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.949387924"
Evaluating: 142.885239*(0.949387924-0.5)+2.93414115
 Parameter: ZPOS <- "67.1450421"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "67.1450421" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "67.1450421" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.40211902"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.40211902-0
 Parameter: XTRAN <- "7.40211902"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.7647591"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.7647591-0
 Parameter: YTRAN <- "25.7647591"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "67.1450421"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 67.1450421-0
 Parameter: ZTRAN <- "67.1450421"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.40211902"
 Parameter: YTRAN -> "25.7647591"
 Parameter: ZTRAN -> "67.1450421"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     7.402119   25.764759   67.145042
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.42375288"
Evaluating: 0.42375288*360.0
 Parameter: XPHI <- "152.551037"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.800217007E-02"
Evaluating: 6.800217007E-02*360.0
 Parameter: YPHI <- "24.4807812"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.691825345"
Evaluating: 0.691825345*360.0
 Parameter: ZPHI <- "249.057124"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.40211902"
 Parameter: YPOS -> "25.7647591"
 Parameter: ZPOS -> "67.1450421"
 Parameter: XPHI -> "152.551037"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.887422    0.460958
    0.000000   -0.460958   -0.887422

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  152.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.40211902"
 Parameter: YPOS -> "25.7647591"
 Parameter: ZPOS -> "67.1450421"
 Parameter: YPHI -> "24.4807812"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.910100    0.000000   -0.414388
    0.000000    1.000000    0.000000
    0.414388    0.000000    0.910100

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   24.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.40211902"
 Parameter: YPOS -> "25.7647591"
 Parameter: ZPOS -> "67.1450421"
 Parameter: ZPHI -> "249.057124"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.357437   -0.933937    0.000000
    0.933937   -0.357437    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  110.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.402119 XMAX =    7.402119 XAVE =    7.402119
    YMIN =   25.764759 YMAX =   25.764759 YAVE =   25.764759
    ZMIN =   67.145042 ZMAX =   67.145042 ZAVE =   67.145042
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.40211902"
Evaluating: 7.40211902+3.5
 Parameter: XMAX <- "10.902119"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.7647591"
Evaluating: 25.7647591+3.5
 Parameter: YMAX <- "29.2647591"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "67.1450421"
Evaluating: 67.1450421+3.5
 Parameter: ZMAX <- "70.6450421"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.40211902"
Evaluating: 7.40211902-3.5
 Parameter: XMIN <- "3.90211902"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.7647591"
Evaluating: 25.7647591-3.5
 Parameter: YMIN <- "22.2647591"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "67.1450421"
Evaluating: 67.1450421-3.5
 Parameter: ZMIN <- "63.6450421"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.902119"
 Parameter: XMIN -> "3.90211902"
 Parameter: YMAX -> "29.2647591"
 Parameter: YMIN -> "22.2647591"
 Parameter: ZMAX -> "70.6450421"
 Parameter: ZMIN -> "63.6450421"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "206"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "206" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "206"
Evaluating: 206
 Parameter: J <- "206"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "206" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "206"
 Parameter: NPOS -> "120"
Evaluating: 206-120
 Parameter: J <- "86"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "86"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.218450303"
Evaluating: 112.065471*(0.218450303-0.5)
 Parameter: XPOS <- "-31.5519994"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.253463884"
Evaluating: 112.065471*(0.253463884-0.5)
 Parameter: YPOS <- "-27.628186"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.743566525"
Evaluating: 142.885239*(0.743566525-0.5)+2.93414115
 Parameter: ZPOS <- "37.7362023"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.7362023" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.7362023" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.5519994"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.5519994-0
 Parameter: XTRAN <- "-31.5519994"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.628186"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.628186-0
 Parameter: YTRAN <- "-27.628186"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.7362023"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.7362023-0
 Parameter: ZTRAN <- "37.7362023"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.5519994"
 Parameter: YTRAN -> "-27.628186"
 Parameter: ZTRAN -> "37.7362023"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -31.551999  -27.628186   37.736202
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.799664336"
Evaluating: 0.799664336*360.0
 Parameter: XPHI <- "287.879161"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.851421719"
Evaluating: 0.851421719*360.0
 Parameter: YPHI <- "306.511819"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317469337"
Evaluating: 0.317469337*360.0
 Parameter: ZPHI <- "114.288961"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.5519994"
 Parameter: YPOS -> "-27.628186"
 Parameter: ZPOS -> "37.7362023"
 Parameter: XPHI -> "287.879161"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.307010   -0.951706
    0.000000    0.951706    0.307010

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   72.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.5519994"
 Parameter: YPOS -> "-27.628186"
 Parameter: ZPOS -> "37.7362023"
 Parameter: YPHI -> "306.511819"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.594989    0.000000    0.803734
    0.000000    1.000000    0.000000
   -0.803734    0.000000    0.594989

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   53.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.5519994"
 Parameter: YPOS -> "-27.628186"
 Parameter: ZPOS -> "37.7362023"
 Parameter: ZPHI -> "114.288961"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.411339    0.911483    0.000000
   -0.911483   -0.411339    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.551999 XMAX =  -31.551999 XAVE =  -31.551999
    YMIN =  -27.628186 YMAX =  -27.628186 YAVE =  -27.628186
    ZMIN =   37.736202 ZMAX =   37.736202 ZAVE =   37.736202
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.5519994"
Evaluating: -31.5519994+3.5
 Parameter: XMAX <- "-28.0519994"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.628186"
Evaluating: -27.628186+3.5
 Parameter: YMAX <- "-24.128186"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.7362023"
Evaluating: 37.7362023+3.5
 Parameter: ZMAX <- "41.2362023"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.5519994"
Evaluating: -31.5519994-3.5
 Parameter: XMIN <- "-35.0519994"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.628186"
Evaluating: -27.628186-3.5
 Parameter: YMIN <- "-31.128186"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.7362023"
Evaluating: 37.7362023-3.5
 Parameter: ZMIN <- "34.2362023"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.0519994"
 Parameter: XMIN -> "-35.0519994"
 Parameter: YMAX -> "-24.128186"
 Parameter: YMIN -> "-31.128186"
 Parameter: ZMAX -> "41.2362023"
 Parameter: ZMIN -> "34.2362023"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "207"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "207" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "207"
Evaluating: 207
 Parameter: J <- "207"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "207" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "207"
 Parameter: NPOS -> "120"
Evaluating: 207-120
 Parameter: J <- "87"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.123537773"
Evaluating: 112.065471*(0.123537773-0.5)
 Parameter: XPOS <- "-42.1884168"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.37046756"
Evaluating: 112.065471*(0.37046756-0.5)
 Parameter: YPOS <- "-14.5161139"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.230705576"
Evaluating: 142.885239*(0.230705576-0.5)+2.93414115
 Parameter: ZPOS <- "-35.544057"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.544057" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.1884168"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.1884168-0
 Parameter: XTRAN <- "-42.1884168"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.5161139"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.5161139-0
 Parameter: YTRAN <- "-14.5161139"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.544057"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -35.544057-0
 Parameter: ZTRAN <- "-35.544057"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.1884168"
 Parameter: YTRAN -> "-14.5161139"
 Parameter: ZTRAN -> "-35.544057"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -42.188417  -14.516114  -35.544057
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.787052111E-02"
Evaluating: 6.787052111E-02*360.0
 Parameter: XPHI <- "24.4333876"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720734837"
Evaluating: 0.720734837*360.0
 Parameter: YPHI <- "259.464541"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.114043064"
Evaluating: 0.114043064*360.0
 Parameter: ZPHI <- "41.055503"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.1884168"
 Parameter: YPOS -> "-14.5161139"
 Parameter: ZPOS -> "-35.544057"
 Parameter: XPHI -> "24.4333876"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.910443    0.413635
    0.000000   -0.413635    0.910443

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   24.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.1884168"
 Parameter: YPOS -> "-14.5161139"
 Parameter: ZPOS -> "-35.544057"
 Parameter: YPHI -> "259.464541"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.182844    0.000000    0.983142
    0.000000    1.000000    0.000000
   -0.983142    0.000000   -0.182844

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  100.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.1884168"
 Parameter: YPOS -> "-14.5161139"
 Parameter: ZPOS -> "-35.544057"
 Parameter: ZPHI -> "41.055503"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.754074    0.656790    0.000000
   -0.656790    0.754074    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   41.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.188417 XMAX =  -42.188417 XAVE =  -42.188417
    YMIN =  -14.516114 YMAX =  -14.516114 YAVE =  -14.516114
    ZMIN =  -35.544057 ZMAX =  -35.544057 ZAVE =  -35.544057
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.1884168"
Evaluating: -42.1884168+3.5
 Parameter: XMAX <- "-38.6884168"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.5161139"
Evaluating: -14.5161139+3.5
 Parameter: YMAX <- "-11.0161139"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.544057"
Evaluating: -35.544057+3.5
 Parameter: ZMAX <- "-32.044057"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.1884168"
Evaluating: -42.1884168-3.5
 Parameter: XMIN <- "-45.6884168"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.5161139"
Evaluating: -14.5161139-3.5
 Parameter: YMIN <- "-18.0161139"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.544057"
Evaluating: -35.544057-3.5
 Parameter: ZMIN <- "-39.044057"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.6884168"
 Parameter: XMIN -> "-45.6884168"
 Parameter: YMAX -> "-11.0161139"
 Parameter: YMIN -> "-18.0161139"
 Parameter: ZMAX -> "-32.044057"
 Parameter: ZMIN -> "-39.044057"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      1 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53264 NEG      CLA      87       CLA     -**** POS      POT      40       POT           3.1273
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "207"
Evaluating: 207
 Parameter: J <- "207"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "207" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "207"
 Parameter: NPOS -> "120"
Evaluating: 207-120
 Parameter: J <- "87"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.947100212"
Evaluating: 112.065471*(0.947100212-0.5)
 Parameter: XPOS <- "50.1044958"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.415258533"
Evaluating: 112.065471*(0.415258533-0.5)
 Parameter: YPOS <- "-9.49659241"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.421907013"
Evaluating: 142.885239*(0.421907013-0.5)+2.93414115
 Parameter: ZPOS <- "-8.22419396"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.22419396" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.22419396" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "207"
Evaluating: 207
 Parameter: J <- "207"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "207" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "207"
 Parameter: NPOS -> "120"
Evaluating: 207-120
 Parameter: J <- "87"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "9.169439766E-02"
Evaluating: 112.065471*(9.169439766E-02-0.5)
 Parameter: XPOS <- "-45.7569596"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.429434922"
Evaluating: 112.065471*(0.429434922-0.5)
 Parameter: YPOS <- "-7.9079087"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "9.673437423E-02"
Evaluating: 142.885239*(9.673437423E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-54.6865642"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.6865642" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.188417 XMAX =  -42.188417 XAVE =  -42.188417
    YMIN =  -14.516114 YMAX =  -14.516114 YAVE =  -14.516114
    ZMIN =  -35.544057 ZMAX =  -35.544057 ZAVE =  -35.544057
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.7569596"
 RDCMND substituted energy or value "?XAVE" to "-42.1884168"
Evaluating: -45.7569596--42.1884168
 Parameter: XTRAN <- "-3.5685428"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.9079087"
 RDCMND substituted energy or value "?YAVE" to "-14.5161139"
Evaluating: -7.9079087--14.5161139
 Parameter: YTRAN <- "6.6082052"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.6865642"
 RDCMND substituted energy or value "?ZAVE" to "-35.544057"
Evaluating: -54.6865642--35.544057
 Parameter: ZTRAN <- "-19.1425072"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.5685428"
 Parameter: YTRAN -> "6.6082052"
 Parameter: ZTRAN -> "-19.1425072"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    -3.568543    6.608205  -19.142507
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.879759847"
Evaluating: 0.879759847*360.0
 Parameter: XPHI <- "316.713545"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.710269698E-02"
Evaluating: 3.710269698E-02*360.0
 Parameter: YPHI <- "13.3569709"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.575123091"
Evaluating: 0.575123091*360.0
 Parameter: ZPHI <- "207.044313"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.7569596"
 Parameter: YPOS -> "-7.9079087"
 Parameter: ZPOS -> "-54.6865642"
 Parameter: XPHI -> "316.713545"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.727935   -0.685646
    0.000000    0.685646    0.727935

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   43.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.7569596"
 Parameter: YPOS -> "-7.9079087"
 Parameter: ZPOS -> "-54.6865642"
 Parameter: YPHI -> "13.3569709"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.972950    0.000000   -0.231017
    0.000000    1.000000    0.000000
    0.231017    0.000000    0.972950

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   13.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.7569596"
 Parameter: YPOS -> "-7.9079087"
 Parameter: ZPOS -> "-54.6865642"
 Parameter: ZPHI -> "207.044313"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.890655   -0.454679    0.000000
    0.454679   -0.890655    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  152.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.756960 XMAX =  -45.756960 XAVE =  -45.756960
    YMIN =   -7.907909 YMAX =   -7.907909 YAVE =   -7.907909
    ZMIN =  -54.686564 ZMAX =  -54.686564 ZAVE =  -54.686564
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.7569596"
Evaluating: -45.7569596+3.5
 Parameter: XMAX <- "-42.2569596"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.9079087"
Evaluating: -7.9079087+3.5
 Parameter: YMAX <- "-4.4079087"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.6865642"
Evaluating: -54.6865642+3.5
 Parameter: ZMAX <- "-51.1865642"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.7569596"
Evaluating: -45.7569596-3.5
 Parameter: XMIN <- "-49.2569596"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.9079087"
Evaluating: -7.9079087-3.5
 Parameter: YMIN <- "-11.4079087"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.6865642"
Evaluating: -54.6865642-3.5
 Parameter: ZMIN <- "-58.1865642"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.2569596"
 Parameter: XMIN -> "-49.2569596"
 Parameter: YMAX -> "-4.4079087"
 Parameter: YMIN -> "-11.4079087"
 Parameter: ZMAX -> "-51.1865642"
 Parameter: ZMIN -> "-58.1865642"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "208"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "208" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "208"
Evaluating: 208
 Parameter: J <- "208"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "208" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "208"
 Parameter: NPOS -> "120"
Evaluating: 208-120
 Parameter: J <- "88"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.965563167"
Evaluating: 112.065471*(0.965563167-0.5)
 Parameter: XPOS <- "52.1735556"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.948936542"
Evaluating: 112.065471*(0.948936542-0.5)
 Parameter: YPOS <- "50.310285"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.533924512"
Evaluating: 142.885239*(0.533924512-0.5)+2.93414115
 Parameter: ZPOS <- "7.78145316"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.78145316" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.78145316" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "208"
Evaluating: 208
 Parameter: J <- "208"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "208" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "208"
 Parameter: NPOS -> "120"
Evaluating: 208-120
 Parameter: J <- "88"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.670860086"
Evaluating: 112.065471*(0.670860086-0.5)
 Parameter: XPOS <- "19.147516"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.816644977"
Evaluating: 112.065471*(0.816644977-0.5)
 Parameter: YPOS <- "35.4849685"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.43192978"
Evaluating: 142.885239*(0.43192978-0.5)+2.93414115
 Parameter: ZPOS <- "-6.7920885"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.7920885" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.7920885" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "208"
Evaluating: 208
 Parameter: J <- "208"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "208" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "208"
 Parameter: NPOS -> "120"
Evaluating: 208-120
 Parameter: J <- "88"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.611793765"
Evaluating: 112.065471*(0.611793765-0.5)
 Parameter: XPOS <- "12.5282209"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "4.676529895E-02"
Evaluating: 112.065471*(4.676529895E-02-0.5)
 Parameter: YPOS <- "-50.7919602"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.977612704"
Evaluating: 142.885239*(0.977612704-0.5)+2.93414115
 Parameter: ZPOS <- "71.1779465"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "71.1779465" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "71.1779465" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.5282209"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.5282209-0
 Parameter: XTRAN <- "12.5282209"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.7919602"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -50.7919602-0
 Parameter: YTRAN <- "-50.7919602"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "71.1779465"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 71.1779465-0
 Parameter: ZTRAN <- "71.1779465"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.5282209"
 Parameter: YTRAN -> "-50.7919602"
 Parameter: ZTRAN -> "71.1779465"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    12.528221  -50.791960   71.177947
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487036312"
Evaluating: 0.487036312*360.0
 Parameter: XPHI <- "175.333072"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314931272"
Evaluating: 0.314931272*360.0
 Parameter: YPHI <- "113.375258"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.951956071"
Evaluating: 0.951956071*360.0
 Parameter: ZPHI <- "342.704186"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.5282209"
 Parameter: YPOS -> "-50.7919602"
 Parameter: ZPOS -> "71.1779465"
 Parameter: XPHI -> "175.333072"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996685    0.081363
    0.000000   -0.081363   -0.996685

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  175.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.5282209"
 Parameter: YPOS -> "-50.7919602"
 Parameter: ZPOS -> "71.1779465"
 Parameter: YPHI -> "113.375258"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.396752    0.000000   -0.917926
    0.000000    1.000000    0.000000
    0.917926    0.000000   -0.396752

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  113.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.5282209"
 Parameter: YPOS -> "-50.7919602"
 Parameter: ZPOS -> "71.1779465"
 Parameter: ZPHI -> "342.704186"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.954783   -0.297305    0.000000
    0.297305    0.954783    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   17.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.528221 XMAX =   12.528221 XAVE =   12.528221
    YMIN =  -50.791960 YMAX =  -50.791960 YAVE =  -50.791960
    ZMIN =   71.177947 ZMAX =   71.177947 ZAVE =   71.177947
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.5282209"
Evaluating: 12.5282209+3.5
 Parameter: XMAX <- "16.0282209"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.7919602"
Evaluating: -50.7919602+3.5
 Parameter: YMAX <- "-47.2919602"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "71.1779465"
Evaluating: 71.1779465+3.5
 Parameter: ZMAX <- "74.6779465"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.5282209"
Evaluating: 12.5282209-3.5
 Parameter: XMIN <- "9.0282209"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.7919602"
Evaluating: -50.7919602-3.5
 Parameter: YMIN <- "-54.2919602"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "71.1779465"
Evaluating: 71.1779465-3.5
 Parameter: ZMIN <- "67.6779465"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.0282209"
 Parameter: XMIN -> "9.0282209"
 Parameter: YMAX -> "-47.2919602"
 Parameter: YMIN -> "-54.2919602"
 Parameter: ZMAX -> "74.6779465"
 Parameter: ZMIN -> "67.6779465"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "209"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "209" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "209"
Evaluating: 209
 Parameter: J <- "209"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "209" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "209"
 Parameter: NPOS -> "120"
Evaluating: 209-120
 Parameter: J <- "89"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "89"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.830415401"
Evaluating: 112.065471*(0.830415401-0.5)
 Parameter: XPOS <- "37.0281575"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.77405458"
Evaluating: 112.065471*(0.77405458-0.5)
 Parameter: YPOS <- "30.7120556"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.529535374"
Evaluating: 142.885239*(0.529535374-0.5)+2.93414115
 Parameter: ZPOS <- "7.15431012"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.15431012" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.15431012" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "209"
Evaluating: 209
 Parameter: J <- "209"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "209" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "209"
 Parameter: NPOS -> "120"
Evaluating: 209-120
 Parameter: J <- "89"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "89"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.605255909"
Evaluating: 112.065471*(0.605255909-0.5)
 Parameter: XPOS <- "11.795553"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.627199307E-02"
Evaluating: 112.065471*(7.627199307E-02-0.5)
 Parameter: YPOS <- "-47.4852787"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "1.981107295E-03"
Evaluating: 142.885239*(1.981107295E-03-0.5)+2.93414115
 Parameter: ZPOS <- "-68.2254074"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-68.2254074" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.795553"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.795553-0
 Parameter: XTRAN <- "11.795553"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.4852787"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.4852787-0
 Parameter: YTRAN <- "-47.4852787"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-68.2254074"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -68.2254074-0
 Parameter: ZTRAN <- "-68.2254074"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.795553"
 Parameter: YTRAN -> "-47.4852787"
 Parameter: ZTRAN -> "-68.2254074"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    11.795553  -47.485279  -68.225407
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.575524628"
Evaluating: 0.575524628*360.0
 Parameter: XPHI <- "207.188866"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.605358242"
Evaluating: 0.605358242*360.0
 Parameter: YPHI <- "217.928967"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.630330468"
Evaluating: 0.630330468*360.0
 Parameter: ZPHI <- "226.918968"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.795553"
 Parameter: YPOS -> "-47.4852787"
 Parameter: ZPOS -> "-68.2254074"
 Parameter: XPHI -> "207.188866"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.889505   -0.456925
    0.000000    0.456925   -0.889505

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  152.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.795553"
 Parameter: YPOS -> "-47.4852787"
 Parameter: ZPOS -> "-68.2254074"
 Parameter: YPHI -> "217.928967"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.788773    0.000000    0.614684
    0.000000    1.000000    0.000000
   -0.614684    0.000000   -0.788773

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  142.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.795553"
 Parameter: YPOS -> "-47.4852787"
 Parameter: ZPOS -> "-68.2254074"
 Parameter: ZPHI -> "226.918968"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.683032   -0.730388    0.000000
    0.730388   -0.683032    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  133.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.795553 XMAX =   11.795553 XAVE =   11.795553
    YMIN =  -47.485279 YMAX =  -47.485279 YAVE =  -47.485279
    ZMIN =  -68.225407 ZMAX =  -68.225407 ZAVE =  -68.225407
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.795553"
Evaluating: 11.795553+3.5
 Parameter: XMAX <- "15.295553"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.4852787"
Evaluating: -47.4852787+3.5
 Parameter: YMAX <- "-43.9852787"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-68.2254074"
Evaluating: -68.2254074+3.5
 Parameter: ZMAX <- "-64.7254074"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.795553"
Evaluating: 11.795553-3.5
 Parameter: XMIN <- "8.295553"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.4852787"
Evaluating: -47.4852787-3.5
 Parameter: YMIN <- "-50.9852787"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-68.2254074"
Evaluating: -68.2254074-3.5
 Parameter: ZMIN <- "-71.7254074"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.295553"
 Parameter: XMIN -> "8.295553"
 Parameter: YMAX -> "-43.9852787"
 Parameter: YMIN -> "-50.9852787"
 Parameter: ZMAX -> "-64.7254074"
 Parameter: ZMIN -> "-71.7254074"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "210"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "210" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "210"
Evaluating: 210
 Parameter: J <- "210"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "210" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "210"
 Parameter: NPOS -> "120"
Evaluating: 210-120
 Parameter: J <- "90"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.917846962"
Evaluating: 112.065471*(0.917846962-0.5)
 Parameter: XPOS <- "46.8262166"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "3.471262941E-02"
Evaluating: 112.065471*(3.471262941E-02-0.5)
 Parameter: YPOS <- "-52.1426483"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.439906841"
Evaluating: 142.885239*(0.439906841-0.5)+2.93414115
 Parameter: ZPOS <- "-5.65228424"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.65228424" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.65228424" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "210"
Evaluating: 210
 Parameter: J <- "210"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "210" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "210"
 Parameter: NPOS -> "120"
Evaluating: 210-120
 Parameter: J <- "90"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.942742854"
Evaluating: 112.065471*(0.942742854-0.5)
 Parameter: XPOS <- "49.6161865"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.96882999"
Evaluating: 112.065471*(0.96882999-0.5)
 Parameter: YPOS <- "52.5396536"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.224105198"
Evaluating: 142.885239*(0.224105198-0.5)+2.93414115
 Parameter: ZPOS <- "-36.4871536"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.4871536" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.6161865"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.6161865-0
 Parameter: XTRAN <- "49.6161865"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "52.5396536"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 52.5396536-0
 Parameter: YTRAN <- "52.5396536"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.4871536"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.4871536-0
 Parameter: ZTRAN <- "-36.4871536"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.6161865"
 Parameter: YTRAN -> "52.5396536"
 Parameter: ZTRAN -> "-36.4871536"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    49.616186   52.539654  -36.487154
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.722208144"
Evaluating: 0.722208144*360.0
 Parameter: XPHI <- "259.994932"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.426360811"
Evaluating: 0.426360811*360.0
 Parameter: YPHI <- "153.489892"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.615243848"
Evaluating: 0.615243848*360.0
 Parameter: ZPHI <- "221.487785"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.6161865"
 Parameter: YPOS -> "52.5396536"
 Parameter: ZPOS -> "-36.4871536"
 Parameter: XPHI -> "259.994932"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.173735   -0.984792
    0.000000    0.984792   -0.173735

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.6161865"
 Parameter: YPOS -> "52.5396536"
 Parameter: ZPOS -> "-36.4871536"
 Parameter: YPHI -> "153.489892"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.894856    0.000000   -0.446356
    0.000000    1.000000    0.000000
    0.446356    0.000000   -0.894856

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  153.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.6161865"
 Parameter: YPOS -> "52.5396536"
 Parameter: ZPOS -> "-36.4871536"
 Parameter: ZPHI -> "221.487785"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.749097   -0.662460    0.000000
    0.662460   -0.749097    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  138.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.616186 XMAX =   49.616186 XAVE =   49.616186
    YMIN =   52.539654 YMAX =   52.539654 YAVE =   52.539654
    ZMIN =  -36.487154 ZMAX =  -36.487154 ZAVE =  -36.487154
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.6161865"
Evaluating: 49.6161865+3.5
 Parameter: XMAX <- "53.1161865"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "52.5396536"
Evaluating: 52.5396536+3.5
 Parameter: YMAX <- "56.0396536"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.4871536"
Evaluating: -36.4871536+3.5
 Parameter: ZMAX <- "-32.9871536"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.6161865"
Evaluating: 49.6161865-3.5
 Parameter: XMIN <- "46.1161865"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "52.5396536"
Evaluating: 52.5396536-3.5
 Parameter: YMIN <- "49.0396536"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.4871536"
Evaluating: -36.4871536-3.5
 Parameter: ZMIN <- "-39.9871536"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.1161865"
 Parameter: XMIN -> "46.1161865"
 Parameter: YMAX -> "56.0396536"
 Parameter: YMIN -> "49.0396536"
 Parameter: ZMAX -> "-32.9871536"
 Parameter: ZMIN -> "-39.9871536"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "211"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "211" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "211"
Evaluating: 211
 Parameter: J <- "211"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "211" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "211"
 Parameter: NPOS -> "120"
Evaluating: 211-120
 Parameter: J <- "91"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "91"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "2.563844415E-02"
Evaluating: 112.065471*(2.563844415E-02-0.5)
 Parameter: XPOS <- "-53.1595512"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.782759295"
Evaluating: 112.065471*(0.782759295-0.5)
 Parameter: YPOS <- "31.6875536"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.640395422"
Evaluating: 142.885239*(0.640395422-0.5)+2.93414115
 Parameter: ZPOS <- "22.9945746"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.9945746" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.9945746" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-53.1595512"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -53.1595512-0
 Parameter: XTRAN <- "-53.1595512"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.6875536"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.6875536-0
 Parameter: YTRAN <- "31.6875536"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.9945746"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.9945746-0
 Parameter: ZTRAN <- "22.9945746"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-53.1595512"
 Parameter: YTRAN -> "31.6875536"
 Parameter: ZTRAN -> "22.9945746"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -53.159551   31.687554   22.994575
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.476303162"
Evaluating: 0.476303162*360.0
 Parameter: XPHI <- "171.469138"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.66025931E-02"
Evaluating: 6.66025931E-02*360.0
 Parameter: YPHI <- "23.9769335"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.332509294"
Evaluating: 0.332509294*360.0
 Parameter: ZPHI <- "119.703346"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-53.1595512"
 Parameter: YPOS -> "31.6875536"
 Parameter: ZPOS -> "22.9945746"
 Parameter: XPHI -> "171.469138"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.988936    0.148342
    0.000000   -0.148342   -0.988936

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  171.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-53.1595512"
 Parameter: YPOS -> "31.6875536"
 Parameter: ZPOS -> "22.9945746"
 Parameter: YPHI -> "23.9769335"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.913709    0.000000   -0.406369
    0.000000    1.000000    0.000000
    0.406369    0.000000    0.913709

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   23.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-53.1595512"
 Parameter: YPOS -> "31.6875536"
 Parameter: ZPOS -> "22.9945746"
 Parameter: ZPHI -> "119.703346"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.495509    0.868603    0.000000
   -0.868603   -0.495509    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  119.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -53.159551 XMAX =  -53.159551 XAVE =  -53.159551
    YMIN =   31.687554 YMAX =   31.687554 YAVE =   31.687554
    ZMIN =   22.994575 ZMAX =   22.994575 ZAVE =   22.994575
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-53.1595512"
Evaluating: -53.1595512+3.5
 Parameter: XMAX <- "-49.6595512"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.6875536"
Evaluating: 31.6875536+3.5
 Parameter: YMAX <- "35.1875536"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.9945746"
Evaluating: 22.9945746+3.5
 Parameter: ZMAX <- "26.4945746"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-53.1595512"
Evaluating: -53.1595512-3.5
 Parameter: XMIN <- "-56.6595512"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.6875536"
Evaluating: 31.6875536-3.5
 Parameter: YMIN <- "28.1875536"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.9945746"
Evaluating: 22.9945746-3.5
 Parameter: ZMIN <- "19.4945746"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-49.6595512"
 Parameter: XMIN -> "-56.6595512"
 Parameter: YMAX -> "35.1875536"
 Parameter: YMIN -> "28.1875536"
 Parameter: ZMAX -> "26.4945746"
 Parameter: ZMIN -> "19.4945746"
 SELRPN>      4 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      3 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "212"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "212" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "212"
Evaluating: 212
 Parameter: J <- "212"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "212" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "212"
 Parameter: NPOS -> "120"
Evaluating: 212-120
 Parameter: J <- "92"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "92"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.705588911"
Evaluating: 112.065471*(0.705588911-0.5)
 Parameter: XPOS <- "23.0394181"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.786382527"
Evaluating: 112.065471*(0.786382527-0.5)
 Parameter: YPOS <- "32.0935928"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.99996665"
Evaluating: 142.885239*(0.99996665-0.5)+2.93414115
 Parameter: ZPOS <- "74.3719954"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "74.3719954" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "74.3719954" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.0394181"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.0394181-0
 Parameter: XTRAN <- "23.0394181"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.0935928"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.0935928-0
 Parameter: YTRAN <- "32.0935928"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "74.3719954"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 74.3719954-0
 Parameter: ZTRAN <- "74.3719954"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.0394181"
 Parameter: YTRAN -> "32.0935928"
 Parameter: ZTRAN -> "74.3719954"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    23.039418   32.093593   74.371995
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.165029342"
Evaluating: 0.165029342*360.0
 Parameter: XPHI <- "59.4105631"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.27428472"
Evaluating: 0.27428472*360.0
 Parameter: YPHI <- "98.7424992"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.24943273"
Evaluating: 0.24943273*360.0
 Parameter: ZPHI <- "89.7957828"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.0394181"
 Parameter: YPOS -> "32.0935928"
 Parameter: ZPOS -> "74.3719954"
 Parameter: XPHI -> "59.4105631"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.508883    0.860836
    0.000000   -0.860836    0.508883

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   59.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.0394181"
 Parameter: YPOS -> "32.0935928"
 Parameter: ZPOS -> "74.3719954"
 Parameter: YPHI -> "98.7424992"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.151994    0.000000   -0.988381
    0.000000    1.000000    0.000000
    0.988381    0.000000   -0.151994

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.0394181"
 Parameter: YPOS -> "32.0935928"
 Parameter: ZPOS -> "74.3719954"
 Parameter: ZPHI -> "89.7957828"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.003564    0.999994    0.000000
   -0.999994    0.003564    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   89.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.039418 XMAX =   23.039418 XAVE =   23.039418
    YMIN =   32.093593 YMAX =   32.093593 YAVE =   32.093593
    ZMIN =   74.371995 ZMAX =   74.371995 ZAVE =   74.371995
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.0394181"
Evaluating: 23.0394181+3.5
 Parameter: XMAX <- "26.5394181"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.0935928"
Evaluating: 32.0935928+3.5
 Parameter: YMAX <- "35.5935928"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "74.3719954"
Evaluating: 74.3719954+3.5
 Parameter: ZMAX <- "77.8719954"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.0394181"
Evaluating: 23.0394181-3.5
 Parameter: XMIN <- "19.5394181"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.0935928"
Evaluating: 32.0935928-3.5
 Parameter: YMIN <- "28.5935928"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "74.3719954"
Evaluating: 74.3719954-3.5
 Parameter: ZMIN <- "70.8719954"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.5394181"
 Parameter: XMIN -> "19.5394181"
 Parameter: YMAX -> "35.5935928"
 Parameter: YMIN -> "28.5935928"
 Parameter: ZMAX -> "77.8719954"
 Parameter: ZMIN -> "70.8719954"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "213"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "213" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "213"
Evaluating: 213
 Parameter: J <- "213"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "213" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "213"
 Parameter: NPOS -> "120"
Evaluating: 213-120
 Parameter: J <- "93"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.376500413"
Evaluating: 112.065471*(0.376500413-0.5)
 Parameter: XPOS <- "-13.8400394"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.286040818"
Evaluating: 112.065471*(0.286040818-0.5)
 Parameter: YPOS <- "-23.9774365"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.507010427"
Evaluating: 142.885239*(0.507010427-0.5)+2.93414115
 Parameter: ZPOS <- "3.93582769"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.93582769" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.93582769" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "213"
Evaluating: 213
 Parameter: J <- "213"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "213" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "213"
 Parameter: NPOS -> "120"
Evaluating: 213-120
 Parameter: J <- "93"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.92781134"
Evaluating: 112.065471*(0.92781134-0.5)
 Parameter: XPOS <- "47.9428793"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.372131881"
Evaluating: 112.065471*(0.372131881-0.5)
 Parameter: YPOS <- "-14.329601"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.297108418"
Evaluating: 142.885239*(0.297108418-0.5)+2.93414115
 Parameter: ZPOS <- "-26.056071"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.056071" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.9428793"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 47.9428793-0
 Parameter: XTRAN <- "47.9428793"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.329601"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.329601-0
 Parameter: YTRAN <- "-14.329601"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.056071"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.056071-0
 Parameter: ZTRAN <- "-26.056071"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.9428793"
 Parameter: YTRAN -> "-14.329601"
 Parameter: ZTRAN -> "-26.056071"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    47.942879  -14.329601  -26.056071
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.239806901"
Evaluating: 0.239806901*360.0
 Parameter: XPHI <- "86.3304844"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.835442013"
Evaluating: 0.835442013*360.0
 Parameter: YPHI <- "300.759125"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.684011449"
Evaluating: 0.684011449*360.0
 Parameter: ZPHI <- "246.244122"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.9428793"
 Parameter: YPOS -> "-14.329601"
 Parameter: ZPOS -> "-26.056071"
 Parameter: XPHI -> "86.3304844"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.064001    0.997950
    0.000000   -0.997950    0.064001

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   86.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.9428793"
 Parameter: YPOS -> "-14.329601"
 Parameter: ZPOS -> "-26.056071"
 Parameter: YPHI -> "300.759125"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.511430    0.000000    0.859325
    0.000000    1.000000    0.000000
   -0.859325    0.000000    0.511430

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   59.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.9428793"
 Parameter: YPOS -> "-14.329601"
 Parameter: ZPOS -> "-26.056071"
 Parameter: ZPHI -> "246.244122"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.402841   -0.915270    0.000000
    0.915270   -0.402841    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  113.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.942879 XMAX =   47.942879 XAVE =   47.942879
    YMIN =  -14.329601 YMAX =  -14.329601 YAVE =  -14.329601
    ZMIN =  -26.056071 ZMAX =  -26.056071 ZAVE =  -26.056071
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.9428793"
Evaluating: 47.9428793+3.5
 Parameter: XMAX <- "51.4428793"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.329601"
Evaluating: -14.329601+3.5
 Parameter: YMAX <- "-10.829601"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.056071"
Evaluating: -26.056071+3.5
 Parameter: ZMAX <- "-22.556071"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.9428793"
Evaluating: 47.9428793-3.5
 Parameter: XMIN <- "44.4428793"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.329601"
Evaluating: -14.329601-3.5
 Parameter: YMIN <- "-17.829601"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.056071"
Evaluating: -26.056071-3.5
 Parameter: ZMIN <- "-29.556071"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.4428793"
 Parameter: XMIN -> "44.4428793"
 Parameter: YMAX -> "-10.829601"
 Parameter: YMIN -> "-17.829601"
 Parameter: ZMAX -> "-22.556071"
 Parameter: ZMIN -> "-29.556071"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "214"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "214" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "214"
Evaluating: 214
 Parameter: J <- "214"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "214" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "214"
 Parameter: NPOS -> "120"
Evaluating: 214-120
 Parameter: J <- "94"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "94"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.479392512"
Evaluating: 112.065471*(0.479392512-0.5)
 Parameter: XPOS <- "-2.30938785"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.141336757"
Evaluating: 112.065471*(0.141336757-0.5)
 Parameter: YPOS <- "-40.1937653"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.536419933"
Evaluating: 142.885239*(0.536419933-0.5)+2.93414115
 Parameter: ZPOS <- "8.13801198"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.13801198" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.13801198" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "214"
Evaluating: 214
 Parameter: J <- "214"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "214" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "214"
 Parameter: NPOS -> "120"
Evaluating: 214-120
 Parameter: J <- "94"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "94"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.851351404"
Evaluating: 112.065471*(0.851351404-0.5)
 Parameter: XPOS <- "39.3743606"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.978782998"
Evaluating: 112.065471*(0.978782998-0.5)
 Parameter: YPOS <- "53.6550422"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.745061848"
Evaluating: 142.885239*(0.745061848-0.5)+2.93414115
 Parameter: ZPOS <- "37.9498619"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.9498619" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.9498619" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.3743606"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.3743606-0
 Parameter: XTRAN <- "39.3743606"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "53.6550422"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 53.6550422-0
 Parameter: YTRAN <- "53.6550422"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.9498619"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.9498619-0
 Parameter: ZTRAN <- "37.9498619"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.3743606"
 Parameter: YTRAN -> "53.6550422"
 Parameter: ZTRAN -> "37.9498619"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    39.374361   53.655042   37.949862
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.734198709"
Evaluating: 0.734198709*360.0
 Parameter: XPHI <- "264.311535"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.895101195"
Evaluating: 0.895101195*360.0
 Parameter: YPHI <- "322.23643"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.801975313"
Evaluating: 0.801975313*360.0
 Parameter: ZPHI <- "288.711113"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.3743606"
 Parameter: YPOS -> "53.6550422"
 Parameter: ZPOS -> "37.9498619"
 Parameter: XPHI -> "264.311535"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.099119   -0.995076
    0.000000    0.995076   -0.099119

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   95.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.3743606"
 Parameter: YPOS -> "53.6550422"
 Parameter: ZPOS -> "37.9498619"
 Parameter: YPHI -> "322.23643"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.790545    0.000000    0.612405
    0.000000    1.000000    0.000000
   -0.612405    0.000000    0.790545

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   37.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.3743606"
 Parameter: YPOS -> "53.6550422"
 Parameter: ZPOS -> "37.9498619"
 Parameter: ZPHI -> "288.711113"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.320797   -0.947148    0.000000
    0.947148    0.320797    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   71.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.374361 XMAX =   39.374361 XAVE =   39.374361
    YMIN =   53.655042 YMAX =   53.655042 YAVE =   53.655042
    ZMIN =   37.949862 ZMAX =   37.949862 ZAVE =   37.949862
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.3743606"
Evaluating: 39.3743606+3.5
 Parameter: XMAX <- "42.8743606"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "53.6550422"
Evaluating: 53.6550422+3.5
 Parameter: YMAX <- "57.1550422"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.9498619"
Evaluating: 37.9498619+3.5
 Parameter: ZMAX <- "41.4498619"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.3743606"
Evaluating: 39.3743606-3.5
 Parameter: XMIN <- "35.8743606"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "53.6550422"
Evaluating: 53.6550422-3.5
 Parameter: YMIN <- "50.1550422"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.9498619"
Evaluating: 37.9498619-3.5
 Parameter: ZMIN <- "34.4498619"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.8743606"
 Parameter: XMIN -> "35.8743606"
 Parameter: YMAX -> "57.1550422"
 Parameter: YMIN -> "50.1550422"
 Parameter: ZMAX -> "41.4498619"
 Parameter: ZMIN -> "34.4498619"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "215"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "215" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "215"
Evaluating: 215
 Parameter: J <- "215"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "215" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "215"
 Parameter: NPOS -> "120"
Evaluating: 215-120
 Parameter: J <- "95"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "95"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.176961199"
Evaluating: 112.065471*(0.176961199-0.5)
 Parameter: XPOS <- "-36.2014954"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.515329352"
Evaluating: 112.065471*(0.515329352-0.5)
 Parameter: YPOS <- "1.71789105"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "6.28875748E-02"
Evaluating: 142.885239*(6.28875748E-02-0.5)+2.93414115
 Parameter: ZPOS <- "-59.5227722"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-59.5227722" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.2014954"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.2014954-0
 Parameter: XTRAN <- "-36.2014954"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.71789105"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.71789105-0
 Parameter: YTRAN <- "1.71789105"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-59.5227722"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -59.5227722-0
 Parameter: ZTRAN <- "-59.5227722"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.2014954"
 Parameter: YTRAN -> "1.71789105"
 Parameter: ZTRAN -> "-59.5227722"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -36.201495    1.717891  -59.522772
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.192763937"
Evaluating: 0.192763937*360.0
 Parameter: XPHI <- "69.3950173"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.900230377"
Evaluating: 0.900230377*360.0
 Parameter: YPHI <- "324.082936"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126279078"
Evaluating: 0.126279078*360.0
 Parameter: ZPHI <- "45.4604681"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.2014954"
 Parameter: YPOS -> "1.71789105"
 Parameter: ZPOS -> "-59.5227722"
 Parameter: XPHI -> "69.3950173"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.351923    0.936029
    0.000000   -0.936029    0.351923

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   69.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.2014954"
 Parameter: YPOS -> "1.71789105"
 Parameter: ZPOS -> "-59.5227722"
 Parameter: YPHI -> "324.082936"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.809867    0.000000    0.586614
    0.000000    1.000000    0.000000
   -0.586614    0.000000    0.809867

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   35.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.2014954"
 Parameter: YPOS -> "1.71789105"
 Parameter: ZPOS -> "-59.5227722"
 Parameter: ZPHI -> "45.4604681"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.701401    0.712767    0.000000
   -0.712767    0.701401    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   45.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.201495 XMAX =  -36.201495 XAVE =  -36.201495
    YMIN =    1.717891 YMAX =    1.717891 YAVE =    1.717891
    ZMIN =  -59.522772 ZMAX =  -59.522772 ZAVE =  -59.522772
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.2014954"
Evaluating: -36.2014954+3.5
 Parameter: XMAX <- "-32.7014954"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.71789105"
Evaluating: 1.71789105+3.5
 Parameter: YMAX <- "5.21789105"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-59.5227722"
Evaluating: -59.5227722+3.5
 Parameter: ZMAX <- "-56.0227722"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.2014954"
Evaluating: -36.2014954-3.5
 Parameter: XMIN <- "-39.7014954"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.71789105"
Evaluating: 1.71789105-3.5
 Parameter: YMIN <- "-1.78210895"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-59.5227722"
Evaluating: -59.5227722-3.5
 Parameter: ZMIN <- "-63.0227722"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.7014954"
 Parameter: XMIN -> "-39.7014954"
 Parameter: YMAX -> "5.21789105"
 Parameter: YMIN -> "-1.78210895"
 Parameter: ZMAX -> "-56.0227722"
 Parameter: ZMIN -> "-63.0227722"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "216"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "216" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "216"
Evaluating: 216
 Parameter: J <- "216"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "216" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "216"
 Parameter: NPOS -> "120"
Evaluating: 216-120
 Parameter: J <- "96"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "6.708255747E-02"
Evaluating: 112.065471*(6.708255747E-02-0.5)
 Parameter: XPOS <- "-48.5150971"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.414543472"
Evaluating: 112.065471*(0.414543472-0.5)
 Parameter: YPOS <- "-9.57672606"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.215276241"
Evaluating: 142.885239*(0.215276241-0.5)+2.93414115
 Parameter: ZPOS <- "-37.7486812"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.7486812" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-48.5150971"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -48.5150971-0
 Parameter: XTRAN <- "-48.5150971"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.57672606"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.57672606-0
 Parameter: YTRAN <- "-9.57672606"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.7486812"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.7486812-0
 Parameter: ZTRAN <- "-37.7486812"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-48.5150971"
 Parameter: YTRAN -> "-9.57672606"
 Parameter: ZTRAN -> "-37.7486812"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -48.515097   -9.576726  -37.748681
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.342501482"
Evaluating: 0.342501482*360.0
 Parameter: XPHI <- "123.300534"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.982365418"
Evaluating: 0.982365418*360.0
 Parameter: YPHI <- "353.65155"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.582332812"
Evaluating: 0.582332812*360.0
 Parameter: ZPHI <- "209.639812"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-48.5150971"
 Parameter: YPOS -> "-9.57672606"
 Parameter: ZPOS -> "-37.7486812"
 Parameter: XPHI -> "123.300534"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.549031    0.835802
    0.000000   -0.835802   -0.549031

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  123.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-48.5150971"
 Parameter: YPOS -> "-9.57672606"
 Parameter: ZPOS -> "-37.7486812"
 Parameter: YPHI -> "353.65155"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.993868    0.000000    0.110575
    0.000000    1.000000    0.000000
   -0.110575    0.000000    0.993868

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    6.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-48.5150971"
 Parameter: YPOS -> "-9.57672606"
 Parameter: ZPOS -> "-37.7486812"
 Parameter: ZPHI -> "209.639812"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.869152   -0.494546    0.000000
    0.494546   -0.869152    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  150.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -48.515097 XMAX =  -48.515097 XAVE =  -48.515097
    YMIN =   -9.576726 YMAX =   -9.576726 YAVE =   -9.576726
    ZMIN =  -37.748681 ZMAX =  -37.748681 ZAVE =  -37.748681
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-48.5150971"
Evaluating: -48.5150971+3.5
 Parameter: XMAX <- "-45.0150971"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.57672606"
Evaluating: -9.57672606+3.5
 Parameter: YMAX <- "-6.07672606"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.7486812"
Evaluating: -37.7486812+3.5
 Parameter: ZMAX <- "-34.2486812"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-48.5150971"
Evaluating: -48.5150971-3.5
 Parameter: XMIN <- "-52.0150971"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.57672606"
Evaluating: -9.57672606-3.5
 Parameter: YMIN <- "-13.0767261"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.7486812"
Evaluating: -37.7486812-3.5
 Parameter: ZMIN <- "-41.2486812"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-45.0150971"
 Parameter: XMIN -> "-52.0150971"
 Parameter: YMAX -> "-6.07672606"
 Parameter: YMIN -> "-13.0767261"
 Parameter: ZMAX -> "-34.2486812"
 Parameter: ZMIN -> "-41.2486812"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "217"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "217" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "217"
Evaluating: 217
 Parameter: J <- "217"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "217" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "217"
 Parameter: NPOS -> "120"
Evaluating: 217-120
 Parameter: J <- "97"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.945269872"
Evaluating: 112.065471*(0.945269872-0.5)
 Parameter: XPOS <- "49.8993779"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.113546509"
Evaluating: 112.065471*(0.113546509-0.5)
 Parameter: YPOS <- "-43.3080925"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.340267091"
Evaluating: 142.885239*(0.340267091-0.5)+2.93414115
 Parameter: ZPOS <- "-19.8893337"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.8893337" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.8993779"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.8993779-0
 Parameter: XTRAN <- "49.8993779"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.3080925"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.3080925-0
 Parameter: YTRAN <- "-43.3080925"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.8893337"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.8893337-0
 Parameter: ZTRAN <- "-19.8893337"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.8993779"
 Parameter: YTRAN -> "-43.3080925"
 Parameter: ZTRAN -> "-19.8893337"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    49.899378  -43.308093  -19.889334
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291404545"
Evaluating: 0.291404545*360.0
 Parameter: XPHI <- "104.905636"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.832726188"
Evaluating: 0.832726188*360.0
 Parameter: YPHI <- "299.781428"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.976343849"
Evaluating: 0.976343849*360.0
 Parameter: ZPHI <- "351.483786"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.8993779"
 Parameter: YPOS -> "-43.3080925"
 Parameter: ZPOS -> "-19.8893337"
 Parameter: XPHI -> "104.905636"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.257228    0.966351
    0.000000   -0.966351   -0.257228

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  104.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.8993779"
 Parameter: YPOS -> "-43.3080925"
 Parameter: ZPOS -> "-19.8893337"
 Parameter: YPHI -> "299.781428"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.496693    0.000000    0.867926
    0.000000    1.000000    0.000000
   -0.867926    0.000000    0.496693

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   60.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.8993779"
 Parameter: YPOS -> "-43.3080925"
 Parameter: ZPOS -> "-19.8893337"
 Parameter: ZPHI -> "351.483786"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.988974   -0.148089    0.000000
    0.148089    0.988974    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    8.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.899378 XMAX =   49.899378 XAVE =   49.899378
    YMIN =  -43.308093 YMAX =  -43.308093 YAVE =  -43.308093
    ZMIN =  -19.889334 ZMAX =  -19.889334 ZAVE =  -19.889334
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.8993779"
Evaluating: 49.8993779+3.5
 Parameter: XMAX <- "53.3993779"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.3080925"
Evaluating: -43.3080925+3.5
 Parameter: YMAX <- "-39.8080925"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.8893337"
Evaluating: -19.8893337+3.5
 Parameter: ZMAX <- "-16.3893337"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.8993779"
Evaluating: 49.8993779-3.5
 Parameter: XMIN <- "46.3993779"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.3080925"
Evaluating: -43.3080925-3.5
 Parameter: YMIN <- "-46.8080925"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.8893337"
Evaluating: -19.8893337-3.5
 Parameter: ZMIN <- "-23.3893337"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.3993779"
 Parameter: XMIN -> "46.3993779"
 Parameter: YMAX -> "-39.8080925"
 Parameter: YMIN -> "-46.8080925"
 Parameter: ZMAX -> "-16.3893337"
 Parameter: ZMIN -> "-23.3893337"
 SELRPN>     23 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     11 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53274 NEG      CLA      97       CLA     -**** MEMB     POPC     293      P             3.2776
53274 NEG      CLA      97       CLA     -**** MEMB     POPC     293      O13           3.1353
53274 NEG      CLA      97       CLA     -**** MEMB     POPC     293      O14           3.5476
53274 NEG      CLA      97       CLA     -**** MEMB     POPC     293      O11           2.6867
53274 NEG      CLA      97       CLA     -**** MEMB     POPC     293      C1            1.5840
53274 NEG      CLA      97       CLA     -**** MEMB     POPC     293      C2            2.3962
53274 NEG      CLA      97       CLA     -**** MEMB     POPC     293      O21           3.7205
53274 NEG      CLA      97       CLA     -**** MEMB     POPC     293      C3            2.7714
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "217"
Evaluating: 217
 Parameter: J <- "217"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "217" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "217"
 Parameter: NPOS -> "120"
Evaluating: 217-120
 Parameter: J <- "97"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "3.932482453E-02"
Evaluating: 112.065471*(3.932482453E-02-0.5)
 Parameter: XPOS <- "-51.6257805"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.984072248"
Evaluating: 112.065471*(0.984072248-0.5)
 Parameter: YPOS <- "54.2477845"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.831371813"
Evaluating: 142.885239*(0.831371813-0.5)+2.93414115
 Parameter: ZPOS <- "50.2822818"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.2822818" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.2822818" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.899378 XMAX =   49.899378 XAVE =   49.899378
    YMIN =  -43.308093 YMAX =  -43.308093 YAVE =  -43.308093
    ZMIN =  -19.889334 ZMAX =  -19.889334 ZAVE =  -19.889334
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.6257805"
 RDCMND substituted energy or value "?XAVE" to "49.8993779"
Evaluating: -51.6257805-49.8993779
 Parameter: XTRAN <- "-101.525158"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "54.2477845"
 RDCMND substituted energy or value "?YAVE" to "-43.3080925"
Evaluating: 54.2477845--43.3080925
 Parameter: YTRAN <- "97.555877"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.2822818"
 RDCMND substituted energy or value "?ZAVE" to "-19.8893337"
Evaluating: 50.2822818--19.8893337
 Parameter: ZTRAN <- "70.1716155"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-101.525158"
 Parameter: YTRAN -> "97.555877"
 Parameter: ZTRAN -> "70.1716155"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR  -101.525158   97.555877   70.171616
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.158686562"
Evaluating: 0.158686562*360.0
 Parameter: XPHI <- "57.1271623"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.65756557"
Evaluating: 0.65756557*360.0
 Parameter: YPHI <- "236.723605"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.301539608E-02"
Evaluating: 8.301539608E-02*360.0
 Parameter: ZPHI <- "29.8855426"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.6257805"
 Parameter: YPOS -> "54.2477845"
 Parameter: ZPOS -> "50.2822818"
 Parameter: XPHI -> "57.1271623"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.542776    0.839877
    0.000000   -0.839877    0.542776

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   57.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.6257805"
 Parameter: YPOS -> "54.2477845"
 Parameter: ZPOS -> "50.2822818"
 Parameter: YPHI -> "236.723605"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.548678    0.000000    0.836033
    0.000000    1.000000    0.000000
   -0.836033    0.000000   -0.548678

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  123.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.6257805"
 Parameter: YPOS -> "54.2477845"
 Parameter: ZPOS -> "50.2822818"
 Parameter: ZPHI -> "29.8855426"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.867023    0.498269    0.000000
   -0.498269    0.867023    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   29.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.625781 XMAX =  -51.625781 XAVE =  -51.625781
    YMIN =   54.247785 YMAX =   54.247785 YAVE =   54.247785
    ZMIN =   50.282281 ZMAX =   50.282281 ZAVE =   50.282281
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.6257807"
Evaluating: -51.6257807+3.5
 Parameter: XMAX <- "-48.1257807"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "54.2477846"
Evaluating: 54.2477846+3.5
 Parameter: YMAX <- "57.7477846"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.2822815"
Evaluating: 50.2822815+3.5
 Parameter: ZMAX <- "53.7822815"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.6257807"
Evaluating: -51.6257807-3.5
 Parameter: XMIN <- "-55.1257807"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "54.2477846"
Evaluating: 54.2477846-3.5
 Parameter: YMIN <- "50.7477846"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.2822815"
Evaluating: 50.2822815-3.5
 Parameter: ZMIN <- "46.7822815"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-48.1257807"
 Parameter: XMIN -> "-55.1257807"
 Parameter: YMAX -> "57.7477846"
 Parameter: YMIN -> "50.7477846"
 Parameter: ZMAX -> "53.7822815"
 Parameter: ZMIN -> "46.7822815"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "218"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "218" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "218"
Evaluating: 218
 Parameter: J <- "218"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "218" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "218"
 Parameter: NPOS -> "120"
Evaluating: 218-120
 Parameter: J <- "98"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "98"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "5.861062858E-02"
Evaluating: 112.065471*(5.861062858E-02-0.5)
 Parameter: XPOS <- "-49.4645078"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.416566559"
Evaluating: 112.065471*(0.416566559-0.5)
 Parameter: YPOS <- "-9.35000786"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.315866451"
Evaluating: 142.885239*(0.315866451-0.5)+2.93414115
 Parameter: ZPOS <- "-23.375825"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.375825" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-49.4645078"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -49.4645078-0
 Parameter: XTRAN <- "-49.4645078"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.35000786"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.35000786-0
 Parameter: YTRAN <- "-9.35000786"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.375825"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.375825-0
 Parameter: ZTRAN <- "-23.375825"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.4645078"
 Parameter: YTRAN -> "-9.35000786"
 Parameter: ZTRAN -> "-23.375825"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -49.464508   -9.350008  -23.375825
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.11725972"
Evaluating: 0.11725972*360.0
 Parameter: XPHI <- "42.2134992"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291826982"
Evaluating: 0.291826982*360.0
 Parameter: YPHI <- "105.057714"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.21091879"
Evaluating: 0.21091879*360.0
 Parameter: ZPHI <- "75.9307644"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-49.4645078"
 Parameter: YPOS -> "-9.35000786"
 Parameter: ZPOS -> "-23.375825"
 Parameter: XPHI -> "42.2134992"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.740646    0.671895
    0.000000   -0.671895    0.740646

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   42.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-49.4645078"
 Parameter: YPOS -> "-9.35000786"
 Parameter: ZPOS -> "-23.375825"
 Parameter: YPHI -> "105.057714"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.259792    0.000000   -0.965665
    0.000000    1.000000    0.000000
    0.965665    0.000000   -0.259792

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  105.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-49.4645078"
 Parameter: YPOS -> "-9.35000786"
 Parameter: ZPOS -> "-23.375825"
 Parameter: ZPHI -> "75.9307644"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.243094    0.970003    0.000000
   -0.970003    0.243094    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   75.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.464508 XMAX =  -49.464508 XAVE =  -49.464508
    YMIN =   -9.350008 YMAX =   -9.350008 YAVE =   -9.350008
    ZMIN =  -23.375825 ZMAX =  -23.375825 ZAVE =  -23.375825
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-49.4645078"
Evaluating: -49.4645078+3.5
 Parameter: XMAX <- "-45.9645078"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.35000786"
Evaluating: -9.35000786+3.5
 Parameter: YMAX <- "-5.85000786"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.375825"
Evaluating: -23.375825+3.5
 Parameter: ZMAX <- "-19.875825"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-49.4645078"
Evaluating: -49.4645078-3.5
 Parameter: XMIN <- "-52.9645078"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.35000786"
Evaluating: -9.35000786-3.5
 Parameter: YMIN <- "-12.8500079"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.375825"
Evaluating: -23.375825-3.5
 Parameter: ZMIN <- "-26.875825"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-45.9645078"
 Parameter: XMIN -> "-52.9645078"
 Parameter: YMAX -> "-5.85000786"
 Parameter: YMIN -> "-12.8500079"
 Parameter: ZMAX -> "-19.875825"
 Parameter: ZMIN -> "-26.875825"
 SELRPN>     13 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      4 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53275 NEG      CLA      98       CLA     -**** MEMB     POPC     249      N             2.6452
53275 NEG      CLA      98       CLA     -**** MEMB     POPC     249      C12           3.7410
53275 NEG      CLA      98       CLA     -**** MEMB     POPC     249      C14           2.3836
53275 NEG      CLA      98       CLA     -**** MEMB     POPC     249      C15           1.8262
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "218"
Evaluating: 218
 Parameter: J <- "218"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "218" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "218"
 Parameter: NPOS -> "120"
Evaluating: 218-120
 Parameter: J <- "98"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "98"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.456619399"
Evaluating: 112.065471*(0.456619399-0.5)
 Parameter: XPOS <- "-4.86146748"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.987794444"
Evaluating: 112.065471*(0.987794444-0.5)
 Parameter: YPOS <- "54.6649141"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.822820273"
Evaluating: 142.885239*(0.822820273-0.5)+2.93414115
 Parameter: ZPOS <- "49.060393"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.060393" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.060393" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.464508 XMAX =  -49.464508 XAVE =  -49.464508
    YMIN =   -9.350008 YMAX =   -9.350008 YAVE =   -9.350008
    ZMIN =  -23.375825 ZMAX =  -23.375825 ZAVE =  -23.375825
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.86146748"
 RDCMND substituted energy or value "?XAVE" to "-49.4645078"
Evaluating: -4.86146748--49.4645078
 Parameter: XTRAN <- "44.6030403"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "54.6649141"
 RDCMND substituted energy or value "?YAVE" to "-9.35000786"
Evaluating: 54.6649141--9.35000786
 Parameter: YTRAN <- "64.014922"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.060393"
 RDCMND substituted energy or value "?ZAVE" to "-23.375825"
Evaluating: 49.060393--23.375825
 Parameter: ZTRAN <- "72.436218"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.6030403"
 Parameter: YTRAN -> "64.014922"
 Parameter: ZTRAN -> "72.436218"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    44.603040   64.014922   72.436218
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.66289427"
Evaluating: 0.66289427*360.0
 Parameter: XPHI <- "238.641937"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987235615"
Evaluating: 0.987235615*360.0
 Parameter: YPHI <- "355.404821"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.222396612"
Evaluating: 0.222396612*360.0
 Parameter: ZPHI <- "80.0627803"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.86146748"
 Parameter: YPOS -> "54.6649141"
 Parameter: ZPOS -> "49.060393"
 Parameter: XPHI -> "238.641937"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.520385   -0.853932
    0.000000    0.853932   -0.520385

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  121.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.86146748"
 Parameter: YPOS -> "54.6649141"
 Parameter: ZPOS -> "49.060393"
 Parameter: YPHI -> "355.404821"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.996786    0.000000    0.080115
    0.000000    1.000000    0.000000
   -0.080115    0.000000    0.996786

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.86146748"
 Parameter: YPOS -> "54.6649141"
 Parameter: ZPOS -> "49.060393"
 Parameter: ZPHI -> "80.0627803"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.172569    0.984997    0.000000
   -0.984997    0.172569    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   80.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.861468 XMAX =   -4.861468 XAVE =   -4.861468
    YMIN =   54.664914 YMAX =   54.664914 YAVE =   54.664914
    ZMIN =   49.060393 ZMAX =   49.060393 ZAVE =   49.060393
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.8614675"
Evaluating: -4.8614675+3.5
 Parameter: XMAX <- "-1.3614675"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "54.6649141"
Evaluating: 54.6649141+3.5
 Parameter: YMAX <- "58.1649141"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.060393"
Evaluating: 49.060393+3.5
 Parameter: ZMAX <- "52.560393"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.8614675"
Evaluating: -4.8614675-3.5
 Parameter: XMIN <- "-8.3614675"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "54.6649141"
Evaluating: 54.6649141-3.5
 Parameter: YMIN <- "51.1649141"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.060393"
Evaluating: 49.060393-3.5
 Parameter: ZMIN <- "45.560393"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.3614675"
 Parameter: XMIN -> "-8.3614675"
 Parameter: YMAX -> "58.1649141"
 Parameter: YMIN -> "51.1649141"
 Parameter: ZMAX -> "52.560393"
 Parameter: ZMIN -> "45.560393"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "219"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "219" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "219"
Evaluating: 219
 Parameter: J <- "219"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "219" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "219"
 Parameter: NPOS -> "120"
Evaluating: 219-120
 Parameter: J <- "99"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.340864338"
Evaluating: 112.065471*(0.340864338-0.5)
 Parameter: XPOS <- "-17.8336129"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.850987837"
Evaluating: 112.065471*(0.850987837-0.5)
 Parameter: YPOS <- "39.3336173"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.351446621"
Evaluating: 142.885239*(0.351446621-0.5)+2.93414115
 Parameter: ZPOS <- "-18.2919439"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.2919439" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.8336129"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.8336129-0
 Parameter: XTRAN <- "-17.8336129"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.3336173"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 39.3336173-0
 Parameter: YTRAN <- "39.3336173"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.2919439"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.2919439-0
 Parameter: ZTRAN <- "-18.2919439"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.8336129"
 Parameter: YTRAN -> "39.3336173"
 Parameter: ZTRAN -> "-18.2919439"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -17.833613   39.333617  -18.291944
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.136652255"
Evaluating: 0.136652255*360.0
 Parameter: XPHI <- "49.1948118"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.205855479"
Evaluating: 0.205855479*360.0
 Parameter: YPHI <- "74.1079724"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.157552565"
Evaluating: 0.157552565*360.0
 Parameter: ZPHI <- "56.7189234"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.8336129"
 Parameter: YPOS -> "39.3336173"
 Parameter: ZPOS -> "-18.2919439"
 Parameter: XPHI -> "49.1948118"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.653489    0.756936
    0.000000   -0.756936    0.653489

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   49.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.8336129"
 Parameter: YPOS -> "39.3336173"
 Parameter: ZPOS -> "-18.2919439"
 Parameter: YPHI -> "74.1079724"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.273825    0.000000   -0.961779
    0.000000    1.000000    0.000000
    0.961779    0.000000    0.273825

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   74.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.8336129"
 Parameter: YPOS -> "39.3336173"
 Parameter: ZPOS -> "-18.2919439"
 Parameter: ZPHI -> "56.7189234"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.548747    0.835989    0.000000
   -0.835989    0.548747    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   56.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.833613 XMAX =  -17.833613 XAVE =  -17.833613
    YMIN =   39.333617 YMAX =   39.333617 YAVE =   39.333617
    ZMIN =  -18.291944 ZMAX =  -18.291944 ZAVE =  -18.291944
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.8336129"
Evaluating: -17.8336129+3.5
 Parameter: XMAX <- "-14.3336129"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.3336173"
Evaluating: 39.3336173+3.5
 Parameter: YMAX <- "42.8336173"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.2919439"
Evaluating: -18.2919439+3.5
 Parameter: ZMAX <- "-14.7919439"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.8336129"
Evaluating: -17.8336129-3.5
 Parameter: XMIN <- "-21.3336129"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.3336173"
Evaluating: 39.3336173-3.5
 Parameter: YMIN <- "35.8336173"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.2919439"
Evaluating: -18.2919439-3.5
 Parameter: ZMIN <- "-21.7919439"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.3336129"
 Parameter: XMIN -> "-21.3336129"
 Parameter: YMAX -> "42.8336173"
 Parameter: YMIN -> "35.8336173"
 Parameter: ZMAX -> "-14.7919439"
 Parameter: ZMIN -> "-21.7919439"
 SELRPN>     20 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      7 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53276 NEG      CLA      99       CLA     -**** MEMB     POPC     172      C12           3.5090
53276 NEG      CLA      99       CLA     -**** MEMB     POPC     194      C2            3.1607
53276 NEG      CLA      99       CLA     -**** MEMB     POPC     194      C3            1.8290
53276 NEG      CLA      99       CLA     -**** MEMB     POPC     194      O31           2.3720
53276 NEG      CLA      99       CLA     -**** MEMB     POPC     194      C31           3.2044
53276 NEG      CLA      99       CLA     -**** MEMB     POPC     194      O32           3.5336
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "219"
Evaluating: 219
 Parameter: J <- "219"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "219" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "219"
 Parameter: NPOS -> "120"
Evaluating: 219-120
 Parameter: J <- "99"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.344661871"
Evaluating: 112.065471*(0.344661871-0.5)
 Parameter: XPOS <- "-17.4080406"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.370961377"
Evaluating: 112.065471*(0.370961377-0.5)
 Parameter: YPOS <- "-14.4607741"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.332610624"
Evaluating: 142.885239*(0.332610624-0.5)+2.93414115
 Parameter: ZPOS <- "-20.9833298"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.9833298" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.833613 XMAX =  -17.833613 XAVE =  -17.833613
    YMIN =   39.333617 YMAX =   39.333617 YAVE =   39.333617
    ZMIN =  -18.291944 ZMAX =  -18.291944 ZAVE =  -18.291944
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.4080406"
 RDCMND substituted energy or value "?XAVE" to "-17.8336129"
Evaluating: -17.4080406--17.8336129
 Parameter: XTRAN <- "0.4255723"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.4607741"
 RDCMND substituted energy or value "?YAVE" to "39.3336173"
Evaluating: -14.4607741-39.3336173
 Parameter: YTRAN <- "-53.7943914"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.9833298"
 RDCMND substituted energy or value "?ZAVE" to "-18.2919439"
Evaluating: -20.9833298--18.2919439
 Parameter: ZTRAN <- "-2.6913859"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.4255723"
 Parameter: YTRAN -> "-53.7943914"
 Parameter: ZTRAN -> "-2.6913859"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     0.425572  -53.794391   -2.691386
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720110228"
Evaluating: 0.720110228*360.0
 Parameter: XPHI <- "259.239682"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.429299936"
Evaluating: 0.429299936*360.0
 Parameter: YPHI <- "154.547977"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.993660741"
Evaluating: 0.993660741*360.0
 Parameter: ZPHI <- "357.717867"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.4080406"
 Parameter: YPOS -> "-14.4607741"
 Parameter: ZPOS -> "-20.9833298"
 Parameter: XPHI -> "259.239682"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.186701   -0.982417
    0.000000    0.982417   -0.186701

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.4080406"
 Parameter: YPOS -> "-14.4607741"
 Parameter: ZPOS -> "-20.9833298"
 Parameter: YPHI -> "154.547977"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.902945    0.000000   -0.429755
    0.000000    1.000000    0.000000
    0.429755    0.000000   -0.902945

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  154.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.4080406"
 Parameter: YPOS -> "-14.4607741"
 Parameter: ZPOS -> "-20.9833298"
 Parameter: ZPHI -> "357.717867"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.999207   -0.039820    0.000000
    0.039820    0.999207    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    2.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.408041 XMAX =  -17.408041 XAVE =  -17.408041
    YMIN =  -14.460774 YMAX =  -14.460774 YAVE =  -14.460774
    ZMIN =  -20.983330 ZMAX =  -20.983330 ZAVE =  -20.983330
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.4080406"
Evaluating: -17.4080406+3.5
 Parameter: XMAX <- "-13.9080406"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.4607741"
Evaluating: -14.4607741+3.5
 Parameter: YMAX <- "-10.9607741"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.9833298"
Evaluating: -20.9833298+3.5
 Parameter: ZMAX <- "-17.4833298"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.4080406"
Evaluating: -17.4080406-3.5
 Parameter: XMIN <- "-20.9080406"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.4607741"
Evaluating: -14.4607741-3.5
 Parameter: YMIN <- "-17.9607741"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.9833298"
Evaluating: -20.9833298-3.5
 Parameter: ZMIN <- "-24.4833298"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.9080406"
 Parameter: XMIN -> "-20.9080406"
 Parameter: YMAX -> "-10.9607741"
 Parameter: YMIN -> "-17.9607741"
 Parameter: ZMAX -> "-17.4833298"
 Parameter: ZMIN -> "-24.4833298"
 SELRPN>     30 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>     11 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53276 NEG      CLA      99       CLA     -7681 PROB     PHE      508      N             3.7594
53276 NEG      CLA      99       CLA     -7683 PROB     PHE      508      CA            2.5513
53276 NEG      CLA      99       CLA     -7685 PROB     PHE      508      CB            1.4071
53276 NEG      CLA      99       CLA     -7688 PROB     PHE      508      CG            2.0479
53276 NEG      CLA      99       CLA     -7689 PROB     PHE      508      CD1           2.4136
53276 NEG      CLA      99       CLA     -7691 PROB     PHE      508      CE1           3.7192
53276 NEG      CLA      99       CLA     -7695 PROB     PHE      508      CD2           3.2715
53276 NEG      CLA      99       CLA     -7697 PROB     PHE      508      CE2           4.3139
53276 NEG      CLA      99       CLA     -7699 PROB     PHE      508      C             2.9876
53276 NEG      CLA      99       CLA     -7700 PROB     PHE      508      O             3.1177
53276 NEG      CLA      99       CLA     -7765 PROB     PHE      512      CE1           3.8760
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "219"
Evaluating: 219
 Parameter: J <- "219"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "219" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "219"
 Parameter: NPOS -> "120"
Evaluating: 219-120
 Parameter: J <- "99"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.756992037"
Evaluating: 112.065471*(0.756992037-0.5)
 Parameter: XPOS <- "28.7999337"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.966081261"
Evaluating: 112.065471*(0.966081261-0.5)
 Parameter: YPOS <- "52.231616"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.538922944"
Evaluating: 142.885239*(0.538922944-0.5)+2.93414115
 Parameter: ZPOS <- "8.49565531"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.49565531" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.49565531" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "219"
Evaluating: 219
 Parameter: J <- "219"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "219" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "219"
 Parameter: NPOS -> "120"
Evaluating: 219-120
 Parameter: J <- "99"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.983796091"
Evaluating: 112.065471*(0.983796091-0.5)
 Parameter: XPOS <- "54.2168368"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.277625269"
Evaluating: 112.065471*(0.277625269-0.5)
 Parameter: YPOS <- "-24.920529"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.180666375"
Evaluating: 142.885239*(0.180666375-0.5)+2.93414115
 Parameter: ZPOS <- "-42.6939202"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.6939202" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.408041 XMAX =  -17.408041 XAVE =  -17.408041
    YMIN =  -14.460774 YMAX =  -14.460774 YAVE =  -14.460774
    ZMIN =  -20.983330 ZMAX =  -20.983330 ZAVE =  -20.983330
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "54.2168368"
 RDCMND substituted energy or value "?XAVE" to "-17.4080406"
Evaluating: 54.2168368--17.4080406
 Parameter: XTRAN <- "71.6248774"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.920529"
 RDCMND substituted energy or value "?YAVE" to "-14.4607741"
Evaluating: -24.920529--14.4607741
 Parameter: YTRAN <- "-10.4597549"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.6939202"
 RDCMND substituted energy or value "?ZAVE" to "-20.9833298"
Evaluating: -42.6939202--20.9833298
 Parameter: ZTRAN <- "-21.7105904"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "71.6248774"
 Parameter: YTRAN -> "-10.4597549"
 Parameter: ZTRAN -> "-21.7105904"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    71.624877  -10.459755  -21.710590
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.237231395"
Evaluating: 0.237231395*360.0
 Parameter: XPHI <- "85.4033022"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.441302849"
Evaluating: 0.441302849*360.0
 Parameter: YPHI <- "158.869026"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.355147957"
Evaluating: 0.355147957*360.0
 Parameter: ZPHI <- "127.853265"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "54.2168368"
 Parameter: YPOS -> "-24.920529"
 Parameter: ZPOS -> "-42.6939202"
 Parameter: XPHI -> "85.4033022"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.080141    0.996783
    0.000000   -0.996783    0.080141

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   85.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "54.2168368"
 Parameter: YPOS -> "-24.920529"
 Parameter: ZPOS -> "-42.6939202"
 Parameter: YPHI -> "158.869026"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.932759    0.000000   -0.360501
    0.000000    1.000000    0.000000
    0.360501    0.000000   -0.932759

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  158.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "54.2168368"
 Parameter: YPOS -> "-24.920529"
 Parameter: ZPOS -> "-42.6939202"
 Parameter: ZPHI -> "127.853265"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.613641    0.789585    0.000000
   -0.789585   -0.613641    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  127.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   54.216837 XMAX =   54.216837 XAVE =   54.216837
    YMIN =  -24.920529 YMAX =  -24.920529 YAVE =  -24.920529
    ZMIN =  -42.693920 ZMAX =  -42.693920 ZAVE =  -42.693920
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "54.2168368"
Evaluating: 54.2168368+3.5
 Parameter: XMAX <- "57.7168368"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.920529"
Evaluating: -24.920529+3.5
 Parameter: YMAX <- "-21.420529"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.6939202"
Evaluating: -42.6939202+3.5
 Parameter: ZMAX <- "-39.1939202"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "54.2168368"
Evaluating: 54.2168368-3.5
 Parameter: XMIN <- "50.7168368"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.920529"
Evaluating: -24.920529-3.5
 Parameter: YMIN <- "-28.420529"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.6939202"
Evaluating: -42.6939202-3.5
 Parameter: ZMIN <- "-46.1939202"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.7168368"
 Parameter: XMIN -> "50.7168368"
 Parameter: YMAX -> "-21.420529"
 Parameter: YMIN -> "-28.420529"
 Parameter: ZMAX -> "-39.1939202"
 Parameter: ZMIN -> "-46.1939202"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "220"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "220" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "220"
Evaluating: 220
 Parameter: J <- "220"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "220" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "220"
 Parameter: NPOS -> "120"
Evaluating: 220-120
 Parameter: J <- "100"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "100"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "8.207170942E-02"
Evaluating: 112.065471*(8.207170942E-02-0.5)
 Parameter: XPOS <- "-46.8353307"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.515101742"
Evaluating: 112.065471*(0.515101742-0.5)
 Parameter: YPOS <- "1.69238383"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.958423592"
Evaluating: 142.885239*(0.958423592-0.5)+2.93414115
 Parameter: ZPOS <- "68.4361057"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "68.4361057" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "68.4361057" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.8353307"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -46.8353307-0
 Parameter: XTRAN <- "-46.8353307"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.69238383"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.69238383-0
 Parameter: YTRAN <- "1.69238383"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "68.4361057"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 68.4361057-0
 Parameter: ZTRAN <- "68.4361057"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.8353307"
 Parameter: YTRAN -> "1.69238383"
 Parameter: ZTRAN -> "68.4361057"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -46.835331    1.692384   68.436106
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.125568481"
Evaluating: 0.125568481*360.0
 Parameter: XPHI <- "45.2046532"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.12393575"
Evaluating: 0.12393575*360.0
 Parameter: YPHI <- "44.61687"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.734728557"
Evaluating: 0.734728557*360.0
 Parameter: ZPHI <- "264.502281"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.8353307"
 Parameter: YPOS -> "1.69238383"
 Parameter: ZPOS -> "68.4361057"
 Parameter: XPHI -> "45.2046532"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.704577    0.709628
    0.000000   -0.709628    0.704577

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   45.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.8353307"
 Parameter: YPOS -> "1.69238383"
 Parameter: ZPOS -> "68.4361057"
 Parameter: YPHI -> "44.61687"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.711819    0.000000   -0.702363
    0.000000    1.000000    0.000000
    0.702363    0.000000    0.711819

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   44.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.8353307"
 Parameter: YPOS -> "1.69238383"
 Parameter: ZPOS -> "68.4361057"
 Parameter: ZPHI -> "264.502281"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.095806   -0.995400    0.000000
    0.995400   -0.095806    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   95.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.835331 XMAX =  -46.835331 XAVE =  -46.835331
    YMIN =    1.692384 YMAX =    1.692384 YAVE =    1.692384
    ZMIN =   68.436106 ZMAX =   68.436106 ZAVE =   68.436106
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.8353307"
Evaluating: -46.8353307+3.5
 Parameter: XMAX <- "-43.3353307"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.69238383"
Evaluating: 1.69238383+3.5
 Parameter: YMAX <- "5.19238383"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "68.4361057"
Evaluating: 68.4361057+3.5
 Parameter: ZMAX <- "71.9361057"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.8353307"
Evaluating: -46.8353307-3.5
 Parameter: XMIN <- "-50.3353307"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.69238383"
Evaluating: 1.69238383-3.5
 Parameter: YMIN <- "-1.80761617"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "68.4361057"
Evaluating: 68.4361057-3.5
 Parameter: ZMIN <- "64.9361057"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.3353307"
 Parameter: XMIN -> "-50.3353307"
 Parameter: YMAX -> "5.19238383"
 Parameter: YMIN -> "-1.80761617"
 Parameter: ZMAX -> "71.9361057"
 Parameter: ZMIN -> "64.9361057"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "221"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "221" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "221"
Evaluating: 221
 Parameter: J <- "221"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "221" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "221"
 Parameter: NPOS -> "120"
Evaluating: 221-120
 Parameter: J <- "101"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.795895861"
Evaluating: 112.065471*(0.795895861-0.5)
 Parameter: XPOS <- "33.159709"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.125417626"
Evaluating: 112.065471*(0.125417626-0.5)
 Parameter: YPOS <- "-41.9777502"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.629165109"
Evaluating: 142.885239*(0.629165109-0.5)+2.93414115
 Parameter: ZPOS <- "21.3899286"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.3899286" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.3899286" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.159709"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.159709-0
 Parameter: XTRAN <- "33.159709"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.9777502"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -41.9777502-0
 Parameter: YTRAN <- "-41.9777502"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.3899286"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.3899286-0
 Parameter: ZTRAN <- "21.3899286"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.159709"
 Parameter: YTRAN -> "-41.9777502"
 Parameter: ZTRAN -> "21.3899286"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    33.159709  -41.977750   21.389929
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.832909681E-02"
Evaluating: 3.832909681E-02*360.0
 Parameter: XPHI <- "13.7984749"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.25192481"
Evaluating: 0.25192481*360.0
 Parameter: YPHI <- "90.6929316"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.969470251E-02"
Evaluating: 4.969470251E-02*360.0
 Parameter: ZPHI <- "17.8900929"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.159709"
 Parameter: YPOS -> "-41.9777502"
 Parameter: ZPOS -> "21.3899286"
 Parameter: XPHI -> "13.7984749"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.971141    0.238508
    0.000000   -0.238508    0.971141

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   13.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.159709"
 Parameter: YPOS -> "-41.9777502"
 Parameter: ZPOS -> "21.3899286"
 Parameter: YPHI -> "90.6929316"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.012094    0.000000   -0.999927
    0.000000    1.000000    0.000000
    0.999927    0.000000   -0.012094

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   90.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.159709"
 Parameter: YPOS -> "-41.9777502"
 Parameter: ZPOS -> "21.3899286"
 Parameter: ZPHI -> "17.8900929"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.951648    0.307192    0.000000
   -0.307192    0.951648    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.159709 XMAX =   33.159709 XAVE =   33.159709
    YMIN =  -41.977750 YMAX =  -41.977750 YAVE =  -41.977750
    ZMIN =   21.389929 ZMAX =   21.389929 ZAVE =   21.389929
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.159709"
Evaluating: 33.159709+3.5
 Parameter: XMAX <- "36.659709"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.9777502"
Evaluating: -41.9777502+3.5
 Parameter: YMAX <- "-38.4777502"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.3899286"
Evaluating: 21.3899286+3.5
 Parameter: ZMAX <- "24.8899286"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.159709"
Evaluating: 33.159709-3.5
 Parameter: XMIN <- "29.659709"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.9777502"
Evaluating: -41.9777502-3.5
 Parameter: YMIN <- "-45.4777502"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.3899286"
Evaluating: 21.3899286-3.5
 Parameter: ZMIN <- "17.8899286"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.659709"
 Parameter: XMIN -> "29.659709"
 Parameter: YMAX -> "-38.4777502"
 Parameter: YMIN -> "-45.4777502"
 Parameter: ZMAX -> "24.8899286"
 Parameter: ZMIN -> "17.8899286"
 SELRPN>     12 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      6 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53278 NEG      CLA      101      CLA     -**** MEMB     POPC     72       C13           2.8897
53278 NEG      CLA      101      CLA     -**** MEMB     POPC     75       O14           3.5874
53278 NEG      CLA      101      CLA     -**** MEMB     POPC     75       O12           3.2884
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "221"
Evaluating: 221
 Parameter: J <- "221"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "221" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "221"
 Parameter: NPOS -> "120"
Evaluating: 221-120
 Parameter: J <- "101"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.304987391"
Evaluating: 112.065471*(0.304987391-0.5)
 Parameter: XPOS <- "-21.8541799"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "7.993543506E-02"
Evaluating: 112.065471*(7.993543506E-02-0.5)
 Parameter: YPOS <- "-47.0747333"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.454720757"
Evaluating: 142.885239*(0.454720757-0.5)+2.93414115
 Parameter: ZPOS <- "-3.53559431"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.53559431" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.53559431" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "221"
Evaluating: 221
 Parameter: J <- "221"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "221" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "221"
 Parameter: NPOS -> "120"
Evaluating: 221-120
 Parameter: J <- "101"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.491164119"
Evaluating: 112.065471*(0.491164119-0.5)
 Parameter: XPOS <- "-0.990197166"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.554895149"
Evaluating: 112.065471*(0.554895149-0.5)
 Parameter: YPOS <- "6.15185073"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "5.684936596E-03"
Evaluating: 142.885239*(5.684936596E-03-0.5)+2.93414115
 Parameter: ZPOS <- "-67.6961848"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-67.6961848" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.159709 XMAX =   33.159709 XAVE =   33.159709
    YMIN =  -41.977750 YMAX =  -41.977750 YAVE =  -41.977750
    ZMIN =   21.389929 ZMAX =   21.389929 ZAVE =   21.389929
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.990197166"
 RDCMND substituted energy or value "?XAVE" to "33.159709"
Evaluating: -0.990197166-33.159709
 Parameter: XTRAN <- "-34.1499062"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.15185073"
 RDCMND substituted energy or value "?YAVE" to "-41.9777502"
Evaluating: 6.15185073--41.9777502
 Parameter: YTRAN <- "48.1296009"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-67.6961848"
 RDCMND substituted energy or value "?ZAVE" to "21.3899286"
Evaluating: -67.6961848-21.3899286
 Parameter: ZTRAN <- "-89.0861134"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.1499062"
 Parameter: YTRAN -> "48.1296009"
 Parameter: ZTRAN -> "-89.0861134"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -34.149906   48.129601  -89.086113
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.933944326"
Evaluating: 0.933944326*360.0
 Parameter: XPHI <- "336.219957"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.447335413"
Evaluating: 0.447335413*360.0
 Parameter: YPHI <- "161.040749"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.243403618E-02"
Evaluating: 7.243403618E-02*360.0
 Parameter: ZPHI <- "26.076253"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.990197166"
 Parameter: YPOS -> "6.15185073"
 Parameter: ZPOS -> "-67.6961848"
 Parameter: XPHI -> "336.219957"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.915100   -0.403227
    0.000000    0.403227    0.915100

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.990197166"
 Parameter: YPOS -> "6.15185073"
 Parameter: ZPOS -> "-67.6961848"
 Parameter: YPHI -> "161.040749"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.945750    0.000000   -0.324896
    0.000000    1.000000    0.000000
    0.324896    0.000000   -0.945750

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  161.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.990197166"
 Parameter: YPOS -> "6.15185073"
 Parameter: ZPOS -> "-67.6961848"
 Parameter: ZPHI -> "26.076253"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.898210    0.439567    0.000000
   -0.439567    0.898210    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   26.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.990197 XMAX =   -0.990197 XAVE =   -0.990197
    YMIN =    6.151851 YMAX =    6.151851 YAVE =    6.151851
    ZMIN =  -67.696185 ZMAX =  -67.696185 ZAVE =  -67.696185
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.990197146"
Evaluating: -0.990197146+3.5
 Parameter: XMAX <- "2.50980285"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.15185069"
Evaluating: 6.15185069+3.5
 Parameter: YMAX <- "9.65185069"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-67.6961848"
Evaluating: -67.6961848+3.5
 Parameter: ZMAX <- "-64.1961848"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.990197146"
Evaluating: -0.990197146-3.5
 Parameter: XMIN <- "-4.49019715"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.15185069"
Evaluating: 6.15185069-3.5
 Parameter: YMIN <- "2.65185069"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-67.6961848"
Evaluating: -67.6961848-3.5
 Parameter: ZMIN <- "-71.1961848"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.50980285"
 Parameter: XMIN -> "-4.49019715"
 Parameter: YMAX -> "9.65185069"
 Parameter: YMIN -> "2.65185069"
 Parameter: ZMAX -> "-64.1961848"
 Parameter: ZMIN -> "-71.1961848"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "222"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "222" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "222"
Evaluating: 222
 Parameter: J <- "222"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "222" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "222"
 Parameter: NPOS -> "120"
Evaluating: 222-120
 Parameter: J <- "102"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.996719801"
Evaluating: 112.065471*(0.996719801-0.5)
 Parameter: XPOS <- "55.6651385"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "6.305155707E-02"
Evaluating: 112.065471*(6.305155707E-02-0.5)
 Parameter: YPOS <- "-48.9668331"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.526234665"
Evaluating: 142.885239*(0.526234665-0.5)+2.93414115
 Parameter: ZPOS <- "6.68268753"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.68268753" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.68268753" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "222"
Evaluating: 222
 Parameter: J <- "222"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "222" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "222"
 Parameter: NPOS -> "120"
Evaluating: 222-120
 Parameter: J <- "102"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.286866797"
Evaluating: 112.065471*(0.286866797-0.5)
 Parameter: XPOS <- "-23.8848728"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.525267073"
Evaluating: 112.065471*(0.525267073-0.5)
 Parameter: YPOS <- "2.83156644"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.667942735"
Evaluating: 142.885239*(0.667942735-0.5)+2.93414115
 Parameter: ZPOS <- "26.930679"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.930679" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.930679" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.8848728"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.8848728-0
 Parameter: XTRAN <- "-23.8848728"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.83156644"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.83156644-0
 Parameter: YTRAN <- "2.83156644"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.930679"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.930679-0
 Parameter: ZTRAN <- "26.930679"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.8848728"
 Parameter: YTRAN -> "2.83156644"
 Parameter: ZTRAN -> "26.930679"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -23.884873    2.831566   26.930679
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.276330846"
Evaluating: 0.276330846*360.0
 Parameter: XPHI <- "99.4791046"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.404499226"
Evaluating: 0.404499226*360.0
 Parameter: YPHI <- "145.619721"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.961054769"
Evaluating: 0.961054769*360.0
 Parameter: ZPHI <- "345.979717"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.8848728"
 Parameter: YPOS -> "2.83156644"
 Parameter: ZPOS -> "26.930679"
 Parameter: XPHI -> "99.4791046"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.164688    0.986346
    0.000000   -0.986346   -0.164688

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   99.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.8848728"
 Parameter: YPOS -> "2.83156644"
 Parameter: ZPOS -> "26.930679"
 Parameter: YPHI -> "145.619721"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.825308    0.000000   -0.564683
    0.000000    1.000000    0.000000
    0.564683    0.000000   -0.825308

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  145.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.8848728"
 Parameter: YPOS -> "2.83156644"
 Parameter: ZPOS -> "26.930679"
 Parameter: ZPHI -> "345.979717"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.970210   -0.242265    0.000000
    0.242265    0.970210    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   14.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.884873 XMAX =  -23.884873 XAVE =  -23.884873
    YMIN =    2.831566 YMAX =    2.831566 YAVE =    2.831566
    ZMIN =   26.930679 ZMAX =   26.930679 ZAVE =   26.930679
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.8848728"
Evaluating: -23.8848728+3.5
 Parameter: XMAX <- "-20.3848728"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.83156644"
Evaluating: 2.83156644+3.5
 Parameter: YMAX <- "6.33156644"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.930679"
Evaluating: 26.930679+3.5
 Parameter: ZMAX <- "30.430679"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.8848728"
Evaluating: -23.8848728-3.5
 Parameter: XMIN <- "-27.3848728"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.83156644"
Evaluating: 2.83156644-3.5
 Parameter: YMIN <- "-0.66843356"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.930679"
Evaluating: 26.930679-3.5
 Parameter: ZMIN <- "23.430679"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.3848728"
 Parameter: XMIN -> "-27.3848728"
 Parameter: YMAX -> "6.33156644"
 Parameter: YMIN -> "-0.66843356"
 Parameter: ZMAX -> "30.430679"
 Parameter: ZMIN -> "23.430679"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "223"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "223" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "223"
Evaluating: 223
 Parameter: J <- "223"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "223" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "223"
 Parameter: NPOS -> "120"
Evaluating: 223-120
 Parameter: J <- "103"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "103"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.539778799"
Evaluating: 112.065471*(0.539778799-0.5)
 Parameter: XPOS <- "4.45782985"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.977415348"
Evaluating: 112.065471*(0.977415348-0.5)
 Parameter: YPOS <- "53.5017758"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.330461905"
Evaluating: 142.885239*(0.330461905-0.5)+2.93414115
 Parameter: ZPOS <- "-21.2903501"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.2903501" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.45782985"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.45782985-0
 Parameter: XTRAN <- "4.45782985"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "53.5017758"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 53.5017758-0
 Parameter: YTRAN <- "53.5017758"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.2903501"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.2903501-0
 Parameter: ZTRAN <- "-21.2903501"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.45782985"
 Parameter: YTRAN -> "53.5017758"
 Parameter: ZTRAN -> "-21.2903501"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR     4.457830   53.501776  -21.290350
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.219746295"
Evaluating: 0.219746295*360.0
 Parameter: XPHI <- "79.1086662"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.800629837"
Evaluating: 0.800629837*360.0
 Parameter: YPHI <- "288.226741"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.284604518"
Evaluating: 0.284604518*360.0
 Parameter: ZPHI <- "102.457626"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.45782985"
 Parameter: YPOS -> "53.5017758"
 Parameter: ZPOS -> "-21.2903501"
 Parameter: XPHI -> "79.1086662"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.188947    0.981987
    0.000000   -0.981987    0.188947

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   79.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.45782985"
 Parameter: YPOS -> "53.5017758"
 Parameter: ZPOS -> "-21.2903501"
 Parameter: YPHI -> "288.226741"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.312778    0.000000    0.949826
    0.000000    1.000000    0.000000
   -0.949826    0.000000    0.312778

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.45782985"
 Parameter: YPOS -> "53.5017758"
 Parameter: ZPOS -> "-21.2903501"
 Parameter: ZPHI -> "102.457626"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.215718    0.976456    0.000000
   -0.976456   -0.215718    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  102.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.457830 XMAX =    4.457830 XAVE =    4.457830
    YMIN =   53.501776 YMAX =   53.501776 YAVE =   53.501776
    ZMIN =  -21.290350 ZMAX =  -21.290350 ZAVE =  -21.290350
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.45782985"
Evaluating: 4.45782985+3.5
 Parameter: XMAX <- "7.95782985"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "53.5017758"
Evaluating: 53.5017758+3.5
 Parameter: YMAX <- "57.0017758"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.2903501"
Evaluating: -21.2903501+3.5
 Parameter: ZMAX <- "-17.7903501"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.45782985"
Evaluating: 4.45782985-3.5
 Parameter: XMIN <- "0.95782985"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "53.5017758"
Evaluating: 53.5017758-3.5
 Parameter: YMIN <- "50.0017758"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.2903501"
Evaluating: -21.2903501-3.5
 Parameter: ZMIN <- "-24.7903501"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.95782985"
 Parameter: XMIN -> "0.95782985"
 Parameter: YMAX -> "57.0017758"
 Parameter: YMIN -> "50.0017758"
 Parameter: ZMAX -> "-17.7903501"
 Parameter: ZMIN -> "-24.7903501"
 SELRPN>      9 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      3 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53280 NEG      CLA      103      CLA     -**** MEMB     POPC     233      C11           3.5284
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "223"
Evaluating: 223
 Parameter: J <- "223"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "223" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "223"
 Parameter: NPOS -> "120"
Evaluating: 223-120
 Parameter: J <- "103"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "103"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.819442248"
Evaluating: 112.065471*(0.819442248-0.5)
 Parameter: XPOS <- "35.798446"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "6.019395804E-02"
Evaluating: 112.065471*(6.019395804E-02-0.5)
 Parameter: YPOS <- "-49.2870712"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.900423903"
Evaluating: 142.885239*(0.900423903-0.5)+2.93414115
 Parameter: ZPOS <- "60.1488062"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "60.1488062" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "60.1488062" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.457830 XMAX =    4.457830 XAVE =    4.457830
    YMIN =   53.501776 YMAX =   53.501776 YAVE =   53.501776
    ZMIN =  -21.290350 ZMAX =  -21.290350 ZAVE =  -21.290350
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.798446"
 RDCMND substituted energy or value "?XAVE" to "4.45782985"
Evaluating: 35.798446-4.45782985
 Parameter: XTRAN <- "31.3406161"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.2870712"
 RDCMND substituted energy or value "?YAVE" to "53.5017758"
Evaluating: -49.2870712-53.5017758
 Parameter: YTRAN <- "-102.788847"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "60.1488062"
 RDCMND substituted energy or value "?ZAVE" to "-21.2903501"
Evaluating: 60.1488062--21.2903501
 Parameter: ZTRAN <- "81.4391563"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.3406161"
 Parameter: YTRAN -> "-102.788847"
 Parameter: ZTRAN -> "81.4391563"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR    31.340616 -102.788847   81.439156
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.264295506E-02"
Evaluating: 8.264295506E-02*360.0
 Parameter: XPHI <- "29.7514638"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.65799722E-02"
Evaluating: 3.65799722E-02*360.0
 Parameter: YPHI <- "13.16879"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.749408693"
Evaluating: 0.749408693*360.0
 Parameter: ZPHI <- "269.787129"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.798446"
 Parameter: YPOS -> "-49.2870712"
 Parameter: ZPOS -> "60.1488062"
 Parameter: XPHI -> "29.7514638"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.868186    0.496239
    0.000000   -0.496239    0.868186

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   29.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.798446"
 Parameter: YPOS -> "-49.2870712"
 Parameter: ZPOS -> "60.1488062"
 Parameter: YPHI -> "13.16879"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.973703    0.000000   -0.227821
    0.000000    1.000000    0.000000
    0.227821    0.000000    0.973703

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   13.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.798446"
 Parameter: YPOS -> "-49.2870712"
 Parameter: ZPOS -> "60.1488062"
 Parameter: ZPHI -> "269.787129"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.003715   -0.999993    0.000000
    0.999993   -0.003715    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   90.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.798446 XMAX =   35.798446 XAVE =   35.798446
    YMIN =  -49.287071 YMAX =  -49.287071 YAVE =  -49.287071
    ZMIN =   60.148806 ZMAX =   60.148806 ZAVE =   60.148806
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.798446"
Evaluating: 35.798446+3.5
 Parameter: XMAX <- "39.298446"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.2870712"
Evaluating: -49.2870712+3.5
 Parameter: YMAX <- "-45.7870712"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "60.1488062"
Evaluating: 60.1488062+3.5
 Parameter: ZMAX <- "63.6488062"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.798446"
Evaluating: 35.798446-3.5
 Parameter: XMIN <- "32.298446"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.2870712"
Evaluating: -49.2870712-3.5
 Parameter: YMIN <- "-52.7870712"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "60.1488062"
Evaluating: 60.1488062-3.5
 Parameter: ZMIN <- "56.6488062"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.298446"
 Parameter: XMIN -> "32.298446"
 Parameter: YMAX -> "-45.7870712"
 Parameter: YMIN -> "-52.7870712"
 Parameter: ZMAX -> "63.6488062"
 Parameter: ZMIN -> "56.6488062"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "224"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "224" and "224".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "224"
Evaluating: 224
 Parameter: J <- "224"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "224" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "224"
 Parameter: NPOS -> "120"
Evaluating: 224-120
 Parameter: J <- "104"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.641276143"
Evaluating: 112.065471*(0.641276143-0.5)
 Parameter: XPOS <- "15.8321775"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.737628546"
Evaluating: 112.065471*(0.737628546-0.5)
 Parameter: YPOS <- "26.6299549"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.458774003"
Evaluating: 142.885239*(0.458774003-0.5)+2.93414115
 Parameter: ZPOS <- "-2.95644528"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.95644528" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.95644528" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "224"
Evaluating: 224
 Parameter: J <- "224"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "224" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "224"
 Parameter: NPOS -> "120"
Evaluating: 224-120
 Parameter: J <- "104"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.145612389"
Evaluating: 112.065471*(0.145612389-0.5)
 Parameter: XPOS <- "-39.7146145"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.185775718"
Evaluating: 112.065471*(0.185775718-0.5)
 Parameter: YPOS <- "-35.2136922"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.598499995"
Evaluating: 142.885239*(0.598499995-0.5)+2.93414115
 Parameter: ZPOS <- "17.0083365"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.0083365" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.0083365" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.7146145"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.7146145-0
 Parameter: XTRAN <- "-39.7146145"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.2136922"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.2136922-0
 Parameter: YTRAN <- "-35.2136922"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.0083365"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.0083365-0
 Parameter: ZTRAN <- "17.0083365"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.7146145"
 Parameter: YTRAN -> "-35.2136922"
 Parameter: ZTRAN -> "17.0083365"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -39.714615  -35.213692   17.008336
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.876864703"
Evaluating: 0.876864703*360.0
 Parameter: XPHI <- "315.671293"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.219763392"
Evaluating: 0.219763392*360.0
 Parameter: YPHI <- "79.1148211"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.469779391"
Evaluating: 0.469779391*360.0
 Parameter: ZPHI <- "169.120581"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.7146145"
 Parameter: YPOS -> "-35.2136922"
 Parameter: ZPOS -> "17.0083365"
 Parameter: XPHI -> "315.671293"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.715343   -0.698774
    0.000000    0.698774    0.715343

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   44.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.7146145"
 Parameter: YPOS -> "-35.2136922"
 Parameter: ZPOS -> "17.0083365"
 Parameter: YPHI -> "79.1148211"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.188841    0.000000   -0.982008
    0.000000    1.000000    0.000000
    0.982008    0.000000    0.188841

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   79.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.7146145"
 Parameter: YPOS -> "-35.2136922"
 Parameter: ZPOS -> "17.0083365"
 Parameter: ZPHI -> "169.120581"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.982027    0.188743    0.000000
   -0.188743   -0.982027    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  169.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.714615 XMAX =  -39.714615 XAVE =  -39.714615
    YMIN =  -35.213692 YMAX =  -35.213692 YAVE =  -35.213692
    ZMIN =   17.008336 ZMAX =   17.008336 ZAVE =   17.008336
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.7146145"
Evaluating: -39.7146145+3.5
 Parameter: XMAX <- "-36.2146145"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.2136922"
Evaluating: -35.2136922+3.5
 Parameter: YMAX <- "-31.7136922"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.0083365"
Evaluating: 17.0083365+3.5
 Parameter: ZMAX <- "20.5083365"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.7146145"
Evaluating: -39.7146145-3.5
 Parameter: XMIN <- "-43.2146145"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.2136922"
Evaluating: -35.2136922-3.5
 Parameter: YMIN <- "-38.7136922"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.0083365"
Evaluating: 17.0083365-3.5
 Parameter: ZMIN <- "13.5083365"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.2146145"
 Parameter: XMIN -> "-43.2146145"
 Parameter: YMAX -> "-31.7136922"
 Parameter: YMIN -> "-38.7136922"
 Parameter: ZMAX -> "20.5083365"
 Parameter: ZMIN -> "13.5083365"
 SELRPN>     19 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      7 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
53281 NEG      CLA      104      CLA     -**** MEMB     POPC     71       N             3.7144
53281 NEG      CLA      104      CLA     -**** MEMB     POPC     71       C12           3.9314
53281 NEG      CLA      104      CLA     -**** MEMB     POPC     71       C15           2.8566
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "224"
Evaluating: 224
 Parameter: J <- "224"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "120"
 Comparing "224" and "120".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "224"
 Parameter: NPOS -> "120"
Evaluating: 224-120
 Parameter: J <- "104"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "1.418412177E-02"
Evaluating: 112.065471*(1.418412177E-02-0.5)
 Parameter: XPOS <- "-54.4431852"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "112.065471"
 RDCMND substituted energy or value "?RANDOM" to "0.358247824"
Evaluating: 112.065471*(0.358247824-0.5)
 Parameter: YPOS <- "-15.8855244"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "142.885239"
 Parameter: ZCEN -> "2.93414115"
 RDCMND substituted energy or value "?RANDOM" to "0.363347161"
Evaluating: 142.885239*(0.363347161-0.5)+2.93414115
 Parameter: ZPOS <- "-16.5915324"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.5915324" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.714615 XMAX =  -39.714615 XAVE =  -39.714615
    YMIN =  -35.213692 YMAX =  -35.213692 YAVE =  -35.213692
    ZMIN =   17.008336 ZMAX =   17.008336 ZAVE =   17.008336
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-54.4431852"
 RDCMND substituted energy or value "?XAVE" to "-39.7146145"
Evaluating: -54.4431852--39.7146145
 Parameter: XTRAN <- "-14.7285707"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.8855244"
 RDCMND substituted energy or value "?YAVE" to "-35.2136922"
Evaluating: -15.8855244--35.2136922
 Parameter: YTRAN <- "19.3281678"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.5915324"
 RDCMND substituted energy or value "?ZAVE" to "17.0083365"
Evaluating: -16.5915324-17.0083365
 Parameter: ZTRAN <- "-33.5998689"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.7285707"
 Parameter: YTRAN -> "19.3281678"
 Parameter: ZTRAN -> "-33.5998689"
 SELRPN>      1 atoms have been selected out of  53281
 TRANSLATION VECTOR   -14.728571   19.328168  -33.599869
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.384554997"
Evaluating: 0.384554997*360.0
 Parameter: XPHI <- "138.439799"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.285882707"
Evaluating: 0.285882707*360.0
 Parameter: YPHI <- "102.917775"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.969831608"
Evaluating: 0.969831608*360.0
 Parameter: ZPHI <- "349.139379"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-54.4431852"
 Parameter: YPOS -> "-15.8855244"
 Parameter: ZPOS -> "-16.5915324"
 Parameter: XPHI -> "138.439799"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.748259    0.663407
    0.000000   -0.663407   -0.748259

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  138.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-54.4431852"
 Parameter: YPOS -> "-15.8855244"
 Parameter: ZPOS -> "-16.5915324"
 Parameter: YPHI -> "102.917775"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
   -0.223553    0.000000   -0.974692
    0.000000    1.000000    0.000000
    0.974692    0.000000   -0.223553

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  102.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-54.4431852"
 Parameter: YPOS -> "-15.8855244"
 Parameter: ZPOS -> "-16.5915324"
 Parameter: ZPHI -> "349.139379"
 SELRPN>      1 atoms have been selected out of  53281
 ROTATION MATRIX
    0.982088   -0.188421    0.000000
    0.188421    0.982088    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   10.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  53281
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -54.443185 XMAX =  -54.443185 XAVE =  -54.443185
    YMIN =  -15.885524 YMAX =  -15.885524 YAVE =  -15.885524
    ZMIN =  -16.591532 ZMAX =  -16.591532 ZAVE =  -16.591532
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-54.4431852"
Evaluating: -54.4431852+3.5
 Parameter: XMAX <- "-50.9431852"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.8855244"
Evaluating: -15.8855244+3.5
 Parameter: YMAX <- "-12.3855244"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.5915324"
Evaluating: -16.5915324+3.5
 Parameter: ZMAX <- "-13.0915324"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-54.4431852"
Evaluating: -54.4431852-3.5
 Parameter: XMIN <- "-57.9431852"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.8855244"
Evaluating: -15.8855244-3.5
 Parameter: YMIN <- "-19.3855244"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.5915324"
Evaluating: -16.5915324-3.5
 Parameter: ZMIN <- "-20.0915324"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-50.9431852"
 Parameter: XMIN -> "-57.9431852"
 Parameter: YMAX -> "-12.3855244"
 Parameter: YMIN -> "-19.3855244"
 Parameter: ZMAX -> "-13.0915324"
 Parameter: ZMIN -> "-20.0915324"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  12321 atoms have been selected out of  53281
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12321"
 Comparing "12321" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  69050
 SELRPN>      0 atoms have been selected out of  69050

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "225"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "224"
 Comparing "225" and "224".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @pos end
 Parameter: POS -> "POT"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "120"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @neg end
 Parameter: NEG -> "CLA"
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "104"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>    120 atoms have been selected out of  53281
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "53058"
 Parameter: POSAT <- "53058"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>    104 atoms have been selected out of  53281
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "53178"
 Parameter: NEGAT <- "53178"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "53178" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "53178"
 Comparing "53058" and "53178".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of  53281
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>    120 atoms have been selected out of  53281
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "120"
 Parameter: NPOSATOMS <- "120"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>    104 atoms have been selected out of  53281
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "104"
 Parameter: NNEGATOMS <- "104"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>    120 atoms have been selected out of  53281
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>    120 atoms have been selected out of  53281
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "120"
 Parameter: NIONATOMS <- "120"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "120" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "104" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        9   Number of residues   =     1313
         Number of atoms         =    53281   Number of groups     =    14364
         Number of bonds         =    52964   Number of angles     =   100444
         Number of dihedrals     =   141448   Number of impropers  =     2612
         Number of cross-terms   =      772
         Number of HB acceptors  =     1076   Number of HB donors  =     1154
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4.3_ion_protmemb.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 01. 2022. JOB
 TITLE> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 TITLE> *  DATE:     3/ 1/22      7:38:16      CREATED BY USER: APACHE
 TITLE> *

 ** WARNING ** Coordinates were overwritten for 53057 atoms.
 *** LEVEL  2 WARNING *** BOMLEV IS    0
  
 CHARMM>     
  
 CHARMM>    write coor pdb name step4.3_ion.pdb
 VOPEN> Attempting to open::step4.3_ion.pdb::
 RDTITL>  
 RDTITL> No title read.
  Write CHARMM-pdb format
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-1.136868377E-12"
Evaluating: -1.136868377E-12
 Parameter: CGTOTINIT <- "-1.136868377E-12"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-1.136868377E-12"
Evaluating: INT(-1.136868377E-12)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "-1.136868377E-12"
Evaluating: ABS(0--1.136868377E-12)
 Parameter: CGDIFF <- "1.136868377E-12"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "1.136868377E-12" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    delete atom sele .not. ( segid IONS ) end
 SELRPN>  53057 atoms have been selected out of  53281

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:       1089 residues deleted.

 Message from MAPIC:          8 segments deleted.
 DELTIC:     52964 bonds deleted
 DELTIC:    100444 angles deleted
 DELTIC:    141448 dihedrals deleted
 DELTIC:      2612 improper dihedrals deleted
 DELTIC:       772 crossterm maps deleted
 DELTIC:      1154 donors deleted
 DELTIC:      1076 acceptors deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      224
         Number of atoms         =      224   Number of groups     =      224
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   16.00000
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step4.3_ion.psf
 VOPEN> Attempting to open::step4.3_ion.psf::
 RDTITL> WRITE COOR CARD NAME STEP4.3_ION.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step4.3_ion.crd
 VOPEN> Attempting to open::step4.3_ion.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    write title card name step4.3_ion.str
 VOPEN> Attempting to open::step4.3_ion.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 120
 RDTITL> * SET NNEGTOT = 104
 RDTITL> * SET NIONTOT = 224
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   10 with status "KEEP"
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                     43.22 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    MOST SEVERE WARNING WAS AT LEVEL  1

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:    43.23  SECONDS 
                         CPU TIME:    23.09  SECONDS 
