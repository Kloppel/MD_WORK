! Input script for Charmm generated by 'Charmm_manager'.

dimension chsize 999999
read rtf card name "/home/pbuser/Desktop/PhD_WORK/MD_WORK/Karlsberg/test_example/toppar27/top_alw_clean_kb.inp" 
read rtf card name "/home/pbuser/Desktop/PhD_WORK/MD_WORK/Karlsberg/test_example/toppar27/patches.rtf" append
read rtf card name "/home/pbuser/Desktop/PhD_WORK/MD_WORK/Karlsberg/test_example/toppar27/top_all36_lipid.rtf" append
read rtf card name "/home/pbuser/Desktop/PhD_WORK/MD_WORK/Karlsberg/test_example/toppar27/top_all36_cgenff.rtf" append
read para card name "/home/pbuser/Desktop/PhD_WORK/MD_WORK/Karlsberg/test_example/toppar27/par_all22_prot_plus_heme_and_Cu_kb.inp" 
read para card name "/home/pbuser/Desktop/PhD_WORK/MD_WORK/Karlsberg/test_example/toppar27/patches.prm" append
read para card name "/home/pbuser/Desktop/PhD_WORK/MD_WORK/Karlsberg/test_example/toppar27/par_all36_lipid.prm" append
read para card name "/home/pbuser/Desktop/PhD_WORK/MD_WORK/Karlsberg/test_example/toppar27/par_all36_cgenff.prm" append


read sequence coor name "1ar1_in_A.crd" resid 
generate setup A first ACE last CT1

read sequence coor name "1ar1_in_B.crd" resid 
generate setup B first NTER last CT1

patch disu A 66 A 80

AUTOgenerate ANGLes DIHEdrals

read sequence coor name "1ar1_in_HOH.crd" resid 
generate setup HOH noangle nodihedral

read sequence coor name "1ar1_in_HOH1.crd" resid 
generate setup HOH1 noangle nodihedral

read coor card name "1ar1_in_A.crd"
read coor card name "1ar1_in_B.crd" resid

read coor card name "1ar1_in_HOH.crd" resid
read coor card name "1ar1_in_HOH1.crd" resid

ic para
ic build

hbuild

define sel_1 select (segid A .and. resid 561 .and. type C3) .or. (segid A .and. resid 561 .and. type O3) -
               .or. (segid A .and. resid 561 .and. type C4) .or. (segid A .and. resid 561 .and. type C5) -
               .or. (segid A .and. resid 561 .and. type C6) .or. (segid A .and. resid 561 .and. type C7) -
               .or. (segid A .and. resid 561 .and. type O7) .or. (segid A .and. resid 561 .and. type C8) -
               .or. (segid A .and. resid 561 .and. type C14) .or. (segid A .and. resid 561 .and. type C15) -
               .or. (segid A .and. resid 561 .and. type C16) .or. (segid A .and. resid 561 .and. type C17) -
               .or. (segid A .and. resid 561 .and. type C13) .or. (segid A .and. resid 561 .and. type C18) -
               .or. (segid A .and. resid 561 .and. type C12) .or. (segid A .and. resid 561 .and. type O12) -
               .or. (segid A .and. resid 561 .and. type C11) .or. (segid A .and. resid 561 .and. type C9) -
               .or. (segid A .and. resid 561 .and. type C10) .or. (segid A .and. resid 561 .and. type C19) -
               .or. (segid A .and. resid 561 .and. type C1) .or. (segid A .and. resid 561 .and. type C2) -
               .or. (segid A .and. resid 561 .and. type C20) .or. (segid A .and. resid 561 .and. type C21) -
               .or. (segid A .and. resid 561 .and. type C22) .or. (segid A .and. resid 561 .and. type C23) -
               .or. (segid A .and. resid 561 .and. type CD) .or. (segid A .and. resid 561 .and. type OE1) -
               .or. (segid A .and. resid 561 .and. type OE2) end
cons fix select .not. ( sel_1 .or. hydrogens )   end
minimize sd nsteps 1000 tolg 0.1
minimize abnr nsteps 5000 tolg 0.01

ioformat exten
write coord pdb name "1ar1_out.pdb"
write coord card name "1ar1_out.crd"
write psf card name "1ar1_out.psf"
write psf xplor card name "1ar1_out.xplor.psf"

stop
